
<div class="toast-container">
  <!-- Message d'erreur principal -->
  <div *ngIf="errorMessage" class="alert alert-danger toast-message-danger">
    {{ errorMessage }}
  </div>
  
  <!-- Message de succès -->
  <div *ngIf="successMessage" class="alert alert-success toast-message-success">
    {{ successMessage }}
  </div>
  
  <!-- Erreur API -->
  <div *ngIf="errorMessageApi" class="alert alert-danger toast-message-danger">
    {{ errorMessageApi }}
  </div>
</div>

<!-- Icon return  -->
<p class="retour_icon_text" (click)="navigateBack()" style="cursor: pointer; color: #0672E4;" title="Retour sur la page boutique">
    <i class="ri-arrow-left-s-line"></i> <span style="margin-left: 8px; font-size: 12px;">Boutique</span>
</p>

<div class="container_client">

  <div *ngIf="isLoading" class="loading-overlay">
    <div class="loading-content">
      <div class="spinner"></div>
      <p>Creation en cours...</p>
    </div>
  </div>

  <div class="information_cadre" style="margin-bottom: 20px; padding: 20px;">
    <div class="info_personnel">
        <div class="information_grid_two">
        <!-- Section Profil -->
        <div class="profil_section">
            <div class="section_title">
                <div class="title">
                    <h6>Action boutique</h6>
                </div>
            </div>

            <div class="container_boutique_action">
                <div class="name_permission">
                    Status : 
                    <span 
                        class="h5 valueBoutique"
                        [style.color]="boutique?.actif ? '#008000' : '#ff0000'">
                        {{ boutique?.actif ? 'Actif' : 'Inactif' }}
                    </span>
                </div>

                <label class="switch">
                    <!-- Activer/désactiver le toggle uniquement en mode édition -->
                    <input type="checkbox"/>
                    <span class="slider round"></span>
                </label>
            </div>

            
        </div>
        
        <!-- Section Informations Personnelles -->
        <div class="info_section">
            <div class="section_title">
                <div class="title title_display">
                    <h6>Informations sur les boutiques</h6>
                    <div class="icon_edit">
                    <i *ngIf="!isEditing" 
                        class="ri-edit-box-line" 
                        title="Cliquer ici pour modifier"
                        (click)="toggleEditing()"></i>
                    
                    <i *ngIf="isEditing" style="color: #ff0000;"
                        class="ri-close-line" 
                        title="Fermer l'édition"
                        (click)="toggleEditing()"></i>
                    </div>
                </div>
            </div>
            
            <form [formGroup]="boutiqueForm" class="container_formulaire">
            <div class="champ_grid">
                <!-- Nom de la boutique -->
                <div class="champ_input">
                    <input 
                        formControlName="nomBoutique" 
                        class="input_focus" 
                        placeholder="Saisis le nom de la boutique"
                    >
                    <label class="label">Nouveau nom</label>
                    <div *ngIf="boutiqueForm.get('nomBoutique')?.invalid && boutiqueForm.get('nomBoutique')?.touched">
                        <small class="text-danger">Ce champ est obligatoire</small>
                    </div>
                </div>

                <!-- Adresse de la boutique -->
                <div class="champ_input">
                    <input 
                        formControlName="adresse" 
                        class="input_focus" 
                        placeholder="Saisis l'adresse de la boutique"
                    >
                    <label class="label">Nouvelle adresse</label>
                </div>
            </div>

            <div class="champ_grid">
                <div class="champ_input">
                    <input 
                        formControlName="email" 
                        class="input_focus" 
                        placeholder="Saisis l'email"
                    >
                    <label class="label">Nouvelle email</label>
                </div>

                <div class="champ_input">
                    <input 
                        formControlName="telephone" 
                        class="input_focus" 
                        placeholder="Saisis telephone"
                    >
                    <label class="label">Nouvelle telephone</label>
                </div>
            </div>
            </form>

            <!-- Boutons Ajouter et Sauvegarder -->
            <div class=" information_cadre_save" *ngIf="isEditing">
            <div></div>

            <div class="info_titre_input info_titre_input_btn">
                <div class="btn_annuler">
                <button class="btn_cancel" >{{ isEditing ? 'Annuler' : 'Retour' }}</button>
                </div>
                <div class="btn_ajouter">
                <button 
                    type="submit" 
                    class="btn"
                    [disabled]="boutiqueForm.invalid || isUpdating_boutique"
                >
                    <span *ngIf="!isUpdating_boutique">Confirmer</span>
                    <span *ngIf="isUpdating_boutique">En cours...</span>
                </button>
                </div>
            </div>
            </div>
        
        </div>
        </div>

        <!-- // Pour la copier des produit  -->
        <div class="content_copie_produit">
            <!-- // title  -->
            <div class="section_title" style="display: flex; align-items: center;">
                <div class="title">
                    <h6>Produit dans la boutique</h6>
                </div>

                <div class="barre" style="margin-bottom: 8px;"></div>

                <div class="icon_content icon_delete" style="margin-bottom: 8px;">
                    <i class="ri-delete-bin-6-line"></i>
                </div>

                <div class="barre" style="margin-bottom: 8px;"></div>

                <div class="icon_content" style="margin-bottom: 8px; position: relative;">
                    <i class="ri-folder-transfer-line" (click)="toggleTransferModal()"></i>

                    <!-- Popup de transfert -->
                    <div *ngIf="showTransferModal" class="transfer-modal">
                        <div class="modal-header">
                            <h5>Déplacer vers</h5>
                            <i class="ri-close-line" (click)="closeTransferModal()"></i>
                        </div>
                        <div class="modal-body">
                            <input 
                                type="text" 
                                class="search-input" 
                                placeholder="Rechercher une boutique..." 
                                [(ngModel)]="searchTerm"
                                (input)="filterBoutiques()"
                            >
                            <div class="boutique-list">
                                <div 
                                    *ngFor="let boutique of filteredBoutiques" 
                                    class="boutique-item"
                                    (click)="selectBoutique(boutique)"
                                >
                                    {{ boutique.nomBoutique }}
                                </div>
                                <div *ngIf="filteredBoutiques.length === 0" class="no-results">
                                    Aucune boutique trouvée
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Fin Popup de transfert -->
                </div>

                <div class="icon_content" style="margin-bottom: 8px; margin-left: 25px; position: relative;">
                    <i class="ri-file-copy-2-line" (click)="toggleCopyModal()"></i>
                    
                    <!-- Popup de copie -->
                    <div *ngIf="showCopyModal" class="copy-modal">
                        <div class="modal-header">
                            <h5>Copier vers</h5>
                            <i class="ri-close-line" (click)="closeCopyModal()"></i>
                        </div>
                        <div class="modal-body">
                            <input 
                                type="text" 
                                class="search-input" 
                                placeholder="Rechercher une boutique..." 
                                [(ngModel)]="copySearchTerm"
                                (input)="filterCopyBoutiques()"
                            >
                            <div class="boutique-list">
                                <div 
                                    *ngFor="let boutique of filteredCopyBoutiques" 
                                    class="boutique-item"
                                    (click)="selectCopyBoutique(boutique)"
                                >
                                    {{ boutique.nomBoutique }}
                                </div>
                                <div *ngIf="filteredCopyBoutiques.length === 0" class="no-results">
                                    Aucune boutique trouvée
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!-- // les produits dans cette boutique  -->

            <!-- Tableau des produits -->
            <table>
                <thead>
                <tr class="titleTableProduit">
                    <th>
                        <label class="cyber-checkbox">
                            <input 
                                type="checkbox">
                            <span class="cyber-checkbox__mark">
                            <div class="cyber-checkbox__box">
                                <svg class="cyber-checkbox__check" viewBox="0 0 12 10">
                                <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                                </svg>
                            </div>
                            <div class="cyber-checkbox__effects">
                                <div class="cyber-checkbox__spark"></div>
                                <div class="cyber-checkbox__spark"></div>
                                <div class="cyber-checkbox__spark"></div>
                                <div class="cyber-checkbox__spark"></div>
                            </div>
                            <div class="cyber-checkbox__particles">
                                <div class="particle-1"></div>
                                <div class="particle-2"></div>
                                <div class="particle-3"></div>
                                <div class="particle-4"></div>
                                <div class="particle-5"></div>
                                <div class="particle-6"></div>
                                <div class="particle-7"></div>
                                <div class="particle-8"></div>
                            </div>
                            </span>
                        </label>
                    </th>
                    <th>Photo</th>
                    <th>Nom produit</th>
                    <th>Description</th>
                    <th>Catégorie</th>
                    <th>Prix Vente</th>
                    <th>En stock</th>
                </tr>
                </thead>
                <tbody>
                    
                <tr>
                    <td>
                        <label class="cyber-checkbox">
                            <input 
                                type="checkbox">
                            <span class="cyber-checkbox__mark">
                            <div class="cyber-checkbox__box">
                                <svg class="cyber-checkbox__check" viewBox="0 0 12 10">
                                <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                                </svg>
                            </div>
                            <div class="cyber-checkbox__effects">
                                <div class="cyber-checkbox__spark"></div>
                                <div class="cyber-checkbox__spark"></div>
                                <div class="cyber-checkbox__spark"></div>
                                <div class="cyber-checkbox__spark"></div>
                            </div>
                            <div class="cyber-checkbox__particles">
                                <div class="particle-1"></div>
                                <div class="particle-2"></div>
                                <div class="particle-3"></div>
                                <div class="particle-4"></div>
                                <div class="particle-5"></div>
                                <div class="particle-6"></div>
                                <div class="particle-7"></div>
                                <div class="particle-8"></div>
                            </div>
                            </span>
                        </label>
                    </td>
                    <td>
                        <div class="imgProduit">
                            <img src="assets/img/appareil.jpg" alt="Produit">
                        </div>
                        <div class="modal">
                            <div class="modal-content">
                            <img src="assets/img/appareil.jpg" alt="Produit">
                            </div>
                        </div>
                    </td>
                    <td>Nom</td>
                    <td>Une description</td>
                    <td>Alimentaire</td>
                    <td>12 000</td>
                    <td>65</td>
                </tr>

                <tr>
                    <td>
                        <label class="cyber-checkbox">
                            <input 
                                type="checkbox">
                            <span class="cyber-checkbox__mark">
                            <div class="cyber-checkbox__box">
                                <svg class="cyber-checkbox__check" viewBox="0 0 12 10">
                                <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                                </svg>
                            </div>
                            <div class="cyber-checkbox__effects">
                                <div class="cyber-checkbox__spark"></div>
                                <div class="cyber-checkbox__spark"></div>
                                <div class="cyber-checkbox__spark"></div>
                                <div class="cyber-checkbox__spark"></div>
                            </div>
                            <div class="cyber-checkbox__particles">
                                <div class="particle-1"></div>
                                <div class="particle-2"></div>
                                <div class="particle-3"></div>
                                <div class="particle-4"></div>
                                <div class="particle-5"></div>
                                <div class="particle-6"></div>
                                <div class="particle-7"></div>
                                <div class="particle-8"></div>
                            </div>
                            </span>
                        </label>
                    </td>
                    <td>
                        <div class="imgProduit">
                            <img src="assets/img/appareil.jpg" alt="Produit">
                        </div>
                        <div class="modal">
                            <div class="modal-content">
                            <img src="assets/img/appareil.jpg" alt="Produit">
                            </div>
                        </div>
                    </td>
                    <td>Nom</td>
                    <td>Une description</td>
                    <td>Alimentaire</td>
                    <td>12 000</td>
                    <td>65</td>
                </tr>

                <!-- Message si aucun produit ne correspond à la recherche -->
                <!-- <tr *ngIf="tasks.length > 0 && filteredProducts().length === 0">
                    <td colspan="10" style="text-align: center;">Aucun produit trouvé.</td>
                </tr> -->
                </tbody>
            </table>

        </div>
        <!-- // Fin pour la copier des produit  -->
    </div>
  </div>

</div>










































<div class="container_detail_boutique">

    <div class="title_div">
        <div class="title">
            <span class="h4">Information sur la boutique</span>
        </div>
    </div>

    <div class="content_detail_boutique" *ngIf="!isLoading && !errorMessage">
        <div class="div1_detail_boutique">
            <div class="card_permission_detail_boutique">
                <div class="name_permission">
                    Nom boutique : <span class="h5 valueBoutique"> {{boutique?.nomBoutique || 'Non nom de la boutique' }} </span>
                </div>
            </div>
        </div>
        <div class="div2_detail_boutique">
            <div class="card_permission_detail_boutique">
                <div class="name_permission">
                    Email : <span class="h5 valueBoutique"> {{ boutique?.email || 'Non email' }} </span>
                </div>
            </div>
        </div>
        <div class="div3_detail_boutique">
            <div class="card_permission_detail_boutique">
                <div class="name_permission">
                    Téléphone : <span class="h5 valueBoutique"> {{ boutique?.telephone || 'Non téléphone' }} </span>
                </div>
            </div>
        </div>
        <div class="div4_detail_boutique">
            <div class="card_permission_detail_boutique">
                <div class="name_permission">
                    Date de creation : <span class="h5 valueBoutique"> {{ boutique?.createdAt | date: 'dd/MM/yyyy' }} </span>
                </div>
            </div>
        </div>
        <div class="div5_detail_boutique">
            <div class="card_permission_detail_boutique">
                <div class="name_permission">
                    Adresse : <span class="h5 valueBoutique"> {{ boutique?.adresse || 'Non adresse' }} </span>
                </div>
            </div>
        </div>
        <div class="div6_detail_boutique">
            <div class="card_permission_detail_boutique">
                <div class="name_permission">
                    Status : 
                    <span 
                        class="h5 valueBoutique"
                        [style.color]="boutique?.actif ? '#008000' : '#ff0000'">
                        {{ boutique?.actif ? 'Actif' : 'Inactif' }}
                    </span>
                </div>
            </div>
        </div>
        <div class="div7_detail_boutique">
            <div class="card_permission_detail_boutique">
                <div class="name_permission" style="color: #ff0000;">
                    Suppression<span class="h5 valueBoutique"> </span>
                </div>
            </div>
        </div>
        <div class="div8_detail_boutique" (click)="toggleModificationForm()">
            <div class="card_permission_detail_boutique">
                <div class="name_permission" style="color: #008000;">
                    Modification
                    <span class="h5 valueBoutique" style="float: right;">
                        <i class="ri-arrow-down-s-line icon_cadre" style="font-size: 20px;" 
                        [class.rotated]="isModificationFormVisible"></i>
                    </span>
                </div>
            </div>
        </div>

        <div class="div9_detail_boutique">
            <div class="card_permission_detail_boutique_check">
                <input 
                    id="inpLock" 
                    type="checkbox"
                    [checked]="boutique?.actif"
                    (change)="toggleBoutiqueStatus($event)"
                    [disabled]="isUpdating">
                
                <label class="btn-lock" for="inpLock">
                    <div class="name_permission">
                        {{ boutique?.actif ? 'Désactiver' : 'Activer' }} la boutique 
                    </div>
                    
                    <div class="suspendre_check suspendre_check_cadre">
                        <svg width="19" height="30" viewBox="0 0 36 60">
                            <path class="lockb" d="M27 27C27 34.1797 21.1797 40 14 40C6.8203 40 1 34.1797 1 27C1 19.8203 6.8203 14 14 14C21.1797 14 27 19.8203 27 27ZM15.6298 26.5191C16.4544 25.9845 17 25.056 17 24C17 22.3431 15.6569 21 14 21C12.3431 21 11 22.3431 11 24C11 25.056 11.5456 25.9845 12.3702 26.5191L11 32H17L15.6298 26.5191Z"></path>
                            <path class="lock" d="M6 21V10C6 5.58172 9.58172 2 14 2V2C18.4183 2 22 5.58172 22 10V21"></path>
                            <path class="bling" d="M29 20L31 22"></path>
                            <path class="bling" d="M31.5 15H34.5"></path>
                            <path class="bling" d="M29 10L31 8"></path>
                        </svg>
                    </div>
                </label>
        
                <div *ngIf="isUpdating" class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
        </div>

    </div>

    <!-- Modification Boutique -->
    <!-- <div class="information_cadre information_cadre_visible" [class.visible]="isModificationFormVisible">
        <form 
            [formGroup]="boutiqueForm" 
            (ngSubmit)="onSubmitBoutique()" 
            class="info_titre_input"
        >
            <h5>Modifier nom de boutique</h5>
            <div class="champ_input">
                <input 
                    formControlName="nomBoutique" 
                    class="input_focus" 
                    placeholder="Saisis le nom de la boutique"
                >
                <label class="label">Nouveau nom</label>
                <div *ngIf="boutiqueForm.get('nomBoutique')?.invalid && boutiqueForm.get('nomBoutique')?.touched">
                    <small class="text-danger">Ce champ est obligatoire</small>
                </div>
            </div>

            <div class="champ_input">
                <input 
                    formControlName="adresse" 
                    class="input_focus" 
                    placeholder="Saisis l'adresse de la boutique"
                >
                <label class="label">Nouvelle adresse</label>
            </div>

            <div class="champ_grid">
                <div class="champ_input">
                    <input 
                        formControlName="email" 
                        class="input_focus" 
                        placeholder="Saisis l'email"
                    >
                    <label class="label">Nouvelle email</label>
                </div>
                <div class="champ_input">
                    <input 
                        formControlName="telephone" 
                        class="input_focus" 
                        placeholder="Saisis telephone"
                    >
                    <label class="label">Nouvelle telephone</label>
                </div>
            </div>
            
            <div class="btn_save" style="display: flex; align-items: center; justify-content: space-between;">
                <div class="message_success">
                    <div *ngIf="successMessage" class="alert-success-message">
                        {{ successMessage }}
                    </div>
                </div>
                <button 
                    type="submit" 
                    class="btn"
                    [disabled]="boutiqueForm.invalid || isUpdating_boutique"
                >
                    <span *ngIf="!isUpdating_boutique">Confirmer</span>
                    <span *ngIf="isUpdating_boutique">En cours...</span>
                </button>
            </div>
        </form>
    </div> -->
</div>

<div *ngIf="isLoading" class="loading-overlay">
    <div class="loading-content">
      <div class="spinner"></div>
      <p>Connexion en cours...</p>
    </div>
</div>




<!-- Ajoutez ceci en bas du template -->
<div class="confirmation-modal" *ngIf="showConfirmationModal">
  <div class="modal-content">
    <h4>{{ confirmationTitle }}</h4>
    <p>{{ confirmationMessage }}</p>
    <div class="modal-actions">
      <button class="btn-cancel" (click)="cancelAction()">Annuler</button>
      <button class="btn-confirm" (click)="handleStatusChange()">Confirmer</button>
    </div>
  </div>
</div>