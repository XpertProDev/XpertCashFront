<div class="toast-container">

  <div *ngIf="errorMessage" class="alert alert-danger toast-message-danger">
    {{ errorMessage }}
  </div>
  <div *ngIf="successMessage" class="alert alert-success toast-message-success">
    {{ successMessage }}
  </div>

</div>

<div class="container">
    <aside class="sidebar">
      <div class="profile">
        <img src="assets/img/profil.png" alt="Chet Faker" class="profile-img">
        <h2>{{userName}}</h2>
        <p class="profil_email">{{email}}</p>
        <h5 style="color: #0672E4; letter-spacing: 0.60px;">{{roleType}}</h5>
        <div class="stats">
          <!-- <div>12<br>Utilisateurs</div> -->
          <div>05<br>Comptable</div>
          <div>02<br>RH</div>
          <div>50<br>Vendeur</div>
        </div>
      </div>
      
    </aside>
    <main class="main-content">
      <header>
        <h1>Profil</h1>
      </header>
      <div class="container_form_profil">
        <div class="form-row div1">
          <label for="company">Entreprise</label>
          <input type="text" id="company" value="{{ nomEntreprise }}" readonly>
        </div>
        <div class="form-row div3">
          <label for="email">Email address</label>
          <input type="email" id="email" value="{{email}}" readonly>
        </div>
        <div class="form-row div4">
          <label for="firstName">Boutique</label>
          <input type="text" id="firstName" value="{{nomBoutique}}" readonly>
        </div>
        <div class="form-row div5">
          <label for="country">Device</label>
          <input type="text" id="Device" value="FCFA" readonly>
        </div>
      
        <div class="form-row div7">
          <label for="city">Pays</label>
          <input type="text" id="city" value="{{pays}} {{ flagPays }}" readonly>
        </div>
        <div class="form-row div8">
          <label for="lastName">Téléphone</label>
          <input type="text" id="lastName" value="{{phone}}" readonly>
        </div>
      </div>
    </main>
</div>

<!-- // PARAMETRE  -->
<div class="container_parametre">
    <div class="content_parametre">
        <!-- // titre pour Paramètre du compte -->
        <div class="title">
            <p>Paramètre du compte</p>
        </div>
        <!-- // cadre action  -->
        <div class="cadre_content">
            <!-- // Modifier le compte  -->
            <div class="cadre cadre_cursor" (click)="toggleUserForm()">
                <!-- // title_cadre  -->
                <div class="title_cadre" >
                    <span>Modifier le compte</span>
                </div>
                <!-- // icon  -->
                <div class="icon_cadre">
                    <i class="ri-arrow-right-s-line"></i>
                </div>
            </div>
            <!-- Profile -->
            <div class="information_cadre information_cadre_visible" [class.visible]="isUserFormVisible">
              <form [formGroup]="nomCompletForm" (ngSubmit)="onSubmitUpdateUser()" class="info_titre_input">
                <h5>Modification Profil</h5>
            
                <!-- Nom -->
                <div class="champ_input">
                  <input 
                    formControlName="nomComplet" 
                    class="input_focus" 
                    placeholder="Saisissez votre nom complet"
                  >
                  <label class="label labelColor">Nom</label>
                  <div *ngIf="nomCompletControl?.touched && nomCompletControl?.invalid">
                    <small class="text-danger" *ngIf="nomCompletControl?.errors?.['required']">
                      Ce champ est obligatoire
                    </small>
                  </div>
                </div>
            
                <!-- Phone User -->
                <div class="champ_input">
                  <input 
                    type="tel"
                    formControlName="phone" 
                    class="input_focus" 
                    placeholder="Saisissez votre numéro de téléphone"
                  >
                  <label class="label labelColor">Votre numéro</label>
                  <div *ngIf="phoneControl?.touched && phoneControl?.invalid">
                    <small class="text-danger" *ngIf="phoneControl?.errors?.['required']">
                      Ce champ est obligatoire
                    </small>
                  </div>
                </div>
            
                <!-- Mot de passe -->
                <div class="champ_input">
                  <input 
                    [type]="showCurrentPassword ? 'text' : 'password'" 
                    formControlName="password" 
                    class="input_focus" 
                    placeholder="Saisissez votre mot de passe"
                  >
                  <label class="label labelColor">Votre mot de passe</label>
                  <div *ngIf="passwordControl?.touched && passwordControl?.invalid">
                    <small class="text-danger" *ngIf="passwordControl?.errors?.['required']">
                      Ce champ est obligatoire
                    </small>
                  </div>
                
                  <!-- Icone œil pour basculer la visibilité -->
                  <div class="eye_container" (click)="toggleCurrentPasswordVisibility()">
                    <div class="eye_ferme" *ngIf="!showCurrentPassword">
                      <i class="ri-eye-close-line"></i>
                    </div>
                    <div class="eye_ouvre" *ngIf="showCurrentPassword">
                      <i class="ri-eye-line"></i>
                    </div>
                  </div>
                </div>
                

                
            
                <!-- Bouton de soumission -->
                <div class="btn_save">
                  <button 
                    type="submit" 
                    class="btn"
                    [disabled]="nomCompletForm.invalid || isLoading"
                  >
                    <span *ngIf="!isLoading">Confirmer</span>
                  </button>
                </div>
              </form>
            </div>
            


            <!-- // Modifier nom de boutique  -->
            <div class="cadre">
                <!-- // title_cadre  -->
                <div class="title_cadre">
                    <span>Nom et Adress de la boutique</span>
                </div>
                <!-- // icon  -->
                <div class="icon_cadre">
                    <button class="btn" (click)="toggleNomBoutiqueForm()">Modifier</button>
                </div>
              
            </div>

               <!-- Modification Boutique -->
               <div class="information_cadre information_cadre_visible" [class.visible]="isNomBoutiqueFormVisible">
                <form [formGroup]="nomBoutiqueForm" (ngSubmit)="onSubmitNomBoutique()" class="info_titre_input">
                  <h5>Modifier nom de boutique</h5>

                  <!-- Nom de la boutique -->
                  <div class="champ_input">
                    <input 
                      formControlName="nomBoutique" 
                      class="input_focus" 
                      placeholder="Saisis le nom de la boutique"
                    >
                    <label class="label labelColor">Nom de la Boutique</label>
                    <div *ngIf="nomBoutiqueControl?.touched && nomBoutiqueControl?.invalid">
                      <small class="text-danger" *ngIf="nomBoutiqueControl?.errors?.['required']">
                        Ce champ est obligatoire
                      </small>
                    </div>
                  </div>

                  <!-- Adresse de la boutique -->
                  <div class="champ_input">
                    <input 
                      formControlName="adresse" 
                      class="input_focus" 
                      placeholder="Saisis l'adresse de la boutique"
                    >
                    <label class="label labelColor">Adresse de la Boutique</label>
                    <!-- <div *ngIf="adresseControl?.touched && adresseControl?.invalid">
                      <small class="text-danger" *ngIf="adresseControl?.errors?.['required']">
                        Ce champ est obligatoire
                      </small>
                    </div> -->
                  </div>

                  <!-- Bouton de soumission -->
                  <div class="btn_save">
                    <button 
                      type="submit" 
                      class="btn"
                      [disabled]="nomBoutiqueForm.invalid || isLoading"
                    >
                      <span *ngIf="!isLoading">Confirmer</span>
                    </button>
                  </div>
                </form>
              </div>
            
            <div class="groupe_cadre">
              <!-- // Modifier le mot de passe  -->
              <div class="cadre">
                <!-- // title_cadre  -->
                <div class="title_cadre">
                    <span>Mot de passe</span>
                </div>
                <!-- // icon  -->
                <div class="icon_cadre">
                    <button class="btn" (click)="togglePasswordForm()">Modifier</button>
                </div>
              </div>

              <!-- Les information des produit Inventaire  -->
              <div class="information_cadre information_cadre_visible" [class.visible]="isPasswordFormVisible">
                <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()" class="info_titre_input">
                  <h5>Modifier mot de passe</h5>

                  <!-- Ancien mot de passe -->
                  <div class="champ_input">
                    <input 
                      formControlName="currentPassword" 
                      [type]="showCurrentPassword ? 'text' : 'password'"
                      class="input_focus" 
                      placeholder="Saisis le mot de passe actuel"
                    >
                    <label class="label labelColor">Mot de passe actuel</label>
                    <div *ngIf="currentPassword?.touched && currentPassword?.invalid">
                      <small class="text-danger" *ngIf="currentPassword?.errors?.['required']">
                        Ce champ est obligatoire
                      </small>
                    </div>

                    <!-- // icon eye_container -->
                    <div class="eye_container" (click)="toggleCurrentPasswordVisibility()">
                      <div class="eye_ferme" *ngIf="!showCurrentPassword">
                        <i class="ri-eye-close-line"></i>
                      </div>
                      <div class="eye_ouvre" *ngIf="showCurrentPassword">
                        <i class="ri-eye-line"></i>
                      </div>
                    </div>

                  </div>

                  <!-- Nouveau mot de passe -->
                  <div class="champ_input">
                    <input 
                      formControlName="newPassword"
                      [type]="showNewPassword ? 'text' : 'password'"
                      class="input_focus" 
                      placeholder="Saisis un nouveau mot de passe"
                    >
                    <label class="label labelColor">Nouveau mot de passe</label>
                    <div *ngIf="newPassword?.touched && newPassword?.invalid">
                      <small class="text-danger" *ngIf="newPassword?.errors?.['required']">
                        Ce champ est obligatoire
                      </small>
                      <small class="text-danger" *ngIf="newPassword?.errors?.['minlength']">
                        Minimum 8 caractères
                      </small>
                    </div>

                    <!-- // icon eye_container -->
                    <div class="eye_container" (click)="toggleNewPasswordVisibility()">
                      <div class="eye_ferme" *ngIf="!showNewPassword">
                        <i class="ri-eye-close-line"></i>
                      </div>
                      <div class="eye_ouvre" *ngIf="showNewPassword">
                        <i class="ri-eye-line"></i>
                      </div>
                    </div>
                  </div>

                  <!-- Confirmation mot de passe -->
                  <div class="champ_input">
                    <input 
                      formControlName="confirmPassword"
                      [type]="showNewPassword ? 'text' : 'password'"
                      class="input_focus" 
                      placeholder="Confirmer le nouveau mot de passe"
                    >
                    <label class="label labelColor">Confirmer le nouveau mot de passe</label>
                    <div *ngIf="confirmPassword?.touched && passwordForm.invalid">
                      <small class="text-danger" *ngIf="passwordForm.errors?.['mismatch']">
                        Les mots de passe ne correspondent pas
                      </small>
                    </div>

                  </div>

                  <!-- Messages d'erreur/succès -->
                  <!-- <div *ngIf="errorMessage" class="alert alert-danger">
                    {{ errorMessage }}
                  </div>
                  <div *ngIf="successMessage" class="alert alert-success">
                    {{ successMessage }}
                  </div> -->

                  <!-- Bouton de soumission -->
                  <div class="btn_save">
                    <button 
                      type="submit" 
                      class="btn"
                      [disabled]="passwordForm.invalid || isLoading">
                      <span *ngIf="!isLoading">Confirmer</span>
                      <!-- <span *ngIf="isLoading">Chargement...</span> -->
                    </button>
                  </div>
                </form>
              </div>

            </div>

            <!-- // Modifier le email  -->
            <!-- <div class="cadre">
                <div class="title_cadre">
                    <span>Email</span>
                </div>
                <div class="icon_cadre">
                    <button class="btn">Modifier</button>
                </div>
            </div> -->

        </div>
    </div>
</div>