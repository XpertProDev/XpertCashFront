<div class="toast-container">

  <div *ngIf="errorMessage" class="alert alert-danger toast-message-danger">
    {{ errorMessage }}
  </div>
  <div *ngIf="successMessage" class="alert alert-success toast-message-success">
    {{ successMessage }}
  </div>

</div>


<div class="tab-content">
    <div class="container_compte_profil">
        <div class="champ_grid_double">
            <!-- // Cadre photo left -->
            <div class="setting_profil cadre_photo">
                <div class="content_setting_profil profile">
                    <!-- // titre de profil  -->
                    <div class="tilte_profil">
                        <h4>Page profil</h4>
                        <p>Changez votre photo de profil à partir d'ici</p>
                    </div>

                    <!-- // Img de profil  -->
                    <div class="profile-img-wrapper">
                        <img
                          [src]="photo || 'assets/img/profil.png'"
                          (error)="photo = 'assets/img/profil.png'"
                          alt="Photo de profil"
                          class="profile-img"
                          (click)="visualiserPhoto($event)" />

                        <!-- Icône en haut à droite -->
                        <div class="menu-button" (click)="toggleMenu($event)">
                          <span>changer la photo</span>
                        </div>

                    </div>
                  <!-- Dropdown -->
                      <div class="dropdown-menu" *ngIf="menuOuvert">
                          <button (click)="visualiserPhoto($event)">
                          <i class="fa fa-eye icon-in-menu"></i>
                          Voir la photo
                        </button>

                        <button (click)="changerPhoto($event)">
                          <i class="fas fa-camera icon-in-menu"></i>
                          Modifier
                        </button>
                        <button (click)="supprimerPhoto($event)">
                          <i class="fas fa-trash icon-in-menu"></i>
                          Supprimer
                        </button>
                    </div>





                    <input
                      type="file"
                      id="fileInput"
                      accept="image/*"
                      (change)="onFileSelected($event)"
                      hidden />

                    <!-- Lightbox de visualisation -->
                    <div class="photo-modal" *ngIf="isModalOpen" (click)="fermerModal()">
                      <div class="photo-modal-content" (click)="$event.stopPropagation()">
                        <img [src]="photo || 'assets/img/profil.png'"(error)="photo = 'assets/img/profil.png'">
                        <button class="fermer-btn" (click)="fermerModal()">✕</button>
                      </div>
                    </div>

                    <h2>{{ userName }}</h2>
                    
                    <p class="profil_email">{{ email }}</p>

                    <h5 style="color: #0672E4; letter-spacing: 0.60px;">{{ roleType }}</h5>

                    <div class="stats">
                      <div>Code Personnel<br>
                        <span class="showCode" [ngClass]="{ 'blurred': !showCode }" >{{ personalCode }}</span>
                          <button class="btnC"
                          (click)="toggleCodeVisibility()" 
                          style="background: none; border: none; cursor: pointer;"
                          aria-label="Afficher/Masquer le code"
                        >
                          <i class="fa" [ngClass]="showCode ? 'fa-eye-slash' : 'fa-eye'"></i>
                        </button>
                      </div>
                    </div>
                </div>
            </div>
            <!-- // Cadre password right -->
            <div class="setting_profil cadre_password">
                <!-- // titre de profil  -->
                <div class="tilte_profil">
                    <h5>Information personnel</h5>
                    <p>Pour changer les informations vous pouvez  <br>le faire dans paramètre</p>
                </div>

                <!-- // Input pour changer mot de passe  -->
                <div class="info_titre_input">
                    <!-- <h5>Modifier mot de passe</h5> -->

                    <!-- Nom de entreprise -->
                    <div class="champ_input">
                        <input id="company" value="{{nomEntreprise}}" disabled class="input_focus" style="cursor: no-drop;">
                        <label for="company" class="label labelColor">Votre email</label>
                    </div>

                    <!-- Emial de entreprise  -->
                    <div class="champ_input">
                        <input id="email" value="{{email}}" disabled class="input_focus" style="cursor: no-drop;">
                        <label for="email" class="label labelColor">Votre email</label>
                    </div>

                    <!-- Pays et telephone -->
                    <div class="champ_grid">
                      <!-- Pays  -->
                      <div class="champ_input">
                          <input id="city" value="{{pays}} {{ flagPays }}" disabled class="input_focus" style="cursor: no-drop;">
                          <label for="city" class="label labelColor">Pays</label>
                      </div>
                      <!-- Telephone  -->
                      <div class="champ_input">
                          <input id="lastName" value="{{phone || 'Aucun numéro'}}" disabled class="input_focus" style="cursor: no-drop;">
                          <label for="lastName" class="label labelColor">Numéro téléphone</label>
                      </div>
                    </div>

                    <!-- Les boutiques  -->
                     <div class="form-row" style="margin-top: 20px;"> 
                      <label for="boutiques">Boutiques</label>
                      <div id="boutiques" class="boutiques-list">
                        <span *ngFor="let boutique of boutiques" class="boutique-tag">
                          {{ boutique.nomBoutique }}
                        </span>
                        <span *ngIf="boutiques.length === 0">Aucune boutique</span>
                      </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- // Reste de l'information de user pour la modification  -->
        <div class="info_personnel">
            <!-- // titre de profil  -->
            <div class="tilte_profil">
                <h5>Détails personnels</h5>
                <p>Pour modifier vos informations personnelles, modifiez-les et enregistrez-les ici</p>
            </div>
        </div>
    </div>
</div>

