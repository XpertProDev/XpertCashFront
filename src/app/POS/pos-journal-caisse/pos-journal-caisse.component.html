<!-- pos-journal-caisse.component.html -->
<div class="journal-container">
  <!-- Header amélioré -->
  <div class="journal-header">
    <div class="header-left">
      <button class="back-button" (click)="goBack()">
        <i class="ri-arrow-left-line"></i>
      </button>
      <h2>Journal des Caisses</h2>
    </div>
    
    <div class="header-actions">
      <div class="search-container">
        <i class="ri-search-line"></i>
        <input 
          type="text" 
          placeholder="Rechercher..." 
          [(ngModel)]="searchTerm"
        />
        <select [(ngModel)]="statusFilter" class="filter-select">
          <option value="">Tous les statuts</option>
          <option value="OUVERTE">Ouvertes</option>
          <option value="FERMEE">Fermées</option>
        </select>
      </div>
      <button class="sort-button" (click)="toggleSortDirection()">
        <i class="ri-sort-desc" *ngIf="sortDirection === 'desc'"></i>
        <i class="ri-sort-asc" *ngIf="sortDirection === 'asc'"></i>
      </button>
    </div>
  </div>

  <!-- Section de filtres améliorée -->
  <div class="filters-section">
    <div class="filter-tags">
      <span class="filter-tag" *ngIf="statusFilter">
        Statut: {{ statusFilter === 'OUVERTE' ? 'Ouvertes' : 'Fermées' }}
        <i class="ri-close-line" (click)="statusFilter = ''"></i>
      </span>
    </div>
    <div class="summary">
      <span>{{ filteredCaisses.length }} opération(s)</span>
    </div>
  </div>

  <!-- États améliorés -->
  <div *ngIf="isLoading" class="state-container">
    <div class="loading-content">
      <div class="spinner"></div>
      <p>Chargement de l'historique...</p>
    </div>
  </div>

  <div *ngIf="!isLoading && errorMessage" class="state-container">
    <div class="error-content">
      <i class="ri-error-warning-fill"></i>
      <p>{{ errorMessage }}</p>
      <button (click)="loadCaisses()">Réessayer</button>
    </div>
  </div>

  <div *ngIf="!isLoading && !errorMessage && filteredCaisses.length === 0" class="state-container">
    <div class="empty-content">
      <i class="ri-file-list-3-line"></i>
      <p>Aucune opération de caisse trouvée</p>
      <button (click)="loadCaisses()">Actualiser</button>
    </div>
  </div>

  <!-- Nouveau design en cartes -->
  <div *ngIf="!isLoading && !errorMessage && filteredCaisses.length > 0" class="caisse-cards">
    <div class="card" *ngFor="let caisse of filteredCaisses">
      <div class="card-header">
        <!-- <span class="card-id">#{{caisse.id}}</span> -->
        <span class="status-badge" [class.open]="caisse.statut === 'OUVERTE'" [class.closed]="caisse.statut === 'FERMEE'">
          {{ caisse.statut === 'OUVERTE' ? 'Ouverte' : 'Fermée' }}
        </span>
      </div>
      
      <div class="card-body">
        <div class="info-row">
          <i class="ri-calendar-event-line"></i>
          <div>
            <label>Ouverture</label>
            <p>{{ formatDate(caisse.dateOuverture) }}</p>
          </div>
        </div>
        
        <div class="info-row">
          <i class="ri-calendar-check-line"></i>
          <div>
            <label>Fermeture</label>
            <p>{{ caisse.dateFermeture ? formatDate(caisse.dateFermeture) : 'En cours' }}</p>
          </div>
        </div>
      </div>
      
      <div class="card-footer">
        <div class="amount">
          <label>Initial</label>
          <p>{{ caisse.montantInitial | currency:'XOF ':'symbol':'1.0-0' }}</p>
        </div>
        <div class="amount">
          <label>Final</label>
          <p>{{ caisse.montantCourant | currency:'XOF ':'symbol':'1.0-0' }}</p>
        </div>
      </div>
    </div>
  </div>
</div>