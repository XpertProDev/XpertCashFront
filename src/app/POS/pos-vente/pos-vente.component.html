<div class="section_contenu_container">
  <!-- // section contenu left -->
  <div class="section_contenu_left">
    <!-- // section favory produit -->
    <div class="section_favory_produit">
      <!-- // section favory -->
      <div class="section_favory">
        <!-- // ul pour le favory  -->
        <ul class="ul_section_favory">
          <li class="li_section_favory" style="display: flex; align-items: center; justify-content: space-between;">
            <div class="double">
              <!-- // icon de favory  -->
              <div class="icon_favory">
                <i class="ri-heart-fill"></i>
              </div>
              <!-- // Title de Favory -->
              <p class="title_favory">Favorie</p>
            </div>

            <div class="nombre_favory">
              03
            </div>
          </li>
        </ul>
        <!-- // categorie -->
        <div class="titre_categorie">
          <p (click)="showAllProducts()">Toutes les catégories</p> <!-- Ajoutez ce click -->
        </div>
        <ul class="ul_name_categorie" *ngIf="categories.length">
          <!-- Boucle sur les catégories -->
          <li *ngFor="let categorie of categories" 
              class="ul_li_name_categorie"
              [class.selected]="selectedCategoryId === categorie.id"
              (click)="selectCategory(categorie.id)" >
            <div class="name_categorie">
              <span>{{ categorie.nom }}</span>
            </div>
            <div class="nombre">
                {{ categorie.produitCount || 0 }}
            </div>
          </li>
        </ul>
      </div>
      <!-- // section produit -->
      <div class="section_produit">
        <!-- on transforme cadre_produit en container de grille -->
        <div class="cadre_produit product-grid" *ngIf="isListView">
          
          <div class="product-card" *ngFor="let produit of displayedProducts">
            <!-- pastille de stock en haut à gauche -->
            <span class="stock-badge">00</span>

            <!-- image produit -->
            <img [src]="getProductImage(produit.photo)" alt="" class="product-img">

            <!-- cœur favori -->
            <i class="ri-heart-line favorite-icon"></i>

            <!-- zone texte -->
            <div class="card-body">
              <p class="product-name">{{ produit.nom }}</p>
              <p class="product-stock">Stocks : {{ produit.quantite }}</p>
            </div>

            <div class="bottom_price_sub">
              <div class="product-price">
                <p>{{ produit.prixVente | currency:'CFA ':'symbol':'1.0-0' }}</p>
              </div>
              <button class="btn-decrement">
                <i class="ri-subtract-line"></i>
              </button>
            </div>
          </div>

          <div *ngIf="!categories.length" class="loading-indicator">
            <i class="ri-loader-4-line"></i> Chargement des produits...
          </div>

        </div>

        <!-- Mode Liste -->
        <div class="cadre_produit_list product-list" *ngIf="!isListView">
          <ul class="ul_list">
            <li class="li_list" *ngFor="let produit of displayedProducts">
              <div class="list_left">
                <div class="double">
                  <div class="img_product_list">
                    <img [src]="getProductImage(produit.photo)" alt="">
                  </div>
                  <div class="name_stock_list">
                    <p class="product-name-list">{{ produit.nom }}</p>
                    <p class="product-stock-list">Stocks : {{ produit.quantite }}</p>
                  </div>
                </div>
              </div>
              
              <div class="list_right">
                <div class="double">
                  <div class="product-price">
                    <p>{{ produit.prixVente | currency:'CFA ':'symbol':'1.0-0' }}</p>
                  </div>
                  <div class="btn_badge">
                    <span class="stock-badge-list">{{ produit.quantite }}</span>
                  </div>
                  <button class="btn-decrement">
                    <i class="ri-subtract-line"></i>
                  </button>
                  <div class="btn_fovory">
                    <i class="ri-heart-line favorite-icon-list"></i>
                  </div>
                </div>
              </div>
            </li>
          </ul>
          <div *ngIf="displayedProducts.length === 0 && categories.length" class="empty-category">
            Aucun produit dans cette catégorie
          </div>
        </div>
      </div>

    </div>
  </div>
  <!-- // section contenu right -->
  <div class="section_contenu_right" style="background-color: #ffffff; height: 100vh; box-shadow: rgba(0, 0, 0, 0.04) 0px 3px 5px;">
    <div class="list_produit_select">
      <!-- // Tout les liste de produc select  -->
      <ul class="ul_list_produit_select">
        <li class="li_list_produit_select">
          <div class="double">
            <!-- // nombre select  -->
            <div class="nombre_select">
              10
            </div>
            <!-- // name produit select  -->
            <div class="name_produit_select">
              <p style="margin: 0;">Ordinateur <span>(20 000 CFA)</span></p>
            </div>
          </div>
          <div class="double">
            <!-- // nombre select  -->
            <div class="price_produit">
              200 000 CFA
            </div>
            <!-- // name produit select  -->
            <div class="icon_close_select">
              <i class="ri-close-circle-fill"></i>
            </div>
          </div>
        </li>
        <li class="li_list_produit_select">
          <div class="double">
            <!-- // nombre select  -->
            <div class="nombre_select">
              10
            </div>
            <!-- // name produit select  -->
            <div class="name_produit_select">
              <p style="margin: 0;">Ordinateur <span>(20 000 CFA)</span></p>
            </div>
          </div>
          <div class="double">
            <!-- // nombre select  -->
            <div class="price_produit">
              200 000 CFA
            </div>
            <!-- // name produit select  -->
            <div class="icon_close_select">
              <i class="ri-close-circle-fill"></i>
            </div>
          </div>
        </li>
        <li class="li_list_produit_select">
          <div class="double">
            <!-- // nombre select  -->
            <div class="nombre_select">
              10
            </div>
            <!-- // name produit select  -->
            <div class="name_produit_select">
              <p style="margin: 0;">Ordinateur <span>(20 000 CFA)</span></p>
            </div>
          </div>
          <div class="double">
            <!-- // nombre select  -->
            <div class="price_produit">
              200 000 CFA
            </div>
            <!-- // name produit select  -->
            <div class="icon_close_select">
              <i class="ri-close-circle-fill"></i>
            </div>
          </div>
        </li>
      </ul>
    </div>
    
    <!-- 2. Récapitulatif : Remise / Taxes / Total -->
    <div class="summary_panel">
      <!-- <div class="double_row">
        <span>Remise</span>
        <span>00 CFA</span>
      </div> -->
      <div class="double_row">
        <span>Taxes</span>
        <span>00 CFA</span>
      </div>
      <div class="double_row total">
        <strong>Total</strong>
        <strong>00 CFA</strong>
      </div>
    </div>

    <!-- 3. Clavier numérique + actions -->
    <div class="keypad">
      <button>1</button><button>2</button><button>3</button><button>Qté</button>
      <button>4</button><button>5</button><button>6</button><button>%</button>
      <button>7</button><button>8</button><button>9</button><button>Prix</button>
      <button>+/-</button><button>0</button><button>,</button><button class="backspace"><i class="ri-delete-back-2-line"></i></button>
    </div>

    <!-- 4. Bouton de paiement -->
    <div class="btn_content">
      <button class="btn-payment" (click)="openPaymentPopup()">Paiement</button>
    </div>
  </div>
</div>

<!-- Popup de paiement -->
<div *ngIf="showPaymentPopup" class="payment-popup-overlay">
  <div class="payment-popup">
    <div class="popup-header">
      <button (click)="closePaymentPopup()" class="close-btn">
        <i class="ri-close-line"></i>
      </button>
    </div>

    <div class="section_popup_paiement">
      <div class="cadre_section_contenu_left_prise">
        <div class="section_contenu_left_prise">

          <!-- 1. Montant du paiement -->
          <div class="montant_paiement">
            <h1>140 0000</h1>
            <span>CFA</span>
          </div>

          <!-- 2. Moyens de paiement -->
          <div class="moyen_paiement_price">
            <div
              class="moyen_paiement">
              <p>Espèces</p>
            </div>
            <div class="moyen_prise_du">
              <div class="price_du">
                <p>0000 CFA</p>
                <i class="ri-close-line clear-icon"></i>
              </div>
            </div>
          </div>


          <div class="paiement_restant">
            <div
              class="moyen_paiement_restant">
              <p style="color: #008000;">Restant</p>
            </div>
            <div class="moyen_prise_du">
              <div class="price_du">
                <p style="color: #008000;">0 CFA</p>
              </div>
            </div>
          </div>

          <!-- 3. Remise par produit -->
          <div class="discount-input">
            <button class="btn-currency">
              <!-- $ -->
              CFA
            </button>
            <input
              type="text"
              placeholder="0"
              class="input-discount"
            />
            <!-- <span class="discount-unit">CFA</span> -->
            <button class="btn-percent">
              %
            </button>
          </div>
          <div class="discount-label">
            <p>Remise par produit</p>
          </div>

        </div>
      </div>

      <div class="section_contenu_right" style="background-color: #ffffff; height: 80vh; box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;">
        <div class="list_produit_select">
          <!-- // Tout les methode paiement  -->
          <div class="methode_paiement">
            <div class="cadre_paiement">
              <!-- // img_paiement  -->
              <div class="img_paiement">
                <img src="assets/img/payer.png" alt="">
              </div>
              <!-- // titre paiement -->
              <div class="title_paiement">
                <p>Espèces</p>
              </div>
            </div>
            <div class="cadre_paiement">
              <!-- // img_paiement  -->
              <div class="img_paiement img_paiement_carte">
                <img src="assets/img/carte-de-credit.png" alt="">
              </div>
              <!-- // titre paiement -->
              <div class="title_paiement">
                <p>Carte</p>
              </div>
            </div>
            <div class="cadre_paiement">
              <!-- // img_paiement  -->
              <div class="img_paiement img_paiement_compte">
                <img src="assets/img/compte-rendu.png" alt="">
              </div>
              <!-- // titre paiement -->
              <div class="title_paiement">
                <!-- <p>Compte</p> -->
                <p>Compte <br>client</p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 2. Récapitulatif : Client et facture -->
        <div class="client_facture">
          <div class="double_client_facture">
            <div class="paiement_btn btn_client">
              <p>Client</p>
            </div>
            <div class="paiement_btn btn_facture">
              <p>Facture</p>
              <input type="checkbox">
            </div>
          </div>
        </div>

        <!-- 3. Clavier numérique + actions -->
        <div class="keypad" style="padding-top: 5px;">
          <button>1</button><button>2</button><button>3</button><button>Qté</button>
          <button>4</button><button>5</button><button>6</button><button>%</button>
          <button>7</button><button>8</button><button>9</button><button>Prix</button>
          <button>+/-</button><button>0</button><button>,</button><button class="backspace"><i class="ri-delete-back-2-line"></i></button>
        </div>

        <!-- 4. Bouton de paiement -->
        <div class="btn_content">
          <button class="btn-payment-pop" (click)="openPaymentPopup()">Paiement</button>
        </div>
      </div>
    </div>
    
  </div>
</div>