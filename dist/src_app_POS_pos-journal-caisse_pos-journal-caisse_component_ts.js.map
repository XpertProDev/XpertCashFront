{"version":3,"file":"src_app_POS_pos-journal-caisse_pos-journal-caisse_component_ts.js","mappings":"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","sources":["./src/app/POS/pos-journal-caisse/pos-journal-caisse.component.ts","./src/app/POS/pos-journal-caisse/pos-journal-caisse.component.html","./src/app/admin-page/SERVICES/CaisseService/boutique-state.service.ts","./src/app/admin-page/SERVICES/CaisseService/pos-caisse-service.ts"],"sourcesContent":["// pos-journal-caisse.component.ts\nimport { CommonModule } from '@angular/common';\nimport { Component } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { CaisseResponse } from 'src/app/admin-page/MODELS/CaisseModel/caisse.model';\nimport { BoutiqueService } from 'src/app/admin-page/SERVICES/boutique-service';\nimport { BoutiqueStateService } from 'src/app/admin-page/SERVICES/CaisseService/boutique-state.service';\nimport { PosCaisseService } from 'src/app/admin-page/SERVICES/CaisseService/pos-caisse-service';\nimport { UsersService } from 'src/app/admin-page/SERVICES/users.service';\n\n@Component({\n  selector: 'app-pos-journal-caisse',\n  standalone: true,\n  imports: [CommonModule, FormsModule],\n  templateUrl: './pos-journal-caisse.component.html',\n  styleUrl: './pos-journal-caisse.component.scss'\n})\nexport class PosJournalCaisseComponent {\n  caisses: CaisseResponse[] = [];\n  isLoading = true;\n  errorMessage: string | null = null;\n  currentBoutiqueId: number | null = null;\n  sortField: keyof CaisseResponse = 'dateOuverture';\n  sortDirection: 'asc' | 'desc' = 'desc';\n  searchTerm = '';\n  statusFilter = '';\n  viewMode: 'card' | 'list' = 'card'; // Nouvelle propriété pour le mode de vue\n\n  selectedBoutiqueIdForList: number | null = null;\n  isLoadingCaisses = false;\n  boutiques: any[] = [];\n\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private usersService: UsersService,\n    private boutiqueState: BoutiqueStateService,\n    private posCaisseService: PosCaisseService,\n    private boutiqueService: BoutiqueService\n  ) {}\n\n  ngOnInit(): void {\n    this.loadBoutiques();\n    this.boutiqueState.selectedBoutique$.subscribe(boutiqueId => {\n      this.currentBoutiqueId = boutiqueId;\n      this.loadCaisses();\n    });\n  }\n\n  loadCaisses(): void {\n    this.isLoading = true;\n    this.errorMessage = null;\n    \n    const currentUser = this.usersService.getCurrentUser();\n    \n    if (!currentUser || !currentUser.id) {\n      this.errorMessage = 'Utilisateur non identifié';\n      this.isLoading = false;\n      return;\n    }\n\n    this.posCaisseService.getHistoriqueCaissesByVendeur(currentUser.id).subscribe({\n      next: (caisses) => {\n        this.caisses = caisses.filter(c => c.boutiqueId == Number(this.currentBoutiqueId));\n        this.sortCaisses();\n        this.isLoading = false;\n      },\n      error: (error) => {\n        this.isLoading = false;\n        this.errorMessage = error.message || 'Erreur lors du chargement des caisses';\n      }\n    });\n  }\n\n  loadBoutiques(): void {\n    this.boutiques = [];\n    this.usersService.getUserInfo().subscribe({\n      next: (user) => {\n        if (user && user.roleType === 'VENDEUR') {\n          this.boutiques = user.boutiques || [];\n          // Correction ici : utilise la valeur du state si elle existe\n          const stateBoutiqueId = this.boutiqueState.getCurrentValue();\n          this.selectedBoutiqueIdForList = stateBoutiqueId ?? (this.boutiques.length > 0 ? this.boutiques[0].id : null);\n        } else {\n          this.boutiqueService.getBoutiquesByEntreprise().subscribe({\n            next: (boutiques) => {\n              this.boutiques = boutiques || [];\n              const stateBoutiqueId = this.boutiqueState.getCurrentValue();\n              this.selectedBoutiqueIdForList = stateBoutiqueId ?? (this.boutiques.length > 0 ? this.boutiques[0].id : null);\n            }\n          });\n        }\n      }\n    });\n  }\n\n  toggleSortDirection(): void {\n    this.sortDirection = this.sortDirection === 'asc' ? 'desc' : 'asc';\n    this.sortCaisses();\n  }\n\n  sortCaisses(field: keyof CaisseResponse = this.sortField): void {\n    this.sortField = field;\n    this.caisses.sort((a, b) => {\n      const valueA = a[this.sortField];\n      const valueB = b[this.sortField];\n      \n      if (valueA === null || valueA === undefined) return 1;\n      if (valueB === null || valueB === undefined) return -1;\n      \n      if (typeof valueA === 'string' && typeof valueB === 'string') {\n        return this.sortDirection === 'asc' \n          ? valueA.localeCompare(valueB) \n          : valueB.localeCompare(valueA);\n      }\n      \n      if (typeof valueA === 'number' && typeof valueB === 'number') {\n        return this.sortDirection === 'asc' \n          ? valueA - valueB \n          : valueB - valueA;\n      }\n      \n      if (valueA instanceof Date && valueB instanceof Date) {\n        return this.sortDirection === 'asc' \n          ? valueA.getTime() - valueB.getTime()\n          : valueB.getTime() - valueA.getTime();\n      }\n      \n      return 0;\n    });\n  }\n\n  get filteredCaisses(): CaisseResponse[] {\n    let filtered = this.caisses;\n    \n    if (this.searchTerm) {\n      const term = this.searchTerm.toLowerCase();\n      filtered = filtered.filter(c => \n        (c.nomVendeur?.toLowerCase().includes(term)) ||\n        (c.statut?.toLowerCase().includes(term)) ||\n        (c.montantCourant?.toString().includes(term)) ||\n        (c.dateOuverture?.toString().includes(term))\n      );\n    }\n    \n    if (this.statusFilter) {\n      filtered = filtered.filter(c => c.statut === this.statusFilter);\n    }\n    \n    return filtered;\n  }\n\n  goBack(): void {\n    this.router.navigate(['/pos-caisse']);\n  }\n\n  formatDate(dateInput: Date | string): string {\n    const date = typeof dateInput === 'string' ? new Date(dateInput) : dateInput;\n    \n    return date.toLocaleDateString('fr-FR', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  }\n\n  onBoutiqueChange(): void {\n    if (this.selectedBoutiqueIdForList === null) return;\n    \n    this.boutiqueState.setSelectedBoutique(this.selectedBoutiqueIdForList);\n    this.caisses = [];\n    this.errorMessage = null;\n    this.loadDerniereCaisseVendeur(this.selectedBoutiqueIdForList);\n  }\n\n  loadDerniereCaisseVendeur(boutiqueId: number): void {\n    this.isLoadingCaisses = true;\n    this.caisses = [];\n    this.errorMessage = null;\n    \n    const currentBoutiqueId = boutiqueId; // Sauvegarder l'ID actuel\n\n    this.posCaisseService.getDerniereCaisseVendeur(boutiqueId).subscribe({\n      next: (response) => {\n        // Vérifier si la sélection n'a pas changé pendant la requête\n        if (this.selectedBoutiqueIdForList !== currentBoutiqueId) {\n          this.isLoadingCaisses = false;\n          return;\n        }\n\n        if (typeof response === 'string') {\n          this.errorMessage = response;\n        } else if (response && response.boutiqueId === boutiqueId) { // Filtrer par boutique\n          this.caisses = [response];\n        } else {\n          this.errorMessage = 'Aucune caisse disponible pour cette boutique';\n        }\n        this.isLoadingCaisses = false;\n      },\n      error: (error) => {\n        // Vérifier si la sélection n'a pas changé pendant la requête\n        if (this.selectedBoutiqueIdForList !== currentBoutiqueId) {\n          this.isLoadingCaisses = false;\n          return;\n        }\n        \n        console.error('Erreur lors du chargement de la dernière caisse', error);\n        this.isLoadingCaisses = false;\n        this.errorMessage = error.message || 'Erreur lors du chargement de la dernière caisse';\n      }\n    });\n  }\n  \n}","<!-- pos-journal-caisse.component.html -->\n<div class=\"journal-container\">\n  <!-- Header amélioré -->\n   <nav class=\"header_pos_caisse\">\n      <div class=\"content_header_pos_caisse_left\">\n          <ul>\n              <li>\n                  <div class=\"double\">\n                      <div class=\"icon_retour\" (click)=\"goBack()\">\n                          <i class=\"ri-arrow-left-s-line\"></i>\n                      </div>\n                      <div class=\"name_pos\">\n                          <p style=\"font-size: 16px;\">Journal des Caisses</p>\n                      </div>\n                      <select class=\"content_select\" name=\"boutique\" \n                              [(ngModel)]=\"selectedBoutiqueIdForList\"\n                              (ngModelChange)=\"onBoutiqueChange()\">\n                          <option *ngFor=\"let boutique of boutiques\" [ngValue]=\"boutique.id\" [disabled]=\"!boutique.actif\">\n                              {{ boutique.nomBoutique }}\n                          </option>\n                      </select>\n                  </div>\n              </li>\n          </ul>\n      </div>\n      <div class=\"content_header_pos_caisse_right\">\n\n          <span class=\"o_pager_counter\"><span class=\"\">1-1</span><span> / </span><span class=\"o_pager_limit\">1</span></span>\n          \n          <span class=\"btn-group d-print-none\" aria-atomic=\"true\">\n              <button type=\"button\" class=\"o_pager_previous\" aria-label=\"Précédent\" data-tooltip=\"Précédent\" ><i class=\"ri-arrow-left-s-line\"></i></button>\n              <button type=\"button\" class=\"o_pager_next\" aria-label=\"Suivant\" data-tooltip=\"Suivant\"><i class=\"ri-arrow-right-s-line\"></i></button>\n          </span>\n\n          <div class=\"barre\"></div>\n          \n          <div class=\"header-actions\">\n            <div class=\"search-container\">\n              <i class=\"ri-search-line\"></i>\n              <input \n                type=\"text\" \n                placeholder=\"Rechercher...\" \n                [(ngModel)]=\"searchTerm\"\n              />\n              <select [(ngModel)]=\"statusFilter\" class=\"filter-select\">\n                <option value=\"\">Tous les statuts</option>\n                <option value=\"OUVERTE\">Ouvertes</option>\n                <option value=\"FERMEE\">Fermées</option>\n              </select>\n            </div>\n\n\n            <div class=\"barre\"></div>\n            \n            <!-- Bouton de bascule de vue -->\n            <div class=\"view-toggle\">\n              <button \n                class=\"view-btn\" \n                [class.active]=\"viewMode === 'card'\"\n                (click)=\"viewMode = 'card'\"\n                title=\"Vue cartes\">\n                <i class=\"ri-grid-line\"></i>\n              </button>\n              <button \n                class=\"view-btn\" \n                [class.active]=\"viewMode === 'list'\"\n                (click)=\"viewMode = 'list'\"\n                title=\"Vue liste\">\n                <i class=\"ri-table-line\"></i>\n              </button>\n            </div>\n            \n            <button class=\"sort-button\" (click)=\"toggleSortDirection()\">\n              <i class=\"ri-sort-desc\" *ngIf=\"sortDirection === 'desc'\"></i>\n              <i class=\"ri-sort-asc\" *ngIf=\"sortDirection === 'asc'\"></i>\n            </button>\n          </div>\n      </div>\n  </nav>\n\n  <!-- Section de filtres améliorée -->\n  <div class=\"filters-section\">\n    <div class=\"filter-tags\">\n      <span class=\"filter-tag\" *ngIf=\"statusFilter\">\n        Statut: {{ statusFilter === 'OUVERTE' ? 'Ouvertes' : 'Fermées' }}\n        <i class=\"ri-close-line\" (click)=\"statusFilter = ''\"></i>\n      </span>\n      <span class=\"filter-tag\" *ngIf=\"searchTerm\">\n        Recherche: \"{{ searchTerm }}\"\n        <i class=\"ri-close-line\" (click)=\"searchTerm = ''\"></i>\n      </span>\n    </div>\n    <div class=\"summary\">\n      <span>{{ filteredCaisses.length }} opération(s)</span>\n    </div>\n  </div>\n\n  <!-- États améliorés -->\n  <div *ngIf=\"isLoading\" class=\"state-container\">\n    <div class=\"loading-content\">\n      <div class=\"spinner\"></div>\n      <p>Chargement de l'historique...</p>\n    </div>\n  </div>\n\n  <div *ngIf=\"!isLoading && errorMessage\" class=\"state-container\">\n    <div class=\"error-content\">\n      <i class=\"ri-error-warning-fill\"></i>\n      <p>{{ errorMessage }}</p>\n      <button (click)=\"loadCaisses()\">Réessayer</button>\n    </div>\n  </div>\n\n  <div *ngIf=\"!isLoading && !errorMessage && filteredCaisses.length === 0\" class=\"state-container\">\n    <div class=\"empty-content\">\n      <i class=\"ri-file-list-3-line\"></i>\n      <p>Aucune opération de caisse trouvée</p>\n      <button (click)=\"loadCaisses()\">Actualiser</button>\n    </div>\n  </div>\n\n  <!-- Vue cartes -->\n  <div *ngIf=\"!isLoading && !errorMessage && filteredCaisses.length > 0 && viewMode === 'card'\" class=\"caisse-cards\">\n    <div class=\"card\" *ngFor=\"let caisse of filteredCaisses\">\n      <div class=\"card-header\">\n        <!-- <span class=\"card-id\">#{{caisse.id}}</span> -->\n        <span class=\"status-badge\" [class.open]=\"caisse.statut === 'OUVERTE'\" [class.closed]=\"caisse.statut === 'FERMEE'\">\n          {{ caisse.statut === 'OUVERTE' ? 'Ouverte' : 'Fermée' }}\n        </span>\n      </div>\n      \n      <div class=\"card-body\">\n        <div class=\"info-row\">\n          <i class=\"ri-calendar-event-line\"></i>\n          <div>\n            <label>Ouverture</label>\n            <p>{{ formatDate(caisse.dateOuverture) }}</p>\n          </div>\n        </div>\n        \n        <div class=\"info-row\">\n          <i class=\"ri-calendar-check-line\"></i>\n          <div>\n            <label>Fermeture</label>\n            <p>{{ caisse.dateFermeture ? formatDate(caisse.dateFermeture) : 'En cours' }}</p>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"card-footer\">\n        <div class=\"amount\">\n          <label>Initial</label>\n          <p>{{ caisse.montantInitial | currency:'XOF ':'symbol':'1.0-0' }}</p>\n        </div>\n        <div class=\"amount\">\n          <label>Final</label>\n          <p>{{ caisse.montantCourant | currency:'XOF ':'symbol':'1.0-0' }}</p>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Vue tableau -->\n  <div *ngIf=\"!isLoading && !errorMessage && filteredCaisses.length > 0 && viewMode === 'list'\" class=\"caisse-table\">\n    <table>\n      <thead>\n        <tr>\n          <th (click)=\"sortCaisses('dateOuverture')\">\n            <div class=\"th-content\">\n              Date Ouverture\n              <i class=\"ri-arrow-up-s-line\" *ngIf=\"sortField === 'dateOuverture' && sortDirection === 'asc'\"></i>\n              <i class=\"ri-arrow-down-s-line\" *ngIf=\"sortField === 'dateOuverture' && sortDirection === 'desc'\"></i>\n            </div>\n          </th>\n          <th (click)=\"sortCaisses('dateFermeture')\">\n            <div class=\"th-content\">\n              Date Fermeture\n              <i class=\"ri-arrow-up-s-line\" *ngIf=\"sortField === 'dateFermeture' && sortDirection === 'asc'\"></i>\n              <i class=\"ri-arrow-down-s-line\" *ngIf=\"sortField === 'dateFermeture' && sortDirection === 'desc'\"></i>\n            </div>\n          </th>\n          <th>Statut</th>\n          <th (click)=\"sortCaisses('montantInitial')\">\n            <div class=\"th-content\">\n              Montant Initial\n              <i class=\"ri-arrow-up-s-line\" *ngIf=\"sortField === 'montantInitial' && sortDirection === 'asc'\"></i>\n              <i class=\"ri-arrow-down-s-line\" *ngIf=\"sortField === 'montantInitial' && sortDirection === 'desc'\"></i>\n            </div>\n          </th>\n          <th (click)=\"sortCaisses('montantCourant')\">\n            <div class=\"th-content\">\n              Montant Final\n              <i class=\"ri-arrow-up-s-line\" *ngIf=\"sortField === 'montantCourant' && sortDirection === 'asc'\"></i>\n              <i class=\"ri-arrow-down-s-line\" *ngIf=\"sortField === 'montantCourant' && sortDirection === 'desc'\"></i>\n            </div>\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let caisse of filteredCaisses\">\n          <td>{{ formatDate(caisse.dateOuverture) }}</td>\n          <td>{{ caisse.dateFermeture ? formatDate(caisse.dateFermeture) : '-' }}</td>\n          <td>\n            <span class=\"status-badge\" [class.open]=\"caisse.statut === 'OUVERTE'\" [class.closed]=\"caisse.statut === 'FERMEE'\">\n              {{ caisse.statut === 'OUVERTE' ? 'Ouverte' : 'Fermée' }}\n            </span>\n          </td>\n          <td>{{ caisse.montantInitial | currency:'XOF ':'symbol':'1.0-0' }}</td>\n          <td>{{ caisse.montantCourant | currency:'XOF ':'symbol':'1.0-0' }}</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>","import { Injectable } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\n\n@Injectable({ providedIn: 'root' })\nexport class BoutiqueStateService {\n  private readonly STORAGE_KEY = 'selectedBoutiqueId';\n\n  // initialisation avec la valeur sessionStorage (ou migration depuis localStorage)\n  private selectedBoutiqueSubject = new BehaviorSubject<number | null>(this.loadInitial());\n  selectedBoutique$ = this.selectedBoutiqueSubject.asObservable();\n\n  constructor() {\n    // rien d'autre à faire ici (loadInitial a déjà effectué la migration si nécessaire)\n  }\n\n  /** Charge la valeur initiale depuis sessionStorage.\n   *  Si une valeur existe dans localStorage (ancienne app), on la migre vers sessionStorage. */\n  private loadInitial(): number | null {\n    // migration depuis localStorage (si nécessaire)\n    const legacy = localStorage.getItem(this.STORAGE_KEY);\n    if (legacy !== null) {\n      try {\n        // transférer dans sessionStorage puis supprimer l'ancien\n        sessionStorage.setItem(this.STORAGE_KEY, legacy);\n      } catch (e) {\n        console.warn('Impossible de migrer la boutique depuis localStorage', e);\n      }\n      localStorage.removeItem(this.STORAGE_KEY);\n    }\n\n    const saved = sessionStorage.getItem(this.STORAGE_KEY);\n    return saved !== null ? Number(saved) : null;\n  }\n\n  setSelectedBoutique(boutiqueId: number | null): void {\n    if (boutiqueId !== null) {\n      sessionStorage.setItem(this.STORAGE_KEY, boutiqueId.toString());\n    } else {\n      sessionStorage.removeItem(this.STORAGE_KEY);\n    }\n    this.selectedBoutiqueSubject.next(boutiqueId);\n  }\n\n  /** retourne la valeur actuelle (ou null si aucune) */\n  getCurrentValue(): number | null {\n    const saved = sessionStorage.getItem(this.STORAGE_KEY);\n    return saved !== null ? Number(saved) : null;\n  }\n}\n","import { Injectable } from \"@angular/core\";\nimport { HttpClient, HttpHeaders } from \"@angular/common/http\";\nimport { environment } from \"src/environments/environment\";\nimport { Observable, of, throwError } from \"rxjs\";\nimport { switchMap, catchError, map } from \"rxjs/operators\";\nimport { OuvrirCaisseRequest, CaisseResponse, FermerCaisseRequest } from \"../../MODELS/CaisseModel/caisse.model\";\nimport { UsersService } from \"../users.service\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PosCaisseService {\n  private apiUrl = environment.apiBaseUrl;\n  \n  constructor(\n    private http: HttpClient,\n    private usersService: UsersService\n  ) { }\n\n  ouvrirCaisse(request: OuvrirCaisseRequest): Observable<CaisseResponse> {\n    return this.usersService.getValidAccessToken().pipe(\n      switchMap(token => {\n        if (!token) {\n          throw new Error('Aucun token trouvé');\n        }\n\n        const headers = new HttpHeaders({\n          'Authorization': `Bearer ${token}`\n        });\n\n        return this.http.post<CaisseResponse>(\n          `${this.apiUrl}/ouvrir`, \n          request, \n          { headers }\n        );\n      }),\n        catchError(error => {\n            console.error('Erreur détaillée', error);\n            \n            // Essayez d'extraire le message d'erreur spécifique\n            let errorMsg = 'Erreur lors de l\\'ouverture de la caisse';\n            \n            if (error.error && error.error.error) {\n                errorMsg = error.error.error;\n            } else if (error.error && error.error.message) {\n                errorMsg = error.error.message;\n            } else if (error.message) {\n                errorMsg = error.message;\n            }\n            \n            return throwError(() => ({ \n                message: errorMsg,\n                originalError: error \n            }));\n        })\n    );\n  }\n\nfermerCaisse(boutiqueId: number): Observable<any> {\n  console.log('Tentative de récupération du token...'); // Log avant de récupérer le token\n\n  return this.usersService.getValidAccessToken().pipe( // On récupère le token valide de l'utilisateur\n    switchMap(token => {\n      if (!token) {\n        console.error('Aucun token trouvé');\n        throw new Error('Aucun token trouvé');\n      }\n\n      console.log('Token récupéré :', token); // Log du token récupéré\n\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}` // Envoi du token d'authentification\n      });\n\n      // Préparation du corps de la requête avec boutiqueId\n      const body = {\n        boutiqueId: boutiqueId\n      };\n\n      console.log('Envoi de la requête POST pour fermer la caisse...'); // Log avant de faire la requête\n\n      return this.http.post<any>(`${this.apiUrl}/fermer`, body, { headers }).pipe(\n        catchError(error => {\n          console.error('Erreur lors de la requête pour fermer la caisse:', error);\n          return throwError(() => error);\n        })\n      );\n    }),\n    catchError(error => {\n      console.error('Erreur détaillée dans le service:', error);\n\n      // Gestion des erreurs\n      let errorMsg = 'Erreur lors de la fermeture de la caisse';\n      if (error.error && error.error.error) {\n        errorMsg = error.error.error;\n      } else if (error.error && error.error.message) {\n        errorMsg = error.error.message;\n      } else if (error.message) {\n        errorMsg = error.message;\n      }\n\n      return throwError(() => ({\n        message: errorMsg,\n        originalError: error\n      }));\n    })\n  );\n}\n\n  getDerniereCaisseVendeur(boutiqueId: number): Observable<CaisseResponse> {\n    return this.usersService.getValidAccessToken().pipe(\n      switchMap(token => {\n        if (!token) throw new Error('Aucun token trouvé');\n\n        const headers = new HttpHeaders({ 'Authorization': `Bearer ${token}` });\n\n        // pos-caisse-service.ts (extrait)\n        return this.http.get<CaisseResponse>(`${this.apiUrl}/caisse/derniere/${boutiqueId}`, { headers }).pipe(\n          map(resp => resp),\n          catchError(err => {\n            console.error('HTTP getDerniereCaisseVendeur error ->', err);\n\n            let msg = 'Erreur inconnue';\n            if (err?.error) {\n              if (typeof err.error === 'string') {\n                msg = err.error;                     // serveur renvoie directement un texte\n              } else if (err.error?.message) {\n                msg = err.error.message;             // structure { message: \"...\" }\n              } else {\n                try { msg = JSON.stringify(err.error); } catch { msg = String(err.error); }\n              }\n            } else if (err?.message) {\n              msg = err.message;\n            } else {\n              try { msg = JSON.stringify(err); } catch { msg = String(err); }\n            }\n\n            // Propager une string (évite new Error(obj) qui devient \"[object Object]\")\n            return throwError(() => msg);\n          })\n        );\n\n      })\n    );\n  }\n\n  getCaissesByBoutique(boutiqueId: number): Observable<CaisseResponse[]> {\n    return this.usersService.getValidAccessToken().pipe(\n      switchMap(token => {\n        if (!token) throw new Error('Aucun token trouvé');\n\n        const headers = new HttpHeaders({\n          'Authorization': `Bearer ${token}`\n        });\n\n        return this.http.get<CaisseResponse[]>(\n          `${this.apiUrl}/boutique/${boutiqueId}/caisses`, \n          { headers }\n        );\n      }),\n      catchError(error => {\n        // Gestion d'erreur détaillée\n        let errorMsg = 'Erreur lors du chargement des caisses';\n        if (error?.error?.error) errorMsg = error.error.error;\n        else if (error?.error?.message) errorMsg = error.error.message;\n        else if (error.message) errorMsg = error.message;\n        \n        return throwError(() => ({ \n          message: errorMsg,\n          originalError: error \n        }));\n      })\n    );\n  }\n\n  getHistoriqueCaissesByVendeur(vendeurId: number): Observable<CaisseResponse[]> {\n    return this.usersService.getValidAccessToken().pipe(\n      switchMap(token => {\n        if (!token) throw new Error('Aucun token trouvé');\n\n        const headers = new HttpHeaders({\n          'Authorization': `Bearer ${token}`\n        });\n\n        return this.http.get<CaisseResponse[]>(\n          `${this.apiUrl}/vendeur/${vendeurId}`, \n          { headers }\n        );\n      }),\n      catchError(error => {\n        let errorMsg = 'Erreur lors du chargement de l\\'historique des caisses';\n        if (error?.error?.error) errorMsg = error.error.error;\n        else if (error?.error?.message) errorMsg = error.error.message;\n        else if (error.message) errorMsg = error.message;\n        \n        return throwError(() => ({ \n          message: errorMsg,\n          originalError: error \n        }));\n      })\n    );\n  }\n  \n\n}"],"names":["CommonModule","FormsModule","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","boutique_r1","id","actif","ɵɵadvance","ɵɵtextInterpolate1","nomBoutique","ɵɵelement","ɵɵlistener","PosJournalCaisseComponent_span_49_Template_i_click_2_listener","ɵɵrestoreView","_r2","ctx_r2","ɵɵnextContext","ɵɵresetView","statusFilter","PosJournalCaisseComponent_span_50_Template_i_click_2_listener","_r4","searchTerm","PosJournalCaisseComponent_div_55_Template_button_click_5_listener","_r5","loadCaisses","ɵɵtextInterpolate","errorMessage","PosJournalCaisseComponent_div_56_Template_button_click_5_listener","_r6","ɵɵclassProp","caisse_r7","statut","formatDate","dateOuverture","dateFermeture","ɵɵpipeBind4","montantInitial","montantCourant","ɵɵtemplate","PosJournalCaisseComponent_div_57_div_1_Template","filteredCaisses","caisse_r9","PosJournalCaisseComponent_div_58_Template_th_click_4_listener","_r8","sortCaisses","PosJournalCaisseComponent_div_58_i_7_Template","PosJournalCaisseComponent_div_58_i_8_Template","PosJournalCaisseComponent_div_58_Template_th_click_9_listener","PosJournalCaisseComponent_div_58_i_12_Template","PosJournalCaisseComponent_div_58_i_13_Template","PosJournalCaisseComponent_div_58_Template_th_click_16_listener","PosJournalCaisseComponent_div_58_i_19_Template","PosJournalCaisseComponent_div_58_i_20_Template","PosJournalCaisseComponent_div_58_Template_th_click_21_listener","PosJournalCaisseComponent_div_58_i_24_Template","PosJournalCaisseComponent_div_58_i_25_Template","PosJournalCaisseComponent_div_58_tr_27_Template","sortField","sortDirection","PosJournalCaisseComponent","constructor","route","router","usersService","boutiqueState","posCaisseService","boutiqueService","caisses","isLoading","currentBoutiqueId","viewMode","selectedBoutiqueIdForList","isLoadingCaisses","boutiques","ngOnInit","loadBoutiques","selectedBoutique$","subscribe","boutiqueId","currentUser","getCurrentUser","getHistoriqueCaissesByVendeur","next","filter","c","Number","error","message","getUserInfo","user","roleType","stateBoutiqueId","getCurrentValue","length","getBoutiquesByEntreprise","toggleSortDirection","field","sort","a","b","valueA","valueB","undefined","localeCompare","Date","getTime","filtered","term","toLowerCase","nomVendeur","includes","toString","goBack","navigate","dateInput","date","toLocaleDateString","day","month","year","hour","minute","onBoutiqueChange","setSelectedBoutique","loadDerniereCaisseVendeur","getDerniereCaisseVendeur","response","console","ɵɵdirectiveInject","i1","ActivatedRoute","Router","i2","UsersService","i3","BoutiqueStateService","i4","PosCaisseService","i5","BoutiqueService","selectors","decls","vars","consts","template","PosJournalCaisseComponent_Template","rf","ctx","PosJournalCaisseComponent_Template_div_click_6_listener","ɵɵtwoWayListener","PosJournalCaisseComponent_Template_select_ngModelChange_11_listener","$event","ɵɵtwoWayBindingSet","PosJournalCaisseComponent_option_12_Template","PosJournalCaisseComponent_Template_input_ngModelChange_30_listener","PosJournalCaisseComponent_Template_select_ngModelChange_31_listener","PosJournalCaisseComponent_Template_button_click_40_listener","PosJournalCaisseComponent_Template_button_click_42_listener","PosJournalCaisseComponent_Template_button_click_44_listener","PosJournalCaisseComponent_i_45_Template","PosJournalCaisseComponent_i_46_Template","PosJournalCaisseComponent_span_49_Template","PosJournalCaisseComponent_span_50_Template","PosJournalCaisseComponent_div_54_Template","PosJournalCaisseComponent_div_55_Template","PosJournalCaisseComponent_div_56_Template","PosJournalCaisseComponent_div_57_Template","PosJournalCaisseComponent_div_58_Template","ɵɵtwoWayProperty","i6","NgForOf","NgIf","CurrencyPipe","i7","NgSelectOption","ɵNgSelectMultipleOption","DefaultValueAccessor","SelectControlValueAccessor","NgControlStatus","NgModel","styles","BehaviorSubject","STORAGE_KEY","selectedBoutiqueSubject","loadInitial","asObservable","legacy","localStorage","getItem","sessionStorage","setItem","e","warn","removeItem","saved","factory","ɵfac","providedIn","HttpHeaders","environment","throwError","switchMap","catchError","map","http","apiUrl","apiBaseUrl","ouvrirCaisse","request","getValidAccessToken","pipe","token","Error","headers","post","errorMsg","originalError","fermerCaisse","log","body","get","resp","err","msg","JSON","stringify","String","getCaissesByBoutique","vendeurId","ɵɵinject","HttpClient"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}