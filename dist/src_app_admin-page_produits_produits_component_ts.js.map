{"version":3,"file":"src_app_admin-page_produits_produits_component_ts.js","mappings":"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","sources":["./src/app/admin-page/SERVICES/categorie.service.ts","./src/app/admin-page/produits/produits.component.ts","./src/app/admin-page/produits/produits.component.html"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { BehaviorSubject, catchError, Observable, switchMap, tap, throwError } from 'rxjs';\nimport { Categorie } from '../MODELS/categorie.model';\nimport { environment } from 'src/environments/environment';\nimport { UsersService } from './users.service';\nimport { ProduitPaginatedResponseDTO } from '../MODELS/ProduitPaginatedResponseDTO';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CategorieService {\n  private apiUrl = environment.apiBaseUrl;\n  private categoriesSubject = new BehaviorSubject<Categorie[]>([]);\n  public categories$ = this.categoriesSubject.asObservable();\n  constructor(private http: HttpClient, private usersService: UsersService) {}\n\n  ajouterCategorie(category: Categorie): Observable<Categorie> {\n    return this.usersService.getValidAccessToken().pipe(\n      switchMap(token => {\n        if (!token) {\n          console.error('⚠️ Token vide ou non défini ! Vérifiez que l\\'utilisateur est bien connecté.');\n          return throwError(() => new Error('Aucun token valide trouvé'));\n        }\n\n        const headers = new HttpHeaders({\n          'Authorization': `Bearer ${token}`\n        });\n\n        return this.http.post<Categorie>(`${this.apiUrl}/createCategory`, category, { headers }).pipe(\n          tap((newCategory) => {\n            // Met à jour le BehaviorSubject dès qu'une nouvelle catégorie est ajoutée\n            const currentCategories = this.categoriesSubject.value;\n            this.categoriesSubject.next([...currentCategories, newCategory]);\n          })\n        );\n      }),\n      catchError(error => {\n        console.error('Erreur lors de l\\'ajout de la catégorie:', error);\n        return throwError(() => error);\n      })\n    );\n  }\n\n getProduitsByCategorie(\n  categorieId: number,\n  page: number = 0,\n  size: number = 20\n): Observable<ProduitPaginatedResponseDTO> {\n  return this.usersService.getValidAccessToken().pipe(\n    switchMap(token => {\n      if (!token) {\n        console.error('⚠️ Token vide ou non défini ! Vérifiez que l\\'utilisateur est bien connecté.');\n        return new Observable<ProduitPaginatedResponseDTO>(); \n      }\n\n      const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\n      const params = { page: page.toString(), size: size.toString() };\n\n      return this.http.get<ProduitPaginatedResponseDTO>(\n        `${this.apiUrl}/categories/${categorieId}/produits`,\n        { headers, params }\n      );\n    }),\n    catchError(error => {\n      console.error('Erreur lors de la récupération des produits paginés:', error);\n      return throwError(() => error);\n    })\n  );\n}\n\n\n  deleteCategorie(id: number): Observable<string> {\n    return this.usersService.getValidAccessToken().pipe(\n      switchMap(token => {\n        if (!token) {\n          console.error('⚠️ Token JWT manquant pour suppression catégorie.');\n          return throwError(() => new Error(\"Token manquant\"));\n        }\n\n        const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\n        console.log(\"🔹 Token envoyé pour DELETE catégorie :\", headers);\n\n        return this.http.delete(`${this.apiUrl}/deleteCategory/${id}`, {\n          headers,\n          responseType: 'text'\n        });\n      }),\n      catchError(error => {\n        console.error(\"❌ Erreur API DELETE :\", error);\n        return throwError(() => error);\n      })\n    );\n  }\n\n  getCategories(): Observable<Categorie[]> {\n    return this.usersService.getValidAccessToken().pipe(\n      switchMap(token => {\n        if (!token) {\n          console.error('⚠️ Token vide ou non défini ! Vérifiez que l\\'utilisateur est bien connecté.');\n          return throwError(() => new Error('Aucun token valide trouvé'));\n        }\n\n        const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\n\n        return this.http.get<Categorie[]>(`${this.apiUrl}/allCategory`, { headers }).pipe(\n          tap((categories) => {\n            // Met à jour le BehaviorSubject avec les catégories récupérées\n            this.categoriesSubject.next(categories);\n          })\n        );\n      }),\n      catchError(error => {\n        console.error('Erreur lors de la récupération des catégories:', error);\n        return throwError(() => error);\n      })\n    );\n  }\n\n}","import { ChangeDetectorRef, Component, ElementRef, HostListener, OnInit, ViewChild } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormBuilder, FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport jsPDF from 'jspdf';\nimport * as XLSX from 'xlsx';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatInputModule } from '@angular/material/input';\nimport { CategorieService } from '../SERVICES/categorie.service';\nimport { ProduitEntreprisePaginatedResponse, ProduitService, ProduitStockPaginatedResponse } from '../SERVICES/produit.service';\nimport { Boutique, Produit } from '../MODELS/produit.model';\nimport { Categorie } from '../MODELS/categorie.model';\n// MatPaginator et PageEvent ne sont plus nécessaires avec la pagination personnalisée\nimport { MatTableDataSource } from '@angular/material/table';\nimport { Router, RouterLink } from '@angular/router';\nimport autoTable from 'jspdf-autotable';\nimport { UsersService } from '../SERVICES/users.service';\nimport { CustomNumberPipe } from '../MODELS/customNumberPipe';\nimport { MatDialog } from '@angular/material/dialog';\nimport { SuspendedBoutiqueDialogComponent } from './suspended-boutique-dialog.component';\nimport { CdkDragDrop, DragDropModule, moveItemInArray } from '@angular/cdk/drag-drop';\nimport { environment } from 'src/environments/environment';\nimport { catchError } from 'rxjs';\n\n@Component({\n  selector: 'app-produits',\n  standalone: true,\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    FormsModule,\n    MatSelectModule,\n    MatFormFieldModule,\n    MatAutocompleteModule,\n    // RouterLink,\n    MatInputModule,\n    // MatPaginatorModule n'est plus nécessaire avec la pagination personnalisée\n    CustomNumberPipe,\n    DragDropModule,\n  ],\n  templateUrl: './produits.component.html',\n  styleUrls: ['./produits.component.scss']\n})\nexport class ProduitsComponent implements OnInit {\n  boutiqueId!: number;\n  private backendUrl = environment.apiBaseUrl;\n  isLoadingCounts: boolean = false;\n  searchText: string = '';\n  tasks: Produit[] = [];\n  imagePopup: string | null = null;\n  nomEntreprise: string = '';\n  adresseEntreprise: string = '';\n  logoEntreprise: string = '';\n  userName: string = '';\n  boutiqueName: string = '';\n  addressBoutique : string = '';\n  showDescription: boolean = false;\n  selectedBoutique: any = null;\n  previousSelectedBoutique: any | null = null;\n  boutiqueActuelle: string = \"Toutes les boutiques\";\n  boutiques: any[] = []; \n  private apiUrl = environment.imgUrl;\n  isDataLoaded = false; \n  isLoading = false;\n  showNoProductsMessage = false;\n  productCounts: { [boutiqueId: number]: number } = {};\n\n  showFilterDropdown = false;\n  selectedFilters: any[] = [];\n  allProducts: Produit[] = [];   // Tous les produits chargés\n  sortColumn: string | null = null;\n  sortDirection: 'asc' | 'desc' = 'asc';\n  @ViewChild('searchInput') searchInput!: ElementRef<HTMLInputElement>;\n\n  showExcelImportModal = false;\n  selectedFile: File | null = null;\n  isImporting = false;\n  importMessage = '';\n  importSuccess = false;\n  importErrors: string[] = [];\n\n  selectedBoutiquesForImport: number[] = [];\n  isAllBoutiquesSelected = false;\n\n  showBoutiqueError: boolean = false;\n\n  showBoutiqueSelectionPanel: boolean = false;\n\n  isPopupVisible = false;\n  categories: (Categorie & { selected?: boolean })[] = [];\n\n  currentPageEnterprise: number = 0;\n  pageSizeEnterprise: number = 20;\n  totalElementsEnterprise: number = 0;\n\n  currentPageBoutique: number = 0;\n  pageSizeBoutique: number = 20;\n  totalElementsBoutique: number = 0;\n\n  currentPage = 0;\n  pageSize = 20;\n  totalElements = 0;\n  totalPages = 0;\n  // Pagination et tableau de données\n  dataSource = new MatTableDataSource<Produit>();\n  // @ViewChild(MatPaginator) paginator!: MatPaginator; // Plus nécessaire avec la pagination personnalisée\n  // Dropdown pour l'export\n  showExportDropdown = false;\n  // Gestion de l'image uploadée\n  urllink: string = \"assets/img/appareil.jpg\";\n  newPhotoUrl: string | null = null;\n  // selectedFile: File | null = null;\n  entrepriseId: number | null = null;\n\n  // HostListener pour fermer les dropdowns\n  @HostListener('document:click', ['$event'])\n  onClick(event: MouseEvent): void {\n    const target = event.target as HTMLElement;\n    \n    // Fermer le dropdown de filtre\n    if (!target.closest('.container_inputSearch') && \n        !target.closest('.filter-dropdown') &&\n        !target.closest('.trier')) {\n      this.showFilterDropdown = false;\n    }\n    \n    // Fermer le dropdown d'export\n    if (!target.closest('.export-container')) {\n      this.showExportDropdown = false;\n    }\n  }\n\n  constructor(\n    private categorieService: CategorieService,\n    private produitService: ProduitService,\n    private fb: FormBuilder,\n    private router: Router,\n    private usersService: UsersService,\n    private dialog: MatDialog,\n    private cdr: ChangeDetectorRef,\n  ) {}\n\n  ngOnInit(): void {\n    this.getUserInfo();\n    this.fetchCategories();\n  }\n\n    // Méthodes de gestion des filtres\n  toggleFilterDropdown(): void {\n    this.showFilterDropdown = !this.showFilterDropdown;\n    this.showExportDropdown = false;\n  }\n\n  applyFilters(): void {\n    let filtered = [...this.allProducts];\n    const searchLower = this.searchText.toLowerCase();\n\n    if (this.searchText) {\n      if (this.selectedFilters.length > 0) {\n        filtered = filtered.filter(product => {\n          return this.selectedFilters.every(filter => {\n            const key = filter.type as keyof Produit;\n            const value = product[key]?.toString().toLowerCase() || '';\n            return value.includes(searchLower);\n          });\n        });\n      } else {\n        filtered = filtered.filter(product => \n          Object.values(product).some(val => \n            val?.toString().toLowerCase().includes(searchLower)\n        ));\n      }\n    }\n\n    this.tasks = filtered;\n    this.currentPage = 0;\n  }\n\n  addFilter(filter: any): void {\n    if (this.isFilterSelected(filter.type)) {\n      this.selectedFilters = [];\n    } else {\n      this.selectedFilters = [filter];\n    }\n    this.showFilterDropdown = false;\n    this.applyFilters();\n    \n    setTimeout(() => {\n      if (this.searchInput?.nativeElement) {\n        this.searchInput.nativeElement.focus();\n      }\n    }, 0);\n  }\n\n  isFilterSelected(filterType: string): boolean {\n    return this.selectedFilters.some(f => f.type === filterType);\n  }\n\n  focusSearchInput(): void {\n    if (this.searchInput?.nativeElement) {\n      this.searchInput.nativeElement.focus();\n    }\n  }\n\n  removeFilter(filter: any): void {\n    this.selectedFilters = this.selectedFilters.filter(f => f !== filter);\n    this.applyFilters();\n  }\n\n  getSearchPlaceholder(): string {\n    if (this.selectedFilters.length > 0) {\n      return `Par ${this.selectedFilters.map(f => f.label).join(', ')}...`;\n    }\n    return \"Recherche...\";\n  }\n\n  resetFilters(): void {\n    this.selectedFilters = [];\n    this.searchText = '';\n    this.tasks = [...this.allProducts];\n    this.currentPage = 0;\n    this.showFilterDropdown = false;\n  }\n\n  goToAddProduit() {\n    this.router.navigate(['/addProduit']);\n  }\n\n  // Permet de mettre en évidence le texte recherché\n  highlightMatch(text: string): string {\n    if (!this.searchText) return text;\n    const regex = new RegExp(`(${this.searchText})`, 'gi');\n    return text.replace(regex, '<mark>$1</mark>');\n  }\n\n  // Retourne la liste filtrée et paginée des produits\n  // filteredProducts(): Produit[] {\n  //   const sortedProducts = [...this.tasks].sort((a, b) => {\n  //     const dateA = new Date(a.createdAt || new Date()).getTime();\n  //     const dateB = new Date(b.createdAt || new Date()).getTime();\n\n  //     return dateB - dateA;\n  //   });\n  //   const filtered = sortedProducts.filter(product =>\n  //     (product.nom && product.nom.toLowerCase().includes(this.searchText.toLowerCase())) ||\n  //     (product.codeGenerique && product.codeGenerique.toLowerCase().includes(this.searchText.toLowerCase())) ||\n  //     (product.codeBare && product.codeBare.toLowerCase().includes(this.searchText.toLowerCase())) \n  //   );\n  //   const startIndex = this.currentPage * this.pageSize;\n  //   return filtered.slice(startIndex, startIndex + this.pageSize);\n  // }\n\n  filteredProducts(): Produit[] {\n    const startIndex = this.currentPage * this.pageSize;\n    return this.tasks.slice(startIndex, startIndex + this.pageSize);\n  }\n\n  // Affichage/Masquage du dropdown d'export\n  toggleExportDropdown() {\n    this.showExportDropdown = !this.showExportDropdown;\n  }\n\n  // Masque le dropdown si l'utilisateur clique en dehors\n  @HostListener('document:click', ['$event'])\n  onClickOutside(event: MouseEvent) {\n    const target = event.target as HTMLElement;\n    if (!target.closest('.export-container')) {\n      this.showExportDropdown = false;\n    }\n  }\n\n  // Permet de convertir une image en base64 pour l'ajouter dans le PDF\n  getImageBase64(url: string): Promise<string> {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.onload = function () {\n        const reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result as string);\n        };\n        reader.readAsDataURL(xhr.response);\n      };\n      xhr.onerror = function () {\n        reject(new Error('Erreur lors du chargement de l\\'image'));\n      };\n      xhr.open('GET', url);\n      xhr.responseType = 'blob';\n      xhr.send();\n    });\n  }\n\n  // Téléchargement en Excel\n  downloadExcel() {\n    const worksheet = XLSX.utils.json_to_sheet(this.tasks);\n    const workbook = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(workbook, worksheet, 'Produits');\n    XLSX.writeFile(workbook, 'Produits.xlsx');\n  }\n\n  // Téléchargement en PDF\n  downloadPDF() {\n    if (!this.tasks || this.tasks.length === 0) {\n      console.error(\"Aucun produit à afficher dans le PDF !\");\n      return;\n    }\n    const doc = new jsPDF();\n    const logoUrl = this.logoEntreprise\n      ? `${this.apiUrl}${this.logoEntreprise}`\n      : `${this.apiUrl}/logoUpload/651.jpg`;\n    const entreprise = this.nomEntreprise || \"Nom non disponible\";\n    \n    \n    this.getImageBase64(logoUrl).then((logoBase64) => {\n      const imageType = logoBase64.startsWith('data:image/png') ? 'PNG' : 'JPEG';\n      doc.addImage(logoBase64, imageType, 14, 5, 30, 30);\n\n      doc.setFontSize(18);\n      doc.setFont('helvetica', 'bold');\n      doc.text(`Nom de l'entreprise: ${entreprise}`, 60, 20);\n      doc.text('Liste des produits', 60, 30);\n      doc.setLineWidth(0.5);\n      doc.line(14, 35, 195, 35);\n      \n      const columns = ['Code', 'Nom produit', 'Description', 'Catégorie', 'Prix vente', 'Prix achat', 'En Stock', 'Unite', 'Seuil Alert'];\n      const startIndex = this.currentPage * this.pageSize;\n      const pageTasks = this.tasks.slice(startIndex, startIndex + this.pageSize);\n      \n      if (!Array.isArray(pageTasks) || pageTasks.length === 0) {\n        console.error(\"Aucun produit trouvée sur cette page !\");\n        return;\n      }\n      \n      const rows = pageTasks.map(task => [\n        task.codeGenerique || '',\n        task.nom || '',\n        task.description || '',\n        task.nomCategorie ? `${task.nomCategorie}` : 'Aucune categorie',\n        task.prixVente ?? 0,\n        task.prixAchat ?? 0,\n        task.quantite ?? 0,\n        task.nomUnite ? `${task.nomUnite}` : 'Sans unité',\n        task.seuilAlert ?? 0,\n      ]);\n      \n      \n      autoTable(doc, {\n        head: [columns],\n        body: rows,\n        startY: 40,\n        theme: 'grid',\n        headStyles: { fillColor: [64, 153, 255], textColor: [255, 255, 255], fontSize: 12 },\n        bodyStyles: { fontSize: 10 }\n      });\n      \n      const finalY = (doc as any).lastAutoTable?.finalY || 60;\n      doc.setLineWidth(0.5);\n      doc.line(14, finalY + 5, 195, finalY + 5);\n      doc.setFontSize(10);\n      doc.setFont('helvetica', 'italic');\n      doc.text(`Nom de Boutique: ${this.boutiqueName}`, 14, finalY + 10);\n      doc.text(`Adress: ${this.addressBoutique}`, 14, finalY + 15);\n      \n      doc.save('Produits.pdf');\n    }).catch((error) => {\n      console.error(\"Erreur lors du chargement du logo :\", error);\n    });\n  }\n\n  // Téléchargement en CSV\n  downloadCSV() {\n    const headers = ['Code', 'Photo', 'Nom produit', 'Catégorie', 'Description', 'Prix Vente', 'Prix Achat', 'Quantité', 'Unité', 'Seuil Alerte', 'Date & heure'];\n    const rows = this.tasks.map(task => [\n      task.codeGenerique || '',\n      task.photo,\n      task.nom,\n      task.nomCategorie || '',\n      task.description,\n      task.prixVente,\n      task.prixAchat,\n      task.quantite,\n      task.nomUnite || '',\n      task.seuilAlert,\n      task.createdAt\n    ]);\n    \n    const csvContent = [\n      headers.join(','),\n      ...rows.map(row => row.join(',')),\n    ].join('\\n');\n    \n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = 'Produits.csv';\n    link.click();\n  }\n\n  // Gestion de la pagination personnalisée\n  goToPage(page: number | string): void {\n    // Ignorer les clics sur les points de suspension\n    if (page === '...') {\n      return;\n    }\n    \n    const pageNumber = page as number;\n    if (pageNumber >= 0 && pageNumber < this.totalPages) {\n      this.currentPage = pageNumber;\n      \n      if (this.selectedBoutique) {\n        // si vue boutique\n        this.loadProduitsPaginated(this.selectedBoutique.id, pageNumber, this.pageSize);\n      } else {\n        // vue \"Toutes les boutiques\"\n        this.loadAllProduitsPaginated(pageNumber, this.pageSize);\n      }\n    }\n  }\n\n  onPageSizeChange(): void {\n    this.currentPage = 0; // Retourner à la première page\n    \n    if (this.selectedBoutique) {\n      // si vue boutique\n      this.loadProduitsPaginated(this.selectedBoutique.id, 0, this.pageSize);\n    } else {\n      // vue \"Toutes les boutiques\"\n      this.loadAllProduitsPaginated(0, this.pageSize);\n    }\n  }\n\n  getPageInfo(): string {\n    const start = this.currentPage * this.pageSize + 1;\n    const end = Math.min((this.currentPage + 1) * this.pageSize, this.totalElements);\n    return `${start} - ${end} / ${this.totalElements}`;\n  }\n\n  getVisiblePages(): (number | string)[] {\n    const pages: (number | string)[] = [];\n    const totalPages = this.totalPages;\n    const current = this.currentPage;\n    \n    if (totalPages <= 7) {\n      // Si moins de 7 pages, afficher toutes les pages\n      for (let i = 0; i < totalPages; i++) {\n        pages.push(i);\n      }\n    } else {\n      // Logique pour afficher les pages avec des points de suspension\n      if (current <= 3) {\n        // Début de la liste\n        for (let i = 0; i < 5; i++) {\n          pages.push(i);\n        }\n        pages.push('...');\n        pages.push(totalPages - 1);\n      } else if (current >= totalPages - 4) {\n        // Fin de la liste\n        pages.push(0);\n        pages.push('...');\n        for (let i = totalPages - 5; i < totalPages; i++) {\n          pages.push(i);\n        }\n      } else {\n        // Milieu de la liste\n        pages.push(0);\n        pages.push('...');\n        for (let i = current - 1; i <= current + 1; i++) {\n          pages.push(i);\n        }\n        pages.push('...');\n        pages.push(totalPages - 1);\n      }\n    }\n    \n    return pages;\n  }\n\n  // Méthode syncPaginator supprimée car plus nécessaire avec la pagination personnalisée\n\n  // Gestion de l'upload d'image pour ajouter une photo\n  // onFileSelected(event: Event): void {\n  //   const input = event.target as HTMLInputElement;\n  //   if (input.files && input.files.length > 0) {\n  //     this.selectedFile = input.files[0];\n  //     const reader = new FileReader();\n  //     reader.onload = (e) => {\n  //       this.newPhotoUrl = e.target?.result as string;\n  //     };\n  //     reader.readAsDataURL(this.selectedFile);\n  //   }\n  // }\n\n  // Récupère l'ID de la boutique depuis le localStorage\n  getUserBoutiqueId(): number | null {\n    const user = JSON.parse(localStorage.getItem('user') || '{}');\n    if (user && user.boutiques && user.boutiques.length > 0) {\n      return user.boutiques[0]?.id || null;\n    } else {\n      console.error('Aucune boutique trouvée pour cet utilisateur');\n      return null;\n    }\n  }\n\n  // Dans getUserInfo, ajoutez l'appel pour charger les compteurs initiaux\n  getUserInfo(): void {\n    this.usersService.getUserInfo().subscribe({\n      next: async (user) => {\n        console.log('Données reçues:', user);\n        localStorage.setItem('user', JSON.stringify(user));\n        this.userName = user.nomComplet;\n        this.nomEntreprise = user.nomEntreprise;\n        this.boutiques = user.boutiques ?? []; \n\n        // Récupération de l'ID entreprise\n        this.entrepriseId = user.entrepriseId;\n\n        // Charger les compteurs avant de sélectionner une boutique\n        await this.loadAllBoutiquesCounts();\n        this.selectBoutique(null);\n\n        if (!this.entrepriseId) {\n          console.error('Aucun ID entreprise trouvé !');\n          return;\n        }\n\n        this.addressBoutique = this.selectedBoutique?.adresse || 'Adresse non trouvée';\n        \n        setTimeout(() => {\n          this.showNoProductsMessage = this.tasks.length === 0;\n          this.cdr.detectChanges();\n        }, 500);\n      },\n      error: (err) => {\n        this.boutiques = [];\n        console.error(\"Erreur lors de la récupération des informations utilisateur :\", err);\n        setTimeout(() => {\n          this.showNoProductsMessage = this.tasks.length === 0;\n          this.cdr.detectChanges();\n        }, 500);\n      }\n    });\n  }\n\n  async selectBoutique(boutique: any | null): Promise<void> {\n    if (boutique && !boutique.actif) {\n      this.showSuspendedBoutiqueDialog();\n      return;\n    }\n\n    this.previousSelectedBoutique = this.selectedBoutique;\n\n    if (boutique === null) {\n      this.selectedBoutique = boutique;\n      this.boutiqueActuelle = \"Toutes les boutiques\";\n      // Charger les compteurs avant d'afficher les produits\n      await this.loadAllBoutiquesCounts();\n      this.loadAllProduitsPaginated(0, this.pageSize);\n    } else {\n      this.selectedBoutique = boutique;\n      this.boutiqueActuelle = boutique.nomBoutique ? boutique.nomBoutique : \"Boutique sans nom\";\n      this.loadProduitsPaginated(boutique.id, 0, this.pageSize);\n    }\n    \n    this.currentPage = 0;\n  }\n\n  // Ajoutez cette nouvelle méthode\n  loadAllProduits(): void {\n    \n    this.showNoProductsMessage = false;\n    if (!this.entrepriseId) {\n      console.error('ID entreprise manquant');\n      return;\n    }\n\n    this.produitService.getProduitsByEntrepriseId(this.entrepriseId).subscribe({\n      next: (produits: Produit[]) => {\n      // Filtrer les produits qui appartiennent à au moins une boutique non entrepôt et active\n          const boutiquesValidesIds = this.boutiques\n            .filter(b => b.typeBoutique !== 'ENTREPOT' && b.actif)\n            .map(b => b.id);\n\n          const produitsFiltres = produits.filter(prod => {\n            return prod.boutiques?.some(b => boutiquesValidesIds.includes(b.id));\n          });\n\n          this.tasks = produitsFiltres.map(prod => {\n            const fullImageUrl = (prod.photo && prod.photo !== 'null' && prod.photo !== 'undefined')\n              ? `${this.apiUrl}${prod.photo}`\n              : '';\n\n            return {\n              ...prod,\n              photo: fullImageUrl,\n              createdAt: this.formatDate(prod.createdAt?.toString() || ''),\n            } as Produit;\n          }).sort((a, b) => {\n            const dateA = new Date(a.createdAt ?? new Date().toISOString()).getTime();\n            const dateB = new Date(b.createdAt ?? new Date().toISOString()).getTime();\n            return dateB - dateA;\n          });\n\n          const counts: { [id: number]: number } = {};\n          produitsFiltres.forEach(prod => {\n            prod.boutiques?.forEach(b => {\n              if (boutiquesValidesIds.includes(b.id)) {\n                counts[b.id] = (counts[b.id] || 0) + 1;\n              }\n            });\n          });\n          this.productCounts = counts;\n\n          this.dataSource.data = this.tasks;\n          // Configuration du paginator supprimée car plus nécessaire avec la pagination personnalisée\n          \n          this.showNoProductsMessage = this.tasks.length === 0;\n          this.allProducts = [...this.tasks];\n          this.resetFilters();\n        }\n        ,\n      error: (err) => {\n        console.error(\"Erreur :\", err);\n        this.showNoProductsMessage = this.tasks.length === 0;\n      }\n    });\n  }\n\n  private async loadAllBoutiquesCounts(): Promise<void> {\n    if (!this.entrepriseId) return;\n\n    this.isLoadingCounts = true;\n    \n    // Réinitialiser temporairement les compteurs pour éviter l'affichage de valeurs incorrectes\n    const previousCounts = { ...this.productCounts };\n    this.boutiquesActivesSansEntrepots.forEach(b => {\n      this.productCounts[b.id] = 0;\n    });\n\n    try {\n      const requests = this.boutiquesActivesSansEntrepots.map(boutique => \n        this.produitService.getProduitsEntreprisePaginated(boutique.id, 0, 1).toPromise()\n      );\n\n      const responses = await Promise.all(requests);\n      \n      responses.forEach((response, index) => {\n        if (response) {\n          const boutiqueId = this.boutiquesActivesSansEntrepots[index].id;\n          this.productCounts[boutiqueId] = response.totalProduitsActifs;\n        }\n      });\n      \n      this.cdr.detectChanges();\n    } catch (err) {\n      console.error('Erreur lors du chargement des compteurs:', err);\n      // Restaurer les anciennes valeurs en cas d'erreur\n      this.productCounts = previousCounts;\n    } finally {\n      this.isLoadingCounts = false;\n    }\n  }\n\n  // Pour le mode \"Toutes les boutiques\"\n  async loadAllProduitsPaginated(page: number = 0, size: number = 20): Promise<void> {\n    this.showNoProductsMessage = false;\n    if (!this.entrepriseId) {\n      console.error('ID entreprise manquant');\n      return;\n    }\n\n    this.isLoading = true;\n\n    // Attendre que tous les compteurs soient chargés\n    await this.loadAllBoutiquesCounts();\n\n    this.produitService.getProduitsByEntrepriseIdPaginated(this.entrepriseId, page, size).subscribe({\n      next: (response: ProduitEntreprisePaginatedResponse) => {\n        this.tasks = response.content.map(prod => {\n          const fullImageUrl = (prod.photo && prod.photo !== 'null' && prod.photo !== 'undefined')\n            ? `${this.apiUrl}${prod.photo}`\n            : '';\n\n          return {\n            ...prod,\n            photo: fullImageUrl,\n            createdAt: this.formatDate(prod.createdAt?.toString() || ''),\n          } as Produit;\n        });\n\n        // Mettre à jour les informations de pagination\n        this.currentPage = response.pageNumber;\n        this.pageSize = response.pageSize;\n        this.totalElements = response.totalElements;\n        this.totalPages = response.totalPages;\n\n        // this.currentPageEnterprise = response.pageNumber;\n        // this.pageSizeEnterprise = response.pageSize;\n        // this.totalElementsEnterprise = response.totalElements;\n\n        this.dataSource.data = this.tasks;\n        // syncPaginator() supprimé car plus nécessaire avec la pagination personnalisée\n        \n        this.showNoProductsMessage = this.tasks.length === 0;\n        this.allProducts = [...this.tasks];\n        this.resetFilters();\n        this.isLoading = false;\n      },\n      error: (err) => {\n        console.error(\"Erreur :\", err);\n        this.showNoProductsMessage = this.tasks.length === 0;\n        this.isLoading = false;\n      }\n    });\n  }\n\n// Pour le mode boutique\n  loadProduitsPaginated(boutiqueId: number, page: number = 0, size: number = 20): void {\n    this.showNoProductsMessage = false;\n    \n    if (!boutiqueId) {\n      console.error('L\\'ID de la boutique est manquant');\n      return;\n    }\n\n    const boutique = this.boutiques.find(b => b.id === boutiqueId);\n    if (boutique?.typeBoutique === 'ENTREPOT') {\n      this.tasks = [];\n      this.dataSource.data = [];\n      this.productCounts[boutiqueId] = 0;\n      this.showNoProductsMessage = true;\n      this.isLoading = false;\n      return;\n    }\n\n    this.isLoading = true;\n    \n    this.produitService.getProduitsEntreprisePaginated(boutiqueId, page, size).subscribe({\n      next: (response: ProduitStockPaginatedResponse) => {\n        this.tasks = response.content.map(prod => {\n          // Mapper les produits\n          const fullImageUrl = (prod.photo && prod.photo !== 'null' && prod.photo !== 'undefined')\n            ? `${this.apiUrl}${prod.photo}`\n            : '';\n\n          let createdAt = '';\n          if (prod.createdAt) {\n            if (prod.createdAt.includes('à')) {\n              const [datePart, timePart] = prod.createdAt.split(' à ');\n              // format personnalisé si besoin\n            } else {\n              createdAt = new Date(prod.createdAt).toISOString();\n            }\n          }\n\n          return {\n            id: prod.id,\n            codeGenerique: prod.codeGenerique || '',\n            codeBare: prod.codeBare || '',\n            nom: prod.nom || 'Nom inconnu',\n            description: prod.description || '',\n            prixVente: prod.prixVente || 0,\n            prixAchat: prod.prixAchat || 0,\n            quantite: prod.quantite || 0,\n            seuilAlert: prod.seuilAlert || 0,\n            enStock: prod.enStock || false,\n            photo: fullImageUrl,\n            nomCategorie: prod.nomCategorie || '',\n            nomUnite: prod.nomUnite || '',\n            createdAt: createdAt,\n            categorieId: prod.categorieId || 0,\n            uniteId: prod.uniteId || 0,\n            typeProduit: prod.typeProduit || 'Non défini',\n            boutiques: prod.boutiques || []\n          } as Produit;\n        });\n\n        // Mettre à jour les informations de pagination\n        this.currentPage = response.pageNumber;\n        this.pageSize = response.pageSize;\n        this.totalElements = response.totalElements;\n        this.totalPages = response.totalPages;\n\n        // this.currentPageBoutique = response.pageNumber;\n        // this.pageSizeBoutique = response.pageSize;\n        // this.totalElementsBoutique = response.totalElements;\n\n        this.productCounts[boutiqueId] = response.totalProduitsActifs;\n\n        this.dataSource.data = this.tasks;\n        // Configuration du paginator supprimée car plus nécessaire avec la pagination personnalisée\n        this.isLoading = false;\n        this.allProducts = [...this.tasks];\n        this.resetFilters();\n        \n        this.showNoProductsMessage = this.tasks.length === 0;\n      },\n      error: (err) => {\n        this.isLoading = false;\n        \n        if (err.message === 'BOUTIQUE_DESACTIVEE') {\n          this.showSuspendedBoutiqueDialog();\n          this.selectedBoutique = this.previousSelectedBoutique;\n          return;\n        }\n        console.error(\"Erreur :\", err);\n        this.showNoProductsMessage = this.tasks.length === 0;\n      }\n    });\n  }\n\n  // Charge les produits depuis le backend et effectue le mapping pour l'affichage\n  loadProduits(boutiqueId: number, page: number = 0, size: number = 20): void {\n    this.showNoProductsMessage = false;\n    \n    if (!boutiqueId) {\n      console.error('L\\'ID de la boutique est manquant');\n      return;\n    }\n\n    const boutique = this.boutiques.find(b => b.id === boutiqueId);\n    if (boutique?.typeBoutique === 'ENTREPOT') {\n      this.tasks = [];\n      this.dataSource.data = [];\n      this.productCounts[boutiqueId] = 0;\n      this.showNoProductsMessage = true;\n      this.isLoading = false;\n      return;\n    }\n\n    this.isLoading = true;\n    \n    this.produitService.getProduitsEntreprisePaginated(boutiqueId, page, size).subscribe({\n      next: (response: ProduitStockPaginatedResponse) => {\n        // Mapper les produits comme avant\n        this.tasks = response.content.map(prod => {\n          const fullImageUrl = (prod.photo && prod.photo !== 'null' && prod.photo !== 'undefined')\n            ? `${this.apiUrl}${prod.photo}`\n            : '';\n\n          let createdAt = '';\n          if (prod.createdAt) {\n            if (prod.createdAt.includes('à')) {\n              const [datePart, timePart] = prod.createdAt.split(' à ');\n              // format personnalisé si besoin\n            } else {\n              createdAt = new Date(prod.createdAt).toISOString();\n            }\n          }\n\n          return {\n            id: prod.id,\n            codeGenerique: prod.codeGenerique || '',\n            codeBare: prod.codeBare || '',\n            nom: prod.nom || 'Nom inconnu',\n            description: prod.description || '',\n            prixVente: prod.prixVente || 0,\n            prixAchat: prod.prixAchat || 0,\n            quantite: prod.quantite || 0,\n            seuilAlert: prod.seuilAlert || 0,\n            enStock: prod.enStock || false,\n            photo: fullImageUrl,\n            nomCategorie: prod.nomCategorie || '',\n            nomUnite: prod.nomUnite || '',\n            createdAt: createdAt,\n            categorieId: prod.categorieId || 0,\n            uniteId: prod.uniteId || 0,\n            typeProduit: prod.typeProduit || 'Non défini',\n            boutiques: prod.boutiques || []\n          } as Produit;\n        });\n\n        // Mettre à jour les informations de pagination\n        this.currentPage = response.pageNumber;\n        this.pageSize = response.pageSize;\n        this.totalElements = response.totalElements;\n        this.totalPages = response.totalPages;\n\n        this.productCounts[boutiqueId] = response.totalProduitsActifs;\n\n        this.dataSource.data = this.tasks;\n        // Configuration du paginator supprimée car plus nécessaire avec la pagination personnalisée\n        this.isLoading = false;\n        this.allProducts = [...this.tasks];\n        this.resetFilters();\n        \n        this.showNoProductsMessage = this.tasks.length === 0;\n      },\n      error: (err) => {\n        this.isLoading = false;\n        \n        if (err.message === 'BOUTIQUE_DESACTIVEE') {\n          this.showSuspendedBoutiqueDialog();\n          this.selectedBoutique = this.previousSelectedBoutique;\n          return;\n        }\n        console.error(\"Erreur :\", err);\n        this.showNoProductsMessage = this.tasks.length === 0;\n      }\n    });\n  }\n\n  async rafraichirProduits(): Promise<void> {\n    this.showNoProductsMessage = false;\n    \n    if (this.selectedBoutique) {\n      this.loadProduitsPaginated(this.selectedBoutique.id, this.currentPage, this.pageSize);\n    } else {\n      // Rafraîchir les compteurs avant de charger les produits\n      await this.loadAllBoutiquesCounts();\n      this.loadAllProduitsPaginated(this.currentPage, this.pageSize);\n    }\n  }\n  \n  public showSuspendedBoutiqueDialog(): void {\n    this.dialog.open(SuspendedBoutiqueDialogComponent, {\n      width: '400px',\n      disableClose: true,\n      data: { \n        onClose: () => {\n          // Forcer la mise à jour de l'affichage\n          this.selectedBoutique = this.previousSelectedBoutique;\n        }\n      }\n    });\n  }\n  \n  // Ajoutez cette méthode si nécessaire\n  private formatDate(dateStr: string): string {\n    try {\n      const [datePart, timePart] = dateStr.split(' à ');\n      const [day, month, year] = datePart.split('-');\n      const [hours, minutes] = timePart.split(':');\n      return new Date(\n        parseInt(year),\n        parseInt(month) - 1,\n        parseInt(day),\n        parseInt(hours),\n        parseInt(minutes)\n      ).toISOString();\n    } catch {\n      return new Date().toISOString();\n    }\n  }\n  \n  // Detail de produit \n  // openProductDetail(productId: number) {}\n\n  openProduitDetail(productId: number): void {\n    const boutiqueId = this.selectedBoutique?.id;\n    this.router.navigate(['/detail-produit', productId], { \n      queryParams: { boutiqueId: boutiqueId } \n    });\n  }\n  \n  // Méthode qui retourne l'image à afficher pour un produit\n  getImageUrl(product: Produit): string {\n    // Vérifier si une image est bien fournie\n    if (product.photo && product.photo.trim() !== '') {\n      return product.photo;\n    } else {\n      // Récupérer la première lettre du nom (par défaut 'P' si non défini)\n      const firstLetter = product.nom ? product.nom.trim().charAt(0) : 'P';\n      return this.generateInitialImage(firstLetter);\n    }\n  }\n\n  // Méthode qui génère une image SVG (sous forme de Data URL) avec la première lettre du nom\n  generateInitialImage(letter: string): string {\n    const svg = `\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"200\">\n        <rect width=\"100%\" height=\"100%\" fill=\"#0671e4ac\"/>\n        <text x=\"50%\" y=\"50%\" dominant-baseline=\"middle\" text-anchor=\"middle\" font-size=\"100\" fill=\"#fff\">\n          ${letter.toUpperCase()}\n        </text> \n      </svg>\n    `;\n    return 'data:image/svg+xml;base64,' + btoa(svg);\n  }\n\n  getBoutiqueNames(boutiques: any[] | undefined): string {\n    if (!boutiques || boutiques.length === 0) return 'Aucune boutique';\n    \n    const maxDisplay = 2; // Nombre de boutiques à afficher avant troncature\n    if (boutiques.length > maxDisplay) {\n      const displayed = boutiques.slice(0, maxDisplay).map(b => b.nom);\n      return `${displayed.join(', ')}, ...`; // Ajoute les points de suspension\n    }\n    return boutiques.map(b => b.nom).join(', ');\n  }\n\n  // Ajoutez cette méthode dans la classe ProduitsComponent\n  // getBoutiqueTextColor(index: number, isActive: boolean): string {\n  //   // Génère des couleurs différentes selon l'index\n  //   const hue = (index * 137.508) % 360; // 137.508 pour une bonne répartition des couleurs\n  //   return isActive ? '#ffffff' : `hsl(${hue}, 70%, 40%)`; // Texte blanc si actif, couleur vive sinon\n  // }\n  // sur html\n  //  ? getBoutiqueTextColor(i, boutique.id === selectedBoutique?.id) : '#999'\n\n  onDrop(event: CdkDragDrop<any[]>) {\n    const previousIndex = this.boutiques.findIndex(boutique => boutique === event.item.data);\n    const currentIndex = event.currentIndex;\n    moveItemInArray(this.boutiques, previousIndex, currentIndex);\n  }\n\n  openExcelImportModal() {\n    this.resetImportState();\n    this.showExcelImportModal = true;\n  }\n\n  closeExcelImportModal() {\n    this.showExcelImportModal = false;\n    this.resetImportState();\n  }\n\n  resetImportState() {\n    this.selectedFile = null;\n    this.isImporting = false;\n    this.importMessage = '';\n    this.importSuccess = false;\n    this.importErrors = [];\n  }\n\n  // Télécharger le modèle Excel\n  downloadExcelTemplate() {\n    // Création du workbook\n    const wb = XLSX.utils.book_new();\n    \n    // Données du modèle\n    const data = [\n      // En-têtes avec mise en forme\n      ['Nom produit*', 'Description', 'Catégorie*', 'Prix Vente*', 'Prix Achat*', 'Quantité*', 'Unité', 'Code Barre', 'Type Produit', 'Date Preemption', 'Seuil Alert'],\n      // Ligne d'exemple\n      ['T-Shirt', 'T-shirt en coton', 'Vêtements', 25.99, 15.50, 100, 'Pièce', 123456789, 'PHYSIQUE', '29-12-2026', 10],\n      // Ligne de note explicative\n      // ['', '', '', '', '', '', '', '', '', '', '']\n    ];\n    \n    // Création de la worksheet avec les données\n    const ws = XLSX.utils.aoa_to_sheet(data);\n    \n    // Largeurs de colonnes personnalisées\n    const colWidths = [\n      { wch: 20 }, // Nom produit\n      { wch: 25 }, // Description\n      { wch: 15 }, // Catégorie\n      { wch: 12 }, // Prix Vente\n      { wch: 12 }, // Prix Achat\n      { wch: 10 }, // Quantité\n      { wch: 10 }, // Unité\n      { wch: 15 }, // Code Barre\n      { wch: 12 }, // Type Produit\n      { wch: 12 }, // Date preemption\n      { wch: 12 }  // Seuil Alert\n    ];\n    ws['!cols'] = colWidths;\n    \n    // Ajout de la worksheet au workbook\n    XLSX.utils.book_append_sheet(wb, ws, 'Modèle Produits');\n    \n    // Génération du fichier\n    const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\n    const blob = new Blob([excelBuffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\n    \n    // Téléchargement\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'modele-import-produits.xlsx';\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    window.URL.revokeObjectURL(url);\n  }\n\n  validateExcelDates(file: File): Promise<boolean> {\n    return new Promise((resolve) => {\n      const reader = new FileReader();\n      reader.onload = (e: any) => {\n        const data = new Uint8Array(e.target.result);\n        const workbook = XLSX.read(data, { type: 'array' });\n        const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n\n        // Vérifier le format des dates (colonne 9)\n        for (let i = 1; i < jsonData.length; i++) {\n          const row = jsonData[i] as any[];\n          if (row[9]) {\n            if (!/^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[012])-\\d{4}$/.test(row[9])) {\n              resolve(false);\n              return;\n            }\n          }\n        }\n        resolve(true);\n      };\n      reader.readAsArrayBuffer(file);\n    });\n  }\n\n  // Gestion de la sélection de fichier\n  async onFileSelected(event: any) {\n    const file: File = event.target.files[0];\n    if (file) {\n      // Vérifier la taille du fichier (max 5MB)\n      if (file.size > 5 * 1024 * 1024) {\n        this.importMessage = 'Le fichier est trop volumineux (max 5MB)';\n        this.importSuccess = false;\n        return;\n      }\n      \n      // Vérifier l'extension\n      const validExtensions = ['.xlsx', '.xls'];\n      const extension = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();\n      \n      if (!validExtensions.includes(extension)) {\n        this.importMessage = 'Format de fichier non supporté';\n        this.importSuccess = false;\n        return;\n      }\n      \n      this.selectedFile = file;\n\n      // Ajouter la validation\n      const isValid = await this.validateExcelDates(file);\n      if (!isValid) {\n        this.importMessage = 'Format de date invalide. Utilisez dd-MM-yyyy';\n        this.importSuccess = false;\n        this.selectedFile = null;\n        return;\n      }\n    }\n  }\n\n  uploadExcel() {\n    if (!this.selectedFile || !this.entrepriseId) return;\n    \n    // this.isImporting = true;\n    this.importMessage = '';\n    this.importErrors = [];\n    \n    const formData = new FormData();\n    formData.append('file', this.selectedFile);\n    formData.append('entrepriseId', this.entrepriseId.toString());\n    \n    if (this.selectedBoutique?.id) {\n      formData.append('boutiqueId', this.selectedBoutique.id.toString());\n    }\n\n      // Vérifier qu'au moins une boutique est sélectionnée\n    if (this.selectedBoutiquesForImport.length === 0) {\n      this.importMessage = \"Veuillez sélectionner au moins une boutique\";\n      this.importSuccess = false;\n      return;\n    }\n    \n    this.produitService.importProduitsFromExcel(formData, this.selectedBoutiquesForImport).subscribe({\n      next: (response: any) => {\n        // this.isImporting = false;\n        \n        // Correction clé ici : utiliser 'count' au lieu de 'successCount'\n        if (response.count > 0) {\n          this.importSuccess = true;\n          this.importMessage = `Importation réussie ! ${response.count} produits ajoutés.`;\n        } else {\n          this.importSuccess = false;\n          this.importMessage = \"Aucun produit ajouté\";\n        }\n        \n        if (response.errors) {\n          this.importErrors = response.errors;\n        }\n        \n        // Rafraîchir les données\n        // setTimeout(() => {\n        //   if (this.selectedBoutique) {\n        //     this.loadProduits(this.selectedBoutique.id);\n        //   } else {\n        //     this.loadAllProduits();\n        //   }\n        // }, 2000);\n        // Fermer le modal après 3 secondes seulement si l'import est réussi\n        if (this.importSuccess) {\n          setTimeout(() => {\n            if (this.selectedBoutique) {\n            this.loadProduits(this.selectedBoutique.id);\n          } else {\n            this.loadAllProduits();\n            this.closeExcelImportModal();\n          }\n          }, 2000);\n        }\n      },\n      error: (error) => {\n        // this.isImporting = false;\n        this.importSuccess = false;\n\n        if (this.importMessage.includes('Date') || this.importMessage.includes('Preemption')) {\n          this.importMessage += '. Format de date invalide. Utilisez dd-MM-yyyy.';\n        }\n        \n        // Gestion améliorée des erreurs\n        if (error.error) {\n          if (error.error.error) {\n            this.importMessage = error.error.error;\n          } else if (error.error.message) {\n            this.importMessage = error.error.message;\n          }\n          \n          if (error.error.errors) {\n            this.importErrors = error.error.errors;\n          }\n        } else {\n          this.importMessage = 'Erreur inconnue lors de l\\'importation';\n        }\n      }\n    });\n  }\n\n  toggleBoutiqueSelection(id: number): void {\n    const index = this.selectedBoutiquesForImport.indexOf(id);\n    if (index === -1) {\n      this.selectedBoutiquesForImport.push(id);\n    } else {\n      this.selectedBoutiquesForImport.splice(index, 1);\n    }\n  }\n\n  toggleAllBoutiques(): void {\n    if (this.isAllBoutiquesSelected) {\n      this.selectedBoutiquesForImport = [];\n    } else {\n      this.selectedBoutiquesForImport = this.boutiques\n        .filter(b => b.actif)\n        .map(b => b.id);\n    }\n    this.isAllBoutiquesSelected = !this.isAllBoutiquesSelected;\n  }\n\n  // Méthodes pour gérer le panel\n  toggleBoutiqueSelectionPanel(): void {\n    this.showBoutiqueSelectionPanel = !this.showBoutiqueSelectionPanel;\n  }\n\n  areAllBoutiquesSelected(): boolean {\n    return this.boutiques.length > 0 && \n          this.boutiques.every(b => this.selectedBoutiquesForImport.includes(b.id));\n  }\n\n  toggleSelectAllBoutiques(event: Event): void {\n    const isChecked = (event.target as HTMLInputElement).checked;\n    if (isChecked) {\n      this.selectedBoutiquesForImport = this.boutiques.map(b => b.id);\n    } else {\n      this.selectedBoutiquesForImport = [];\n    }\n  }\n\n  confirmBoutiqueSelection(): void {\n    this.toggleBoutiqueSelectionPanel();\n  }\n\n  getSelectedBoutiquesText(): string {\n    if (this.selectedBoutiquesForImport.length === 0) {\n      return '';\n    }\n\n    if (this.selectedBoutiquesForImport.length === this.boutiques.length) {\n      return 'Toutes les boutiques';\n    }\n\n    const selectedNames = this.boutiques\n      .filter(b => this.selectedBoutiquesForImport.includes(b.id))\n      .map(b => b.nomBoutique);\n\n    return selectedNames.join(', ');\n  }\n  \n  get boutiquesSansEntrepots(): any[] {\n    return this.boutiques?.filter(b => b.typeBoutique !== 'ENTREPOT') || [];\n  }\n\n  get boutiquesActivesSansEntrepots(): Boutique[] {\n    return this.boutiques?.filter(b => b.typeBoutique !== 'ENTREPOT' && b.actif) || [];\n  }\n\n  get totalAllProducts(): number {\n    if (this.isLoadingCounts) return 0;\n    if (!this.boutiquesActivesSansEntrepots.length) return 0;\n    \n    return this.boutiquesActivesSansEntrepots\n      .map(b => this.productCounts[b.id] || 0)\n      .reduce((acc, curr) => acc + curr, 0);\n  }\n\n  fetchCategories(): void {\n    this.categorieService.getCategories().pipe(\n      catchError(err => {\n        console.error(\"Erreur de chargement des catégories\", err);\n        return [];\n      })\n    ).subscribe((data: Categorie[]) => {\n      this.categories = data.map((cat: Categorie) => ({\n        ...cat,\n        selected: false\n      }));\n    });\n  }\n\n  get isAnySelected(): boolean {\n    return this.categories.some(cat => cat.selected);\n  }\n  onCheckboxChange(): void {\n    // Juste pour déclencher la détection de changement\n  }\n  cancelSelection(): void {\n  if (this.isAnySelected) {\n    // Si y a des cochés, décocher tout\n    this.categories.forEach(cat => cat.selected = false);\n  } else {\n    // Sinon fermer popup\n    this.isPopupVisible = false;\n  }\n}\n\n  @ViewChild('popupContainer') popupContainer!: ElementRef;\n  // Masque le dropdown si l'utilisateur clique en dehors\n @HostListener('document:click', ['$event'])\n  _onClickOutside(event: MouseEvent) {\n    if (this.isPopupVisible && this.popupContainer && !this.popupContainer.nativeElement.contains(event.target)) {\n      this.isPopupVisible = false;\n    }\n  }\n\nsuccessMessage: string | null = null;\nerrorMessageApi: string | null = null;\n\ntogglePopup(): void {\n  this.successMessage = null;\n  this.errorMessageApi = null;\n  this.isPopupVisible = !this.isPopupVisible;\n}\n\ndeleteSelection(): void {\n  // Réinitialiser les messages avant chaque action\n  this.successMessage = null;\n  this.errorMessageApi = null;\n\n  const selectedIds = this.categories.filter(c => c.selected && c.id !== undefined).map(c => c.id!);\n  console.log(\"🔴 À supprimer :\", selectedIds);\n\n  if (selectedIds.length === 0) {\n    this.errorMessageApi = \"Veuillez sélectionner au moins une catégorie.\";\n    this.clearMessagesAfterDelay();\n    return;\n  }\n\n  if (selectedIds.length > 1) {\n    this.errorMessageApi = \"Vous ne pouvez supprimer qu'une seule catégorie à la fois.\";\n    this.clearMessagesAfterDelay();\n    return;\n  }\n\n  const idToDelete = selectedIds[0];\n\n  this.categorieService.deleteCategorie(idToDelete).subscribe({\n    next: (message: string) => {\n      this.successMessage = message || \"Catégorie supprimée avec succès.\";\n      this.errorMessageApi = null;\n\n      this.categories = this.categories.filter(c => c.id !== idToDelete);\n      this.isPopupVisible = false;\n\n      this.clearMessagesAfterDelay();\n    },\n    error: (error) => {\n      this.successMessage = null;\n\n      if (error.error && typeof error.error === 'string') {\n        this.errorMessageApi = error.error;\n      } else if (error.status === 403) {\n        this.errorMessageApi = \"Accès refusé. Seuls les administrateurs ou managers peuvent supprimer une catégorie.\";\n      } else if (error.status === 409) {\n        this.errorMessageApi = \"Cette catégorie contient des produits. Veuillez d'abord les supprimer.\";\n      } else {\n        this.errorMessageApi = \"Erreur inattendue lors de la suppression.\";\n      }\n\n      this.clearMessagesAfterDelay();\n    }\n  });\n}\n\nprivate clearMessagesAfterDelay(): void {\n  setTimeout(() => {\n    this.successMessage = null;\n    this.errorMessageApi = null;\n  }, 4000); // 4 secondes\n}\n\n\n\n\n\n\n\n}\n","  <!-- Message d'erreur principal -->\n   <div class=\"toast-container\">\n        <div *ngIf=\"errorMessageApi\" class=\"alert alert-danger toast-message-danger\">\n          {{ errorMessageApi }}\n        </div>\n        \n        <!-- Message de succès -->\n        <div *ngIf=\"successMessage\" class=\"alert alert-success toast-message-success\">\n          {{ successMessage }}\n        </div>\n    </div>\n  \n<div class=\"containerTable\">\n  <!-- En-tête : titre, actions et barre de recherche -->\n  <div class=\"tasks-header\">\n    <h1 class=\"title\">Produits / Services</h1>\n\n    <div class=\"actions\">\n      <button class=\"add-task\" (click)=\"goToAddProduit()\">Ajouter un produit</button>\n       <button class=\"add-task1\" (click)=\"openExcelImportModal()\" title=\"importer Excel\">\n       <i class=\"fa fa-download\" aria-hidden=\"true\"></i>\n      </button>\n      \n \n       <div class=\"bare\"></div>\n\n      <div class=\"contentIcon\">\n        <i class=\"ri-refresh-line\" (click)=\"rafraichirProduits()\" *ngIf=\"!isLoading\"></i>\n        <i *ngIf=\"isLoading\" class=\"ri-loader-line ri-spin\"></i>\n        <div class=\"bare\"></div>\n\n        <div class=\"export-container\" #popupContainer> \n\n            <i (click)=\"togglePopup()\">\n              <img src=\"assets/icon/category.png\" alt=\"Category Icon\" style=\"width: 20px; height: 20px;\" />\n            </i>\n              <!-- Popup -->\n          <div *ngIf=\"isPopupVisible\" class=\"popup show\">\n            <div class=\"checkbox-list\">\n             <label *ngFor=\"let cat of categories\">\n                 <input type=\"checkbox\" [(ngModel)]=\"cat.selected\" (change)=\"onCheckboxChange()\" />\n                {{ cat.nom }}\n              </label>\n            </div>\n\n            <!-- Si au moins une case est cochée, afficher les boutons -->\n            <div *ngIf=\"isAnySelected\" class=\"action-buttons\">\n              <button class=\"cancel-btn\" (click)=\"cancelSelection()\">Annuler</button>\n              <button class=\"delete-btn\" (click)=\"deleteSelection()\">Supprimer</button>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"bare\"></div>\n        <div class=\"export-container\">\n          <div class=\"iconDrop\">\n            <i class=\"ri-printer-cloud-line\" (click)=\"toggleExportDropdown()\"></i>\n          </div>\n          <div class=\"export-dropdown\" *ngIf=\"showExportDropdown\">\n            <div class=\"export-option\" (click)=\"downloadExcel()\">Télécharger en Excel</div>\n            <div class=\"export-option\" (click)=\"downloadPDF()\">Télécharger en PDF</div>\n            <div class=\"export-option\" (click)=\"downloadCSV()\">Télécharger en CSV</div>\n          </div>\n        </div>\n        \n      </div>\n\n    <!-- Nouvelle barre de recherche avec filtres -->\n    <div class=\"container_inputSearch\" style=\"display: flex; align-items: center; position: relative;\">\n      <div class=\"inputSearch\" style=\"flex: 1; position: relative;\">\n        <div class=\"tags-container\" \n          (click)=\"focusSearchInput()\"\n          style=\"display: flex; flex-wrap: wrap; align-items: center; padding-left: 35px; min-height: 40px; border: 1.5px solid #000; border-top-left-radius: 5px; min-width: 250px; border-bottom-left-radius: 5px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; background: white; cursor: text;\">   \n          \n          <span *ngIf=\"selectedFilters.length > 0\" class=\"tag\" style=\"display: flex; align-items: center; background: #e0e0e0; padding: 2px 8px; border-radius: 20px; margin: 2px 4px 2px 0; font-size: 12px; z-index: 12;\">\n            {{ selectedFilters[0].label }}\n            <span class=\"remove-chip\" (click)=\"removeFilter(selectedFilters[0]); $event.stopPropagation()\">✖</span>\n          </span>\n\n          <input \n            #searchInput\n            type=\"text\" \n            [(ngModel)]=\"searchText\" \n            (ngModelChange)=\"applyFilters()\" \n            [placeholder]=\"getSearchPlaceholder()\"\n            style=\"border: none; outline: none; flex: 1; padding: 5px 0; min-width: 120px;\"\n            (click)=\"$event.stopPropagation()\"\n          />\n\n          <i class=\"ri-search-2-line\" style=\"position: absolute; left: 10px; top: 50%; transform: translateY(-50%); z-index: 1;\"></i>\n        </div>\n      </div>\n\n      <div class=\"trier\" title=\"Trier et filtrer\" (click)=\"toggleFilterDropdown(); $event.stopPropagation()\" style=\"cursor: pointer;\">\n        <i *ngIf=\"!showFilterDropdown\" style=\"font-size: 18px;\" class=\"ri-arrow-down-s-fill\"></i>\n        <i *ngIf=\"showFilterDropdown\" style=\"font-size: 18px;\" class=\"ri-close-line\"></i>\n      </div>\n\n      <div class=\"filter-dropdown\" *ngIf=\"showFilterDropdown\" (click)=\"$event.stopPropagation()\"\n          style=\"position: absolute; top: 100%; right: 0; background: white; \n          border: 1px solid #ccc; border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); \n          z-index: 100; width: 100%; margin-top: 5px;\">\n        <div class=\"filter-section\" style=\"padding: 10px;\">\n          <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n              <h4 style=\"margin: 0; font-size: 16px; color: #333;\">Filtres</h4>\n              <div>\n                <button (click)=\"resetFilters(); $event.stopPropagation()\" \n                        style=\"background: none; border: none; color: #0671e4; cursor: pointer; font-size: 13px;\">\n                  Réinitialiser\n                </button>\n              </div>\n          </div>\n          <ul style=\"list-style: none; padding: 0; margin: 10px 0 0 0;\">\n            <li (click)=\"addFilter({ type: 'nomCategorie', label: 'Catégorie' })\" \n                [class.disabled]=\"isFilterSelected('nomCategorie')\"\n                style=\"padding: 8px 12px; cursor: pointer; border-radius: 4px; margin-bottom: 5px; transition: background 0.3s;\"\n                [style.background]=\"isFilterSelected('nomCategorie') ? '#f0f0f0' : 'transparent'\">\n              Catégorie\n            </li>\n            <li (click)=\"addFilter({ type: 'nomUnite', label: 'Unité' })\" \n                [class.disabled]=\"isFilterSelected('nomUnite')\"\n                style=\"padding: 8px 12px; cursor: pointer; border-radius: 4px; transition: background 0.3s;\"\n                [style.background]=\"isFilterSelected('nomUnite') ? '#f0f0f0' : 'transparent'\">\n              Unité\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n      \n    </div>\n  </div>\n\n<div class=\"container_list_boutique\" cdkDropList \n  [cdkDropListData]=\"boutiques\" \n  (cdkDropListDropped)=\"onDrop($event)\"\n  cdkDropListAutoScroll>\n    <div class=\"content_list_boutique\">\n        <div class=\"name_boutique\">\n            <div class=\"all_boutique\" \n                [class.name_boutique_active]=\"selectedBoutique === null\"\n                (click)=\"selectBoutique(null)\">\n                <p class=\"all_boutique\" style=\"display: flex; align-items: center;\">\n                  Toutes les boutiques\n                  <span *ngIf=\"!isLoadingCounts && totalAllProducts > 0\" class=\"facture-count\">\n                    {{ totalAllProducts }}\n                  </span>\n                  <span *ngIf=\"isLoadingCounts\" class=\"facture-count\">\n                    <i class=\"ri-loader-line ri-spin\" style=\"font-size: 12px;\"></i>\n                  </span>\n                </p>\n            </div>\n        \n            <ng-container *ngIf=\"(boutiques?.length || 0) > 0;\">\n                <!-- <ng-container *ngFor=\"let boutique of boutiques || []; let i = index\"> -->\n                  <ng-container *ngFor=\"let boutique of boutiquesSansEntrepots; let i = index\">\n                    <div cdkDrag class=\"draggable-item\" [class.name_boutique_active]=\"boutique.id === selectedBoutique?.id && boutique.actif\"\n                        [class.suspended-boutique]=\"!boutique.actif\"\n                        [style.color]=\"boutique.actif\"\n                        (click)=\"boutique.actif ? selectBoutique(boutique) : showSuspendedBoutiqueDialog()\">\n                        <p style=\"display: flex; align-items: center;\">\n                          {{ boutique.nomBoutique }}\n                          <span *ngIf=\"productCounts[boutique.id] > 0\" class=\"facture-count\">\n                            {{ productCounts[boutique.id] }}\n                          </span>\n                          <i *ngIf=\"!boutique.actif\" class=\"ri-error-warning-line warning-icon\"></i>\n                        </p>\n                    </div>\n                    <div *ngIf=\"i !== boutiques.length - 1\" class=\"barre\"></div>\n                </ng-container>\n            </ng-container>\n\n            <!-- <ng-template #noBoutiques>\n                <p class=\"no-boutiques-message\">Aucune boutique trouvée</p>\n            </ng-template> -->\n        </div>\n    </div>\n</div>\n\n\n  <!-- Tableau des produits -->\n  <table>\n    <thead>\n      <tr class=\"titleTableProduit\">\n        <th>Code</th>\n        <th>Photo</th>\n        <th>Nom produit</th>\n        <th>Description</th>\n        <th>Catégorie</th>\n        <th>Prix Vente</th>\n        <th>Coût du produit</th>\n        <!-- <th style=\"background-color: #0671e44a;\">En stock</th> -->\n        <th>Unité</th>\n        <th>Type</th>\n        <ng-container *ngIf=\"!selectedBoutique\">\n          <th>Boutique</th>\n        </ng-container>\n      </tr>\n    </thead>\n    <tbody>\n      <!--  -->\n      <tr *ngFor=\"let product of filteredProducts(); let i = index\" style=\"font-size: 10px;\" (click)=\"openProduitDetail(product.id)\">\n        <td [innerHTML]=\"highlightMatch(product.codeGenerique || '')\"></td>\n        <td>\n          <div class=\"imgProduit\">\n            <img [src]=\"product.photo\" alt=\"Produit\">\n          </div>\n          <div class=\"modal\" *ngIf=\"imagePopup\">\n            <div class=\"modal-content\" (click)=\"$event.stopPropagation()\">\n              <img [src]=\"imagePopup\" alt=\"Produit\">\n            </div>\n          </div>\n        </td>\n        <!-- <div> {{ product | json }}</div> -->\n        <td [innerHTML]=\"highlightMatch(product.nom)\" ></td>\n        <td class=\"description-cell\" (mouseover)=\"showDescription = true\" (mouseout)=\"showDescription = false\">\n          {{ product.description ? (product.description | slice:0:20) + (product.description.length > 20 ? '...' : '') : 'sans description' }}\n          <div class=\"description-hover\" *ngIf=\"showDescription\">{{ product.description || 'sans description' }}</div>\n        </td>\n        <td [innerHTML]=\"highlightMatch(product.nomCategorie || 'sans categorie')\"></td>\n        <td>{{ product.prixVente | customNumber }}</td>\n        <td>{{ product.prixAchat | customNumber }}</td>\n        <!-- <td style=\"background-color: #0671e410;\" [innerHTML]=\"highlightMatch(product.quantite.toString())\"></td> -->\n        <!-- <td>{{ product.nomUnite || 'Sans unité'}}</td> -->\n        <td [innerHTML]=\"highlightMatch(product.nomUnite || 'sans unite')\"></td>\n       <td>\n          {{ product.typeProduit === 'PHYSIQUE' ? 'Produit' : (product.typeProduit === 'SERVICE' ? 'Service' : 'Type Produit') }}\n        </td>\n\n        <!-- <td>\n          <span *ngIf=\"product.boutiques && product.boutiques.length > 0\">\n            {{ product.boutiques.map(b => b.nom).join(', ') }}\n          </span>\n          <span *ngIf=\"!product.boutiques || product.boutiques.length === 0\">\n            Aucune boutique\n          </span>\n        </td> -->\n        <!-- Cellule conditionnelle -->\n        <ng-container>\n          <td  *ngIf=\"!selectedBoutique\">{{ getBoutiqueNames(product.boutiques) }}</td>\n        </ng-container>\n      </tr>\n      <!-- Message si aucun produit ne correspond à la recherche -->\n      <tr *ngIf=\"tasks.length > 0 && filteredProducts().length === 0\">\n        <td colspan=\"10\" style=\"text-align: center;\">Aucun produit trouvée.</td>\n      </tr>\n    </tbody>\n  </table>\n\n  <!-- Message si aucun produit n'est présent -->\n  <div *ngIf=\"showNoProductsMessage && !isLoading\" style=\"text-align: center; margin-top: 20px;\">\n    <p style=\"color: red;\">Vous n'avez pas de produit</p>\n  </div>\n\n  <!-- Pagination personnalisée -->\n  <div class=\"pager\" aria-label=\"Pagination\" *ngIf=\"totalElements > pageSize\">\n    <div class=\"pager-info\">\n      <span>Items per page:</span>\n      <select [(ngModel)]=\"pageSize\" (change)=\"onPageSizeChange()\" class=\"page-size-select\">\n        <option value=\"5\">5</option>\n        <option value=\"10\">10</option>\n        <option value=\"20\">20</option>\n        <option value=\"50\">50</option>\n      </select>\n      <span class=\"page-info\">{{ getPageInfo() }}</span>\n    </div>\n    \n    <div class=\"pager-navigation\">\n      <button \n        class=\"pager-btn\" \n        [disabled]=\"currentPage === 0\"\n        (click)=\"goToPage(0)\"\n        title=\"Première page\">\n        <i class=\"ri-skip-back-line\"></i>\n      </button>\n      \n      <button \n        class=\"pager-btn\" \n        [disabled]=\"currentPage === 0\"\n        (click)=\"goToPage(currentPage - 1)\"\n        title=\"Page précédente\">\n        <i class=\"ri-arrow-left-s-line\"></i>\n      </button>\n      \n              <div class=\"page-numbers\">\n          <button \n            *ngFor=\"let page of getVisiblePages()\" \n            class=\"page-number\"\n            [class.active]=\"page === currentPage\"\n            (click)=\"goToPage(page)\"\n            [disabled]=\"page === '...'\">\n            {{ page }}\n          </button>\n        </div>\n      \n      <button \n        class=\"pager-btn\" \n        [disabled]=\"currentPage >= totalPages - 1\"\n        (click)=\"goToPage(currentPage + 1)\"\n        title=\"Page suivante\">\n        <i class=\"ri-arrow-right-s-line\"></i>\n      </button>\n      \n      <button \n        class=\"pager-btn\" \n        [disabled]=\"currentPage >= totalPages - 1\"\n        (click)=\"goToPage(totalPages - 1)\"\n        title=\"Dernière page\">\n        <i class=\"ri-skip-forward-line\"></i>\n      </button>\n    </div>\n  </div>\n</div>\n\n<!-- Modal d'importation Excel -->\n<div class=\"modal\" *ngIf=\"showExcelImportModal\">\n  <div class=\"modal-content\" (click)=\"$event.stopPropagation()\">\n    <span class=\"close\" (click)=\"closeExcelImportModal()\">&times;</span>\n    \n    <h5>Importer des produits depuis Excel</h5>\n\n    <div class=\"container_modal_excel\">\n\n      <div class=\"import-instructions\">\n        <h3>Instructions pour préparer votre fichier Excel :</h3>\n        <ol>\n          <li style=\"font-size: 12px;\">Téléchargez notre modèle Excel ci-dessous</li>\n          <li style=\"font-size: 12px;\">Remplissez les colonnes avec vos données</li>\n          <li style=\"font-size: 12px;\">Les colonnes obligatoires sont marquées d'un *</li>\n          <li style=\"font-size: 12px;\">Évitez de modifier les en-têtes de colonnes</li>\n        </ol>\n        \n        <div class=\"columns-info\">\n          <h6>Structure des colonnes :</h6>\n          <ul>\n            <li><strong>Nom produit <span style=\"color: red;\">*</span></strong> - Nom du produit (texte)</li>\n            <li><strong>Description</strong> - Description du produit</li>\n            <li><strong>Catégorie <span style=\"color: red;\">*</span></strong> - Nom de la catégorie existante</li>\n            <li><strong>Prix Vente <span style=\"color: red;\">*</span></strong> - Prix de vente (nombre)</li>\n            <li><strong>Prix Achat <span style=\"color: red;\">*</span></strong> - Prix d'achat (nombre)</li>\n            <li><strong>Quantité <span style=\"color: red;\">*</span></strong> - Quantité initiale (nombre entier)</li>\n            <li><strong>Unité</strong> - Unité de mesure existante</li>\n            <li><strong>Code Barre</strong> - Code barre (nombre entier)</li>\n            <li><strong>Type Produit</strong> - PHYSIQUE ou SERVICE</li>\n            <!-- <li><strong>Date Preemption</strong> - Date de préemption (format: JJ-MM-AAAA)</li> -->\n             <li>\n                <strong>Date Preemption</strong> - Format: <span style=\"color:red;font-weight:bold\">dd-MM-yyyy</span> \n                (ex: 31-12-2025)\n              </li>\n            <li><strong>Seuil Alert</strong> - Seuil d'alerte stock (nombre entier)</li>\n          </ul>\n        </div>\n        \n        <button class=\"download-template\" (click)=\"downloadExcelTemplate()\">\n          <i class=\"ri-download-line\"></i> Télécharger le modèle\n        </button>\n      </div>\n\n      <div class=\"left_import_excel\">\n        <div class=\"double_input2\">\n          <div class=\"champ_input\" [class.invalid-field]=\"showBoutiqueError\">\n            <input autocomplete=\"off\" \n                  type=\"text\" \n                  placeholder=\"Sélectionner vos boutiques\"\n                  class=\"input_focus\" \n                  matInput \n                  (click)=\"toggleBoutiqueSelectionPanel()\"\n                  [value]=\"getSelectedBoutiquesText()\"\n                  readonly\n                  style=\"cursor: pointer;\">\n            <label for=\"boutiqueId\" class=\"label\"><i class=\"ri-check-double-line\"></i> Sélectionner vos boutiques</label>\n            \n            <div class=\"boutique-selection-panel\" *ngIf=\"showBoutiqueSelectionPanel\">\n              <div class=\"panel-header\">\n                <h4>Sélectionner des boutiques</h4>\n                <button class=\"close-btn\" (click)=\"toggleBoutiqueSelectionPanel()\">&times;</button>\n              </div>\n              <div class=\"panel-body\">\n                <div class=\"boutique-item select-all\">\n                  <label>\n                    <input type=\"checkbox\" \n                          [checked]=\"areAllBoutiquesSelected()\"\n                          (change)=\"toggleSelectAllBoutiques($event)\">\n                    Sélectionner toutes les boutiques\n                  </label>\n                </div>\n                \n                <div *ngFor=\"let boutique of boutiques\" class=\"boutique-item\">\n                  <label>\n                    <input type=\"checkbox\" \n                          [checked]=\"selectedBoutiquesForImport.includes(boutique.id)\"\n                          (change)=\"toggleBoutiqueSelection(boutique.id)\">\n                    {{ boutique.nomBoutique }}\n                  </label>\n                </div>\n              </div>\n              <div class=\"panel-footer\">\n                <button class=\"btn-confirm\" (click)=\"confirmBoutiqueSelection()\">Confirmer</button>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"file-upload-area\" (click)=\"fileInput.click()\" [class.active]=\"selectedFile\">\n          <input type=\"file\" #fileInput (change)=\"onFileSelected($event)\" accept=\".xlsx, .xls\" hidden>\n          <i class=\"ri-upload-cloud-2-line\"></i>\n          <p *ngIf=\"!selectedFile\">Cliquez pour sélectionner votre fichier Excel</p>\n          <p *ngIf=\"selectedFile\">{{ selectedFile.name }}</p>\n          <small>Formats acceptés: .xlsx, .xls (Max 5MB)</small>\n        </div>\n        \n        <div class=\"modal-actions\">\n          <button class=\"btn-cancel\" (click)=\"closeExcelImportModal()\">Annuler</button>\n          <button class=\"btn-import\" \n                  (click)=\"uploadExcel()\" \n                  [disabled]=\"!selectedFile\">\n            \n            <!-- Remplacer le texte par un spinner -->\n            <ng-container>Importer</ng-container>\n            <!-- <i *ngIf=\"isImporting\" class=\"ri-loader-4-line ri-spin\"></i> -->\n          </button>\n        </div>\n        \n        <div *ngIf=\"importMessage\" class=\"import-status\" [class.success]=\"importSuccess\" [class.error]=\"!importSuccess\">\n          {{ importMessage }}\n          <div *ngIf=\"importErrors.length > 0\" class=\"import-errors\">\n            <h4>Erreurs survenues :</h4>\n            <ul>\n              <li *ngFor=\"let error of importErrors\">{{ error }}</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n    </div>\n    \n\n  </div>\n</div>"],"names":["HttpHeaders","BehaviorSubject","catchError","Observable","switchMap","tap","throwError","environment","CategorieService","constructor","http","usersService","apiUrl","apiBaseUrl","categoriesSubject","categories$","asObservable","ajouterCategorie","category","getValidAccessToken","pipe","token","console","error","Error","headers","post","newCategory","currentCategories","value","next","getProduitsByCategorie","categorieId","page","size","set","params","toString","get","deleteCategorie","id","log","delete","responseType","getCategories","categories","i0","ɵɵinject","i1","HttpClient","i2","UsersService","factory","ɵfac","providedIn","CommonModule","FormsModule","ReactiveFormsModule","jsPDF","XLSX","MatSelectModule","MatFormFieldModule","MatAutocompleteModule","MatInputModule","MatTableDataSource","autoTable","CustomNumberPipe","SuspendedBoutiqueDialogComponent","DragDropModule","moveItemInArray","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","ctx_r1","errorMessageApi","successMessage","ɵɵlistener","ProduitsComponent_i_14_Template_i_click_0_listener","ɵɵrestoreView","_r3","ɵɵnextContext","ɵɵresetView","rafraichirProduits","ɵɵelement","ɵɵtwoWayListener","ProduitsComponent_div_21_label_2_Template_input_ngModelChange_1_listener","$event","cat_r5","_r4","$implicit","ɵɵtwoWayBindingSet","selected","ProduitsComponent_div_21_label_2_Template_input_change_1_listener","onCheckboxChange","ɵɵtwoWayProperty","nom","ProduitsComponent_div_21_div_3_Template_button_click_1_listener","_r6","cancelSelection","ProduitsComponent_div_21_div_3_Template_button_click_3_listener","deleteSelection","ɵɵtemplate","ProduitsComponent_div_21_label_2_Template","ProduitsComponent_div_21_div_3_Template","ɵɵproperty","isAnySelected","ProduitsComponent_div_26_Template_div_click_1_listener","_r7","downloadExcel","ProduitsComponent_div_26_Template_div_click_3_listener","downloadPDF","ProduitsComponent_div_26_Template_div_click_5_listener","downloadCSV","ProduitsComponent_span_30_Template_span_click_2_listener","_r8","removeFilter","selectedFilters","stopPropagation","label","ProduitsComponent_div_37_Template_div_click_0_listener","_r9","ProduitsComponent_div_37_Template_button_click_6_listener","resetFilters","ProduitsComponent_div_37_Template_li_click_9_listener","addFilter","type","ProduitsComponent_div_37_Template_li_click_11_listener","ɵɵstyleProp","isFilterSelected","ɵɵclassProp","totalAllProducts","productCounts","boutique_r11","ɵɵelementContainerStart","ProduitsComponent_ng_container_46_ng_container_1_Template_div_click_1_listener","_r10","actif","selectBoutique","showSuspendedBoutiqueDialog","ProduitsComponent_ng_container_46_ng_container_1_span_4_Template","ProduitsComponent_ng_container_46_ng_container_1_i_5_Template","ProduitsComponent_ng_container_46_ng_container_1_div_6_Template","selectedBoutique","nomBoutique","i_r12","boutiques","length","ProduitsComponent_ng_container_46_ng_container_1_Template","boutiquesSansEntrepots","ProduitsComponent_tr_70_div_5_Template_div_click_1_listener","_r15","imagePopup","ɵɵsanitizeUrl","ɵɵtextInterpolate","product_r14","description","getBoutiqueNames","ProduitsComponent_tr_70_Template_tr_click_0_listener","_r13","openProduitDetail","ProduitsComponent_tr_70_div_5_Template","ProduitsComponent_tr_70_Template_td_mouseover_7_listener","showDescription","ProduitsComponent_tr_70_Template_td_mouseout_7_listener","ProduitsComponent_tr_70_div_10_Template","ProduitsComponent_tr_70_td_22_Template","highlightMatch","codeGenerique","ɵɵsanitizeHtml","photo","ɵɵpipeBind3","nomCategorie","ɵɵpipeBind1","prixVente","prixAchat","nomUnite","typeProduit","ProduitsComponent_div_73_button_21_Template_button_click_0_listener","page_r18","_r17","goToPage","currentPage","ProduitsComponent_div_73_Template_select_ngModelChange_4_listener","_r16","pageSize","ProduitsComponent_div_73_Template_select_change_4_listener","onPageSizeChange","ProduitsComponent_div_73_Template_button_click_16_listener","ProduitsComponent_div_73_Template_button_click_18_listener","ProduitsComponent_div_73_button_21_Template","ProduitsComponent_div_73_Template_button_click_22_listener","ProduitsComponent_div_73_Template_button_click_24_listener","totalPages","getPageInfo","getVisiblePages","ProduitsComponent_div_74_div_90_div_11_Template_input_change_2_listener","boutique_r22","_r21","toggleBoutiqueSelection","selectedBoutiquesForImport","includes","ProduitsComponent_div_74_div_90_Template_button_click_4_listener","_r20","toggleBoutiqueSelectionPanel","ProduitsComponent_div_74_div_90_Template_input_change_9_listener","toggleSelectAllBoutiques","ProduitsComponent_div_74_div_90_div_11_Template","ProduitsComponent_div_74_div_90_Template_button_click_13_listener","confirmBoutiqueSelection","areAllBoutiquesSelected","selectedFile","name","error_r24","ProduitsComponent_div_74_div_105_div_2_li_4_Template","importErrors","ProduitsComponent_div_74_div_105_div_2_Template","importSuccess","importMessage","ProduitsComponent_div_74_Template_div_click_1_listener","_r19","ProduitsComponent_div_74_Template_span_click_2_listener","closeExcelImportModal","ProduitsComponent_div_74_Template_button_click_80_listener","downloadExcelTemplate","ProduitsComponent_div_74_Template_input_click_86_listener","ProduitsComponent_div_74_div_90_Template","ProduitsComponent_div_74_Template_div_click_91_listener","fileInput_r23","ɵɵreference","click","ProduitsComponent_div_74_Template_input_change_92_listener","onFileSelected","ProduitsComponent_div_74_p_95_Template","ProduitsComponent_div_74_p_96_Template","ProduitsComponent_div_74_Template_button_click_100_listener","ProduitsComponent_div_74_Template_button_click_102_listener","uploadExcel","ProduitsComponent_div_74_div_105_Template","showBoutiqueError","getSelectedBoutiquesText","showBoutiqueSelectionPanel","ProduitsComponent","onClick","event","target","closest","showFilterDropdown","showExportDropdown","categorieService","produitService","fb","router","dialog","cdr","backendUrl","isLoadingCounts","searchText","tasks","nomEntreprise","adresseEntreprise","logoEntreprise","userName","boutiqueName","addressBoutique","previousSelectedBoutique","boutiqueActuelle","imgUrl","isDataLoaded","isLoading","showNoProductsMessage","allProducts","sortColumn","sortDirection","showExcelImportModal","isImporting","isAllBoutiquesSelected","isPopupVisible","currentPageEnterprise","pageSizeEnterprise","totalElementsEnterprise","currentPageBoutique","pageSizeBoutique","totalElementsBoutique","totalElements","dataSource","urllink","newPhotoUrl","entrepriseId","ngOnInit","getUserInfo","fetchCategories","toggleFilterDropdown","applyFilters","filtered","searchLower","toLowerCase","filter","product","every","key","Object","values","some","val","setTimeout","searchInput","nativeElement","focus","filterType","f","focusSearchInput","getSearchPlaceholder","map","join","goToAddProduit","navigate","text","regex","RegExp","replace","filteredProducts","startIndex","slice","toggleExportDropdown","onClickOutside","getImageBase64","url","Promise","resolve","reject","xhr","XMLHttpRequest","onload","reader","FileReader","onloadend","result","readAsDataURL","response","onerror","open","send","worksheet","utils","json_to_sheet","workbook","book_new","book_append_sheet","writeFile","doc","logoUrl","entreprise","then","logoBase64","imageType","startsWith","addImage","setFontSize","setFont","setLineWidth","line","columns","pageTasks","Array","isArray","rows","task","quantite","seuilAlert","head","body","startY","theme","headStyles","fillColor","textColor","fontSize","bodyStyles","finalY","lastAutoTable","save","catch","createdAt","csvContent","row","blob","Blob","link","document","createElement","href","URL","createObjectURL","download","pageNumber","loadProduitsPaginated","loadAllProduitsPaginated","start","end","Math","min","pages","current","i","push","getUserBoutiqueId","user","JSON","parse","localStorage","getItem","_this","subscribe","_ref","_asyncToGenerator","setItem","stringify","nomComplet","loadAllBoutiquesCounts","adresse","detectChanges","_x","apply","arguments","err","boutique","_this2","loadAllProduits","getProduitsByEntrepriseId","produits","boutiquesValidesIds","b","typeBoutique","produitsFiltres","prod","fullImageUrl","formatDate","sort","a","dateA","Date","toISOString","getTime","dateB","counts","forEach","data","_this3","previousCounts","boutiquesActivesSansEntrepots","requests","getProduitsEntreprisePaginated","toPromise","responses","all","index","boutiqueId","totalProduitsActifs","_this4","getProduitsByEntrepriseIdPaginated","content","find","datePart","timePart","split","codeBare","enStock","uniteId","message","loadProduits","_this5","width","disableClose","onClose","dateStr","day","month","year","hours","minutes","parseInt","productId","queryParams","getImageUrl","trim","firstLetter","charAt","generateInitialImage","letter","svg","toUpperCase","btoa","maxDisplay","displayed","onDrop","previousIndex","findIndex","item","currentIndex","openExcelImportModal","resetImportState","wb","ws","aoa_to_sheet","colWidths","wch","excelBuffer","write","bookType","window","appendChild","removeChild","revokeObjectURL","validateExcelDates","file","e","Uint8Array","read","Sheets","SheetNames","jsonData","sheet_to_json","header","test","readAsArrayBuffer","_this6","files","validExtensions","extension","substring","lastIndexOf","isValid","formData","FormData","append","importProduitsFromExcel","count","errors","indexOf","splice","toggleAllBoutiques","isChecked","checked","selectedNames","reduce","acc","curr","cat","_onClickOutside","popupContainer","contains","togglePopup","selectedIds","c","undefined","clearMessagesAfterDelay","idToDelete","status","ɵɵdirectiveInject","ProduitService","i3","FormBuilder","i4","Router","i5","i6","MatDialog","ChangeDetectorRef","selectors","viewQuery","ProduitsComponent_Query","rf","ctx","ProduitsComponent_click_HostBindingHandler","ɵɵresolveDocument","ProduitsComponent_div_1_Template","ProduitsComponent_div_2_Template","ProduitsComponent_Template_button_click_8_listener","_r1","ProduitsComponent_Template_button_click_10_listener","ProduitsComponent_i_14_Template","ProduitsComponent_i_15_Template","ProduitsComponent_Template_i_click_19_listener","ProduitsComponent_div_21_Template","ProduitsComponent_Template_i_click_25_listener","ProduitsComponent_div_26_Template","ProduitsComponent_Template_div_click_29_listener","ProduitsComponent_span_30_Template","ProduitsComponent_Template_input_ngModelChange_31_listener","ProduitsComponent_Template_input_click_31_listener","ProduitsComponent_Template_div_click_34_listener","ProduitsComponent_i_35_Template","ProduitsComponent_i_36_Template","ProduitsComponent_div_37_Template","ProduitsComponent_Template_div_cdkDropListDropped_38_listener","ProduitsComponent_Template_div_click_41_listener","ProduitsComponent_span_44_Template","ProduitsComponent_span_45_Template","ProduitsComponent_ng_container_46_Template","ProduitsComponent_ng_container_68_Template","ProduitsComponent_tr_70_Template","ProduitsComponent_tr_71_Template","ProduitsComponent_div_72_Template","ProduitsComponent_div_73_Template","ProduitsComponent_div_74_Template","i7","NgForOf","NgIf","SlicePipe","NgSelectOption","ɵNgSelectMultipleOption","DefaultValueAccessor","CheckboxControlValueAccessor","SelectControlValueAccessor","NgControlStatus","NgModel","i8","MatInput","i9","CdkDropList","CdkDrag","styles"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}