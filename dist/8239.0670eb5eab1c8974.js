"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[8239],{52719:(E,P,g)=>{g.d(P,{c:()=>e});var d=g(21626),s=g(25558),l=g(18810),h=g(99437),x=g(22525),C=g(54438),k=g(88026);let e=(()=>{class _{constructor(a,r){this.http=a,this.usersService=r,this.apiUrl=x.c.apiBaseUrl}updateBoutique(a,r){return this.usersService.getValidAccessToken().pipe((0,s.n)(c=>{if(!c)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const v=new d.Lr({Authorization:`Bearer ${c}`});return this.http.put(`${this.apiUrl}/updatedBoutique/${a}`,r,{headers:v})}),(0,h.W)(c=>(console.error("Erreur lors de la mise \xe0 jour de la boutique:",c),(0,l.$)(()=>c))))}getBoutiquesByEntreprise(){return this.usersService.getValidAccessToken().pipe((0,s.n)(a=>{if(!a)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const r=new d.Lr({Authorization:`Bearer ${a}`});return this.http.get(`${this.apiUrl}/boutiqueEntreprise`,{headers:r})}),(0,h.W)(a=>(console.error("Erreur lors de la r\xe9cup\xe9ration des boutiques:",a),(0,l.$)(()=>a))))}getBoutiqueById(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.get(`${this.apiUrl}/boutique/${a}`,{headers:c})}),(0,h.W)(r=>(console.error("Erreur lors de la r\xe9cup\xe9ration de la boutique:",r),(0,l.$)(()=>r))))}activerBoutique(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.put(`${this.apiUrl}/activerBoutique/${a}`,{},{headers:c})}),(0,h.W)(r=>(console.error("Erreur lors de l'activation de la boutique:",r),(0,l.$)(()=>r))))}desactiverBoutique(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.put(`${this.apiUrl}/desactiverBoutique/${a}`,{},{headers:c})}),(0,h.W)(r=>(console.error("Erreur lors de la d\xe9sactivation de la boutique:",r),(0,l.$)(()=>r))))}deleteBoutique(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.delete(`${this.apiUrl}/boutique/${a}`,{headers:c})}),(0,h.W)(r=>(console.error("Erreur lors de la suppression de la boutique:",r),(0,l.$)(()=>r))))}getProductsByBoutiqueId(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.get(`${this.apiUrl}/boutique/${a}/produits`,{headers:c})}),(0,h.W)(r=>(console.error("Erreur lors de la r\xe9cup\xe9ration des produits:",r),(0,l.$)(()=>r))))}copierProduits(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/copier-produits`,a,{headers:c,responseType:"json"})}),(0,h.W)(r=>{if(r.error&&"string"==typeof r.error)try{const c=JSON.parse(r.error);return(0,l.$)(()=>c)}catch{return(0,l.$)(()=>({message:r.error}))}return(0,l.$)(()=>r)}))}mettreEnCorbeille(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.delete(`${this.apiUrl}/corbeille/${a}`,{headers:c})}),(0,h.W)(r=>{let c="Erreur lors de la mise en corbeille";return r.error?.message?c=r.error.message:r.message&&(c=r.message),(0,l.$)(()=>new Error(c))}))}associateUserToBoutique(a,r){return this.http.post(`${this.apiUrl}/boutiques/${a}/users/${r}`,{})}assignerVendeur(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/assigner-vendeur`,a,{headers:c})}),(0,h.W)(r=>(console.error("Erreur lors de l'assignation du vendeur:",r),(0,l.$)(()=>r))))}retirerVendeur(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/retirer-vendeur`,a,{headers:c})}),(0,h.W)(r=>(console.error("Erreur lors de l'assignation du vendeur:",r),(0,l.$)(()=>r))))}getVendeursDeBoutique(a){return this.usersService.getValidAccessToken().pipe((0,s.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const c=new d.Lr({Authorization:`Bearer ${r}`});return this.http.get(`${this.apiUrl}/vendeurs/${a}`,{headers:c}).pipe((0,h.W)(v=>(console.error("Erreur lors de la r\xe9cup\xe9ration des vendeurs:",v),(0,l.$)(()=>v))))}))}getProduitsBoutiquePaginated(a,r=0,c=20){return this.usersService.getValidAccessToken().pipe((0,s.n)(v=>{const M=new d.Lr({Authorization:`Bearer ${v}`}),O=(new d.Nl).set("page",r.toString()).set("size",c.toString());return this.http.get(`${this.apiUrl}/boutique/${a}/produits/paginated`,{headers:M,params:O}).pipe((0,h.W)(b=>(0,l.$)(400===b.status&&"Cette boutique est d\xe9sactiv\xe9e, ses produits ne sont pas accessibles !"===b.error?.error?()=>new Error("BOUTIQUE_DESACTIVEE"):()=>b)))}))}static{this.\u0275fac=function(r){return new(r||_)(C.KVO(d.Qq),C.KVO(k.g))}}static{this.\u0275prov=C.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}}return _})()},88239:(E,P,g)=>{g.r(P),g.d(P,{CompteComponent:()=>w});var d=g(60177),s=g(89417),l=g(36440),h=g(25558),x=g(18810),C=g(7673),k=g(96697),e=g(54438),_=g(21626),F=g(22525),a=g(88026);let r=(()=>{class i{constructor(t,o){this.http=t,this.usersService=o,this.apiUrl=F.c.apiBaseUrl}getAllRoles(){return this.usersService.getValidAccessToken().pipe((0,h.n)(t=>{const o=(new _.Lr).set("Authorization",`Bearer ${t}`);return console.log("\u{1f539} En-t\xeates envoy\xe9s :",o),this.http.get(`${this.apiUrl}/getAllRoles`,{headers:o})}))}static{this.\u0275fac=function(o){return new(o||i)(e.KVO(_.Qq),e.KVO(a.g))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var c=g(49192),v=g(52719);function M(i,m){if(1&i&&(e.j41(0,"div",23),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.successMessage," ")}}function O(i,m){if(1&i&&(e.j41(0,"div",24),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessage," ")}}function b(i,m){1&i&&(e.j41(0,"div",25)(1,"div",26),e.nrm(2,"div",27),e.j41(3,"p"),e.EFF(4,"Creation en cours..."),e.k0s()()())}function $(i,m){if(1&i){const t=e.RV6();e.j41(0,"tr",28),e.bIt("click",function(){const n=e.eBV(t).$implicit,p=e.XpG();return e.Njj(p.openPermissionDetail(n.id))}),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.j41(9,"span"),e.EFF(10),e.k0s()(),e.j41(11,"td"),e.EFF(12),e.k0s()()}if(2&i){const t=m.$implicit;e.R7$(2),e.JRh(t.nomComplet),e.R7$(2),e.JRh(t.email),e.R7$(2),e.JRh(null==t.role?null:t.role.name),e.R7$(2),e.SpI(" ",t.pays," "),e.R7$(2),e.JRh(t.flag),e.R7$(2),e.JRh(t.phone)}}function j(i,m){if(1&i&&(e.j41(0,"div",29),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.messageNoClient," ")}}function y(i,m){if(1&i){const t=e.RV6();e.j41(0,"button",50),e.bIt("click",function(){const n=e.eBV(t).$implicit,p=e.XpG(2);return e.Njj(p.onPageClick(n))}),e.EFF(1),e.k0s()}if(2&i){const t=m.$implicit,o=e.XpG(2);e.AVh("active",t===o.currentPage),e.Y8G("disabled","..."===t),e.R7$(),e.SpI(" ",t," ")}}function T(i,m){if(1&i){const t=e.RV6();e.j41(0,"div",30)(1,"div",31)(2,"div",32)(3,"span"),e.EFF(4,"Utilisateurs par page:"),e.k0s(),e.j41(5,"select",33),e.mxI("ngModelChange",function(n){e.eBV(t);const p=e.XpG();return e.DH7(p.pageSize,n)||(p.pageSize=n),e.Njj(n)}),e.bIt("change",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onPageSizeChange())}),e.j41(6,"option",34),e.EFF(7,"5"),e.k0s(),e.j41(8,"option",35),e.EFF(9,"10"),e.k0s(),e.j41(10,"option",36),e.EFF(11,"20"),e.k0s(),e.j41(12,"option",37),e.EFF(13,"50"),e.k0s()(),e.j41(14,"span",38),e.EFF(15),e.k0s()(),e.j41(16,"div",39)(17,"button",40),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.goToPage(0))}),e.nrm(18,"i",41),e.k0s(),e.j41(19,"button",42),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.goToPage(n.currentPage-1))}),e.nrm(20,"i",43),e.k0s(),e.j41(21,"div",44),e.DNE(22,y,2,4,"button",45),e.k0s(),e.j41(23,"button",46),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.goToPage(n.currentPage+1))}),e.nrm(24,"i",47),e.k0s(),e.j41(25,"button",48),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.goToPage(n.totalPages-1))}),e.nrm(26,"i",49),e.k0s()()()()}if(2&i){const t=e.XpG();e.R7$(5),e.R50("ngModel",t.pageSize),e.R7$(10),e.JRh(t.getPageInfo()),e.R7$(2),e.Y8G("disabled",0===t.currentPage),e.R7$(2),e.Y8G("disabled",0===t.currentPage),e.R7$(3),e.Y8G("ngForOf",t.getVisiblePages()),e.R7$(),e.Y8G("disabled",t.currentPage>=t.totalPages-1),e.R7$(2),e.Y8G("disabled",t.currentPage>=t.totalPages-1)}}function A(i,m){1&i&&(e.j41(0,"div")(1,"small",76),e.EFF(2,"Le nom complet est requis."),e.k0s()())}function I(i,m){1&i&&(e.j41(0,"div")(1,"small",76),e.EFF(2,"Un email valide est requis."),e.k0s()())}function U(i,m){if(1&i&&(e.j41(0,"option",78),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.Y8G("value",t.name),e.R7$(),e.SpI(" ",t.name," ")}}function R(i,m){if(1&i&&(e.qex(0),e.DNE(1,U,2,2,"option",77),e.bVm()),2&i){const t=m.$implicit,o=e.XpG(2);e.R7$(),e.Y8G("ngIf",o.isRoleVisible(t.name))}}function S(i,m){1&i&&(e.j41(0,"div")(1,"small",76),e.EFF(2,"Veuillez s\xe9lectionner un r\xf4le."),e.k0s()())}function V(i,m){1&i&&(e.j41(0,"div")(1,"small",76),e.EFF(2,"Veuillez choisir un pays."),e.k0s()())}function B(i,m){1&i&&(e.j41(0,"div")(1,"small",76),e.EFF(2,"Le num\xe9ro de t\xe9l\xe9phone est requis."),e.k0s()())}function z(i,m){if(1&i){const t=e.RV6();e.j41(0,"div",51)(1,"div",52)(2,"div",53)(3,"h4"),e.EFF(4,"Ajouter un membre"),e.k0s(),e.j41(5,"button",54),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopup())}),e.EFF(6,"\xd7"),e.k0s()(),e.j41(7,"form",55)(8,"div",56)(9,"div",57)(10,"div",58),e.nrm(11,"input",59),e.j41(12,"label",60),e.EFF(13,"Nom complet"),e.k0s(),e.DNE(14,A,3,0,"div",61),e.k0s(),e.j41(15,"div",58),e.nrm(16,"input",62),e.j41(17,"label",60),e.EFF(18,"Email"),e.k0s(),e.DNE(19,I,3,0,"div",61),e.k0s()(),e.j41(20,"div",63)(21,"select",64)(22,"option",65),e.EFF(23,"Type de r\xf4le"),e.k0s(),e.DNE(24,R,2,1,"ng-container",66),e.k0s(),e.DNE(25,S,3,0,"div",61),e.k0s(),e.j41(26,"div",67)(27,"div",63)(28,"select",68),e.bIt("change",function(n){e.eBV(t);const p=e.XpG();return e.Njj(p.onPaysChange(n))}),e.j41(29,"option",65),e.EFF(30,"Pays"),e.k0s(),e.j41(31,"option",69),e.EFF(32,"Mali"),e.k0s(),e.j41(33,"option",70),e.EFF(34,"S\xe9n\xe9gal"),e.k0s(),e.j41(35,"option",71),e.EFF(36,"C\xf4te d'Ivoire"),e.k0s()(),e.DNE(37,V,3,0,"div",61),e.k0s(),e.j41(38,"div",63),e.nrm(39,"input",72),e.j41(40,"label",60),e.EFF(41,"Phone"),e.k0s(),e.DNE(42,B,3,0,"div",61),e.k0s()()(),e.j41(43,"div",73)(44,"button",74),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopup())}),e.EFF(45,"Annuler"),e.k0s(),e.j41(46,"button",75),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmit())}),e.EFF(47," Ajouter "),e.k0s()()()()()}if(2&i){let t,o,n,p,f;const u=e.XpG();e.R7$(7),e.Y8G("formGroup",u.userForm),e.R7$(7),e.Y8G("ngIf",(null==(t=u.userForm.get("nomComplet"))?null:t.invalid)&&(null==(t=u.userForm.get("nomComplet"))?null:t.touched)),e.R7$(5),e.Y8G("ngIf",(null==(o=u.userForm.get("email"))?null:o.invalid)&&(null==(o=u.userForm.get("email"))?null:o.touched)),e.R7$(5),e.Y8G("ngForOf",u.roles),e.R7$(),e.Y8G("ngIf",(null==(n=u.userForm.get("roleType"))?null:n.invalid)&&(null==(n=u.userForm.get("roleType"))?null:n.touched)),e.R7$(12),e.Y8G("ngIf",(null==(p=u.userForm.get("pays"))?null:p.invalid)&&(null==(p=u.userForm.get("pays"))?null:p.touched)),e.R7$(5),e.Y8G("ngIf",(null==(f=u.userForm.get("phone"))?null:f.invalid)&&(null==(f=u.userForm.get("phone"))?null:f.touched)),e.R7$(4),e.xc7("background-color",u.userForm.valid?"#0672E4":"#0671e434")("color",u.userForm.valid?"#ffffff":"#00000073")("cursor",u.userForm.valid?"pointer":"no-drop"),e.Y8G("disabled",u.userForm.invalid)}}let w=(()=>{class i{constructor(t,o,n,p,f,u,G){this.rolesService=t,this.usersService=o,this.fb=n,this.http=p,this.router=f,this.route=u,this.boutiqueService=G,this.showPopup=!1,this.roles=[],this.selectedRole="",this.isLoading=!1,this.errorMessage=null,this.successMessage=null,this.users=[],this.filteredUsers=[],this.messageNoClient="Aucun utilisateur disponible.",this.pageSize=5,this.currentPage=0,this.totalPages=0,this.paginatedUsers=[],this.paysFlags={Mali:"\u{1f1f2}\u{1f1f1}",S\u00e9n\u00e9gal:"\u{1f1f8}\u{1f1f3}","C\xf4te d'Ivoire":"\u{1f1e8}\u{1f1ee}",Guin\u00e9e:"\u{1f1ec}\u{1f1f3}","Burkina Faso":"\u{1f1e7}\u{1f1eb}",Niger:"\u{1f1f3}\u{1f1ea}"},this.indicatif="",this.maxPhoneLength=8,this.paysIndicatifs={Mali:{indicatif:"+223",longueur:8},S\u00e9n\u00e9gal:{indicatif:"+221",longueur:9},"C\xf4te d'Ivoire":{indicatif:"+225",longueur:10},Guin\u00e9e:{indicatif:"+224",longueur:9},"Burkina Faso":{indicatif:"+226",longueur:8},Niger:{indicatif:"+227",longueur:8}},this.isAscending=!0,this.searchTerm="",this.currentUserRole="",this.boutiques=[],this.showBoutiqueSelect=!1}ngOnInit(){this.loadRoles(),this.initForm(),this.updatePaginatedUsers(),this.loadBoutiques(),this.loadCurrentUserRole(),this.usersService.getUserInfo().subscribe({next:t=>{t&&t.id&&(this.entrepriseId=t.id,this.loadUsersOfEntreprise(this.entrepriseId))},error:t=>{console.error("Erreur lors de la r\xe9cup\xe9ration des informations utilisateur :",t)}}),this.filteredUsers=this.users}initForm(){this.userForm=this.fb.group({nomComplet:["",s.k0.required],email:["",[s.k0.required,s.k0.email,s.k0.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],roleType:["",s.k0.required],phone:["",[s.k0.required,s.k0.pattern(/^\d{8,15}$/)]],pays:["",s.k0.required]})}onPaysChange(t){const n=this.paysIndicatifs[t.target.value];n&&(this.indicatif=`${n.indicatif} `,this.maxPhoneLength=this.indicatif.length+n.longueur,this.userForm.controls.phone.setValue(this.indicatif),this.updatePhoneValidator(n.longueur))}updatePhoneValidator(t){this.userForm.controls.phone.setValidators([s.k0.required,s.k0.pattern(`^\\+\\d{1,3}\\s?\\d{${t}}$`)]),this.userForm.controls.phone.updateValueAndValidity()}formatPhoneNumber(){let t=this.userForm.controls.phone.value;t.startsWith(this.indicatif)||this.userForm.controls.phone.setValue(this.indicatif);let o=new RegExp(`^\\${this.indicatif}(\\d*)$`),n=t.match(o);if(n){let p=n[1].replace(/\D/g,"");this.userForm.controls.phone.setValue(this.indicatif+p)}}onPageChange(t){this.currentPage=t.pageIndex,this.pageSize=t.pageSize,this.updatePaginatedUsers()}updatePaginatedUsers(){const t=this.currentPage*this.pageSize;this.paginatedUsers=this.filteredUsers.slice(t,t+this.pageSize)}goToPage(t){this.currentPage=t,this.updatePaginatedUsers(),this.updateTotalPages()}onPageSizeChange(){this.currentPage=0,this.updatePaginatedUsers(),this.updateTotalPages()}updateTotalPages(){this.totalPages=Math.ceil(this.filteredUsers.length/this.pageSize)}getPageInfo(){return`${this.currentPage*this.pageSize+1}-${Math.min((this.currentPage+1)*this.pageSize,this.filteredUsers.length)} sur ${this.filteredUsers.length}`}getVisiblePages(){const t=[];if(this.totalPages<=5)for(let n=0;n<this.totalPages;n++)t.push(n);else if(this.currentPage<=2){for(let n=0;n<4;n++)t.push(n);t.push("..."),t.push(this.totalPages-1)}else if(this.currentPage>=this.totalPages-3){t.push(0),t.push("...");for(let n=this.totalPages-4;n<this.totalPages;n++)t.push(n)}else{t.push(0),t.push("...");for(let n=this.currentPage-1;n<=this.currentPage+1;n++)t.push(n);t.push("..."),t.push(this.totalPages-1)}return t}onPageClick(t){"number"==typeof t&&this.goToPage(t)}loadRoles(){this.usersService.getValidAccessToken().pipe((0,h.n)(t=>t?this.rolesService.getAllRoles():(console.error("\u{1f510} Aucun token trouv\xe9 !"),(0,x.$)(()=>new Error("Aucun token trouv\xe9"))))).subscribe({next:t=>{this.roles=t},error:t=>{console.error("Erreur lors du chargement des r\xf4les",t)}})}loadUsersOfEntreprise(t){this.isLoading=!0;const o=this.usersService.getToken(),n=o?this.usersService.extractUserIdFromToken(o):null;this.usersService.getAllUsersOfEntreprise(t).subscribe({next:p=>{const f=p.filter(u=>!n||u.uuid!==n);this.users=f.map(u=>({...u,flag:this.paysFlags[u.pays]||""})),this.filteredUsers=this.users,this.updatePaginatedUsers(),this.updateTotalPages(),this.isLoading=!1,console.log("Utilisateurs r\xe9cup\xe9r\xe9s (hors connect\xe9) :",this.users)},error:p=>{console.error("Erreur lors du chargement des utilisateurs",p),this.isLoading=!1}})}openPopup(){this.showPopup=!0}closePopup(){this.showPopup=!1,this.resetForm()}resetForm(){this.userForm.patchValue({nomComplet:"",email:"",roleType:"",phone:"",pays:""}),this.userForm.markAsPristine(),this.userForm.markAsUntouched(),this.userForm.updateValueAndValidity()}onSubmit(){if(this.errorMessage=null,this.successMessage=null,this.userForm.invalid)return void(this.errorMessage="Veuillez remplir tous les champs correctement.");const t=this.userForm.value;this.isLoading=!0,this.usersService.getValidAccessToken().pipe((0,h.n)(o=>o?(console.log("Donn\xe9es envoy\xe9es :",t),this.usersService.addUserToEntreprise(t,o)):(this.errorMessage="Vous devez \xeatre connect\xe9 pour ajouter un utilisateur.",this.isLoading=!1,(0,x.$)(()=>new Error("Aucun token trouv\xe9")))),(0,h.n)(o=>o.id?(this.successMessage="Utilisateur ajout\xe9 avec succ\xe8s !",this.userForm.reset(),this.closePopup(),this.router.navigate(["/userPermission",o.id]),this.loadUsersOfEntreprise(this.entrepriseId),this.usersService.getUserInfo()):(0,C.of)(null))).subscribe({next:o=>{o&&o.id&&this.loadUsersOfEntreprise(o.id),this.isLoading=!1,setTimeout(()=>this.successMessage=null,3e3)},error:o=>{console.error("Erreur lors de l'ajout utilisateur ou r\xe9cup\xe9ration info utilisateur :",o),this.errorMessage=o.message||"Une erreur est survenue",this.isLoading=!1}})}openPermissionDetail(t){this.router.navigate(["/userPermission",t])}sortRoles(){this.users=this.users.sort((t,o)=>{if(this.isAscending){if(t.role?.name<o.role?.name)return-1;if(t.role?.name>o.role?.name)return 1}else{if(t.role?.name>o.role?.name)return-1;if(t.role?.name<o.role?.name)return 1}return 0}),this.isAscending=!this.isAscending,this.updatePaginatedUsers()}filterUsers(t){this.searchTerm=t.target.value.toLowerCase(),this.filteredUsers=this.users.filter(o=>o.nomComplet.toLowerCase().includes(this.searchTerm)),this.currentPage=0,this.updatePaginatedUsers(),this.updateTotalPages()}clearSearch(t){this.searchTerm="",this.filteredUsers=this.users,this.currentPage=0,this.updatePaginatedUsers(),this.updateTotalPages(),t.value=""}loadBoutiques(){this.usersService.getUserInfo().pipe((0,k.s)(1)).subscribe({next:t=>{t&&"VENDEUR"===t.roleType?this.boutiques=t.boutiques||[]:this.boutiqueService.getBoutiquesByEntreprise().subscribe({next:o=>{this.boutiques=o},error:o=>console.error("Erreur lors du chargement des boutiques",o)})},error:t=>{this.boutiqueService.getBoutiquesByEntreprise().subscribe({next:o=>{this.boutiques=o},error:o=>console.error(o)})}})}isRoleVisible(t){return!("ADMIN"===this.currentUserRole&&"ADMIN"===t||"VENDEUR"===t||"MANAGER"===this.currentUserRole&&"MANAGER"===t||"ADMIN"===t||"VENDEUR"===t)}loadCurrentUserRole(){this.usersService.getUserInfo().pipe((0,k.s)(1)).subscribe({next:t=>{this.currentUserRole=t.roleType},error:t=>{console.error("Erreur lors de la r\xe9cup\xe9ration du r\xf4le utilisateur :",t)}})}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(r),e.rXU(a.g),e.rXU(s.ok),e.rXU(_.Qq),e.rXU(c.Ix),e.rXU(c.nX),e.rXU(v.c))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-compte"]],decls:37,vars:8,consts:[["searchInput",""],[1,"toast-container"],["class","alert alert-success toast-message-success",4,"ngIf"],["class","alert alert-danger toast-message-danger",4,"ngIf"],[1,"containerTable"],["class","loading-overlay",4,"ngIf"],[1,"tasks-header"],[1,"title"],[1,"actions"],[1,"add-task",3,"click"],[1,"contentIcon"],[1,"bare"],[1,"inputSearch"],["type","text","placeholder","Recherche...",3,"input"],[3,"click","ngClass"],[1,"titleTableProduit"],[1,"content_sort"],[1,"icon_sort"],[1,"ri-sort-asc",3,"click"],[3,"click",4,"ngFor","ngForOf"],["class","no-client-message",4,"ngIf"],["class","pagination_global",4,"ngIf"],["class","popup-overlay",4,"ngIf"],[1,"alert","alert-success","toast-message-success"],[1,"alert","alert-danger","toast-message-danger"],[1,"loading-overlay"],[1,"loading-content"],[1,"spinner"],[3,"click"],[1,"no-client-message"],[1,"pagination_global"],[1,"pager"],[1,"pager-info"],[1,"page-size-select",3,"ngModelChange","change","ngModel"],["value","5"],["value","10"],["value","20"],["value","50"],[1,"page-info"],[1,"pager-navigation"],["title","Premi\xe8re page",1,"pager-btn",3,"click","disabled"],[1,"ri-skip-back-line"],["title","Page pr\xe9c\xe9dente",1,"pager-btn",3,"click","disabled"],[1,"ri-arrow-left-s-line"],[1,"page-numbers"],["class","page-number",3,"active","disabled","click",4,"ngFor","ngForOf"],["title","Page suivante",1,"pager-btn",3,"click","disabled"],[1,"ri-arrow-right-s-line"],["title","Derni\xe8re page",1,"pager-btn",3,"click","disabled"],[1,"ri-skip-forward-line"],[1,"page-number",3,"click","disabled"],[1,"popup-overlay"],[1,"popup-content"],[1,"popup-header"],[1,"close-btn",3,"click"],[3,"formGroup"],[1,"popup-body"],[1,"double_input"],[1,"champ_input","champ_input2"],["type","text","formControlName","nomComplet","placeholder","Saisis le nom et pr\xe9nom",1,"input_focus"],[1,"label"],[4,"ngIf"],["type","email","formControlName","email","placeholder","Saisis l'email",1,"input_focus"],[1,"champ_input"],["formControlName","roleType",1,"input_focus"],["value","","disabled","","selected",""],[4,"ngFor","ngForOf"],[1,"champ_grid"],["formControlName","pays",1,"input_focus",3,"change"],["value","Mali"],["value","S\xe9n\xe9gal"],["value","C\xf4te d'Ivoire"],["type","text","formControlName","phone","placeholder","00 00 00 00",1,"input_focus"],[1,"popup-footer"],[1,"btn-cancel",3,"click"],[1,"btn-submit",3,"click","disabled"],[1,"error"],[3,"value",4,"ngIf"],[3,"value"]],template:function(o,n){if(1&o){const p=e.RV6();e.j41(0,"div",1),e.DNE(1,M,2,1,"div",2)(2,O,2,1,"div",3),e.k0s(),e.j41(3,"div",4),e.DNE(4,b,5,0,"div",5),e.j41(5,"div",6)(6,"h1",7),e.EFF(7,"Comptes"),e.k0s(),e.j41(8,"div",8)(9,"button",9),e.bIt("click",function(){return e.eBV(p),e.Njj(n.openPopup())}),e.EFF(10,"Ajouter"),e.k0s(),e.j41(11,"div",10),e.nrm(12,"div",11),e.k0s(),e.j41(13,"div",12)(14,"input",13,0),e.bIt("input",function(u){return e.eBV(p),e.Njj(n.filterUsers(u))}),e.k0s(),e.j41(16,"i",14),e.bIt("click",function(){e.eBV(p);const u=e.sdS(15);return e.Njj(n.clearSearch(u))}),e.k0s()()()(),e.j41(17,"table")(18,"thead")(19,"tr",15)(20,"th"),e.EFF(21,"Nom complet"),e.k0s(),e.j41(22,"th"),e.EFF(23,"Email"),e.k0s(),e.j41(24,"th",16),e.EFF(25," R\xf4le type "),e.j41(26,"div",17)(27,"i",18),e.bIt("click",function(){return e.eBV(p),e.Njj(n.sortRoles())}),e.k0s()()(),e.j41(28,"th"),e.EFF(29,"Pays"),e.k0s(),e.j41(30,"th"),e.EFF(31,"Phone"),e.k0s()()(),e.j41(32,"tbody"),e.DNE(33,$,13,6,"tr",19),e.k0s()(),e.DNE(34,j,2,1,"div",20)(35,T,27,7,"div",21),e.k0s(),e.DNE(36,z,48,14,"div",22)}2&o&&(e.R7$(),e.Y8G("ngIf",n.successMessage),e.R7$(),e.Y8G("ngIf",n.errorMessage),e.R7$(2),e.Y8G("ngIf",n.isLoading),e.R7$(12),e.Y8G("ngClass",n.searchTerm?"ri-close-line red-icon":"ri-search-2-line"),e.R7$(17),e.Y8G("ngForOf",n.paginatedUsers),e.R7$(),e.Y8G("ngIf",0===n.filteredUsers.length),e.R7$(),e.Y8G("ngIf",n.filteredUsers.length>0),e.R7$(),e.Y8G("ngIf",n.showPopup))},dependencies:[d.MD,d.YU,d.Sq,d.bT,s.YN,s.qT,s.xH,s.y7,s.me,s.wz,s.BC,s.cb,s.vS,s.X1,s.j4,s.JD,l.Ou],styles:['@charset "UTF-8";.title_return[_ngcontent-%COMP%]{display:flex;align-items:center}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.title[_ngcontent-%COMP%]{font-size:18px;margin:0 0 0 10px}tr[_ngcontent-%COMP%]{font-size:13px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border-bottom:1px solid rgba(221,221,221,.5803921569);padding:15px 8px}th[_ngcontent-%COMP%]{background-color:#f2f2f2}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}tr[_ngcontent-%COMP%]:hover{background-color:#ddd}.containerTable[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:10px}.tasks-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}.actions[_ngcontent-%COMP%]{display:flex;align-items:center}.add-task[_ngcontent-%COMP%]{padding:10px 30px;background-color:#0672e4;color:#fff;border-radius:5px;border:none}.contentIcon[_ngcontent-%COMP%]{margin:0 10px;display:flex;align-items:center}.contentIcon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{padding:0 15px;font-size:20px;cursor:pointer}.contentIcon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:#0672e4;transition:all .5s ease}.bare[_ngcontent-%COMP%]{width:2px;height:30px;background-color:#eee}.inputSearch[_ngcontent-%COMP%]{position:relative;width:250px;height:40px;display:flex;align-items:center}.inputSearch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:100%;padding-left:10px;border-radius:5px}.inputSearch[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:0;margin-right:15px;font-size:17px}.titleTableProduit[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:12px}.content_sort[_ngcontent-%COMP%]{display:flex;align-items:center}.icon_sort[_ngcontent-%COMP%]{margin-left:6px}.icon_sort[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px;cursor:pointer;color:#292929}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;width:50%}.popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.popup-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer}.popup-footer[_ngcontent-%COMP%]{margin-top:20px;text-align:right}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{padding:8px 20px;margin-left:10px;border:none;border-radius:4px;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]{background-color:#ff0000e1;border:1px solid #ff0000;padding:6px 25px;color:#fff}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#e7b1b6;transition:all .5s}.btn-submit[_ngcontent-%COMP%]{background-color:#0671e434;padding:6px 25px;color:#fff;cursor:pointer;cursor:no-drop}.double_input[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.champ_input[_ngcontent-%COMP%]{position:relative;margin-bottom:25px}.champ_input2[_ngcontent-%COMP%]{display:inline-block;width:50%;box-sizing:border-box;vertical-align:top}.input_focus[_ngcontent-%COMP%]{width:100%;min-width:150px;height:49px;outline:none;border-bottom:1px solid rgb(53,50,50);border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:14px;background:none;color:#695c5c}.champ_input[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:4px;pointer-events:none;color:#6b6666}.champ_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.input_focus[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.input_focus[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:0;left:0;transition:all .3s ease-in-out;background:none;font-size:11px;padding:0}.input_focus[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:12px;transition:all .2s ease-in-out}.toast-container[_ngcontent-%COMP%]{position:fixed;top:60px;right:35px;z-index:9999}.toast-message-success[_ngcontent-%COMP%]{background-color:#d5e6de;border:1px solid #ACCEBC;color:#000;padding:10px;border-radius:8px;font-size:13px;box-shadow:0 4px 6px #0000001a;opacity:0;animation:_ngcontent-%COMP%_fadeInOut 4s ease-in-out;transform:translateY(-20px)}.toast-message-danger[_ngcontent-%COMP%]{background-color:#f3d8da;border:1px solid #E7B1B6;color:#000;padding:10px;border-radius:8px;font-size:13px;box-shadow:0 4px 6px #0000001a;opacity:0;animation:_ngcontent-%COMP%_fadeInOut 4s ease-in-out;transform:translateY(-20px)}@keyframes _ngcontent-%COMP%_fadeInOut{0%{opacity:0;transform:translateY(-20px)}20%{opacity:1;transform:translateY(0)}80%{opacity:1}to{opacity:0;transform:translateY(2px)}}.error[_ngcontent-%COMP%]{color:red;font-weight:700;margin-top:10px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;color:#fff;font-size:18px;z-index:9999999999}.loading-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid white;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.red-icon[_ngcontent-%COMP%]{color:red}.pagination_global[_ngcontent-%COMP%], .pagination[_ngcontent-%COMP%]{justify-content:right;margin-top:30px}.no-client-message[_ngcontent-%COMP%]{text-align:center;padding:40px;font-size:13px;color:#666;background-color:#f8f9fa;border-radius:8px;margin:20px;box-shadow:0 2px 4px #0000001a}.pager[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px 10px;margin-top:20px;background:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}.pager[_ngcontent-%COMP%]   .pager-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-size:14px;color:#6c757d}.pager[_ngcontent-%COMP%]   .pager-info[_ngcontent-%COMP%]   .page-size-select[_ngcontent-%COMP%]{padding:5px 10px;border:1px solid #ced4da;border-radius:4px;background:#fff;font-size:14px;cursor:pointer}.pager[_ngcontent-%COMP%]   .pager-info[_ngcontent-%COMP%]   .page-size-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#0671e4;box-shadow:0 0 0 2px #0671e440}.pager[_ngcontent-%COMP%]   .pager-info[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%]{font-weight:500;color:#495057}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .pager-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid #ced4da;background:#fff;color:#495057;border-radius:4px;cursor:pointer;transition:all .2s ease}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .pager-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#0671e4;color:#fff;border-color:#0671e4}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .pager-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background:#f8f9fa}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .pager-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2px;margin:0 10px}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-width:36px;height:36px;border:1px solid #ced4da;background:#fff;color:#495057;border-radius:4px;cursor:pointer;transition:all .2s ease;font-size:14px;font-weight:500}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]:hover:not(:disabled){background:#e9ecef;border-color:#adb5bd}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number.active[_ngcontent-%COMP%]{background:#0671e4;color:#fff;border-color:#0671e4}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background:#f8f9fa}@media (max-width: 768px){.pager[_ngcontent-%COMP%]{flex-direction:column;gap:15px;padding:15px}.pager[_ngcontent-%COMP%]   .pager-info[_ngcontent-%COMP%]{order:2}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]{order:1}}']})}}return i})()}}]);