"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[505],{50505:(D,w,p)=>{p.r(w),p.d(w,{PosAccueilComponent:()=>oe});var _=p(60177),C=p(89417),l=p(49192),h=p(40724),b=p(22525),y=p(41731),e=p(54438),A=p(80145),k=p(88026),j=p(74864),d=p(17022),s=p(37788),o=p(52719),u=p(90612),m=p(68420),v=p(36406);const B=["calculatorRef"],$=["calcElement"],S=c=>({transform:c}),z=(c,g,t)=>({transform:c,"width.px":g,"height.px":t});function N(c,g){if(1&c){const t=e.RV6();e.j41(0,"li",35),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.setActiveCommande(n))}),e.EFF(1),e.k0s()}if(2&c){const t=g.$implicit,i=e.XpG();e.AVh("list_commande_active",i.activeCommande===t),e.R7$(),e.SpI(" ",t," ")}}function U(c,g){if(1&c){const t=e.RV6();e.j41(0,"li",36),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.showCommandePopup=!0)}),e.nrm(1,"i",37),e.k0s()}}function X(c,g){1&c&&(e.j41(0,"div",38),e.nrm(1,"i",39),e.k0s())}function L(c,g){if(1&c){const t=e.RV6();e.j41(0,"li",35),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.setActiveCommande(n))}),e.EFF(1),e.k0s()}if(2&c){const t=g.$implicit,i=e.XpG(2);e.AVh("active",i.activeCommande===t),e.R7$(),e.SpI(" ",t," ")}}function W(c,g){if(1&c){const t=e.RV6();e.j41(0,"div",40)(1,"div",41),e.bIt("click",function(n){return e.eBV(t),e.Njj(n.stopPropagation())}),e.j41(2,"div",42),e.bIt("mousedown",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.startDragPopup(n))}),e.j41(3,"h3"),e.EFF(4,"Liste des commandes"),e.k0s(),e.j41(5,"i",43),e.bIt("click",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.closePopup(n))}),e.k0s()(),e.j41(6,"div",44)(7,"ul",45),e.DNE(8,L,2,3,"li",46),e.k0s()()()()}if(2&c){const t=e.XpG();e.R7$(),e.Y8G("ngStyle",e.eq3(2,S,"translate3d("+t.popupOffsetPopup.x+"px, "+t.popupOffsetPopup.y+"px, 0)")),e.R7$(7),e.Y8G("ngForOf",t.commandes)}}function G(c,g){if(1&c&&(e.qex(0),e.j41(1,"p"),e.EFF(2),e.k0s(),e.bVm()),2&c){const t=e.XpG();e.R7$(2),e.JRh(t.selectedBoutiqueName)}}function q(c,g){1&c&&(e.j41(0,"p",47),e.EFF(1,"..."),e.k0s())}function H(c,g){1&c&&e.nrm(0,"i",48)}function K(c,g){if(1&c){const t=e.RV6();e.j41(0,"i",43),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.clearSearch())}),e.k0s()}}function Y(c,g){if(1&c){const t=e.RV6();e.j41(0,"div",49)(1,"div",50),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.toggleView("grid"))}),e.EFF(2),e.nI1(3,"async"),e.k0s(),e.j41(4,"div",50),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.toggleView("list"))}),e.EFF(5),e.nI1(6,"async"),e.k0s()()}if(2&c){const t=e.XpG();e.R7$(2),e.SpI(" Cadre ",e.bMT(3,2,t.isListView$)?"\u2713":""," "),e.R7$(3),e.SpI(" Liste ",e.bMT(6,4,t.isListView$)?"":"\u2713"," ")}}function J(c,g){if(1&c){const t=e.RV6();e.j41(0,"div",51)(1,"div",52),e.nrm(2,"i",53),e.EFF(3," Installer l'application "),e.k0s(),e.j41(4,"div",50),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.handleAnalytique())}),e.nrm(5,"i",54),e.EFF(6," Tableau de bord "),e.k0s(),e.j41(7,"div",52),e.nrm(8,"i",55),e.EFF(9," Recharger les donnees "),e.k0s(),e.j41(10,"div",50),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.prepareFermerCaisse())}),e.nrm(11,"i",56),e.EFF(12," Fermer la caisse "),e.k0s()()}}function Q(c,g){1&c&&(e.j41(0,"div",64),e.nrm(1,"i",65),e.EFF(2," Chargement des d\xe9tails... "),e.k0s())}function Z(c,g){if(1&c&&(e.j41(0,"div",71)(1,"span",72),e.EFF(2,"Ferm\xe9e le :"),e.k0s(),e.j41(3,"span",73),e.EFF(4),e.k0s()()),2&c){const t=e.XpG(3);e.R7$(4),e.JRh(t.formatDate(t.caisseDetails.dateFermeture))}}function ee(c,g){if(1&c&&(e.j41(0,"div",66)(1,"div",67)(2,"div",30)(3,"span"),e.EFF(4),e.k0s()(),e.j41(5,"div")(6,"div",68),e.EFF(7),e.k0s(),e.j41(8,"div",69),e.EFF(9),e.k0s()()(),e.j41(10,"div",70)(11,"div",71)(12,"span",72),e.EFF(13,"Statut:"),e.k0s(),e.j41(14,"span",73),e.EFF(15),e.k0s()(),e.j41(16,"div",71)(17,"span",72),e.EFF(18,"Montant initial :"),e.k0s(),e.j41(19,"span",73),e.EFF(20),e.nI1(21,"cfaCurrency"),e.k0s()(),e.j41(22,"div",71)(23,"span",72),e.EFF(24,"Montant courant :"),e.k0s(),e.j41(25,"span",73),e.EFF(26),e.nI1(27,"cfaCurrency"),e.k0s()(),e.j41(28,"div",71)(29,"span",72),e.EFF(30,"Ouverte le :"),e.k0s(),e.j41(31,"span",73),e.EFF(32),e.k0s()(),e.DNE(33,Z,5,1,"div",74),e.j41(34,"div",71)(35,"span",72),e.EFF(36,"Montant obtenu :"),e.k0s(),e.j41(37,"span",73),e.EFF(38),e.nI1(39,"cfaCurrency"),e.k0s()(),e.j41(40,"div",71)(41,"span",72),e.EFF(42,"Nom Vendeur :"),e.k0s(),e.j41(43,"span",73),e.EFF(44),e.k0s()(),e.j41(45,"div",71)(46,"span",72),e.EFF(47,"Nom Boutique :"),e.k0s(),e.j41(48,"span",73),e.EFF(49),e.k0s()()()()),2&c){const t=e.XpG(2);e.R7$(4),e.JRh(t.caisseDetails.nomVendeur?t.caisseDetails.nomVendeur[0]:"?"),e.R7$(3),e.JRh(t.caisseDetails.nomVendeur||"Vendeur non sp\xe9cifi\xe9"),e.R7$(2),e.JRh(t.caisseDetails.nomBoutique||"Boutique non sp\xe9cifi\xe9e"),e.R7$(5),e.AVh("text-success-status","OUVERTE"===t.caisseDetails.statut)("text-danger","FERMEE"===t.caisseDetails.statut),e.R7$(),e.SpI(" ","OUVERTE"===t.caisseDetails.statut?"Ouverte":"Ferm\xe9e"," "),e.R7$(5),e.JRh(e.bMT(21,15,t.caisseDetails.montantInitial)),e.R7$(6),e.JRh(e.bMT(27,17,t.caisseDetails.montantCourant)),e.R7$(6),e.JRh(t.formatDate(t.caisseDetails.dateOuverture)),e.R7$(),e.Y8G("ngIf",t.caisseDetails.dateFermeture),e.R7$(5),e.JRh(e.bMT(39,19,t.getMontantObtenu())),e.R7$(6),e.JRh(t.caisseDetails.nomVendeur||"N/A"),e.R7$(5),e.JRh(t.caisseDetails.nomBoutique||"N/A")}}function te(c,g){if(1&c&&(e.j41(0,"div",75),e.nrm(1,"i",76),e.EFF(2),e.k0s()),2&c){const t=e.XpG(2);e.R7$(2),e.SpI(" ",t.fermetureErrorMessage," ")}}function ne(c,g){if(1&c){const t=e.RV6();e.j41(0,"div",40)(1,"div",41),e.bIt("click",function(n){return e.eBV(t),e.Njj(n.stopPropagation())}),e.j41(2,"div",42),e.bIt("mousedown",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.startDragPopup(n))}),e.j41(3,"h3"),e.EFF(4,"Fermer la caisse"),e.k0s(),e.j41(5,"i",43),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.showFermerCaissePopup=!1)}),e.k0s()(),e.j41(6,"div",57),e.DNE(7,Q,3,0,"div",58)(8,ee,50,21,"div",59)(9,te,3,1,"div",60),e.k0s(),e.j41(10,"div",61)(11,"button",62),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.showFermerCaissePopup=!1)}),e.EFF(12," Annuler "),e.k0s(),e.j41(13,"button",63),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onLogout())}),e.EFF(14," Confirmer la fermeture "),e.k0s()()()()}if(2&c){const t=e.XpG();e.R7$(),e.Y8G("ngStyle",e.eq3(6,S,"translate3d("+t.popupOffsetPopup.x+"px, "+t.popupOffsetPopup.y+"px, 0)")),e.R7$(6),e.Y8G("ngIf",t.isLoadingCaisseDetails),e.R7$(),e.Y8G("ngIf",t.caisseDetails&&!t.isLoadingCaisseDetails),e.R7$(),e.Y8G("ngIf",t.fermetureErrorMessage),e.R7$(2),e.Y8G("disabled",t.isLoadingCaisseDetails),e.R7$(2),e.Y8G("disabled",t.isLoadingCaisseDetails||!t.caisseDetails)}}function ie(c,g){if(1&c){const t=e.RV6();e.j41(0,"div",77)(1,"div",78),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.minimizeCalculator())}),e.k0s(),e.j41(2,"div",79,1),e.bIt("click",function(n){e.eBV(t);const r=e.XpG();return n.stopPropagation(),e.Njj(r.onCalculatorClick())})("mousemove",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onCalculatorMouseMove(n))})("mouseleave",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onCalculatorMouseLeave(n))})("mousedown",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onCalculatorMouseDown(n))})("touchstart",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onCalculatorTouchStart(n))}),e.j41(4,"div",80)(5,"div",81),e.bIt("mousedown",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.startDragPopup(n))}),e.j41(6,"span"),e.EFF(7,"Calculatrice"),e.k0s(),e.j41(8,"div",82)(9,"i",83),e.bIt("click",function(n){return e.eBV(t),e.XpG().minimizeCalculator(),e.Njj(n.stopPropagation())}),e.k0s(),e.j41(10,"i",43),e.bIt("click",function(n){return e.eBV(t),e.XpG().closeCalculator(),e.Njj(n.stopPropagation())}),e.k0s()()(),e.j41(11,"div",84)(12,"div",85,2)(14,"div",86)(15,"div",87),e.nrm(16,"img",88),e.k0s(),e.j41(17,"span",89),e.EFF(18,"12\xa0FICHES"),e.k0s()(),e.j41(19,"div",90)(20,"span",91),e.EFF(21),e.k0s()(),e.j41(22,"div",92),e.EFF(23,"Dispositifs de calcul"),e.k0s(),e.j41(24,"div",93)(25,"div",94)(26,"span",95),e.EFF(27),e.k0s()(),e.j41(28,"div",96)(29,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("+/-"))}),e.EFF(30,"+/-"),e.k0s(),e.j41(31,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("\u221a"))}),e.EFF(32,"\u221a"),e.k0s(),e.j41(33,"button",98),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("ON/AC"))}),e.EFF(34,"ON/AC"),e.k0s()()(),e.j41(35,"div",99)(36,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("M+"))}),e.EFF(37,"M+"),e.k0s(),e.j41(38,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("M-"))}),e.EFF(39,"M-"),e.k0s(),e.j41(40,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("MRC"))}),e.EFF(41,"MRC"),e.k0s(),e.j41(42,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("GT"))}),e.EFF(43,"GT"),e.k0s(),e.j41(44,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("C.CE"))}),e.EFF(45,"C.CE"),e.k0s(),e.j41(46,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("MC"))}),e.EFF(47,"MC"),e.k0s(),e.j41(48,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("MR"))}),e.EFF(49,"MR"),e.k0s(),e.j41(50,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("Ex"))}),e.EFF(51,"Ex"),e.k0s(),e.j41(52,"button",100),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("\xf7"))}),e.EFF(53,"\xf7"),e.k0s(),e.j41(54,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("\u25b6"))}),e.EFF(55,"\u25b6"),e.k0s(),e.j41(56,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("7"))}),e.EFF(57,"7"),e.k0s(),e.j41(58,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("8"))}),e.EFF(59,"8"),e.k0s(),e.j41(60,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("9"))}),e.EFF(61,"9"),e.k0s(),e.j41(62,"button",100),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("\xd7"))}),e.EFF(63,"\xd7"),e.k0s(),e.j41(64,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("%"))}),e.EFF(65,"%"),e.k0s(),e.j41(66,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("4"))}),e.EFF(67,"4"),e.k0s(),e.j41(68,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("5"))}),e.EFF(69,"5"),e.k0s(),e.j41(70,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("6"))}),e.EFF(71,"6"),e.k0s(),e.j41(72,"button",100),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("\u2212"))}),e.EFF(73,"\u2212"),e.k0s(),e.j41(74,"button",97),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("MU"))}),e.EFF(75,"MU"),e.k0s(),e.j41(76,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("1"))}),e.EFF(77,"1"),e.k0s(),e.j41(78,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("2"))}),e.EFF(79,"2"),e.k0s(),e.j41(80,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("3"))}),e.EFF(81,"3"),e.k0s(),e.j41(82,"button",102),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("+"))}),e.EFF(83,"+"),e.k0s(),e.j41(84,"button",103),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("="))}),e.EFF(85,"="),e.k0s(),e.j41(86,"button",104),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("0"))}),e.EFF(87,"0"),e.k0s(),e.j41(88,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("00"))}),e.EFF(89,"00"),e.k0s(),e.j41(90,"button",101),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onCalcKey("."))}),e.EFF(91,"."),e.k0s()()()()()()()}if(2&c){const t=e.XpG();e.R7$(2),e.Y8G("ngStyle",e.sMw(5,z,"translate3d("+t.popupOffsetPopup.x+"px, "+t.popupOffsetPopup.y+"px, 0)",t.calcWidth,t.calcHeight)),e.R7$(9),e.AVh("minimized",t.isCalculatorMinimized),e.R7$(10),e.JRh(t.calcDisplay),e.R7$(6),e.JRh(t.calcSolarDisplay)}}let oe=(()=>{class c{constructor(t,i,n,r,a,f,x,M,O,E,I){this.router=t,this.viewState=i,this.userService=n,this.posCaisseService=r,this.commandeState=a,this.boutiqueState=f,this.boutiqueService=x,this.searchService=M,this.calculator=O,this.scannerService=E,this.renderer=I,this.apiUrl=b.c.imgUrl,this.showDropdown=!1,this.activeButton="vente",this.showMenuDropdown=!1,this.userName="",this.nomEntreprise="",this.photo=null,this.photoUrl=null,this.commandes=["001"],this.activeCommande="001",this.showCommandePopup=!1,this.boutiques=[],this.selectedBoutiqueId=null,this.selectedBoutiqueName="",this.boutiquesLoaded=!1,this.isBoutiqueNameLoaded=!1,this.scanInProgress=!1,this.isDraggingPopup=!1,this.startXPopup=0,this.startYPopup=0,this.initialXPopup=0,this.initialYPopup=0,this.popupOffsetPopup={x:0,y:0},this.showFermerCaissePopup=!1,this.caisseDetails=null,this.isLoadingCaisseDetails=!1,this.fermetureErrorMessage=null,this.showCalculatorPopup=!1,this.baseWidth=420,this.baseHeight=480,this.calcWidth=420,this.calcHeight=480,this.calcScale=1,this.hoverResizeCorner=null,this.cornerThreshold=18,this.isResizing=!1,this.resizeCorner=null,this.startXResize=0,this.startYResize=0,this.initialWidth=0,this.initialHeight=0,this.initialPopupX=0,this.initialPopupY=0,this.minWidth=160,this.minHeight=200,this.maxWidth=window.innerWidth-40,this.maxHeight=window.innerHeight-40,this.isCalculatorMinimized=!1,this.calculatorPosition={x:100,y:100},this.isCalculatorActive=!1,this.onMouseMovePopup=P=>{this.isDraggingPopup&&requestAnimationFrame(()=>{const F=P.clientY-this.startYPopup;this.popupOffsetPopup.x=this.initialXPopup+(P.clientX-this.startXPopup),this.popupOffsetPopup.y=this.initialYPopup+F})},this.onMouseUpPopup=()=>{this.isDraggingPopup=!1,document.removeEventListener("mousemove",this.onMouseMovePopup),document.removeEventListener("mouseup",this.onMouseUpPopup)},this.searchTerm="",this.isListView$=this.viewState.isListView$,this.commandes=this.commandeState.getAllCommandesIds(),this.commandeState.commandeUpdated$.subscribe(()=>{this.commandes=this.commandeState.getAllCommandesIds()}),this.commandeState.activeCommandeId$.subscribe(P=>{this.activeCommande=P}),this.commandeSubscription=this.commandeState.activeCommandeId$.subscribe(P=>{this.activeCommande=P}),this.calculatorActiveSub=this.calculator.isActive$.subscribe(P=>{this.isCalculatorActive=P})}ngOnInit(){this.activeButton=this.router.url.includes("/commandes")?"commande":"vente",this.getUserInfo(),this.loadBoutiques(),this.boutiqueService.getBoutiquesByEntreprise().subscribe({next:n=>{this.boutiques=n||[],this.boutiquesLoaded=!0,null!==this.selectedBoutiqueId&&this.updateBoutiqueName(this.selectedBoutiqueId)},error:n=>console.error("Erreur chargement boutiques",n)}),this.boutiqueSub=this.boutiqueState.selectedBoutique$.subscribe(n=>{this.selectedBoutiqueId=n,null===n?this.selectedBoutiqueName="S\xe9lectionnez une boutique":this.updateBoutiqueName(n)});const i=this.router.getCurrentNavigation()?.extras?.state;i?.caisse?.boutiqueId&&this.boutiqueState.setSelectedBoutique(i.caisse.boutiqueId),this.scannerService.getScanningObservable().subscribe(n=>{this.scanInProgress=n})}loadBoutiques(){this.boutiqueService.getBoutiquesByEntreprise().subscribe({next:t=>{this.boutiques=t||[],this.boutiquesLoaded=!0;const i=this.boutiqueState.getCurrentValue();i&&this.updateBoutiqueName(i)},error:t=>console.error("Erreur chargement boutiques",t)})}updateBoutiqueName(t){this.isBoutiqueNameLoaded=!1;const i=this.boutiques.find(n=>n.id===t);i?(this.selectedBoutiqueName=i.nomBoutique||"",this.isBoutiqueNameLoaded=!0):this.boutiqueService.getBoutiqueById(t).subscribe({next:n=>{this.selectedBoutiqueName=n?.nomBoutique||"Boutique inconnue",this.isBoutiqueNameLoaded=!0},error:()=>{this.selectedBoutiqueName="Boutique inconnue",this.isBoutiqueNameLoaded=!0}})}ngOnDestroy(){this.removeResizeListeners(),this.boutiqueSub?.unsubscribe(),this.commandeSubscription?.unsubscribe(),this.calculatorActiveSub?.unsubscribe()}toggleView(t){this.viewState.setViewPreference("grid"===t),this.showDropdown=!0}onClickCommandes(){this.activeButton="commande",this.router.navigate(["/pos-accueil/commandes"])}onClickVente(){this.activeButton="vente",this.router.navigate(["/pos-accueil"])}toggleMenuDropdown(){this.showMenuDropdown=!this.showMenuDropdown}addCommande(){const t=this.commandeState.addNewCommande();this.commandes=this.commandeState.getAllCommandesIds(),this.setActiveCommande(t),this.showCommandePopup=!1}setActiveCommande(t){this.commandeState.setActiveCommande(t),this.activeCommande=t,this.showCommandePopup=!1}get visibleCommandes(){const t=Math.max(0,this.commandes.length-6);return this.commandes.slice(t)}get hiddenCommandes(){return this.commandes.length>6?this.commandes.slice(0,this.commandes.length-6):[]}getUserInfo(){this.userService.getUserInfo().subscribe({next:t=>{this.userName=t.nomComplet.charAt(0).toUpperCase(),this.nomEntreprise=t.nomEntreprise},error:t=>{console.error("Erreur lors de la r\xe9cup\xe9ration des infos utilisateur :",t)}})}onLogout(){console.log("D\xe9but de la proc\xe9dure de d\xe9connexion...");const t=this.boutiqueState.getCurrentValue();if(!t)return console.error("Aucune boutique active d\xe9tect\xe9e."),void this.router.navigate(["/analytics"]);this.userService.getUserInfo().subscribe({next:i=>{console.log("Utilisateur r\xe9cup\xe9r\xe9:",i);const n=i.permissions;1===n.length&&n.includes("VENDRE_PRODUITS")?(console.log('L\'utilisateur a uniquement la permission "VENDRE_PRODUITS". Tentative de fermeture de la caisse...'),this.posCaisseService.fermerCaisse(t).subscribe({next:r=>{console.log("Caisse ferm\xe9e avec succ\xe8s:",r),this.userService.logoutUser(),console.log("D\xe9connexion de l'utilisateur..."),this.router.navigate(["/connexion"]).then(a=>{console.log("D\xe9connexion r\xe9ussie ?",a)})},error:r=>{console.error("Erreur lors de la fermeture de la caisse:",r.message),this.router.navigate(["/analytics"]).then(a=>{console.log("Navigation vers analytics r\xe9ussie ?",a)})}})):(console.log("L'utilisateur n'a pas uniquement la permission \"VENDRE_PRODUITS\", fermeture de la caisse et redirection vers analytics..."),this.posCaisseService.fermerCaisse(t).subscribe({next:r=>{console.log("Caisse ferm\xe9e avec succ\xe8s:",r),this.router.navigate(["/analytics"]).then(a=>{console.log("Navigation vers analytics r\xe9ussie ?",a)})},error:r=>{console.error("Erreur lors de la fermeture de la caisse:",r.message),this.router.navigate(["/analytics"]).then(a=>{console.log("Navigation vers analytics r\xe9ussie ?",a)})}}))},error:i=>{console.error("Erreur lors de la r\xe9cup\xe9ration des informations utilisateur:",i),this.router.navigate(["/analytics"])}})}prepareFermerCaisse(){this.isLoadingCaisseDetails=!0,this.fermetureErrorMessage=null,this.caisseDetails=null;const t=this.boutiqueState.getCurrentValue();if(!t)return this.fermetureErrorMessage="Aucune boutique s\xe9lectionn\xe9e",void(this.isLoadingCaisseDetails=!1);this.posCaisseService.getDerniereCaisseVendeur(t).subscribe({next:i=>{"string"==typeof i?this.fermetureErrorMessage=i:(this.caisseDetails=i,"OUVERTE"!==this.caisseDetails.statut?this.fermetureErrorMessage="Aucune caisse ouverte pour cette boutique":this.showFermerCaissePopup=!0),this.isLoadingCaisseDetails=!1},error:i=>{this.fermetureErrorMessage="Erreur lors du chargement des d\xe9tails de la caisse: "+i.message,this.isLoadingCaisseDetails=!1}})}formatDate(t){if(!t)return"N/A";const i=new Date(t);return isNaN(i.getTime())?"Date invalide":i.toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}confirmFermerCaisse(){if(!this.caisseDetails?.id)return;const t=this.caisseDetails.id;this.isLoadingCaisseDetails=!0,this.posCaisseService.fermerCaisse(t).subscribe({next:i=>{this.showFermerCaissePopup=!1,this.handlePostFermeture()},error:i=>{this.fermetureErrorMessage="\xc9chec de la fermeture de la caisse",this.isLoadingCaisseDetails=!1}})}handlePostFermeture(){this.userService.getUserInfo().subscribe({next:t=>{const i=t.permissions;1===i.length&&i.includes("VENDRE_PRODUITS")?(this.userService.logoutUser(),this.router.navigate(["/connexion"])):this.router.navigate(["/analytics"])},error:()=>this.router.navigate(["/analytics"])})}handleAnalytique(){this.userService.getUserInfo().subscribe({next:t=>{const i=t.permissions;1===i.length&&i.includes("VENDRE_PRODUITS")?(this.userService.logoutUser(),this.router.navigate(["/pos-accueil"])):this.router.navigate(["/analytics"])},error:()=>this.router.navigate(["/analytics"])})}startDragPopup(t){t.preventDefault(),t.stopPropagation(),this.isDraggingPopup=!0,this.startXPopup=t.clientX,this.startYPopup=t.clientY,this.initialXPopup=this.popupOffsetPopup.x,this.initialYPopup=this.popupOffsetPopup.y,document.addEventListener("mousemove",this.onMouseMovePopup),document.addEventListener("mouseup",this.onMouseUpPopup)}closePopup(t){t&&t.stopPropagation(),this.showCommandePopup=!1}getMontantObtenu(){return this.caisseDetails?(this.caisseDetails.montantCourant||0)-(this.caisseDetails.montantInitial||0):0}toggleCalculator(){this.showCalculatorPopup=!this.showCalculatorPopup,this.showCalculatorPopup?(this.calculator.setActive(!0),this.scannerService.disableScanner()):(this.calculator.setActive(!1),this.scannerService.enableScanner())}closeCalculator(){this.showCalculatorPopup=!1,this.scannerService.enableScanner()}onCalcKey(t){this.calculator.handleKey(t)}get calcDisplay(){return this.calculator.display}get calcSolarDisplay(){return this.calculator.solarDisplay}handleKeyDown(t){if(!this.showCalculatorPopup)return;const i=t.target;!i||"INPUT"!==i.tagName&&"TEXTAREA"!==i.tagName&&!i.isContentEditable?this.isCalculatorActive&&this.calculator.handleComputerKeyboard(t):this.calculator.setActive(!1)}onCalculatorClick(){this.calculator.setActive(!0)}ngAfterViewInit(){setTimeout(()=>{if(this.calcElement?.nativeElement){const t=this.calcElement.nativeElement;this.baseWidth=t.offsetWidth||420,this.baseHeight=t.offsetHeight||480,this.calcWidth=this.baseWidth,this.calcHeight=this.baseHeight,this.calcScale=1}this.maxWidth=Math.max(400,window.innerWidth-40),this.maxHeight=Math.max(400,window.innerHeight-40)},0)}startResize(t,i){t.preventDefault(),t.stopPropagation(),this.startResizeFromCoords(i,t.clientX,t.clientY)}startResizeTouch(t,i){this.startResizeFromCoords(i,t.clientX,t.clientY)}startResizeFromCoords(t,i,n){this.isResizing=!0,this.resizeCorner=t,this.startXResize=i,this.startYResize=n,this.initialWidth=this.calcWidth,this.initialHeight=this.calcHeight,this.initialPopupX=this.popupOffsetPopup.x,this.initialPopupY=this.popupOffsetPopup.y,this.pointerMoveHandler=r=>{"touchmove"===r.type&&r.preventDefault();const{clientX:a,clientY:f}=this.extractClientFromEvent(r);this.handlePointerMove(a,f)},this.pointerUpHandler=r=>{this.handlePointerUp()},document.addEventListener("mousemove",this.pointerMoveHandler,{passive:!1}),document.addEventListener("mouseup",this.pointerUpHandler),document.addEventListener("touchmove",this.pointerMoveHandler,{passive:!1}),document.addEventListener("touchend",this.pointerUpHandler)}extractClientFromEvent(t){if(!t)return{clientX:0,clientY:0};if(t.type&&t.type.startsWith("touch")){const i=t.touches&&t.touches[0]?t.touches[0]:t.changedTouches&&t.changedTouches[0]?t.changedTouches[0]:null;if(i)return{clientX:i.clientX,clientY:i.clientY}}else if(void 0!==t.clientX)return{clientX:t.clientX,clientY:t.clientY};return{clientX:this.startXResize,clientY:this.startYResize}}handlePointerMove(t,i){if(!this.isResizing||!this.resizeCorner)return;const n=t-this.startXResize;let a=this.initialWidth,f=this.initialHeight;"br"===this.resizeCorner?a=this.initialWidth+n:"bl"===this.resizeCorner&&(a=this.initialWidth-n),f=this.initialHeight+(i-this.startYResize),a=Math.max(10,a),f=Math.max(10,f);let O=Math.min(a/this.initialWidth,f/this.initialHeight);O=Math.max(.4,Math.min(2.5,O));const E=Math.round(this.baseWidth*O),I=Math.round(this.baseHeight*O),P=Math.max(this.minWidth,Math.min(this.maxWidth,E)),T=Math.max(this.minHeight,Math.min(this.maxHeight,I)),R=Math.min(P/this.baseWidth,T/this.baseHeight);if(this.calcScale=R,this.calcWidth=Math.round(this.baseWidth*R),this.calcHeight=Math.round(this.baseHeight*R),this.popupOffsetPopup.x="bl"===this.resizeCorner?Math.round(this.initialPopupX+(this.initialWidth-this.calcWidth)):this.initialPopupX,this.calcElement?.nativeElement){const V=this.calcElement.nativeElement;V.style.transformOrigin="top left",V.style.transform=`scale(${this.calcScale})`}}onMouseMoveResize(t){if(!this.isResizing||!this.resizeCorner)return;const i=t.clientX-this.startXResize;let r=this.initialWidth,a=this.initialHeight,f=this.initialPopupX;if("br"===this.resizeCorner?(r=this.initialWidth+i,f=this.initialPopupX):"bl"===this.resizeCorner&&(r=this.initialWidth-i,f=this.initialPopupX+i),a=this.initialHeight+(t.clientY-this.startYResize),r=Math.max(this.minWidth,Math.min(this.maxWidth,r)),a=Math.max(this.minHeight,Math.min(this.maxHeight,a)),this.calcWidth=Math.round(r),this.calcHeight=Math.round(a),this.popupOffsetPopup.x=Math.round(f),this.calcScale=Math.max(.4,Math.min(2.5,Math.min(this.calcWidth/this.baseWidth,this.calcHeight/this.baseHeight))),this.calcElement?.nativeElement){const O=this.calcElement.nativeElement;O.style.transformOrigin="top left",O.style.transform=`scale(${this.calcScale})`}}onMouseUpResize(){this.isResizing=!1,this.resizeCorner=null,this.removeResizeListeners()}onWindowResize(){this.maxWidth=Math.max(300,window.innerWidth-40),this.maxHeight=Math.max(300,window.innerHeight-40),this.calcWidth=Math.min(this.calcWidth,this.maxWidth),this.calcHeight=Math.min(this.calcHeight,this.maxHeight)}onCalculatorMouseMove(t){const i=this.calculatorRef?.nativeElement;if(!i)return;const n=i.getBoundingClientRect(),r=t.clientX-n.left,x=r<=this.cornerThreshold,M=n.height-(t.clientY-n.top)<=this.cornerThreshold;M&&n.width-r<=this.cornerThreshold?(this.hoverResizeCorner="br",i.style.cursor="nwse-resize"):M&&x?(this.hoverResizeCorner="bl",i.style.cursor="nesw-resize"):(this.hoverResizeCorner=null,i.style.cursor="default")}onCalculatorMouseLeave(t){const i=this.calculatorRef?.nativeElement;i&&(i.style.cursor="default"),this.hoverResizeCorner=null}handlePointerUp(){this.isResizing=!1,this.resizeCorner=null,document.removeEventListener("mousemove",this.pointerMoveHandler),document.removeEventListener("mouseup",this.pointerUpHandler),document.removeEventListener("touchmove",this.pointerMoveHandler),document.removeEventListener("touchend",this.pointerUpHandler),this.pointerMoveHandler=void 0,this.pointerUpHandler=void 0}removeResizeListeners(){this.pointerMoveHandler&&(document.removeEventListener("mousemove",this.pointerMoveHandler),document.removeEventListener("touchmove",this.pointerMoveHandler),this.pointerMoveHandler=void 0),this.pointerUpHandler&&(document.removeEventListener("mouseup",this.pointerUpHandler),document.removeEventListener("touchend",this.pointerUpHandler),this.pointerUpHandler=void 0)}onCalculatorMouseDown(t){const i=t.target;if(!i.closest(".key")&&"BUTTON"!==i.tagName&&"INPUT"!==i.tagName){if(this.hoverResizeCorner)return void this.startResize(t,this.hoverResizeCorner);this.startDragPopup(t)}}onCalculatorTouchStart(t){if(!t||!t.touches||0===t.touches.length)return;const i=t.touches[0],n=this.calculatorRef?.nativeElement;if(!n)return;const r=n.getBoundingClientRect(),a=i.clientX-r.left,x=r.width-a<=this.cornerThreshold;if(r.height-(i.clientY-r.top)<=this.cornerThreshold&&(x||a<=this.cornerThreshold)){const P=x?"br":"bl";return t.preventDefault(),void this.startResizeTouch(i,P)}const E=t.target;if(E&&(E.closest(".key")||"BUTTON"===E.tagName||"INPUT"===E.tagName))return;const I=new MouseEvent("mousedown",{clientX:i.clientX,clientY:i.clientY,bubbles:!0});this.startDragPopup(I)}minimizeCalculator(){this.isCalculatorMinimized=!this.isCalculatorMinimized,this.isCalculatorMinimized?(this.calculatorPosition.x=this.popupOffsetPopup.x,this.calculatorPosition.y=this.popupOffsetPopup.y,this.calcWidth=200,this.calcHeight=40,this.calcScale=Math.max(.1,Math.min(1,this.calcWidth/this.baseWidth)),this.calcElement?.nativeElement&&(this.renderer.setStyle(this.calcElement.nativeElement,"transformOrigin","top left"),this.renderer.setStyle(this.calcElement.nativeElement,"transform",`scale(${this.calcScale})`))):(this.calcWidth=this.baseWidth,this.calcHeight=this.baseHeight,this.calcScale=1,this.calcElement?.nativeElement&&this.renderer.setStyle(this.calcElement.nativeElement,"transform",`scale(${this.calcScale})`),this.popupOffsetPopup.x=this.calculatorPosition.x,this.popupOffsetPopup.y=this.calculatorPosition.y)}onSearch(t){const i=t.target;this.calculator.setActive(!1),console.log("Recherche:",i.value),this.searchTerm=i.value,this.searchService.setSearch(i.value)}clearSearch(){this.searchTerm="",this.searchService.setSearch("")}static{this.\u0275fac=function(i){return new(i||c)(e.rXU(l.Ix),e.rXU(A.C),e.rXU(k.g),e.rXU(j.U),e.rXU(d.f),e.rXU(s.j),e.rXU(o.c),e.rXU(u.S),e.rXU(m.C),e.rXU(v.I),e.rXU(e.sFG))}}static{this.\u0275cmp=e.VBU({type:c,selectors:[["app-pos-accueil"]],viewQuery:function(i,n){if(1&i&&(e.GBs(B,5),e.GBs($,5)),2&i){let r;e.mGM(r=e.lsd())&&(n.calculatorRef=r.first),e.mGM(r=e.lsd())&&(n.calcElement=r.first)}},hostBindings:function(i,n){1&i&&e.bIt("keydown",function(a){return n.handleKeyDown(a)},!1,e.tSv)("resize",function(a){return n.onWindowResize(a)},!1,e.tSv)},decls:43,vars:22,consts:[["loadingBoutique",""],["calculatorRef",""],["calcElement",""],[1,"pos_container"],[1,"pos_content"],[1,"pos_header"],[1,"navBar"],[1,"header_left"],[1,"btn_vente_pos",3,"click"],[1,"btn","btn_default"],[1,"btn_commande_pos",3,"click"],[1,"btn_add_commande"],[1,"btn",3,"click"],[1,"ri-add-line"],[1,"list_commande"],[3,"list_commande_active","click",4,"ngFor","ngForOf"],["class","list_commande_plus",3,"click",4,"ngIf"],["class","miin_loading",4,"ngIf"],["class","commande-popup-overlay",4,"ngIf"],[1,"header_right"],[1,"icon_calculatrice",3,"click"],["src","assets/img/calculatrice-moderne.png","alt",""],[1,"name_boutique"],[4,"ngIf","ngIfElse"],[1,"inputSearch"],["class","ri-search-2-line",4,"ngIf"],["class","ri-close-line",3,"click",4,"ngIf"],["type","text","placeholder","Recherche des produits",3,"input","value"],["clickOutside","",1,"icon_sort",3,"click","clickOutside"],["class","view-dropdown",4,"ngIf"],[1,"profil"],["clickOutside","",1,"menu",3,"click","clickOutside"],[1,"ri-menu-line"],["class","menu-dropdown",4,"ngIf"],["class","calculate-popup-overlay",4,"ngIf"],[3,"click"],[1,"list_commande_plus",3,"click"],[1,"ri-arrow-down-s-line"],[1,"miin_loading"],[1,"ri-barcode-line","scan-indicator"],[1,"commande-popup-overlay"],[1,"commande-popup-content",3,"click","ngStyle"],[1,"popup-header",3,"mousedown"],[1,"ri-close-line",3,"click"],[1,"popup-commandes"],[1,"list_commande","commandes-grid"],[3,"active","click",4,"ngFor","ngForOf"],[1,"boutique-loading"],[1,"ri-search-2-line"],[1,"view-dropdown"],[1,"dropdown-item",3,"click"],[1,"menu-dropdown"],[1,"dropdown-item"],[1,"ri-download-line"],[1,"ri-home-5-line"],[1,"ri-restart-line"],[1,"ri-money-euro-circle-line"],[1,"popup-body"],["class","loading-indicator",4,"ngIf"],["class","caisse-details-container",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"popup-footer"],[1,"btn","btn-cancel",3,"click","disabled"],[1,"btn","btn-confirm",3,"click","disabled"],[1,"loading-indicator"],[1,"ri-loader-4-line","spin"],[1,"caisse-details-container"],[1,"caisse-info-header"],[1,"caisse-info-title"],[1,"caisse-info-subtitle"],[1,"caisse-details-grid"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],["class","detail-item",4,"ngIf"],[1,"error-message"],[1,"ri-error-warning-line"],[1,"calculate-popup-overlay"],[1,"calc-backdrop",2,"pointer-events","auto",3,"click"],[1,"calculator",3,"click","mousemove","mouseleave","mousedown","touchstart","ngStyle"],[1,"total"],[1,"calculator-title-bar",3,"mousedown"],[1,"calculator-window-controls"],[1,"ri-subtract-line",3,"click"],[1,"calculator-content"],[1,"calc"],[1,"calc-top"],[1,"brand-img"],["src","assets/logo/tchakeda.png","alt",""],[1,"digits-badge"],[1,"screen"],[1,"screen-text"],[1,"meta"],[1,"meta-row"],[1,"solar"],[1,"screen-text-sub"],[1,"keys-true"],[1,"key","fn",3,"click"],[1,"key","on",2,"font-size","14px",3,"click"],[1,"keys"],[1,"key","op",3,"click"],[1,"key","num",3,"click"],[1,"key","plus","tall",3,"click"],[1,"key","equals","tall",3,"click"],[1,"key","num","wide0",3,"click"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"nav",6)(4,"div",7)(5,"div",8),e.bIt("click",function(){return e.eBV(r),e.Njj(n.onClickVente())}),e.j41(6,"button",9),e.EFF(7," Ventes POS "),e.k0s()(),e.j41(8,"div",10),e.bIt("click",function(){return e.eBV(r),e.Njj(n.onClickCommandes())}),e.j41(9,"button",9),e.EFF(10," Commandes "),e.k0s()(),e.j41(11,"div",11)(12,"button",12),e.bIt("click",function(){return e.eBV(r),e.Njj(n.addCommande())}),e.nrm(13,"i",13),e.k0s()(),e.j41(14,"ul",14),e.DNE(15,N,2,3,"li",15)(16,U,2,0,"li",16),e.k0s(),e.DNE(17,X,2,0,"div",17)(18,W,9,4,"div",18),e.k0s(),e.j41(19,"div",19)(20,"div",20),e.bIt("click",function(){return e.eBV(r),e.Njj(n.toggleCalculator())}),e.nrm(21,"img",21),e.k0s(),e.j41(22,"div",22),e.DNE(23,G,3,1,"ng-container",23)(24,q,2,0,"ng-template",null,0,e.C5r),e.k0s(),e.j41(26,"div",24),e.DNE(27,H,1,0,"i",25)(28,K,1,0,"i",26),e.j41(29,"input",27),e.bIt("input",function(f){return e.eBV(r),e.Njj(n.onSearch(f))}),e.k0s()(),e.j41(30,"div",28),e.bIt("click",function(){return e.eBV(r),e.Njj(n.showDropdown=!n.showDropdown)})("clickOutside",function(){return e.eBV(r),e.Njj(n.showDropdown=!1)}),e.nrm(31,"i"),e.nI1(32,"async"),e.DNE(33,Y,7,6,"div",29),e.k0s(),e.j41(34,"div",30)(35,"span"),e.EFF(36),e.k0s()(),e.j41(37,"div",31),e.bIt("click",function(){return e.eBV(r),e.Njj(n.toggleMenuDropdown())})("clickOutside",function(){return e.eBV(r),e.Njj(n.showMenuDropdown=!1)}),e.nrm(38,"i",32),e.DNE(39,J,13,0,"div",33),e.k0s()()()(),e.nrm(40,"router-outlet"),e.k0s()(),e.DNE(41,ne,15,8,"div",18)(42,ie,92,9,"div",34)}if(2&i){const r=e.sdS(25);e.R7$(6),e.AVh("btn_active","vente"===n.activeButton),e.R7$(3),e.AVh("btn_active","commande"===n.activeButton),e.R7$(6),e.Y8G("ngForOf",n.visibleCommandes),e.R7$(),e.Y8G("ngIf",n.commandes.length>6),e.R7$(),e.Y8G("ngIf",n.scanInProgress),e.R7$(),e.Y8G("ngIf",n.showCommandePopup),e.R7$(5),e.Y8G("ngIf",n.isBoutiqueNameLoaded)("ngIfElse",r),e.R7$(4),e.Y8G("ngIf",!n.searchTerm),e.R7$(),e.Y8G("ngIf",n.searchTerm),e.R7$(),e.Y8G("value",n.searchTerm),e.R7$(2),e.HbH(e.bMT(32,20,n.isListView$)?"ri-apps-fill":"ri-list-check"),e.R7$(2),e.Y8G("ngIf",n.showDropdown),e.R7$(3),e.JRh(n.userName),e.R7$(3),e.Y8G("ngIf",n.showMenuDropdown),e.R7$(2),e.Y8G("ngIf",n.showFermerCaissePopup),e.R7$(),e.Y8G("ngIf",n.showCalculatorPopup)}},dependencies:[C.YN,_.MD,_.Sq,_.bT,_.B3,_.Jj,l.iI,l.n3,h.z,y.M],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:flex;flex-direction:column;position:fixed;inset:0;overflow:hidden}.pos_container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}ul[_ngcontent-%COMP%]{list-style-type:none;padding:0}.pos_content[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-height:0}.pos_header[_ngcontent-%COMP%]{flex:0 0 auto}.view-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;background:#fff;border:1px solid #ddd;border-radius:4px;box-shadow:0 2px 5px #0000001a;z-index:100;min-width:150px}.dropdown-item[_ngcontent-%COMP%]{padding:8px 12px;font-size:14px;cursor:pointer}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.navBar[_ngcontent-%COMP%]{width:100%;height:60px;display:flex;align-items:center;justify-content:space-between;background-color:#fff;border-bottom:1px solid #ddd;box-shadow:#2123261a 0 10px 10px -10px;padding:0 15px}.header_left[_ngcontent-%COMP%], .header_right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.header_right[_ngcontent-%COMP%]{gap:20px}.btn_vente_pos[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%], .btn_commande_pos[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{gap:10px}.btn_default[_ngcontent-%COMP%]{background-color:#f4f4f4}.btn_default[_ngcontent-%COMP%]:focus{background-color:#f4f4f4}.btn[_ngcontent-%COMP%]{border:none;padding:8px 16px;border-radius:4px;cursor:pointer;transition:background-color .3s}.btn.btn_active[_ngcontent-%COMP%]{background-color:#cde3fa;color:#1a73e8}.btn_add_commande[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{background-color:#f4f4f4;padding:4px 13px}.btn_add_commande[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px}li.list_commande_active[_ngcontent-%COMP%]{background-color:#cde3fa!important}ul.list_commande[_ngcontent-%COMP%]{list-style-type:none;display:flex;align-items:center;gap:10px;margin:0;padding:0}ul.list_commande[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:#f4f4f4;padding:7px 13px;border-radius:5px;cursor:pointer}ul.list_commande[_ngcontent-%COMP%]   li.list_commande_plus[_ngcontent-%COMP%]{padding:5px}.name_boutique[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.inputSearch[_ngcontent-%COMP%]{position:relative;width:250px;height:35px;display:flex;align-items:center}.inputSearch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:100%;padding-left:10px;border-radius:5px;border:1px solid #000;font-size:13px}.inputSearch[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:0;margin-right:15px;font-size:17px}.icon_sort[_ngcontent-%COMP%]{position:relative;background-color:#f4f4f4;padding:5px 11px;border-radius:5px;cursor:pointer}.icon_sort[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px}.profil[_ngcontent-%COMP%]{background-color:#0672e4;padding:0 12px;border-radius:4px;cursor:pointer}.profil[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;color:#fff}.menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px;cursor:pointer}.menu[_ngcontent-%COMP%]{position:relative;cursor:pointer}.menu[_ngcontent-%COMP%]   .menu-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;background:#fff;border:1px solid #e1e1e1;border-radius:4px;box-shadow:0 4px 12px #0000001a;z-index:1000;min-width:200px;margin-top:8px;overflow:hidden}.menu[_ngcontent-%COMP%]   .menu-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{padding:10px 16px;display:flex;align-items:center;gap:12px;font-size:12px;color:#333;transition:all .2s;cursor:pointer}.menu[_ngcontent-%COMP%]   .menu-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#f5f7fa}.menu[_ngcontent-%COMP%]   .menu-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;color:#64748b}.commande-popup[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;width:300px;background:#fff;border:1px solid #e0e0e0;border-radius:8px;box-shadow:0 4px 12px #0000001a;z-index:1000;margin-top:8px}.commande-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #f0f0f0}.commande-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600}.commande-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer;font-size:20px;color:#666}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;max-height:300px;overflow-y:auto}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;cursor:pointer;border-bottom:1px solid #f8f8f8;transition:background .2s}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#f4f4f4}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background:#e6f4ff;color:#1890ff}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#999}.commande-popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:10000}.commande-popup-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:90%;max-width:800px;max-height:80vh;overflow-y:auto;box-shadow:0 10px 30px #0000004d}.commande-popup-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px;height:4px}.commande-popup-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0003;border-radius:3px}.commande-popup-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:5px 20px;border-bottom:1px solid #eee;position:sticky;top:0;background:#fff;z-index:10}.popup-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;color:#333}.popup-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px;cursor:pointer;color:#666;transition:color .2s}.popup-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:red}.popup-commandes[_ngcontent-%COMP%]{padding:15px}.popup-commandes[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:12px 15px;border-radius:6px;margin-bottom:8px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:all .2s;border:1px solid #f0f0f0}.popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;border-color:#e0e0e0}.popup-commandes[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background-color:#e6f4ff;border-color:#91caff;color:#1890ff;font-weight:500}.popup-commandes[_ngcontent-%COMP%]   .commandes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(65px,1fr));gap:10px;padding:0;margin:0;list-style:none}.popup-commandes[_ngcontent-%COMP%]   .commandes-grid[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px 15px;background-color:#f8f8f8;border:1px solid #e0e0e0;border-radius:6px;cursor:pointer;transition:all .2s;text-align:center;margin-bottom:0!important;display:flex;align-items:center;justify-content:center}.popup-commandes[_ngcontent-%COMP%]   .commandes-grid[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#e9e9e9}.popup-commandes[_ngcontent-%COMP%]   .commandes-grid[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background-color:#cde3fa;border-color:#a0c5f0;color:#1a73e8;font-weight:700}[draggable][_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.popup-header[_ngcontent-%COMP%]{cursor:move}.caisse-info-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-bottom:20px;padding-bottom:15px;border-bottom:1px solid #eee}.caisse-info-header[_ngcontent-%COMP%]   .profil[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#4e73df;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px}.caisse-info-header[_ngcontent-%COMP%]   .caisse-info-title[_ngcontent-%COMP%]{font-weight:600;font-size:18px}.caisse-info-header[_ngcontent-%COMP%]   .caisse-info-subtitle[_ngcontent-%COMP%]{color:#6c757d;font-size:14px}.caisse-details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:15px}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column}.detail-label[_ngcontent-%COMP%]{font-size:13px;color:#6c757d;margin-bottom:4px}.detail-value[_ngcontent-%COMP%]{font-weight:500;font-size:14px;word-break:break-word}.text-success-status[_ngcontent-%COMP%]{color:green!important;font-weight:600}.text-danger[_ngcontent-%COMP%]{color:#dc3545;font-weight:600}.popup-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;padding:15px;border-top:1px solid #eee;margin-top:15px}.popup-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:4px;cursor:pointer;font-weight:500;transition:all .2s}.popup-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dee2e6;color:#495057}.popup-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{background:#e9ecef}.popup-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{background:#dc3545;color:#fff;border:none}.popup-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:hover{background:#c82333}.popup-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:disabled{background:#e99ba4;cursor:not-allowed}.loading-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:20px;color:#6c757d}.loading-indicator[_ngcontent-%COMP%]   .spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-right:10px;font-size:20px}.error-message[_ngcontent-%COMP%]{padding:10px;background:#f8d7da;color:#721c24;border-radius:4px;margin-top:15px;display:flex;align-items:center}.error-message[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:8px;font-size:18px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.popup-body[_ngcontent-%COMP%]{padding:20px}.boutique-loading[_ngcontent-%COMP%]{opacity:.6;font-size:14px;color:#666}.spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite;display:inline-block;vertical-align:middle}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.miin_loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.miin_loading[_ngcontent-%COMP%]   .scan-indicator[_ngcontent-%COMP%]{font-size:24px;color:#4caf50;animation:_ngcontent-%COMP%_pulse .1s}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.2)}to{transform:scale(1)}}.ri-close-line[_ngcontent-%COMP%]{cursor:pointer;color:#f40505}.icon_calculatrice[_ngcontent-%COMP%]{width:30px;height:30px;display:flex;align-items:center;justify-content:center;border-radius:5px;cursor:pointer}.icon_calculatrice[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.calculate-popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none;z-index:10000}.calculator[_ngcontent-%COMP%]{pointer-events:auto;z-index:10001}.calculator-popup-content-back[_ngcontent-%COMP%]{background-color:#44424d;max-width:400px;width:100%;min-height:80vh;box-shadow:0 10px 30px #0000004d;border-radius:35px}.calculator-popup-content[_ngcontent-%COMP%]{padding:10px;border:1px solid #858489;max-width:400px;min-height:80vh;overflow-y:auto;box-shadow:0 10px 30px #0000004d;border-radius:28px;margin:5px;overflow:hidden}.brand-img[_ngcontent-%COMP%]{width:90px}.brand-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.calculator-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:5px}.digits[_ngcontent-%COMP%]{font-size:12px;color:#ccc}.calculator[_ngcontent-%COMP%]   .calc[_ngcontent-%COMP%]{--body:#2e2f33;--bezel:#3a3b40;--screen:#eef3f6;--screen-text:#213a52;--key-dark:#111214;--key-dark-text:#ffffff;--key-mid:#a9adb3;--key-mid-text:#1c1f23;--key-blue:#0672E4;--key-blue-text:#ffffff;--key-grey:#cfd3d7;--accent:#9aa0a6;--badge:#ffffff;position:relative;overflow:hidden;width:420px;max-width:92vw;background:var(--body);border-bottom-left-radius:20px;border-bottom-right-radius:20px;padding:0 18px 22px;box-shadow:0 8px 24px #00000059,inset 0 1px #ffffff0d;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica Neue,Helvetica,sans-serif}.calculator[_ngcontent-%COMP%]   .calc-top[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;padding-top:15px}.calculator[_ngcontent-%COMP%]   .calc-top[_ngcontent-%COMP%]   .calculator[_ngcontent-%COMP%]{pointer-events:all}.calculator[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:flex-end}.calculator[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{font-weight:800;letter-spacing:.6px;font-size:20px}.calculator[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]   .model[_ngcontent-%COMP%]{font-size:12px;opacity:.7}.calculator[_ngcontent-%COMP%]   .digits-badge[_ngcontent-%COMP%]{font-size:12px;color:var(--badge);opacity:.9}.calculator[_ngcontent-%COMP%]   .screen[_ngcontent-%COMP%]{font-family:Calculator,monospace;background:var(--screen);color:var(--screen-text);border-radius:10px;height:72px;display:flex;align-items:center;justify-content:flex-end;padding:0 16px;font-variant-numeric:tabular-nums;box-shadow:inset 0 2px 6px #0000002e;margin-bottom:10px;border:5px outset rgba(244,244,244,.8666666667)}.calculator[_ngcontent-%COMP%]   .screen-text[_ngcontent-%COMP%]{font-size:55px;letter-spacing:2px}.calculator[_ngcontent-%COMP%]   .screen-text-sub[_ngcontent-%COMP%]{font-size:14px;letter-spacing:2px;color:silver}.calculator[_ngcontent-%COMP%]   .meta-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:140px 1fr;align-items:center;gap:14px;margin-bottom:14px}.calculator[_ngcontent-%COMP%]   .solar[_ngcontent-%COMP%]{font-family:Calculator,monospace;height:40px;display:flex;align-items:center;justify-content:flex-end;border-radius:6px;background-color:#5f4a3a;border:1px solid rgba(186,186,186,.1843137255);padding:0 5px 0 0;box-shadow:inset 0 2px 6px #00000059}.calculator[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{text-align:center;font-size:12px;letter-spacing:.4px;color:#afb1b278;opacity:.9;margin-bottom:8px}.calculator[_ngcontent-%COMP%]   .keys[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:10px}.calculator[_ngcontent-%COMP%]   .keys-true[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}.calculator[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{height:54px;border:none;border-radius:12px;font-size:22px;line-height:1;cursor:default;box-shadow:0 3px #00000073,inset 0 1px #ffffff0f}.calculator[_ngcontent-%COMP%]   .key.num[_ngcontent-%COMP%]{background:var(--key-dark);color:var(--key-dark-text)}.calculator[_ngcontent-%COMP%]   .key.fn[_ngcontent-%COMP%]{background:var(--key-mid);color:var(--key-mid-text);font-size:18px;font-weight:600}.calculator[_ngcontent-%COMP%]   .key.on[_ngcontent-%COMP%]{background:var(--key-blue);color:var(--key-blue-text);font-weight:700}.calculator[_ngcontent-%COMP%]   .key.op[_ngcontent-%COMP%]{background:var(--key-mid);color:var(--key-mid-text);font-size:26px}.calculator[_ngcontent-%COMP%]   .key.nav[_ngcontent-%COMP%]{background:var(--key-grey);color:#222;font-weight:700}.calculator[_ngcontent-%COMP%]   .key.plus[_ngcontent-%COMP%]{background:var(--key-blue);color:var(--key-blue-text);font-weight:800;font-size:28px;grid-column:4;grid-row:5/span 2;height:118px}.calculator[_ngcontent-%COMP%]   .key.equals[_ngcontent-%COMP%]{background:var(--key-grey);color:#222;font-weight:700;font-size:28px;grid-column:5;grid-row:5/span 2;height:118px}.calculator[_ngcontent-%COMP%]   .wide0[_ngcontent-%COMP%]{letter-spacing:.5px}.calculator[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]:active{transform:translateY(2px);box-shadow:0 1px #00000073,inset 0 1px #ffffff0f}.display[_ngcontent-%COMP%]{display:flex;gap:5px;align-items:center}.resize-handle[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;background:#0000001f;border:2px solid rgba(255,255,255,.85);box-shadow:0 2px 6px #00000040;z-index:12000;touch-action:none;pointer-events:auto;border-radius:4px;transition:background .12s,transform .08s;display:block}.resize-handle.br[_ngcontent-%COMP%]{right:6px;bottom:6px;cursor:nwse-resize}.resize-handle.bl[_ngcontent-%COMP%]{left:6px;bottom:6px;cursor:nesw-resize}.resize-handle[_ngcontent-%COMP%]:hover{background:#00000038;transform:scale(1.05)}.popup-header-close-calc[_ngcontent-%COMP%]{position:absolute;top:-28px;right:0}.popup-header-close-calc[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-color:#cec7c7;font-size:14px;cursor:pointer;color:red;transition:color .2s;padding:5px 10px;border-radius:5px}.popup-header-close-calc[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{background-color:#aca7a7}.calculator-title-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background-color:#3a3b40;color:#fff;cursor:move;border-top-left-radius:20px;border-top-right-radius:20px}.calculator-title-bar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.calculator-title-bar[_ngcontent-%COMP%]   .calculator-window-controls[_ngcontent-%COMP%]{display:flex;gap:12px}.calculator-title-bar[_ngcontent-%COMP%]   .calculator-window-controls[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer;font-size:16px}.calculator-title-bar[_ngcontent-%COMP%]   .calculator-window-controls[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:#ccc}.calculator-content[_ngcontent-%COMP%]{transition:opacity .3s ease}.calculator-content.minimized[_ngcontent-%COMP%]{opacity:0;height:0;overflow:hidden;pointer-events:none}.calculate-popup-overlay[_ngcontent-%COMP%]{pointer-events:none;z-index:10000}.calculate-popup-overlay[_ngcontent-%COMP%]   .calculator[_ngcontent-%COMP%]{pointer-events:all}']})}}return c})()},74864:(D,w,p)=>{p.d(w,{U:()=>k});var _=p(21626),C=p(22525),l=p(18810),h=p(25558),b=p(99437),y=p(96354),e=p(54438),A=p(88026);let k=(()=>{class j{constructor(s,o){this.http=s,this.usersService=o,this.apiUrl=C.c.apiBaseUrl}ouvrirCaisse(s){return this.usersService.getValidAccessToken().pipe((0,h.n)(o=>{if(!o)throw new Error("Aucun token trouv\xe9");const u=new _.Lr({Authorization:`Bearer ${o}`});return this.http.post(`${this.apiUrl}/ouvrir`,s,{headers:u})}),(0,b.W)(o=>{console.error("Erreur d\xe9taill\xe9e",o);let u="Erreur lors de l'ouverture de la caisse";return o.error&&o.error.error?u=o.error.error:o.error&&o.error.message?u=o.error.message:o.message&&(u=o.message),(0,l.$)(()=>({message:u,originalError:o}))}))}fermerCaisse(s){return console.log("Tentative de r\xe9cup\xe9ration du token..."),this.usersService.getValidAccessToken().pipe((0,h.n)(o=>{if(!o)throw console.error("Aucun token trouv\xe9"),new Error("Aucun token trouv\xe9");console.log("Token r\xe9cup\xe9r\xe9 :",o);const u=new _.Lr({Authorization:`Bearer ${o}`}),m={boutiqueId:s};return console.log("Envoi de la requ\xeate POST pour fermer la caisse..."),this.http.post(`${this.apiUrl}/fermer`,m,{headers:u}).pipe((0,b.W)(v=>(console.error("Erreur lors de la requ\xeate pour fermer la caisse:",v),(0,l.$)(()=>v))))}),(0,b.W)(o=>{console.error("Erreur d\xe9taill\xe9e dans le service:",o);let u="Erreur lors de la fermeture de la caisse";return o.error&&o.error.error?u=o.error.error:o.error&&o.error.message?u=o.error.message:o.message&&(u=o.message),(0,l.$)(()=>({message:u,originalError:o}))}))}getDerniereCaisseVendeur(s){return this.usersService.getValidAccessToken().pipe((0,h.n)(o=>{if(!o)throw new Error("Aucun token trouv\xe9");const u=new _.Lr({Authorization:`Bearer ${o}`});return this.http.get(`${this.apiUrl}/caisse/derniere/${s}`,{headers:u}).pipe((0,y.T)(m=>m),(0,b.W)(m=>{console.error("HTTP getDerniereCaisseVendeur error ->",m);let v="Erreur inconnue";if(m?.error)if("string"==typeof m.error)v=m.error;else if(m.error?.message)v=m.error.message;else try{v=JSON.stringify(m.error)}catch{v=String(m.error)}else if(m?.message)v=m.message;else try{v=JSON.stringify(m)}catch{v=String(m)}return(0,l.$)(()=>v)}))}))}getCaissesByBoutique(s){return this.usersService.getValidAccessToken().pipe((0,h.n)(o=>{if(!o)throw new Error("Aucun token trouv\xe9");const u=new _.Lr({Authorization:`Bearer ${o}`});return this.http.get(`${this.apiUrl}/boutique/${s}/caisses`,{headers:u})}),(0,b.W)(o=>{let u="Erreur lors du chargement des caisses";return o?.error?.error?u=o.error.error:o?.error?.message?u=o.error.message:o.message&&(u=o.message),(0,l.$)(()=>({message:u,originalError:o}))}))}getHistoriqueCaissesByVendeur(s){return this.usersService.getValidAccessToken().pipe((0,h.n)(o=>{if(!o)throw new Error("Aucun token trouv\xe9");const u=new _.Lr({Authorization:`Bearer ${o}`});return this.http.get(`${this.apiUrl}/vendeur/${s}`,{headers:u})}),(0,b.W)(o=>{let u="Erreur lors du chargement de l'historique des caisses";return o?.error?.error?u=o.error.error:o?.error?.message?u=o.error.message:o.message&&(u=o.message),(0,l.$)(()=>({message:u,originalError:o}))}))}static{this.\u0275fac=function(o){return new(o||j)(e.KVO(_.Qq),e.KVO(A.g))}}static{this.\u0275prov=e.jDH({token:j,factory:j.\u0275fac,providedIn:"root"})}}return j})()},52719:(D,w,p)=>{p.d(w,{c:()=>A});var _=p(21626),C=p(25558),l=p(18810),h=p(99437),b=p(22525),y=p(54438),e=p(88026);let A=(()=>{class k{constructor(d,s){this.http=d,this.usersService=s,this.apiUrl=b.c.apiBaseUrl}updateBoutique(d,s){return this.usersService.getValidAccessToken().pipe((0,C.n)(o=>{if(!o)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const u=new _.Lr({Authorization:`Bearer ${o}`});return this.http.put(`${this.apiUrl}/updatedBoutique/${d}`,s,{headers:u})}),(0,h.W)(o=>(console.error("Erreur lors de la mise \xe0 jour de la boutique:",o),(0,l.$)(()=>o))))}getBoutiquesByEntreprise(){return this.usersService.getValidAccessToken().pipe((0,C.n)(d=>{if(!d)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const s=new _.Lr({Authorization:`Bearer ${d}`});return this.http.get(`${this.apiUrl}/boutiqueEntreprise`,{headers:s})}),(0,h.W)(d=>(console.error("Erreur lors de la r\xe9cup\xe9ration des boutiques:",d),(0,l.$)(()=>d))))}getBoutiqueById(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.get(`${this.apiUrl}/boutique/${d}`,{headers:o})}),(0,h.W)(s=>(console.error("Erreur lors de la r\xe9cup\xe9ration de la boutique:",s),(0,l.$)(()=>s))))}activerBoutique(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.put(`${this.apiUrl}/activerBoutique/${d}`,{},{headers:o})}),(0,h.W)(s=>(console.error("Erreur lors de l'activation de la boutique:",s),(0,l.$)(()=>s))))}desactiverBoutique(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.put(`${this.apiUrl}/desactiverBoutique/${d}`,{},{headers:o})}),(0,h.W)(s=>(console.error("Erreur lors de la d\xe9sactivation de la boutique:",s),(0,l.$)(()=>s))))}deleteBoutique(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.delete(`${this.apiUrl}/boutique/${d}`,{headers:o})}),(0,h.W)(s=>(console.error("Erreur lors de la suppression de la boutique:",s),(0,l.$)(()=>s))))}getProductsByBoutiqueId(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.get(`${this.apiUrl}/boutique/${d}/produits`,{headers:o})}),(0,h.W)(s=>(console.error("Erreur lors de la r\xe9cup\xe9ration des produits:",s),(0,l.$)(()=>s))))}copierProduits(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.post(`${this.apiUrl}/copier-produits`,d,{headers:o,responseType:"json"})}),(0,h.W)(s=>{if(s.error&&"string"==typeof s.error)try{const o=JSON.parse(s.error);return(0,l.$)(()=>o)}catch{return(0,l.$)(()=>({message:s.error}))}return(0,l.$)(()=>s)}))}mettreEnCorbeille(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.delete(`${this.apiUrl}/corbeille/${d}`,{headers:o})}),(0,h.W)(s=>{let o="Erreur lors de la mise en corbeille";return s.error?.message?o=s.error.message:s.message&&(o=s.message),(0,l.$)(()=>new Error(o))}))}associateUserToBoutique(d,s){return this.http.post(`${this.apiUrl}/boutiques/${d}/users/${s}`,{})}assignerVendeur(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.post(`${this.apiUrl}/assigner-vendeur`,d,{headers:o})}),(0,h.W)(s=>(console.error("Erreur lors de l'assignation du vendeur:",s),(0,l.$)(()=>s))))}retirerVendeur(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.post(`${this.apiUrl}/retirer-vendeur`,d,{headers:o})}),(0,h.W)(s=>(console.error("Erreur lors de l'assignation du vendeur:",s),(0,l.$)(()=>s))))}getVendeursDeBoutique(d){return this.usersService.getValidAccessToken().pipe((0,C.n)(s=>{if(!s)return console.error("Aucun token trouv\xe9"),(0,l.$)(()=>new Error("Aucun token trouv\xe9"));const o=new _.Lr({Authorization:`Bearer ${s}`});return this.http.get(`${this.apiUrl}/vendeurs/${d}`,{headers:o}).pipe((0,h.W)(u=>(console.error("Erreur lors de la r\xe9cup\xe9ration des vendeurs:",u),(0,l.$)(()=>u))))}))}getProduitsBoutiquePaginated(d,s=0,o=20){return this.usersService.getValidAccessToken().pipe((0,C.n)(u=>{const m=new _.Lr({Authorization:`Bearer ${u}`}),v=(new _.Nl).set("page",s.toString()).set("size",o.toString());return this.http.get(`${this.apiUrl}/boutique/${d}/produits/paginated`,{headers:m,params:v}).pipe((0,h.W)(B=>(0,l.$)(400===B.status&&"Cette boutique est d\xe9sactiv\xe9e, ses produits ne sont pas accessibles !"===B.error?.error?()=>new Error("BOUTIQUE_DESACTIVEE"):()=>B)))}))}static{this.\u0275fac=function(s){return new(s||k)(y.KVO(_.Qq),y.KVO(e.g))}}static{this.\u0275prov=y.jDH({token:k,factory:k.\u0275fac,providedIn:"root"})}}return k})()}}]);