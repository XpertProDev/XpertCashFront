"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[8],{37726:(v,p,n)=>{n.d(p,{$:()=>t});var a=n(54438),l=n(345);let t=(()=>{class s{constructor(o){this.sanitizer=o}transform(o){return this.sanitizer.bypassSecurityTrustHtml(o)}static{this.\u0275fac=function(c){return new(c||s)(a.rXU(l.up,16))}}static{this.\u0275pipe=a.EJ8({name:"safeHtml",type:s,pure:!0})}}return s})()},37788:(v,p,n)=>{n.d(p,{j:()=>t});var a=n(84412),l=n(54438);let t=(()=>{class s{constructor(){this.STORAGE_KEY="selectedBoutiqueId",this.selectedBoutiqueSubject=new a.t(this.loadInitial()),this.selectedBoutique$=this.selectedBoutiqueSubject.asObservable()}loadInitial(){const o=localStorage.getItem(this.STORAGE_KEY);if(null!==o){try{sessionStorage.setItem(this.STORAGE_KEY,o)}catch(A){console.warn("Impossible de migrer la boutique depuis localStorage",A)}localStorage.removeItem(this.STORAGE_KEY)}const c=sessionStorage.getItem(this.STORAGE_KEY);return null!==c?Number(c):null}setSelectedBoutique(o){null!==o?sessionStorage.setItem(this.STORAGE_KEY,o.toString()):sessionStorage.removeItem(this.STORAGE_KEY),this.selectedBoutiqueSubject.next(o)}getCurrentValue(){const o=sessionStorage.getItem(this.STORAGE_KEY);return null!==o?Number(o):null}static{this.\u0275fac=function(c){return new(c||s)}}static{this.\u0275prov=l.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})()},12334:(v,p,n)=>{n.d(p,{f:()=>t});var a=n(84412),l=n(54438);let t=(()=>{class s{constructor(){this.caisseCreatedSource=new a.t(null),this.refreshCaissesSource=new a.t(!1),this.showAllCaissesSource=new a.t(!0),this.caisseCreated$=this.caisseCreatedSource.asObservable(),this.refreshCaisses$=this.refreshCaissesSource.asObservable(),this.showAllCaisses$=this.showAllCaissesSource.asObservable()}notifyCaisseCreated(o){this.caisseCreatedSource.next(o)}triggerRefresh(){this.refreshCaissesSource.next(!0)}showAllCaisses(o){this.showAllCaissesSource.next(!!o),console.log("[CaisseStateService] showAllCaisses ->",!!o)}toggleShowAllCaisses(){const o=!this.showAllCaissesSource.getValue();this.showAllCaissesSource.next(o),console.log("[CaisseStateService] toggle ->",o)}getShowAllCaissesValue(){return this.showAllCaissesSource.getValue()}static{this.\u0275fac=function(c){return new(c||s)}}static{this.\u0275prov=l.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})()},35322:(v,p,n)=>{n.d(p,{m:()=>t});var a=n(84412),l=n(54438);let t=(()=>{class s{constructor(){this.paginationState=new a.t({currentPage:1,itemsPerPage:10,totalItems:0}),this.state$=this.paginationState.asObservable()}getState(){return this.paginationState.value}updateState(o){this.paginationState.next({...this.paginationState.value,...o})}setPage(o){const c=Math.max(1,Math.floor(o));this.updateState({currentPage:c})}setItemsPerPage(o){const c=Math.max(1,Math.floor(o));this.updateState({itemsPerPage:c,currentPage:1})}setTotalItems(o){const c=Math.max(0,Math.floor(o));this.updateState({totalItems:c})}reset(){this.paginationState.next({currentPage:1,itemsPerPage:10,totalItems:0})}static{this.\u0275fac=function(c){return new(c||s)}}static{this.\u0275prov=l.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})()},74864:(v,p,n)=>{n.d(p,{U:()=>E});var a=n(21626),l=n(22525),t=n(18810),s=n(25558),g=n(99437),o=n(96354),c=n(54438),A=n(88026);let E=(()=>{class _{constructor(r,e){this.http=r,this.usersService=e,this.apiUrl=l.c.apiBaseUrl}ouvrirCaisse(r){return this.usersService.getValidAccessToken().pipe((0,s.n)(e=>{if(!e)throw new Error("Aucun token trouv\xe9");const i=new a.Lr({Authorization:`Bearer ${e}`});return this.http.post(`${this.apiUrl}/ouvrir`,r,{headers:i})}),(0,g.W)(e=>{console.error("Erreur d\xe9taill\xe9e",e);let i="Erreur lors de l'ouverture de la caisse";return e.error&&e.error.error?i=e.error.error:e.error&&e.error.message?i=e.error.message:e.message&&(i=e.message),(0,t.$)(()=>({message:i,originalError:e}))}))}fermerCaisse(r){return console.log("Tentative de r\xe9cup\xe9ration du token..."),this.usersService.getValidAccessToken().pipe((0,s.n)(e=>{if(!e)throw console.error("Aucun token trouv\xe9"),new Error("Aucun token trouv\xe9");console.log("Token r\xe9cup\xe9r\xe9 :",e);const i=new a.Lr({Authorization:`Bearer ${e}`}),h={boutiqueId:r};return console.log("Envoi de la requ\xeate POST pour fermer la caisse..."),this.http.post(`${this.apiUrl}/fermer`,h,{headers:i}).pipe((0,g.W)(d=>(console.error("Erreur lors de la requ\xeate pour fermer la caisse:",d),(0,t.$)(()=>d))))}),(0,g.W)(e=>{console.error("Erreur d\xe9taill\xe9e dans le service:",e);let i="Erreur lors de la fermeture de la caisse";return e.error&&e.error.error?i=e.error.error:e.error&&e.error.message?i=e.error.message:e.message&&(i=e.message),(0,t.$)(()=>({message:i,originalError:e}))}))}getDerniereCaisseVendeur(r){return this.usersService.getValidAccessToken().pipe((0,s.n)(e=>{if(!e)throw new Error("Aucun token trouv\xe9");const i=new a.Lr({Authorization:`Bearer ${e}`});return this.http.get(`${this.apiUrl}/caisse/derniere/${r}`,{headers:i}).pipe((0,o.T)(h=>h),(0,g.W)(h=>{console.error("HTTP getDerniereCaisseVendeur error ->",h);let d="Erreur inconnue";if(h?.error)if("string"==typeof h.error)d=h.error;else if(h.error?.message)d=h.error.message;else try{d=JSON.stringify(h.error)}catch{d=String(h.error)}else if(h?.message)d=h.message;else try{d=JSON.stringify(h)}catch{d=String(h)}return(0,t.$)(()=>d)}))}))}getCaissesByBoutique(r){return this.usersService.getValidAccessToken().pipe((0,s.n)(e=>{if(!e)throw new Error("Aucun token trouv\xe9");const i=new a.Lr({Authorization:`Bearer ${e}`});return this.http.get(`${this.apiUrl}/boutique/${r}/caisses`,{headers:i})}),(0,g.W)(e=>{let i="Erreur lors du chargement des caisses";return e?.error?.error?i=e.error.error:e?.error?.message?i=e.error.message:e.message&&(i=e.message),(0,t.$)(()=>({message:i,originalError:e}))}))}getHistoriqueCaissesByVendeur(r){return this.usersService.getValidAccessToken().pipe((0,s.n)(e=>{if(!e)throw new Error("Aucun token trouv\xe9");const i=new a.Lr({Authorization:`Bearer ${e}`});return this.http.get(`${this.apiUrl}/vendeur/${r}`,{headers:i})}),(0,g.W)(e=>{let i="Erreur lors du chargement de l'historique des caisses";return e?.error?.error?i=e.error.error:e?.error?.message?i=e.error.message:e.message&&(i=e.message),(0,t.$)(()=>({message:i,originalError:e}))}))}static{this.\u0275fac=function(e){return new(e||_)(c.KVO(a.Qq),c.KVO(A.g))}}static{this.\u0275prov=c.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}}return _})()},52719:(v,p,n)=>{n.d(p,{c:()=>A});var a=n(21626),l=n(25558),t=n(18810),s=n(99437),g=n(22525),o=n(54438),c=n(88026);let A=(()=>{class E{constructor(u,r){this.http=u,this.usersService=r,this.apiUrl=g.c.apiBaseUrl}updateBoutique(u,r){return this.usersService.getValidAccessToken().pipe((0,l.n)(e=>{if(!e)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const i=new a.Lr({Authorization:`Bearer ${e}`});return this.http.put(`${this.apiUrl}/updatedBoutique/${u}`,r,{headers:i})}),(0,s.W)(e=>(console.error("Erreur lors de la mise \xe0 jour de la boutique:",e),(0,t.$)(()=>e))))}getBoutiquesByEntreprise(){return this.usersService.getValidAccessToken().pipe((0,l.n)(u=>{if(!u)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const r=new a.Lr({Authorization:`Bearer ${u}`});return this.http.get(`${this.apiUrl}/boutiqueEntreprise`,{headers:r})}),(0,s.W)(u=>(console.error("Erreur lors de la r\xe9cup\xe9ration des boutiques:",u),(0,t.$)(()=>u))))}getBoutiqueById(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.get(`${this.apiUrl}/boutique/${u}`,{headers:e})}),(0,s.W)(r=>(console.error("Erreur lors de la r\xe9cup\xe9ration de la boutique:",r),(0,t.$)(()=>r))))}activerBoutique(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.put(`${this.apiUrl}/activerBoutique/${u}`,{},{headers:e})}),(0,s.W)(r=>(console.error("Erreur lors de l'activation de la boutique:",r),(0,t.$)(()=>r))))}desactiverBoutique(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.put(`${this.apiUrl}/desactiverBoutique/${u}`,{},{headers:e})}),(0,s.W)(r=>(console.error("Erreur lors de la d\xe9sactivation de la boutique:",r),(0,t.$)(()=>r))))}deleteBoutique(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.delete(`${this.apiUrl}/boutique/${u}`,{headers:e})}),(0,s.W)(r=>(console.error("Erreur lors de la suppression de la boutique:",r),(0,t.$)(()=>r))))}getProductsByBoutiqueId(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.get(`${this.apiUrl}/boutique/${u}/produits`,{headers:e})}),(0,s.W)(r=>(console.error("Erreur lors de la r\xe9cup\xe9ration des produits:",r),(0,t.$)(()=>r))))}copierProduits(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/copier-produits`,u,{headers:e,responseType:"json"})}),(0,s.W)(r=>{if(r.error&&"string"==typeof r.error)try{const e=JSON.parse(r.error);return(0,t.$)(()=>e)}catch{return(0,t.$)(()=>({message:r.error}))}return(0,t.$)(()=>r)}))}mettreEnCorbeille(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.delete(`${this.apiUrl}/corbeille/${u}`,{headers:e})}),(0,s.W)(r=>{let e="Erreur lors de la mise en corbeille";return r.error?.message?e=r.error.message:r.message&&(e=r.message),(0,t.$)(()=>new Error(e))}))}associateUserToBoutique(u,r){return this.http.post(`${this.apiUrl}/boutiques/${u}/users/${r}`,{})}assignerVendeur(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/assigner-vendeur`,u,{headers:e})}),(0,s.W)(r=>(console.error("Erreur lors de l'assignation du vendeur:",r),(0,t.$)(()=>r))))}retirerVendeur(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/retirer-vendeur`,u,{headers:e})}),(0,s.W)(r=>(console.error("Erreur lors de l'assignation du vendeur:",r),(0,t.$)(()=>r))))}getVendeursDeBoutique(u){return this.usersService.getValidAccessToken().pipe((0,l.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.get(`${this.apiUrl}/vendeurs/${u}`,{headers:e}).pipe((0,s.W)(i=>(console.error("Erreur lors de la r\xe9cup\xe9ration des vendeurs:",i),(0,t.$)(()=>i))))}))}getProduitsBoutiquePaginated(u,r=0,e=20){return this.usersService.getValidAccessToken().pipe((0,l.n)(i=>{const h=new a.Lr({Authorization:`Bearer ${i}`}),d=(new a.Nl).set("page",r.toString()).set("size",e.toString());return this.http.get(`${this.apiUrl}/boutique/${u}/produits/paginated`,{headers:h,params:d}).pipe((0,s.W)($=>(0,t.$)(400===$.status&&"Cette boutique est d\xe9sactiv\xe9e, ses produits ne sont pas accessibles !"===$.error?.error?()=>new Error("BOUTIQUE_DESACTIVEE"):()=>$)))}))}static{this.\u0275fac=function(r){return new(r||E)(o.KVO(a.Qq),o.KVO(c.g))}}static{this.\u0275prov=o.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}}return E})()}}]);