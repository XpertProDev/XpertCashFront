"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[1760],{49293:(y,I,a)=>{a.d(I,{R:()=>p});var _=a(21626),m=a(84412),C=a(25558),x=a(18810),O=a(88141),M=a(99437),T=a(71985),D=a(22525),k=a(54438),j=a(88026);let p=(()=>{class l{constructor(u,g){this.http=u,this.usersService=g,this.apiUrl=D.c.apiBaseUrl,this.categoriesSubject=new m.t([]),this.categories$=this.categoriesSubject.asObservable()}ajouterCategorie(u){return this.usersService.getValidAccessToken().pipe((0,C.n)(g=>{if(!g)return console.error("\u26a0\ufe0f Token vide ou non d\xe9fini ! V\xe9rifiez que l'utilisateur est bien connect\xe9."),(0,x.$)(()=>new Error("Aucun token valide trouv\xe9"));const P=new _.Lr({Authorization:`Bearer ${g}`});return this.http.post(`${this.apiUrl}/createCategory`,u,{headers:P}).pipe((0,O.M)(t=>{this.categoriesSubject.next([...this.categoriesSubject.value,t])}))}),(0,M.W)(g=>(console.error("Erreur lors de l'ajout de la cat\xe9gorie:",g),(0,x.$)(()=>g))))}getProduitsByCategorie(u,g=0,P=20){return this.usersService.getValidAccessToken().pipe((0,C.n)(t=>{if(!t)return console.error("\u26a0\ufe0f Token vide ou non d\xe9fini ! V\xe9rifiez que l'utilisateur est bien connect\xe9."),new T.c;const w=(new _.Lr).set("Authorization",`Bearer ${t}`),E={page:g.toString(),size:P.toString()};return this.http.get(`${this.apiUrl}/categories/${u}/produits`,{headers:w,params:E})}),(0,M.W)(t=>(console.error("Erreur lors de la r\xe9cup\xe9ration des produits pagin\xe9s:",t),(0,x.$)(()=>t))))}deleteCategorie(u){return this.usersService.getValidAccessToken().pipe((0,C.n)(g=>{if(!g)return console.error("\u26a0\ufe0f Token JWT manquant pour suppression cat\xe9gorie."),(0,x.$)(()=>new Error("Token manquant"));const P=(new _.Lr).set("Authorization",`Bearer ${g}`);return console.log("\u{1f539} Token envoy\xe9 pour DELETE cat\xe9gorie :",P),this.http.delete(`${this.apiUrl}/deleteCategory/${u}`,{headers:P,responseType:"text"})}),(0,M.W)(g=>(console.error("\u274c Erreur API DELETE :",g),(0,x.$)(()=>g))))}getCategories(){return this.usersService.getValidAccessToken().pipe((0,C.n)(u=>{if(!u)return console.error("\u26a0\ufe0f Token vide ou non d\xe9fini ! V\xe9rifiez que l'utilisateur est bien connect\xe9."),(0,x.$)(()=>new Error("Aucun token valide trouv\xe9"));const g=(new _.Lr).set("Authorization",`Bearer ${u}`);return this.http.get(`${this.apiUrl}/allCategory`,{headers:g}).pipe((0,O.M)(P=>{this.categoriesSubject.next(P)}))}),(0,M.W)(u=>(console.error("Erreur lors de la r\xe9cup\xe9ration des cat\xe9gories:",u),(0,x.$)(()=>u))))}getCategoriesWithCounts(){return this.usersService.getValidAccessToken().pipe((0,C.n)(u=>{if(!u)return console.error("\u26a0\ufe0f Token vide ou non d\xe9fini ! V\xe9rifiez que l'utilisateur est bien connect\xe9."),(0,x.$)(()=>new Error("Aucun token valide trouv\xe9"));const g=(new _.Lr).set("Authorization",`Bearer ${u}`);return this.http.get(`${this.apiUrl}/categories/count`,{headers:g}).pipe((0,O.M)(P=>{console.log("\u{1f4ca} Compteurs de cat\xe9gories r\xe9cup\xe9r\xe9s:",P),this.categoriesSubject.next(P)}))}),(0,M.W)(u=>(console.error("Erreur lors de la r\xe9cup\xe9ration des compteurs de cat\xe9gories:",u),(0,x.$)(()=>u))))}static{this.\u0275fac=function(g){return new(g||l)(k.KVO(_.Qq),k.KVO(j.g))}}static{this.\u0275prov=k.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})()},66375:(y,I,a)=>{a.d(I,{D:()=>D});var _=a(21626),m=a(25558),C=a(99437),x=a(18810),O=a(22525),M=a(54438),T=a(88026);let D=(()=>{class k{constructor(p,l){this.http=p,this.usersService=l,this.apiUrl=O.c.apiBaseUrl}ajouterProduit(p,l,f,u,g,P,t){const w=`${this.apiUrl}/create?addToStock=${P}`,E=new FormData;return E.append("boutiqueIds",JSON.stringify(p)),E.append("quantites",JSON.stringify(l)),E.append("produit",JSON.stringify(u)),E.append("seuilAlert",JSON.stringify(f)),g&&E.append("image",g,g.name),t&&E.append("datePreemption",t),this.usersService.getValidAccessToken().pipe((0,m.n)(B=>{const F=new _.Lr({Authorization:`Bearer ${B}`});return this.http.post(w,E,{headers:F})}))}modifierProduit(p,l){const f=new FormData,{id:u,...g}=p;return f.append("produit",JSON.stringify(g)),f.append("addToStock",p.enStock?"true":"false"),l&&f.append("image",l,l.name),this.usersService.getValidAccessToken().pipe((0,m.n)(P=>{const t=new _.Lr({Authorization:`Bearer ${P}`});return this.http.patch(`${this.apiUrl}/updateProduit/${p.id}`,f,{headers:t})}))}getProduitById(p){return this.usersService.getValidAccessToken().pipe((0,m.n)(l=>{const f=new _.Lr({Authorization:`Bearer ${l}`});return this.http.get(`${this.apiUrl}/produits/${p}`,{headers:f})}))}getProduitsEntreprise(p){return this.usersService.getValidAccessToken().pipe((0,m.n)(l=>{const f=new _.Lr({Authorization:`Bearer ${l}`});return this.http.get(`${this.apiUrl}/produits/${p}/stock`,{headers:f}).pipe((0,C.W)(u=>(0,x.$)(400===u.status&&"Cette boutique est d\xe9sactiv\xe9e, ses produits ne sont pas accessibles !"===u.error?.error?()=>new Error("BOUTIQUE_DESACTIVEE"):()=>u)))}))}getProduitBoutique(p){return this.usersService.getValidAccessToken().pipe((0,m.n)(l=>{const f=new _.Lr({Authorization:`Bearer ${l}`});return this.http.get(`${this.apiUrl}/produits/${p}/totaux-stock`,{headers:f})}))}getProduitsByEntrepriseId(p){return this.usersService.getValidAccessToken().pipe((0,m.n)(l=>{const f=new _.Lr({Authorization:`Bearer ${l}`});return this.http.get(`${this.apiUrl}/produits/entreprise/${p}`,{headers:f})}))}getProduitsParEntreprise(p){return this.usersService.getValidAccessToken().pipe((0,m.n)(l=>{const f=new _.Lr({Authorization:`Bearer ${l}`});return this.http.get(`${this.apiUrl}/produits/entreprise/${p}`,{headers:f})}))}getFournisseurs(){return this.usersService.getValidAccessToken().pipe((0,m.n)(p=>{const l=new _.Lr({Authorization:`Bearer ${p}`});return this.http.get(`${this.apiUrl}/get-fournisseurs`,{headers:l})}))}importProduitsFromExcel(p,l){return this.usersService.getValidAccessToken().pipe((0,m.n)(f=>{const u=new _.Lr({Authorization:`Bearer ${f}`});return p.append("boutiqueIds",JSON.stringify(l)),this.http.post(`${this.apiUrl}/import-produits-excel`,p,{headers:u})}))}getProduitsByEntrepriseIdPaginated(p,l=0,f=20){return this.usersService.getValidAccessToken().pipe((0,m.n)(u=>{const g=new _.Lr({Authorization:`Bearer ${u}`}),P=(new _.Nl).set("page",l.toString()).set("size",f.toString());return this.http.get(`${this.apiUrl}/entreprise/${p}/produits/paginated`,{headers:g,params:P})}))}getProduitsEntreprisePaginated(p,l=0,f=20){return this.usersService.getValidAccessToken().pipe((0,m.n)(u=>{const g=new _.Lr({Authorization:`Bearer ${u}`}),P=(new _.Nl).set("page",l.toString()).set("size",f.toString());return this.http.get(`${this.apiUrl}/boutique/${p}/produits/paginated`,{headers:g,params:P}).pipe((0,C.W)(t=>(0,x.$)(400===t.status&&"Cette boutique est d\xe9sactiv\xe9e, ses produits ne sont pas accessibles !"===t.error?.error?()=>new Error("BOUTIQUE_DESACTIVEE"):()=>t)))}))}static{this.\u0275fac=function(l){return new(l||k)(M.KVO(_.Qq),M.KVO(T.g))}}static{this.\u0275prov=M.jDH({token:k,factory:k.\u0275fac,providedIn:"root"})}}return k})()},21760:(y,I,a)=>{a.r(I),a.d(I,{StocksComponent:()=>at});var _=a(10467),m=a(89417),C=a(49192),x=a(9159),O=a(60177),M=a(60850),T=a(30636),D=a(99631),k=a(82798),j=a(89107),p=a(62288),l=a(34941),f=a.n(l),u=a(96115),g=a(85837),P=a(22525),t=a(54438),w=a(49293),E=a(66375),B=a(88026),F=a(75351);const A=["searchInput"];function R(r,h){if(1&r){const e=t.RV6();t.j41(0,"i",37),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.rafraichirProduits())}),t.k0s()}}function $(r,h){1&r&&t.nrm(0,"i",38)}function U(r,h){if(1&r){const e=t.RV6();t.j41(0,"div",39)(1,"div",40),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.downloadExcel())}),t.EFF(2,"T\xe9l\xe9charger en Excel"),t.k0s(),t.j41(3,"div",40),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.downloadPDF())}),t.EFF(4,"T\xe9l\xe9charger en PDF"),t.k0s(),t.j41(5,"div",40),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.downloadCSV())}),t.EFF(6,"T\xe9l\xe9charger en CSV"),t.k0s()()}}function L(r,h){if(1&r){const e=t.RV6();t.j41(0,"span",41),t.EFF(1),t.j41(2,"span",42),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.removeFilter(n.selectedFilters[0]))}),t.EFF(3,"\u2716"),t.k0s()()}if(2&r){const e=t.XpG();t.R7$(),t.SpI(" ",e.selectedFilters[0].label," ")}}function q(r,h){1&r&&t.nrm(0,"i",43)}function z(r,h){1&r&&t.nrm(0,"i",44)}function N(r,h){if(1&r){const e=t.RV6();t.j41(0,"div",45),t.bIt("click",function(n){return t.eBV(e),t.Njj(n.stopPropagation())}),t.j41(1,"div",46)(2,"div",47)(3,"h4",48),t.EFF(4,"Filtres"),t.k0s(),t.j41(5,"div")(6,"button",49),t.bIt("click",function(n){return t.eBV(e),t.XpG().resetFilters(),t.Njj(n.stopPropagation())}),t.EFF(7," R\xe9initialiser "),t.k0s()()(),t.j41(8,"ul",50)(9,"li",51),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addFilter({type:"nomCategorie",label:"Cat\xe9gorie"}))}),t.EFF(10," Cat\xe9gorie "),t.k0s(),t.j41(11,"li",52),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.addFilter({type:"nomUnite",label:"Unit\xe9"}))}),t.EFF(12," Unit\xe9 "),t.k0s()()()()}if(2&r){const e=t.XpG();t.R7$(9),t.xc7("background",e.isFilterSelected("nomCategorie")?"#f0f0f0":"transparent"),t.AVh("disabled",e.isFilterSelected("nomCategorie")),t.R7$(2),t.xc7("background",e.isFilterSelected("nomUnite")?"#f0f0f0":"transparent"),t.AVh("disabled",e.isFilterSelected("nomUnite"))}}function V(r,h){if(1&r&&(t.j41(0,"span",57),t.EFF(1),t.k0s()),2&r){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.totalAllProducts," ")}}function G(r,h){1&r&&(t.j41(0,"span",57),t.nrm(1,"i",58),t.k0s())}function W(r,h){if(1&r&&(t.j41(0,"span",57),t.EFF(1),t.k0s()),2&r){const e=t.XpG().$implicit,o=t.XpG(2);t.R7$(),t.SpI(" ",o.productCounts[e.id]," ")}}function K(r,h){1&r&&t.nrm(0,"i",62)}function X(r,h){1&r&&t.nrm(0,"div",63)}function Y(r,h){if(1&r){const e=t.RV6();t.qex(0),t.j41(1,"p",59),t.bIt("click",function(){const n=t.eBV(e).$implicit,i=t.XpG(2);return t.Njj(n.actif?i.selectBoutique(n):i.showSuspendedBoutiqueDialog())}),t.EFF(2),t.DNE(3,W,2,1,"span",55)(4,K,1,0,"i",60),t.k0s(),t.DNE(5,X,1,0,"div",61),t.bVm()}if(2&r){const e=h.$implicit,o=h.index,n=t.XpG(2);t.R7$(),t.xc7("color",e.actif),t.AVh("name_boutique_active",e.id===(null==n.selectedBoutique?null:n.selectedBoutique.id)&&e.actif)("suspended-boutique",!e.actif),t.R7$(),t.SpI(" ",e.nomBoutique," "),t.R7$(),t.Y8G("ngIf",n.productCounts[e.id]>0),t.R7$(),t.Y8G("ngIf",!e.actif),t.R7$(),t.Y8G("ngIf",o!==n.boutiques.length-1)}}function H(r,h){if(1&r){const e=t.RV6();t.qex(0),t.j41(1,"div",53),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.selectBoutique(null))}),t.j41(2,"p",54),t.EFF(3," Toutes les boutiques "),t.DNE(4,V,2,1,"span",55)(5,G,2,0,"span",55),t.k0s()(),t.DNE(6,Y,6,10,"ng-container",56),t.bVm()}if(2&r){const e=t.XpG();t.R7$(),t.AVh("name_boutique_active",null===e.selectedBoutique),t.R7$(3),t.Y8G("ngIf",!e.isLoadingCounts&&e.totalAllProducts>0),t.R7$(),t.Y8G("ngIf",e.isLoadingCounts),t.R7$(),t.Y8G("ngForOf",e.boutiquesSansEntrepots)}}function J(r,h){1&r&&(t.j41(0,"p",64),t.EFF(1,"Aucune boutique trouv\xe9e"),t.k0s())}function Q(r,h){if(1&r&&t.nrm(0,"i"),2&r){const e=t.XpG();t.HbH("asc"===e.sortDirection?"ri-arrow-up-line":"ri-arrow-down-line")}}function Z(r,h){1&r&&(t.qex(0),t.j41(1,"th"),t.EFF(2,"Boutique"),t.k0s(),t.bVm())}function tt(r,h){if(1&r){const e=t.RV6();t.j41(0,"div",70)(1,"div",71),t.bIt("click",function(n){return t.eBV(e),t.Njj(n.stopPropagation())}),t.nrm(2,"img",72),t.k0s()()}if(2&r){const e=t.XpG(2);t.R7$(2),t.Y8G("src",e.imagePopup,t.B4B)}}function et(r,h){if(1&r&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&r){const e=t.XpG().$implicit,o=t.XpG();t.R7$(),t.JRh(o.getBoutiqueNames(e.boutiques))}}function nt(r,h){if(1&r){const e=t.RV6();t.j41(0,"tr",30),t.bIt("click",function(){const n=t.eBV(e).$implicit,i=t.XpG();return t.Njj(i.openStockDetail(n.id))}),t.nrm(1,"td",65),t.j41(2,"td")(3,"div",66),t.nrm(4,"img",67),t.k0s(),t.DNE(5,tt,3,1,"div",68),t.k0s(),t.nrm(6,"td",65)(7,"td",65),t.j41(8,"td"),t.EFF(9),t.nI1(10,"customNumber"),t.k0s(),t.j41(11,"td"),t.EFF(12),t.nI1(13,"customNumber"),t.k0s(),t.nrm(14,"td",69)(15,"td",65),t.j41(16,"td"),t.EFF(17),t.k0s(),t.qex(18),t.DNE(19,et,2,1,"td",33),t.bVm(),t.k0s()}if(2&r){const e=h.$implicit,o=t.XpG();t.R7$(),t.Y8G("innerHTML",o.highlightMatch(e.codeGenerique||""),t.npT),t.R7$(3),t.Y8G("src",e.photo,t.B4B),t.R7$(),t.Y8G("ngIf",o.imagePopup),t.R7$(),t.Y8G("innerHTML",o.highlightMatch(e.nom),t.npT),t.R7$(),t.Y8G("innerHTML",o.highlightMatch(e.nomCategorie||"sans categorie"),t.npT),t.R7$(2),t.JRh(t.bMT(10,11,e.prixVente)),t.R7$(3),t.JRh(t.bMT(13,13,e.prixAchat)),t.R7$(2),t.Y8G("innerHTML",o.highlightMatch(e.quantite.toString()),t.npT),t.R7$(),t.Y8G("innerHTML",o.highlightMatch(e.nomUnite||"sans unite"),t.npT),t.R7$(2),t.JRh(e.seuilAlert),t.R7$(2),t.Y8G("ngIf",!o.selectedBoutique)}}function ot(r,h){1&r&&(t.j41(0,"tr")(1,"td",73),t.EFF(2,"Aucun produit trouv\xe9e."),t.k0s()())}function it(r,h){1&r&&(t.j41(0,"div",74)(1,"p",75),t.EFF(2,"Vous n'avez pas de produit"),t.k0s()())}function rt(r,h){if(1&r){const e=t.RV6();t.j41(0,"button",95),t.bIt("click",function(){const n=t.eBV(e).$implicit,i=t.XpG(2);return t.Njj(i.goToPage(n))}),t.EFF(1),t.k0s()}if(2&r){const e=h.$implicit,o=t.XpG(2);t.AVh("active",e===o.currentPage),t.Y8G("disabled","..."===e),t.R7$(),t.SpI(" ",e," ")}}function st(r,h){if(1&r){const e=t.RV6();t.j41(0,"div",76)(1,"div",77)(2,"span"),t.EFF(3,"Produits par page:"),t.k0s(),t.j41(4,"select",78),t.mxI("ngModelChange",function(n){t.eBV(e);const i=t.XpG();return t.DH7(i.pageSize,n)||(i.pageSize=n),t.Njj(n)}),t.bIt("change",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.onPageSizeChange())}),t.j41(5,"option",79),t.EFF(6,"5"),t.k0s(),t.j41(7,"option",80),t.EFF(8,"10"),t.k0s(),t.j41(9,"option",81),t.EFF(10,"20"),t.k0s(),t.j41(11,"option",82),t.EFF(12,"50"),t.k0s()(),t.j41(13,"span",83),t.EFF(14),t.k0s()(),t.j41(15,"div",84)(16,"button",85),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.goToPage(0))}),t.nrm(17,"i",86),t.k0s(),t.j41(18,"button",87),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.goToPage(n.currentPage-1))}),t.nrm(19,"i",88),t.k0s(),t.j41(20,"div",89),t.DNE(21,rt,2,4,"button",90),t.k0s(),t.j41(22,"button",91),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.goToPage(n.currentPage+1))}),t.nrm(23,"i",92),t.k0s(),t.j41(24,"button",93),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.goToPage(n.totalPages-1))}),t.nrm(25,"i",94),t.k0s()()()}if(2&r){const e=t.XpG();t.R7$(4),t.R50("ngModel",e.pageSize),t.R7$(10),t.JRh(e.getPageInfo()),t.R7$(2),t.Y8G("disabled",0===e.currentPage),t.R7$(2),t.Y8G("disabled",0===e.currentPage),t.R7$(3),t.Y8G("ngForOf",e.getVisiblePages()),t.R7$(),t.Y8G("disabled",e.currentPage>=e.totalPages-1),t.R7$(2),t.Y8G("disabled",e.currentPage>=e.totalPages-1)}}let at=(()=>{class r{get currentPage(){return this._currentPage}set currentPage(e){this._currentPage=e}onClick(e){const o=e.target;!o.closest(".container_inputSearch")&&!o.closest(".filter-dropdown")&&!o.closest(".trier")&&(this.showFilterDropdown=!1),o.closest(".export-container")||(this.showExportDropdown=!1)}constructor(e,o,n,i,s,c,d){this.categorieService=e,this.produitService=o,this.fb=n,this.router=i,this.usersService=s,this.dialog=c,this.cdr=d,this.backendUrl=P.c.apiBaseUrl,this.searchText="",this.tasks=[],this.imagePopup=null,this.nomEntreprise="",this.adresseEntreprise="",this.logoEntreprise="",this.userName="",this.boutiqueName="",this.addressBoutique="",this.dataSource=new x.I6,this.pageSize=20,this.totalElements=0,this.totalPages=0,this.totalProduitsEnStock=0,this._currentPage=0,this.selectedBoutique=null,this.boutiques=[],this.showExportDropdown=!1,this.urllink="assets/img/appareil.jpg",this.newPhotoUrl=null,this.selectedFile=null,this.showDescription=!1,this.apiUrl=P.c.imgUrl,this.showNoProductsMessage=!1,this.showFilterDropdown=!1,this.selectedFilters=[],this.allProducts=[],this.filteredProduct=[],this.sortColumn=null,this.sortDirection="asc",this.productCounts={},this.isLoading=!1,this.isLoadingCounts=!1,this._lastPageRequestId=0,this.entrepriseId=null}ngOnInit(){this.getUserBoutiqueId(),this.getUserInfo()}highlightMatch(e){if(!this.searchText)return e;const o=new RegExp(`(${this.searchText})`,"gi");return e.replace(o,"<mark>$1</mark>")}filteredProducts(){if(!this.tasks)return[];if("number"==typeof this.totalPages&&this.totalPages>1||"number"==typeof this.totalElements&&this.totalElements>this.pageSize)return this.tasks;const o=this.currentPage*this.pageSize;return this.tasks.slice(o,o+this.pageSize)}toggleExportDropdown(){this.showExportDropdown=!this.showExportDropdown}onClickOutside(e){e.target.closest(".export-container")||(this.showExportDropdown=!1)}getImageBase64(e){return new Promise((o,n)=>{const i=new XMLHttpRequest;i.onload=function(){const s=new FileReader;s.onloadend=function(){o(s.result)},s.readAsDataURL(i.response)},i.onerror=function(){n(new Error("Erreur lors du chargement de l'image"))},i.open("GET",e),i.responseType="blob",i.send()})}downloadExcel(){const e=p.Wp.json_to_sheet(this.tasks),o=p.Wp.book_new();p.Wp.book_append_sheet(o,e,"Produits"),p._h(o,"Produits.xlsx")}downloadPDF(){if(!this.tasks||0===this.tasks.length)return void console.error("Aucun produit \xe0 afficher dans le PDF !");const e=new j.default,n=this.nomEntreprise||"Nom non disponible";this.getImageBase64(this.logoEntreprise?`${this.backendUrl}/logoUpload/${this.logoEntreprise}`:`${this.backendUrl}/logoUpload/651.jpg`).then(i=>{e.addImage(i,"PNG",14,5,30,30),e.setFontSize(18),e.setFont("helvetica","bold"),e.text(`Nom de l'entreprise: ${n}`,60,20),e.text("Liste des produits en Stock",60,30),e.setLineWidth(.5),e.line(14,35,195,35);const c=this.currentPage*this.pageSize,d=this.tasks.slice(c,c+this.pageSize);if(!Array.isArray(d)||0===d.length)return void console.error("Aucun produit trouv\xe9 sur cette page !");const b=d.map(v=>[v.codeGenerique||"",v.nom||"",v.description||"",v.nomCategorie?`Cat\xe9gorie ${v.nomCategorie}`:"Cat\xe9gorie inconnue",v.quantite??0]);f()(e,{head:[["Code","Nom produit","Description","Cat\xe9gorie","Quantit\xe9"]],body:b,startY:40,theme:"grid",headStyles:{fillColor:[100,100,255],textColor:[255,255,255],fontSize:12},bodyStyles:{fontSize:10}});const S=e.lastAutoTable?.finalY||60;e.setLineWidth(.5),e.line(14,S+5,195,S+5),e.setFontSize(10),e.setFont("helvetica","italic"),e.text(`Nom de Boutique: ${this.boutiqueName}`,14,S+10),e.text(`Adress: ${this.addressBoutique}`,14,S+15),e.save("Produits.pdf")}).catch(i=>{console.error("Erreur lors du chargement du logo :",i)})}downloadCSV(){const o=this.tasks.map(c=>[c.codeGenerique||"",c.photo,c.nom,c.nomCategorie||"",c.description,c.prixVente,c.prixAchat,c.quantite,c.nomUnite||"",c.seuilAlert,c.createdAt]),n=[["Code","Photo","Nom produit","Cat\xe9gorie","Description","Prix Vente","Prix Achat","Quantit\xe9","Unit\xe9","Seuil Alerte","Date & heure"].join(","),...o.map(c=>c.join(","))].join("\n"),i=new Blob([n],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(i),s.download="Produits.csv",s.click()}goToPage(e){if("..."===e)return;const o=Number(e);if(isNaN(o)||o<0||this.totalPages&&o>=this.totalPages)return;this.currentPage=o,this.isLoading=!0;const n=++this._lastPageRequestId;console.log("[pagination] requestedPage=",o,"reqId=",n),this.selectedBoutique?this.loadProduitsPaginated(this.selectedBoutique.id,o,this.pageSize,o,n):this.loadAllProduitsPaginated(o,this.pageSize,o,n)}onPageSizeChange(){this.currentPage=0,this.selectedBoutique?this.loadProduitsPaginated(this.selectedBoutique.id,0,this.pageSize):this.loadAllProduitsPaginated(0,this.pageSize)}getPageInfo(){return`${this.currentPage*this.pageSize+1} - ${Math.min((this.currentPage+1)*this.pageSize,this.totalProduitsEnStock)} / ${this.totalProduitsEnStock}`}getVisiblePages(){const e=[],o=this.totalPages,n=this.currentPage;if(o<=7)for(let i=0;i<o;i++)e.push(i);else if(n<=3){for(let i=0;i<5;i++)e.push(i);e.push("..."),e.push(o-1)}else if(n>=o-4){e.push(0),e.push("...");for(let i=o-5;i<o;i++)e.push(i)}else{e.push(0),e.push("...");for(let i=n-1;i<=n+1;i++)e.push(i);e.push("..."),e.push(o-1)}return e}onFileSelected(e){const o=e.target;if(o.files&&o.files.length>0){this.selectedFile=o.files[0];const n=new FileReader;n.onload=i=>{this.newPhotoUrl=i.target?.result},n.readAsDataURL(this.selectedFile)}}getUserBoutiqueId(){const e=JSON.parse(localStorage.getItem("user")||"{}");return e&&e.boutiques&&e.boutiques.length>0?e.boutiques[0]?.id||null:(console.error("Aucune boutique trouv\xe9e pour cet utilisateur"),null)}getEntrepriseId(){return JSON.parse(localStorage.getItem("user")||"{}").entrepriseId||null}getUserInfo(){var o,e=this;this.usersService.getUserInfo().subscribe({next:(o=(0,_.A)(function*(n){console.log("Donn\xe9es re\xe7ues:",n),localStorage.setItem("user",JSON.stringify(n)),e.userName=n.nomComplet,e.nomEntreprise=n.nomEntreprise,e.boutiques=n.boutiques??[],e.entrepriseId=n.entrepriseId,yield e.loadAllBoutiquesCounts(),e.selectBoutique(null),e.entrepriseId?(e.addressBoutique=e.selectedBoutique?.adresse||"Adresse non trouv\xe9e",setTimeout(()=>{e.showNoProductsMessage=0===e.tasks.length,e.cdr.detectChanges()},500)):console.error("Aucun ID entreprise trouv\xe9 !")}),function(i){return o.apply(this,arguments)}),error:o=>{this.boutiques=[],console.error("Erreur lors de la r\xe9cup\xe9ration des informations utilisateur :",o),setTimeout(()=>{this.showNoProductsMessage=0===this.tasks.length,this.cdr.detectChanges()},500)}})}loadProduits(e){this.showNoProductsMessage=!1,e?this.produitService.getProduitsEntreprise(e).subscribe({next:o=>{console.log("Produits r\xe9cup\xe9r\xe9s:",o),this.tasks=o.filter(n=>n.enStock).map(n=>({id:n.id,codeGenerique:n.codeGenerique||"",codeBare:n.codeBare||"Non num\xe9ro code barre",nom:n.nom||"Nom inconnu",description:n.description||"Sans description",prixVente:n.prixVente||0,prixAchat:n.prixAchat||0,quantite:n.quantite||0,seuilAlert:n.seuilAlert||0,enStock:n.enStock||!1,photo:(n.photo&&"null"!==n.photo&&"undefined"!==n.photo?`${this.apiUrl}${n.photo}`:"")||this.generateLetterAvatar(n.nom),nomCategorie:n.nomCategorie||"Aucune categorie",nomUnite:n.nomUnite||"Sans unit\xe9",createdAt:n.createdAt||(new Date).toISOString(),categorieId:n.categorieId,uniteId:n.uniteId,boutiqueId:n.boutiqueId,boutiques:n.boutiques||[]})).sort((n,i)=>new Date(i.createdAt).getTime()-new Date(n.createdAt).getTime()),this.productCounts[e]=o.filter(n=>n.enStock).length,this.allProducts=[...this.tasks],this.dataSource.data=this.tasks,this.showNoProductsMessage=0===this.tasks.length},error:o=>{console.error("Erreur lors de la r\xe9cup\xe9ration des produits",o),this.showNoProductsMessage=0===this.tasks.length}}):console.error("L'ID de la boutique est manquant")}selectBoutique(e){!e||e.actif?(this.selectedBoutique=e,this.boutiqueName=null===e?"Toutes les boutiques":e.nomBoutique?e.nomBoutique:"Boutique sans nom",this.goToPage(0)):this.showSuspendedBoutiqueDialog()}toggleFilterDropdown(){this.showFilterDropdown=!this.showFilterDropdown,this.showExportDropdown=!1}loadAllBoutiquesCounts(){var e=this;return(0,_.A)(function*(){if(!e.entrepriseId)return;e.isLoadingCounts=!0;const o={...e.productCounts};e.boutiquesActivesSansEntrepots.forEach(n=>{e.productCounts[n.id]=0});try{const n=e.boutiquesActivesSansEntrepots.map(s=>e.produitService.getProduitsEntreprisePaginated(s.id,0,1).toPromise());(yield Promise.all(n)).forEach((s,c)=>{s&&(e.productCounts[e.boutiquesActivesSansEntrepots[c].id]=s.totalProduitsEnStock)}),e.cdr.detectChanges()}catch(n){console.error("Erreur lors du chargement des compteurs:",n),e.productCounts=o}finally{e.isLoadingCounts=!1}})()}loadAllProduitsPaginated(){var e=this;return(0,_.A)(function*(o=0,n=20,i,s){if(e.showNoProductsMessage=!1,!e.entrepriseId)return console.error("ID entreprise manquant"),void(e.isLoading=!1);e.isLoading=!0,yield e.loadAllBoutiquesCounts(),e.produitService.getProduitsByEntrepriseIdPaginated(e.entrepriseId,o,n).subscribe({next:c=>{"number"!=typeof s||s===e._lastPageRequestId?(console.log("[pagination] loadAllProduitsPaginated response pageNumber=",c.pageNumber,"totalPages=",c.totalPages),e.tasks=c.content.filter(d=>d.enStock).map(d=>{const S=d.photo&&"null"!==d.photo&&"undefined"!==d.photo?`${e.apiUrl}${d.photo}`:"";return{...d,photo:S||e.generateLetterAvatar(d.nom),boutiques:d.boutiques||[]}}),e.pageSize=c.pageSize,e.totalElements=c.totalElements,e.totalPages=c.totalPages,e.totalProduitsEnStock=e.totalAllProducts,e.currentPage="number"==typeof i?Math.min(Math.max(0,i),Math.max(0,e.totalPages-1)):Math.min(Math.max(0,e.currentPage),Math.max(0,e.totalPages-1)),e.dataSource.data=e.tasks,e.showNoProductsMessage=0===e.tasks.length,e.allProducts=[...e.tasks],e.resetFilters(),e.isLoading=!1,e.cdr.detectChanges()):console.log("[pagination] Ignoring stale loadAllProduitsPaginated response reqId=",s,"current=",e._lastPageRequestId)},error:c=>{"number"!=typeof s||s===e._lastPageRequestId?(console.error("Erreur :",c),e.showNoProductsMessage=0===e.tasks.length,e.isLoading=!1,e.cdr.detectChanges()):console.log("[pagination] Ignoring stale error for reqId=",s)}})}).apply(this,arguments)}loadProduitsPaginated(e,o=0,n=20,i,s){return this.showNoProductsMessage=!1,e?"ENTREPOT"===this.boutiques.find(d=>d.id===e)?.typeBoutique?(this.tasks=[],this.dataSource.data=[],this.productCounts[e]=0,this.showNoProductsMessage=!0,void(this.isLoading=!1)):(this.isLoading=!0,void this.produitService.getProduitsEntreprisePaginated(e,o,n).subscribe({next:d=>{"number"!=typeof s||s===this._lastPageRequestId?(console.log("[pagination] loadProduitsPaginated response pageNumber=",d.pageNumber,"totalPages=",d.totalPages),this.tasks=d.content.filter(b=>b.enStock).map(b=>{const v=b.photo&&"null"!==b.photo&&"undefined"!==b.photo?`${this.apiUrl}${b.photo}`:"";return{...b,photo:v||this.generateLetterAvatar(b.nom),boutiques:b.boutiques||[]}}),this.pageSize=d.pageSize,this.totalElements=d.totalElements,this.totalPages=d.totalPages,this.totalProduitsEnStock=d.totalProduitsEnStock,this.currentPage="number"==typeof i?Math.min(Math.max(0,i),Math.max(0,this.totalPages-1)):Math.min(Math.max(0,this.currentPage),Math.max(0,this.totalPages-1)),this.productCounts[e]=d.totalProduitsEnStock,this.dataSource.data=this.tasks,this.isLoading=!1,this.allProducts=[...this.tasks],this.resetFilters(),this.showNoProductsMessage=0===this.tasks.length,this.cdr.detectChanges()):console.log("[pagination] Ignoring stale loadProduitsPaginated response reqId=",s,"current=",this._lastPageRequestId)},error:d=>{if("number"!=typeof s||s===this._lastPageRequestId)return this.isLoading=!1,"BOUTIQUE_DESACTIVEE"===d.message?(this.showSuspendedBoutiqueDialog(),void(this.selectedBoutique=null)):(console.error("Erreur :",d),this.showNoProductsMessage=0===this.tasks.length,void this.cdr.detectChanges());console.log("[pagination] Ignoring stale error for reqId=",s)}})):(console.error("L'ID de la boutique est manquant"),void(this.isLoading=!1))}getBoutiqueNames(e){return e&&0!==e.length?e.length>2?`${e.slice(0,2).map(i=>i.nom).join(", ")}, ...`:e.map(n=>n.nom).join(", "):"Aucune boutique"}generateLetterAvatar(e){const n=`\n      <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">\n        <rect width="100" height="100" fill="#0671e4ac"/>\n        <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#fff" font-size="50">${e?e.charAt(0).toUpperCase():"?"}</text>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(n)}`}openStockDetail(e){this.router.navigate(["/detail-stock",e],{queryParams:this.selectedBoutique?{boutiqueId:this.selectedBoutique.id}:{}})}showSuspendedBoutiqueDialog(){this.dialog.open(g.F,{width:"400px",disableClose:!0,data:{onClose:()=>{this.selectedBoutique=null}}})}applyFilters(){let e=[...this.allProducts];const o=this.searchText.toLowerCase();this.searchText&&(e=e.filter(this.selectedFilters.length>0?n=>this.selectedFilters.every(i=>{const s=i.type;return(n[s]?.toString().toLowerCase()||"").includes(o)}):n=>Object.values(n).some(i=>i?.toString().toLowerCase().includes(o)))),this.sortColumn&&e.sort((n,i)=>{const s=this.sortColumn,c=n[s]?.toString().toLowerCase()||"",d=i[s]?.toString().toLowerCase()||"";return c<d?"asc"===this.sortDirection?-1:1:c>d?"asc"===this.sortDirection?1:-1:0}),this.tasks=e,this.filteredProduct=e,this.currentPage=0}resetFilters(e=!1){this.selectedFilters=[],this.searchText="",this.tasks=[...this.allProducts],e&&(this.currentPage=0),this.showFilterDropdown=!1}setSorting(e){this.sortColumn===e?this.sortDirection="asc"===this.sortDirection?"desc":"asc":(this.sortColumn=e,this.sortDirection="asc"),this.applyFilters()}addFilter(e){this.selectedFilters=this.isFilterSelected(e.type)?[]:[e],this.showFilterDropdown=!1,this.applyFilters(),setTimeout(()=>{this.searchInput?.nativeElement&&this.searchInput.nativeElement.focus()},0)}isFilterSelected(e){return this.selectedFilters.some(o=>o.type===e)}focusSearchInput(){this.searchInput?.nativeElement&&this.searchInput.nativeElement.focus()}removeFilter(e){this.selectedFilters=this.selectedFilters.filter(o=>o!==e),this.applyFilters()}getSearchPlaceholder(){return this.selectedFilters.length>0?`Par ${this.selectedFilters.map(e=>e.label).join(", ")}...`:"Recherche..."}get boutiquesSansEntrepots(){return this.boutiques?.filter(e=>"ENTREPOT"!==e.typeBoutique)||[]}get boutiquesActivesSansEntrepots(){return this.boutiques?.filter(e=>"ENTREPOT"!==e.typeBoutique&&e.actif)||[]}get totalAllProducts(){return this.isLoadingCounts||!this.boutiquesActivesSansEntrepots.length?0:this.boutiquesActivesSansEntrepots.map(e=>this.productCounts[e.id]||0).reduce((e,o)=>e+o,0)}rafraichirProduits(){var e=this;return(0,_.A)(function*(){e.showNoProductsMessage=!1,e.goToPage(e.currentPage)})()}static{this.\u0275fac=function(o){return new(o||r)(t.rXU(w.R),t.rXU(E.D),t.rXU(m.ok),t.rXU(C.Ix),t.rXU(B.g),t.rXU(F.bZ),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-stocks"]],viewQuery:function(o,n){if(1&o&&t.GBs(A,5),2&o){let i;t.mGM(i=t.lsd())&&(n.searchInput=i.first)}},hostBindings:function(o,n){1&o&&t.bIt("click",function(s){return n.onClickOutside(s)},!1,t.EBC)},decls:60,vars:17,consts:[["searchInput",""],["noBoutiques",""],[1,"containerTable"],[1,"tasks-header"],[1,"title"],[1,"actions"],["routerLink","/stock_ajustement",1,"add-task"],[1,"contentIcon"],["class","ri-refresh-line",3,"click",4,"ngIf"],["class","ri-loader-line ri-spin",4,"ngIf"],[1,"bare"],[1,"export-container"],[1,"iconDrop"],[1,"ri-printer-cloud-line",3,"click"],["class","export-dropdown",4,"ngIf"],[1,"container_inputSearch",2,"display","flex","align-items","center","position","relative"],[1,"inputSearch",2,"flex","1","position","relative"],[1,"tags-container",2,"display","flex","flex-wrap","wrap","align-items","center","padding-left","35px","min-height","40px","border","1.5px solid #000","border-top-left-radius","5px","min-width","250px","border-bottom-left-radius","5px","border-top-right-radius","0px","border-bottom-right-radius","0px","background","white","cursor","text",3,"click"],["class","tag","style","display: flex; align-items: center; background: #e0e0e0; padding: 2px 8px; border-radius: 20px; margin: 2px 4px 2px 0; z-index: 12;",4,"ngIf"],["type","text",2,"border","none","outline","none","flex","1","padding","5px 0","min-width","120px",3,"ngModelChange","click","ngModel","placeholder"],[1,"ri-search-2-line",2,"position","absolute","left","10px","top","50%","transform","translateY(-50%)","z-index","1"],["title","Trier et filtrer",1,"trier",2,"cursor","pointer",3,"click"],["style","font-size: 18px;","class","ri-arrow-down-s-fill",4,"ngIf"],["style","font-size: 18px;","class","ri-close-line",4,"ngIf"],["class","filter-dropdown","style","position: absolute; top: 100%; right: 0; background: white; \n          border: 1px solid #ccc; border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); \n          z-index: 100; width: 100%; margin-top: 5px;",3,"click",4,"ngIf"],[1,"container_list_boutique"],[1,"content_list_boutique"],[1,"name_boutique"],[4,"ngIf","ngIfElse"],[1,"titleTableProduit"],[3,"click"],[3,"class",4,"ngIf"],[2,"background-color","#0671e44a"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],["style","text-align: center; margin-top: 20px;",4,"ngIf"],["class","pager","aria-label","Pagination",4,"ngIf"],[1,"ri-refresh-line",3,"click"],[1,"ri-loader-line","ri-spin"],[1,"export-dropdown"],[1,"export-option",3,"click"],[1,"tag",2,"display","flex","align-items","center","background","#e0e0e0","padding","2px 8px","border-radius","20px","margin","2px 4px 2px 0","z-index","12"],[1,"remove-chip",3,"click"],[1,"ri-arrow-down-s-fill",2,"font-size","18px"],[1,"ri-close-line",2,"font-size","18px"],[1,"filter-dropdown",2,"position","absolute","top","100%","right","0","background","white","border","1px solid #ccc","border-radius","5px","box-shadow","0 2px 10px rgba(0,0,0,0.1)","z-index","100","width","100%","margin-top","5px",3,"click"],[1,"filter-section",2,"padding","10px"],[2,"display","flex","justify-content","space-between","align-items","center"],[2,"margin","0","font-size","16px","color","#333"],[2,"background","none","border","none","color","#0671e4","cursor","pointer","font-size","13px",3,"click"],[2,"list-style","none","padding","0","margin","10px 0 0 0"],[2,"padding","8px 12px","cursor","pointer","border-radius","4px","margin-bottom","5px","transition","background 0.3s",3,"click"],[2,"padding","8px 12px","cursor","pointer","border-radius","4px","transition","background 0.3s",3,"click"],[1,"all_boutique",3,"click"],[1,"all_boutique",2,"display","flex","align-items","center"],["class","facture-count",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"facture-count"],[1,"ri-loader-line","ri-spin",2,"font-size","12px"],[2,"display","flex","align-items","center",3,"click"],["class","ri-error-warning-line warning-icon",4,"ngIf"],["class","barre",4,"ngIf"],[1,"ri-error-warning-line","warning-icon"],[1,"barre"],[1,"no-boutiques-message"],[3,"innerHTML"],[1,"imgProduit"],[3,"src"],["class","modal",4,"ngIf"],[2,"background-color","#0671e410",3,"innerHTML"],[1,"modal"],[1,"modal-content",3,"click"],["alt","Produit",3,"src"],["colspan","10",2,"text-align","center"],[2,"text-align","center","margin-top","20px"],[2,"color","red"],["aria-label","Pagination",1,"pager"],[1,"pager-info"],[1,"page-size-select",3,"ngModelChange","change","ngModel"],["value","5"],["value","10"],["value","20"],["value","50"],[1,"page-info"],[1,"pager-navigation"],["title","Premi\xe8re page",1,"pager-btn",3,"click","disabled"],[1,"ri-skip-back-line"],["title","Page pr\xe9c\xe9dente",1,"pager-btn",3,"click","disabled"],[1,"ri-arrow-left-s-line"],[1,"page-numbers"],["class","page-number",3,"active","disabled","click",4,"ngFor","ngForOf"],["title","Page suivante",1,"pager-btn",3,"click","disabled"],[1,"ri-arrow-right-s-line"],["title","Derni\xe8re page",1,"pager-btn",3,"click","disabled"],[1,"ri-skip-forward-line"],[1,"page-number",3,"click","disabled"]],template:function(o,n){if(1&o){const i=t.RV6();t.j41(0,"div",2)(1,"div",3)(2,"h1",4),t.EFF(3,"Mes Stocks"),t.k0s(),t.j41(4,"div",5)(5,"button",6),t.EFF(6,"Cr\xe9er un ajustement de stock"),t.k0s(),t.j41(7,"div",7),t.DNE(8,R,1,0,"i",8)(9,$,1,0,"i",9),t.nrm(10,"div",10),t.j41(11,"div",11)(12,"div",12)(13,"i",13),t.bIt("click",function(){return t.eBV(i),t.Njj(n.toggleExportDropdown())}),t.k0s()(),t.DNE(14,U,7,0,"div",14),t.k0s()(),t.j41(15,"div",15)(16,"div",16)(17,"div",17),t.bIt("click",function(){return t.eBV(i),t.Njj(n.focusSearchInput())}),t.DNE(18,L,4,1,"span",18),t.j41(19,"input",19,0),t.mxI("ngModelChange",function(c){return t.eBV(i),t.DH7(n.searchText,c)||(n.searchText=c),t.Njj(c)}),t.bIt("ngModelChange",function(){return t.eBV(i),t.Njj(n.applyFilters())})("click",function(c){return t.eBV(i),t.Njj(c.stopPropagation())}),t.k0s(),t.nrm(21,"i",20),t.k0s()(),t.j41(22,"div",21),t.bIt("click",function(c){return t.eBV(i),n.toggleFilterDropdown(),t.Njj(c.stopPropagation())}),t.DNE(23,q,1,0,"i",22)(24,z,1,0,"i",23),t.k0s(),t.DNE(25,N,13,8,"div",24),t.k0s()()(),t.j41(26,"div",25)(27,"div",26)(28,"div",27),t.DNE(29,H,7,5,"ng-container",28)(30,J,2,0,"ng-template",null,1,t.C5r),t.k0s()()(),t.j41(32,"table")(33,"thead")(34,"tr",29)(35,"th",30),t.bIt("click",function(){return t.eBV(i),t.Njj(n.setSorting("codeGenerique"))}),t.EFF(36," Code "),t.DNE(37,Q,1,3,"i",31),t.k0s(),t.j41(38,"th"),t.EFF(39,"Photo"),t.k0s(),t.j41(40,"th"),t.EFF(41,"Nom produit"),t.k0s(),t.j41(42,"th"),t.EFF(43,"Cat\xe9gorie"),t.k0s(),t.j41(44,"th"),t.EFF(45,"Prix Vente"),t.k0s(),t.j41(46,"th"),t.EFF(47,"Co\xfbt du produit"),t.k0s(),t.j41(48,"th",32),t.EFF(49,"En stock"),t.k0s(),t.j41(50,"th"),t.EFF(51,"Unit\xe9"),t.k0s(),t.j41(52,"th"),t.EFF(53,"Seuil Alerte"),t.k0s(),t.DNE(54,Z,3,0,"ng-container",33),t.k0s()(),t.j41(55,"tbody"),t.DNE(56,nt,20,15,"tr",34)(57,ot,3,0,"tr",33),t.k0s()(),t.DNE(58,it,3,0,"div",35)(59,st,26,7,"div",36),t.k0s()}if(2&o){const i=t.sdS(31);t.R7$(8),t.Y8G("ngIf",!n.isLoading),t.R7$(),t.Y8G("ngIf",n.isLoading),t.R7$(5),t.Y8G("ngIf",n.showExportDropdown),t.R7$(4),t.Y8G("ngIf",n.selectedFilters.length>0),t.R7$(),t.R50("ngModel",n.searchText),t.Y8G("placeholder",n.getSearchPlaceholder()),t.R7$(4),t.Y8G("ngIf",!n.showFilterDropdown),t.R7$(),t.Y8G("ngIf",n.showFilterDropdown),t.R7$(),t.Y8G("ngIf",n.showFilterDropdown),t.R7$(4),t.Y8G("ngIf",((null==n.boutiques?null:n.boutiques.length)||0)>0)("ngIfElse",i),t.R7$(8),t.Y8G("ngIf","codeGenerique"===n.sortColumn),t.R7$(17),t.Y8G("ngIf",!n.selectedBoutique),t.R7$(2),t.Y8G("ngForOf",n.filteredProducts()),t.R7$(),t.Y8G("ngIf",n.tasks.length>0&&0===n.filteredProducts().length),t.R7$(),t.Y8G("ngIf",n.showNoProductsMessage),t.R7$(),t.Y8G("ngIf",n.totalProduitsEnStock>n.pageSize)}},dependencies:[O.MD,O.Sq,O.bT,m.X1,m.xH,m.y7,m.me,m.wz,m.BC,m.YN,m.vS,k.Ve,T.RG,M.jL,D.fS,C.Wk,u.v],styles:['@charset "UTF-8";table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.title[_ngcontent-%COMP%]{font-size:18px;font-family:Poppins,sans-serif;color:#222}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border-bottom:1px solid rgba(221,221,221,.5803921569);padding:8px;font-size:13px!important;font-family:Poppins,sans-serif;color:#222}th[_ngcontent-%COMP%]{background-color:#f2f2f2}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}tr[_ngcontent-%COMP%]:hover{background-color:#ddd}.titleTableProduit[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px;font-family:Poppins,sans-serif;color:#222}.containerTable[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:10px}.tasks-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}.actions[_ngcontent-%COMP%]{display:flex;align-items:center}.actions[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#000}.add-task[_ngcontent-%COMP%]{padding:10px 30px;background-color:#0672e4;color:#fff;border-radius:5px;border:none}.contentIcon[_ngcontent-%COMP%]{margin:0 10px;display:flex;align-items:center}.contentIcon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{padding:0 15px;font-size:20px;cursor:pointer}.contentIcon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:#0672e4;transition:all .5s ease}.bare[_ngcontent-%COMP%]{width:2px;height:30px;background-color:#eee}.inputSearch[_ngcontent-%COMP%]{position:relative;height:40px;display:flex;align-items:center}.inputSearch[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:0;margin-right:15px;font-size:17px}.totals[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;margin-left:20px;font-size:14px;color:#333;margin-bottom:5px}.red-text[_ngcontent-%COMP%]{color:red}.export-container[_ngcontent-%COMP%]{position:relative;display:inline-block}.export-dropdown[_ngcontent-%COMP%]{position:absolute;background-color:#f9f9f9;min-width:180px;box-shadow:0 8px 16px #00000063;z-index:1;top:100%;left:0;border-radius:5px}.export-dropdown[_ngcontent-%COMP%]   .export-option[_ngcontent-%COMP%]{padding:12px 16px;cursor:pointer}.export-dropdown[_ngcontent-%COMP%]   .export-option[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.iconDrop[_ngcontent-%COMP%]{display:flex;align-items:center}.iconMontreArrow[_ngcontent-%COMP%]{margin-left:-30px}.iconMontreArrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px}.imgProduit[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;overflow:hidden;display:flex;align-items:center;justify-content:center;background-color:#f5f5f5;box-shadow:0 4px 6px #0000001a;cursor:pointer}.imgProduit[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80%;height:80%;object-fit:cover;border-radius:50%;transition:transform .2s}.imgProduit[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.1)}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:10px;border-radius:10px;max-width:80%;max-height:80%;display:flex;justify-content:center}.modal-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:80vh;border-radius:10px}.pager[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px 10px;margin-top:20px;background:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}.pager[_ngcontent-%COMP%]   .pager-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-size:14px;color:#6c757d}.pager[_ngcontent-%COMP%]   .pager-info[_ngcontent-%COMP%]   .page-size-select[_ngcontent-%COMP%]{padding:5px 10px;border:1px solid #ced4da;border-radius:4px;background:#fff;font-size:14px;cursor:pointer}.pager[_ngcontent-%COMP%]   .pager-info[_ngcontent-%COMP%]   .page-size-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#0671e4;box-shadow:0 0 0 2px #0671e440}.pager[_ngcontent-%COMP%]   .pager-info[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%]{font-weight:500;color:#495057}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .pager-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid #ced4da;background:#fff;color:#495057;border-radius:4px;cursor:pointer;transition:all .2s ease}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .pager-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#0671e4;color:#fff;border-color:#0671e4}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .pager-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background:#f8f9fa}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .pager-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2px;margin:0 10px}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-width:36px;height:36px;border:1px solid #ced4da;background:#fff;color:#495057;border-radius:4px;cursor:pointer;transition:all .2s ease;font-size:14px;font-weight:500}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]:hover:not(:disabled){background:#e9ecef;border-color:#adb5bd}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number.active[_ngcontent-%COMP%]{background:#0671e4;color:#fff;border-color:#0671e4}.pager[_ngcontent-%COMP%]   .pager-navigation[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background:#f8f9fa}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;width:100%;max-width:600px;border-radius:8px;box-shadow:0 2px 10px #0003;overflow:hidden}.modal-header[_ngcontent-%COMP%]{padding:16px;background-color:#f1f1f1;display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px}.modal-close[_ngcontent-%COMP%]{cursor:pointer;font-size:24px}.modal-body[_ngcontent-%COMP%]{padding:16px}.modal-footer[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:center}.champ_input[_ngcontent-%COMP%]{position:relative}.inpuemail[_ngcontent-%COMP%]{margin-top:20px}.input_focus[_ngcontent-%COMP%]{width:100%;min-width:250px;height:49px;outline:none;border-bottom:1px solid rgb(53,50,50);border-top:none;border-left:none;border-right:none;margin:10px 0;transition:all .3s;font-size:18px;background:none;color:#695c5c}.add_category[_ngcontent-%COMP%]{border:none;margin-top:5px;cursor:pointer}.input_focus[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.champ_input[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:4px;pointer-events:none;color:#6b6666}.input_focus[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:-6px;left:0;transition:all .3s ease-in-out;background:none;font-size:14px;padding:0}.input_focus[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:15px;transition:all .2s ease-in-out}.double_input[_ngcontent-%COMP%]{display:flex;align-items:center}.input_focus2[_ngcontent-%COMP%]{width:100%;min-width:250px;height:60px;outline:none;border-top:none;border-left:none;border-right:none;margin-top:10px;transition:all .3s;font-size:18px;padding-left:10px;background-color:#dcdcdc4c;color:#777474;resize:none;border-radius:5px;padding-top:10px;border-bottom:1px solid rgb(53,50,50)}.input_focus2[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.champ_input2[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:0;left:15px;pointer-events:none;color:#423838}.input_focus2[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus2[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:-10px;left:0;transition:all .3s ease-in-out;background:none;font-size:14px;padding:0}.input_focus2[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus2[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:15px;transition:all .2s ease-in-out}.champ_input_margin[_ngcontent-%COMP%]{margin-left:50px}.input_file[_ngcontent-%COMP%]{display:inline-block;width:300px;margin-top:10px}.custom-file-label[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid #ccc;border-radius:5px;overflow:hidden;width:100%;cursor:pointer}.custom-file-button[_ngcontent-%COMP%]{background-color:#0672e4;color:#fff;padding:8px 12px;font-size:14px;border:none;outline:none;cursor:pointer}.custom-file-text[_ngcontent-%COMP%]{flex:1;padding:8px;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:#555}.btn-save[_ngcontent-%COMP%]{padding:8px 20px;margin-right:10px;background-color:#0672e4;color:#fff;border:none;border-radius:5px}.btn-cancel[_ngcontent-%COMP%]{padding:8px 20px;margin-right:10px;background-color:#ff0000b3;color:#fff;border:none;border-radius:5px}.btn-save[_ngcontent-%COMP%]:hover{background-color:#0465cd;transition:all .5s}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:red;transition:all .5s}.iconArrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:10px;top:20px}.iconArrow[_ngcontent-%COMP%]{font-size:20px}.pagination[_ngcontent-%COMP%]{justify-content:right;margin-top:20px}mat-paginator[_ngcontent-%COMP%]{background-color:#dcdcdc51;border-radius:5px}.error-message[_ngcontent-%COMP%]{font-size:13px;color:red;font-weight:700;margin-top:10px}.expiring-soon[_ngcontent-%COMP%]{color:#f1940f}.expiring-today[_ngcontent-%COMP%]{color:red;animation:_ngcontent-%COMP%_blink 1s linear infinite}@keyframes _ngcontent-%COMP%_blink{50%{opacity:0}}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(-5px)}50%{transform:translate(5px)}75%{transform:translate(-5px)}}.shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake .2s ease-in-out infinite}.expired[_ngcontent-%COMP%]{color:red;font-style:italic;opacity:.7}.description-cell[_ngcontent-%COMP%]{position:relative;cursor:pointer}.description-hover[_ngcontent-%COMP%]{display:none;position:absolute;top:100%;left:50%;transform:translate(-50%);background-color:#333;color:#fff;padding:10px;border-radius:5px;font-size:12px;width:200px;z-index:10}.description-cell[_ngcontent-%COMP%]:hover   .description-hover[_ngcontent-%COMP%]{display:block}.name_boutique[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;cursor:pointer;margin:30px 0 10px}.name_boutique[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:5px 15px}.name_boutique_active[_ngcontent-%COMP%]{background-color:#e9d421;border-radius:5px;color:#000}.barre[_ngcontent-%COMP%]{height:25px;width:1px;background-color:#0000003f;margin:8px 0}.container_list_boutique[_ngcontent-%COMP%]{overflow:auto;scrollbar-color:#888 #f1f1f1}.container_list_boutique[_ngcontent-%COMP%]::-webkit-scrollbar{width:2px;height:3px}.container_list_boutique[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}.container_list_boutique[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#00f;border-radius:4px}.container_list_boutique[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:red}.name_boutique[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{cursor:pointer;padding:8px 16px;margin:4px 0;transition:all .3s ease;font-weight:500;border-radius:4px}.name_boutique[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:hover{background-color:#0000000d;transform:translateY(-1px)}.name_boutique[_ngcontent-%COMP%]   p.name_boutique_active[_ngcontent-%COMP%]{background-color:#e9d421;color:#000!important}.warning-icon[_ngcontent-%COMP%]{margin-left:8px;color:red;font-size:14px}.inputSearch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:100%;padding-left:10px;border-top-left-radius:5px;border-bottom-left-radius:5px}.trier[_ngcontent-%COMP%]{border-top:1.5px solid #000;border-right:1.5px solid #000;border-bottom:1.5px solid #000;border-top-right-radius:5px;border-bottom-right-radius:5px;padding:5px 10px;cursor:pointer}.tags-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;padding:5px 5px 5px 35px;border:1px solid #ccc;border-radius:5px;background:#fff;min-height:40px}.tag[_ngcontent-%COMP%]{display:flex;align-items:center;background:#e0e0e0;padding:2px 8px;border-radius:20px;margin:2px 4px 2px 0;font-size:12px}.tag[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:5px;cursor:pointer}.inputSearch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;flex:1;padding:8px 0}.filter-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;background:#fff;border:1px solid #ccc;border-radius:5px;box-shadow:0 2px 10px #0000001a;z-index:100;width:250px;margin-top:5px}.filter-section[_ngcontent-%COMP%]{padding:10px}.filter-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;font-size:16px;color:#333}.filter-section[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.filter-section[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:5px 10px;cursor:pointer;border-radius:4px;margin-bottom:5px}.filter-section[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#f0f0f0}th[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}.remove-chip[_ngcontent-%COMP%]{margin-left:5px;cursor:pointer}.remove-chip[_ngcontent-%COMP%]:hover{color:#f44}.filter-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;background:#fff;border:1px solid #ccc;border-radius:5px;box-shadow:0 2px 10px #0000001a;z-index:100;width:300px;padding:15px}.filter-dropdown[_ngcontent-%COMP%]   .filter-option[_ngcontent-%COMP%]{padding:8px 0;display:flex;flex-direction:column}.filter-dropdown[_ngcontent-%COMP%]   .filter-select[_ngcontent-%COMP%]{margin-top:5px;padding:8px;border:1px solid #ddd;border-radius:4px;background:#fff;cursor:pointer}.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed!important;pointer-events:none}.facture-count[_ngcontent-%COMP%]{background-color:#ddd;color:#000;border-radius:50%;font-size:10px;min-width:18px;height:18px;display:flex;justify-content:center;align-items:center;padding:2px;margin-left:10px}.draggable-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;align-items:center}']})}}return r})()}}]);