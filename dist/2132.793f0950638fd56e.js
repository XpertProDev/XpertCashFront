"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[2132],{76822:(V,j,d)=>{d.d(j,{K:()=>h});var h=function(m){return m.BROUILLON="BROUILLON",m.APPROBATION="APPROBATION",m.APPROUVE="APPROUVE",m.ENVOYE="ENVOYE",m.VALIDE="VALIDE",m.ANNULE="ANNULE",m}(h||{})},92120:(V,j,d)=>{d.d(j,{r:()=>w});var h=d(21626),m=d(84412),y=d(25558),b=d(99437),v=d(18810),P=d(88141),O=d(22525),D=d(54438),F=d(88026);let w=(()=>{class E{constructor(l,s){this.http=l,this.usersService=s,this.apiUrl=O.c.apiBaseUrl,this.entrepriseSubject=new m.t([]),this.entreprise$=this.entrepriseSubject.asObservable()}getListEntreprises(){return this.usersService.getValidAccessToken().pipe((0,y.n)(l=>{const s=new h.Lr({Authorization:`Bearer ${l}`,"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}/entreprises`,{headers:s})}),(0,b.W)(l=>{let s="Erreur inconnue";return l.error instanceof ErrorEvent?s=`Erreur: ${l.error.message}`:404===l.status&&(s="Aucune entreprise trouv\xe9e"),(0,v.$)(()=>new Error(s))}))}addEntreprise(l){return this.usersService.getValidAccessToken().pipe((0,y.n)(s=>{const a=new h.Lr({Authorization:`Bearer ${s}`,"Content-Type":"application/json"});return this.http.post(`${this.apiUrl}/entreprise-clients`,l,{headers:a})}),(0,P.M)(s=>{this.entrepriseSubject.next([...this.entrepriseSubject.value,s])}),(0,b.W)(s=>{let a="Erreur inconnue";return s.error instanceof ErrorEvent?a=`Erreur: ${s.error.message}`:400===s.status&&(a=s.error||"Donn\xe9es invalides"),(0,v.$)(()=>new Error(a))}))}getListEntreprise(){return this.usersService.getValidAccessToken().pipe((0,y.n)(l=>{if(!l)return console.error("Token vide ou non d\xe9fini ! V\xe9rifiez que l'utilisateur est bien connect\xe9."),(0,v.$)(()=>new Error("Token manquant"));const s=(new h.Lr).set("Authorization",`Bearer ${l}`);return console.log("En-t\xeates envoy\xe9s : ",s),this.http.get(`${this.apiUrl}/entreprises`,{headers:s})}),(0,P.M)(l=>{this.entrepriseSubject.next(l)}),(0,b.W)(l=>(console.error("Erreur lors de la r\xe9cup\xe9ration des entreprises:",l),(0,v.$)(()=>l))))}getEntrepriseById(l){return this.usersService.getValidAccessToken().pipe((0,y.n)(s=>{if(!s)return console.error("Token manquant"),(0,v.$)(()=>new Error("Token manquant"));const a=new h.Lr({Authorization:`Bearer ${s}`,"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}/entreprises/${l}`,{headers:a})}),(0,b.W)(s=>{let a="Erreur inconnue";return s.error instanceof ErrorEvent?a=`Erreur: ${s.error.message}`:404===s.status&&(a="Entreprise non trouv\xe9e"),(0,v.$)(()=>new Error(a))}))}updateEntreprise(l,s){return this.usersService.getValidAccessToken().pipe((0,y.n)(a=>{if(!a)return(0,v.$)(()=>new Error("Token manquant"));const c=new h.Lr({Authorization:`Bearer ${a}`});return this.http.patch(`${this.apiUrl}/updateEntreprise/${l}`,s,{headers:c,responseType:"text"})}),(0,b.W)(a=>{let c="Erreur inconnue";return a.error instanceof ErrorEvent?c=`Erreur: ${a.error.message}`:400===a.status&&(c=a.error||"Donn\xe9es invalides"),(0,v.$)(()=>new Error(c))}))}getEntrepriseInfo(){return this.usersService.getValidAccessToken().pipe((0,y.n)(l=>{if(!l)return(0,v.$)(()=>new Error("Aucun token trouv\xe9"));const s=new h.Lr({Authorization:`Bearer ${l}`});return this.http.get(`${this.apiUrl}/myEntreprise`,{headers:s}).pipe((0,P.M)(a=>{localStorage.setItem("entreprise",JSON.stringify(a))}))}),(0,b.W)(l=>(console.error("Erreur r\xe9cup\xe9ration info entreprise:",l),(0,v.$)(()=>l))))}decodeJwt(l){return JSON.parse(atob(l.split(".")[1]))}isTokenExpired(l){return new Date(1e3*l.exp)<new Date}getNewTokenFromApi(){const l=localStorage.getItem("refreshToken");return this.http.post(`${this.apiUrl}/refresh-token`,{refreshToken:l})}static{this.\u0275fac=function(s){return new(s||E)(D.KVO(h.Qq),D.KVO(F.g))}}static{this.\u0275prov=D.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}}return E})()},72409:(V,j,d)=>{d.d(j,{c:()=>w});var h=d(21626),m=d(25558),y=d(88141),b=d(99437),v=d(18810),P=d(76822),O=d(22525),D=d(54438),F=d(88026);let w=(()=>{class E{constructor(l,s){this.http=l,this.usersService=s,this.apiUrl=O.c.apiBaseUrl}creerFactureProforma(l,s,a,c){return this.usersService.getValidAccessToken().pipe((0,m.n)(o=>{const e=new h.Lr({Authorization:`Bearer ${o}`});let u=new h.Nl;return c&&(void 0!==s&&(u=u.set("remisePourcentage",s.toString())),void 0!==a&&(u=u.set("appliquerTVA",a.toString()))),this.http.post(`${this.apiUrl}/ajouter`,l,{headers:e,params:u})}),(0,y.M)(o=>console.log("Facture cr\xe9\xe9e avec succ\xe8s:",o)),(0,b.W)(o=>(console.error("Erreur d\xe9taill\xe9e:",o),console.log("Corps de la r\xe9ponse:",o.error),(0,v.$)(()=>o))))}getAlFactproformaOfEntreprise(l){return this.usersService.getValidAccessToken().pipe((0,m.n)(s=>{const a=new h.Lr({Authorization:`Bearer ${s}`});return this.http.get(`${this.apiUrl}/mes-factures`,{headers:a})}))}getFactureProformaById(l){return this.usersService.getValidAccessToken().pipe((0,m.n)(s=>{const a=new h.Lr({Authorization:`Bearer ${s}`});return this.http.get(`${this.apiUrl}/factureProforma/${l}`,{headers:a})}))}updateFactureProforma(l,s,a,c,o){return this.usersService.getValidAccessToken().pipe((0,m.n)(e=>{const u=new h.Lr({Authorization:`Bearer ${e}`,"Content-Type":"application/json"});let C=new h.Nl;return void 0!==s&&(C=C.set("remisePourcentage",s.toString())),void 0!==a&&(C=C.set("appliquerTVA",a.toString())),o&&o.length>0&&o.forEach(f=>{C=C.append("idsApprobateurs",f.toString())}),c.statut===P.K.ANNULE&&(C=C.set("isAnnulation","true")),this.http.put(`${this.apiUrl}/updatefacture/${l}`,c,{headers:u,params:C}).pipe((0,y.M)(f=>console.log("Facture mise \xe0 jour:",f)),(0,b.W)(f=>(console.error("Erreur mise \xe0 jour:",f),(0,v.$)(()=>f))))}))}envoyerFactureEmail(l,s){const a=new FormData;return a.append("to",s.to),a.append("cc",s.cc),a.append("subject",s.subject),a.append("body",s.body),s.attachments&&s.attachments.forEach((c,o)=>{a.append("attachments",c,c.name)}),this.usersService.getValidAccessToken().pipe((0,m.n)(c=>{const o=new h.Lr({Authorization:`Bearer ${c}`});return this.http.post(`${this.apiUrl}/factures/${l}/envoyer-email`,a,{headers:o,responseType:"text"})}))}getHistoriqueFacture(l){return this.usersService.getValidAccessToken().pipe((0,m.n)(s=>{const a=new h.Lr({Authorization:`Bearer ${s}`});return this.http.get(`${this.apiUrl}/factpro/${l}/historique`,{headers:a})}),(0,b.W)(s=>(console.error("Erreur r\xe9cup\xe9ration historique facture:",s),(0,v.$)(()=>s))))}getNotesFactureProforma(l){return this.usersService.getValidAccessToken().pipe((0,m.n)(s=>{const a=new h.Lr({Authorization:`Bearer ${s}`});return this.http.get(`${this.apiUrl}/factures/${l}/notes`,{headers:a})}),(0,b.W)(s=>(console.error("Erreur r\xe9cup\xe9ration historique facture:",s),(0,v.$)(()=>s))))}getNoteById(l,s){return this.usersService.getValidAccessToken().pipe((0,m.n)(a=>{const c=new h.Lr({Authorization:`Bearer ${a}`,Accept:"application/json"});return this.http.get(`${this.apiUrl}/auth/${l}/notes/${s}`,{headers:c})}),(0,b.W)(a=>(console.error("Erreur lors de la r\xe9cup\xe9ration de la note:",a),(0,v.$)(()=>a))))}updateNote(l,s,a){return this.usersService.getValidAccessToken().pipe((0,m.n)(c=>{const o=new h.Lr({Authorization:`Bearer ${c}`,"Content-Type":"application/json"});return this.http.put(`${this.apiUrl}/${l}/notes/${s}`,{nouveauContenu:a},{headers:o})}),(0,y.M)(c=>console.log("Note modifi\xe9e avec succ\xe8s:",c)),(0,b.W)(c=>(console.error("Erreur lors de la modification de la note:",c),(0,v.$)(()=>c))))}deletNoteFactureProforma(l,s){return this.usersService.getValidAccessToken().pipe((0,m.n)(a=>{const c=new h.Lr({Authorization:`Bearer ${a}`,Accept:"application/json"});return this.http.delete(`${this.apiUrl}/${l}/notes/${s}/supprimer`,{headers:c})}),(0,b.W)(a=>(console.error("Erreur lors de la suppression de la note:",a),(0,v.$)(()=>a))))}getFacturesByClient(l,s){return this.usersService.getValidAccessToken().pipe((0,m.n)(a=>{let c=new h.Nl;void 0!==l&&(c=c.set("clientId",l.toString())),void 0!==s&&(c=c.set("entrepriseClientId",s.toString()));const o=new h.Lr({Authorization:`Bearer ${a}`});return this.http.get(`${this.apiUrl}/factures/client`,{headers:o,params:c})}),(0,b.W)(a=>(console.error("Erreur dans getFacturesByClient:",a),(0,v.$)(()=>a))))}getFacturesParPeriode(l,s,a){return this.usersService.getValidAccessToken().pipe((0,m.n)(c=>{const o=new h.Lr({Authorization:`Bearer ${c}`});let e=(new h.Nl).set("type",l);if("personnalise"===l){if(!s||!a)throw new Error("Pour 'personnalise', les dates dateDebut et dateFin sont obligatoires.");e=e.set("dateDebut",s).set("dateFin",a)}return this.http.get(`${this.apiUrl}/mes-factures/par-periode`,{headers:o,params:e})}))}deletFactureProforma(l){return this.usersService.getValidAccessToken().pipe((0,m.n)(s=>{const a=new h.Lr({Authorization:`Bearer ${s}`,Accept:"application/json"});return this.http.delete(`${this.apiUrl}/deletefactureproforma/${l}`,{headers:a})}),(0,b.W)(s=>(console.error("Erreur lors de la suppression de la note:",s),(0,v.$)(()=>s))))}static{this.\u0275fac=function(s){return new(s||E)(D.KVO(h.Qq),D.KVO(F.g))}}static{this.\u0275prov=D.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}}return E})()},79597:(V,j,d)=>{d.r(j),d.d(j,{DetailEditClientComponent:()=>we});var h=d(10467),m=d(89417),y=d(7673),b=d(84412),v=d(84572),P=d(99172),O=d(96354),D=d(25558),F=d(18810),w=d(96967),E=d(60177),S=d(60850),l=d(96115),s=d(9454),a=d(30636),c=d(99213),o=d(96850),e=d(54438),u=d(3);let U=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=e.$C({type:i});static \u0275inj=e.G2t({imports:[u.yE,u.yE]})}return i})();var L=d(9159);let z=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=e.$C({type:i});static \u0275inj=e.G2t({imports:[u.yE,u.yE]})}return i})();var B=d(22525),G=d(49192),W=d(92120),Y=d(47746),X=d(72409),J=d(88026),K=d(44413);const H=["fileInput"],Q=()=>({standalone:!0}),Z=(i,g,t,n)=>({draft:i,sent:g,approved:t,valid:n});function q(i,g){if(1&i&&(e.j41(0,"div",91),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessage," ")}}function ee(i,g){if(1&i&&(e.j41(0,"div",92),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.successMessage," ")}}function te(i,g){if(1&i&&(e.j41(0,"div",91),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessageApi," ")}}function ie(i,g){1&i&&(e.j41(0,"div",93)(1,"div",94),e.nrm(2,"div",95),e.j41(3,"p"),e.EFF(4,"Creation en cours..."),e.k0s()()())}function ne(i,g){if(1&i){const t=e.RV6();e.j41(0,"i",96),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.toggleEditing())}),e.k0s()}}function re(i,g){if(1&i){const t=e.RV6();e.j41(0,"i",97),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.toggleEditing())}),e.k0s()}}function oe(i,g){1&i&&(e.j41(0,"small"),e.EFF(1,"Champ requis."),e.k0s())}function se(i,g){1&i&&(e.j41(0,"small"),e.EFF(1,"Au moins 2 caract\xe8res."),e.k0s())}function ae(i,g){if(1&i&&(e.j41(0,"div",98),e.DNE(1,oe,2,0,"small",77)(2,se,2,0,"small",77),e.k0s()),2&i){let t,n;const r=e.XpG();e.R7$(),e.Y8G("ngIf",null==(t=r.modifierClientForm.get("nomComplet"))||null==t.errors?null:t.errors.required),e.R7$(),e.Y8G("ngIf",null==(n=r.modifierClientForm.get("nomComplet"))||null==n.errors?null:n.errors.minlength)}}function le(i,g){1&i&&(e.j41(0,"small"),e.EFF(1,"Format invalide."),e.k0s())}function ce(i,g){if(1&i&&(e.j41(0,"div",98),e.DNE(1,le,2,0,"small",77),e.k0s()),2&i){let t;const n=e.XpG();e.R7$(),e.Y8G("ngIf",null==(t=n.modifierClientForm.get("email"))||null==t.errors?null:t.errors.email)}}function de(i,g){if(1&i&&(e.j41(0,"option",99),e.EFF(1),e.k0s()),2&i){const t=g.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function pe(i,g){if(1&i){const t=e.RV6();e.j41(0,"div",100)(1,"h6"),e.EFF(2,"Entreprise"),e.k0s(),e.j41(3,"div",101)(4,"p"),e.EFF(5,"J'appartient \xe0 une entreprise"),e.k0s(),e.j41(6,"label",102)(7,"input",103),e.mxI("ngModelChange",function(r){e.eBV(t);const p=e.XpG();return e.DH7(p.isEntrepriseSelected,r)||(p.isEntrepriseSelected=r),e.Njj(r)}),e.k0s(),e.nrm(8,"span",104),e.k0s()()()}if(2&i){const t=e.XpG();e.R7$(7),e.Y8G("disabled",!t.isEditing),e.R50("ngModel",t.isEntrepriseSelected),e.Y8G("ngModelOptions",e.lJ4(3,Q))}}function ue(i,g){if(1&i&&(e.j41(0,"mat-option",99)(1,"div",115),e.EFF(2),e.k0s()()),2&i){const t=g.$implicit;e.Y8G("value",t),e.R7$(2),e.SpI(" ",t.nom," ")}}function me(i,g){if(1&i){const t=e.RV6();e.j41(0,"div",105)(1,"div",36),e.nrm(2,"input",106),e.j41(3,"label",107),e.EFF(4,"Mon entreprise"),e.k0s(),e.j41(5,"mat-autocomplete",108,2),e.bIt("optionSelected",function(r){e.eBV(t);const p=e.XpG();return e.Njj(p.onEntrepriseSelected(r))}),e.j41(7,"mat-option",109),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.openPopup())}),e.j41(8,"div",110),e.nrm(9,"i",111),e.j41(10,"span",112),e.EFF(11,"Cr\xe9er une entreprise"),e.k0s()()(),e.DNE(12,ue,3,2,"mat-option",47),e.nI1(13,"async"),e.k0s(),e.j41(14,"div",113),e.nrm(15,"i",114),e.k0s()()()}if(2&i){const t=e.sdS(6),n=e.XpG();e.R7$(2),e.Y8G("formControl",n.control)("matAutocomplete",t),e.R7$(3),e.Y8G("displayWith",n.displayFnEntreprise),e.R7$(7),e.Y8G("ngForOf",e.bMT(13,4,n.filteredOptions))}}function ge(i,g){if(1&i){const t=e.RV6();e.j41(0,"div",116),e.nrm(1,"div"),e.j41(2,"div",117)(3,"div",118)(4,"button",119),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.goToClients())}),e.EFF(5),e.k0s()(),e.j41(6,"div",120)(7,"button",121),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.modifierClient())}),e.EFF(8," Modifier "),e.k0s()()()()}if(2&i){const t=e.XpG();e.R7$(5),e.JRh(t.isEditing?"Annuler":"Retour"),e.R7$(2),e.xc7("background-color",t.modifierClientForm.valid?"#0672E4":"#0671e434")("color",t.modifierClientForm.valid?"#ffffff":"#00000073")("cursor",t.modifierClientForm.valid?"pointer":"no-drop"),e.Y8G("disabled",t.modifierClientForm.invalid)}}function he(i,g){if(1&i){const t=e.RV6();e.j41(0,"div",122)(1,"div",123)(2,"h4",124),e.EFF(3,"Confirmation"),e.k0s(),e.j41(4,"p",125),e.EFF(5,"\xcates-vous s\xfbr de vouloir supprimer ce Client ?"),e.k0s(),e.j41(6,"div",126)(7,"button",127),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.confirmDeleteC())}),e.EFF(8,"OUI"),e.k0s(),e.j41(9,"button",128),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showConfirmationModalC=!1)}),e.EFF(10,"NON"),e.k0s()()()()}}function fe(i,g){if(1&i&&(e.j41(0,"div",129)(1,"span"),e.EFF(2,"Factures client"),e.k0s(),e.j41(3,"span",130),e.EFF(4),e.k0s()()),2&i){const t=e.XpG();e.R7$(4),e.JRh(t.factureCount)}}function _e(i,g){if(1&i&&(e.j41(0,"tr")(1,"td",151),e.EFF(2),e.k0s(),e.j41(3,"td",151),e.EFF(4),e.k0s(),e.j41(5,"td",151),e.EFF(6),e.nI1(7,"customNumber"),e.k0s(),e.j41(8,"td",151),e.EFF(9),e.k0s(),e.j41(10,"td",151),e.EFF(11),e.nI1(12,"customNumber"),e.k0s()()),2&i){const t=g.$implicit;e.R7$(2),e.JRh(t.nomProduit),e.R7$(2),e.JRh(t.ligneDescription),e.R7$(2),e.JRh(e.bMT(7,5,t.prixUnitaire)),e.R7$(3),e.JRh(t.quantite),e.R7$(2),e.JRh(e.bMT(12,7,t.montantTotal))}}function ve(i,g){1&i&&(e.j41(0,"tr")(1,"td",150),e.EFF(2,"Remise 0%"),e.k0s(),e.j41(3,"td",151),e.EFF(4,"0000"),e.k0s()())}function Ce(i,g){1&i&&(e.j41(0,"tr")(1,"td",150),e.EFF(2,"TVA 0%"),e.k0s(),e.j41(3,"td",151),e.EFF(4,"000"),e.k0s()())}function Ee(i,g){if(1&i&&(e.j41(0,"div",131)(1,"div",132)(2,"div",133),e.nrm(3,"img",134),e.k0s(),e.j41(4,"div",135)(5,"p",136),e.EFF(6),e.k0s(),e.j41(7,"p",136),e.EFF(8),e.k0s(),e.j41(9,"div",136),e.EFF(10),e.k0s()()(),e.nrm(11,"hr")(12,"hr"),e.j41(13,"div",137)(14,"h6"),e.EFF(15,"Facture proforma: "),e.j41(16,"span",138),e.EFF(17),e.k0s()()(),e.j41(18,"div",139)(19,"p",140),e.EFF(20),e.nI1(21,"date"),e.k0s()(),e.j41(22,"div",141)(23,"div",142)(24,"h6",143),e.EFF(25,"Doit : "),e.k0s(),e.j41(26,"p",143),e.EFF(27),e.k0s()(),e.j41(28,"div",144)(29,"h6",143),e.EFF(30,"Objet : "),e.k0s(),e.j41(31,"p",143),e.EFF(32),e.k0s()()(),e.j41(33,"div",145)(34,"table",146)(35,"thead")(36,"tr")(37,"th",147),e.EFF(38,"D\xe9signation"),e.k0s(),e.j41(39,"th",147),e.EFF(40,"Description"),e.k0s(),e.j41(41,"th",147),e.EFF(42,"PU"),e.k0s(),e.j41(43,"th",147),e.EFF(44,"Quantit\xe9"),e.k0s(),e.j41(45,"th",147),e.EFF(46,"Montant (FCFA)"),e.k0s()()(),e.j41(47,"tbody"),e.DNE(48,_e,13,9,"tr",148),e.k0s(),e.j41(49,"tfoot",149)(50,"tr")(51,"td",150),e.EFF(52,"Total HT"),e.k0s(),e.j41(53,"td",151),e.EFF(54),e.nI1(55,"customNumber"),e.k0s()(),e.DNE(56,ve,5,0,"tr",77)(57,Ce,5,0,"tr",77),e.j41(58,"tr")(59,"td",150),e.EFF(60,"Montant TTC"),e.k0s(),e.j41(61,"td",151),e.EFF(62),e.nI1(63,"customNumber"),e.k0s()()()()(),e.j41(64,"div",152)(65,"p",153),e.EFF(66,"Arr\xeat\xe9 la pr\xe9sente facture \xe0 la somme de : Zero ....."),e.k0s()(),e.j41(67,"div",154)(68,"div",155)(69,"p",156),e.EFF(70),e.k0s()(),e.j41(71,"div",157)(72,"p",156),e.EFF(73),e.k0s()()(),e.j41(74,"div",158)(75,"div",159),e.nrm(76,"hr"),e.j41(77,"p",160)(78,"strong"),e.EFF(79),e.k0s()(),e.j41(80,"div",161)(81,"em"),e.EFF(82),e.k0s()(),e.j41(83,"div",162)(84,"em"),e.EFF(85),e.k0s()()()()()),2&i){const t=e.XpG();e.R7$(3),e.Y8G("src",t.entrepriseLogo||t.entrepriseLogo||"assets/img/Votre.png",e.B4B),e.R7$(3),e.JRh(t.entrepriseNom),e.R7$(2),e.SpI("Secteur: ",t.entrepriseSecteur,""),e.R7$(2),e.Lme(" Email: ",t.entrepriseEmail," T\xe9l\xe9phone: ",t.entrepriseTelephone," "),e.R7$(7),e.SpI(" ",t.factureDetails.numeroFacture," "),e.R7$(3),e.Lme(" ",t.entrepriseSiege,", ",e.i5U(21,24,t.factureDetails.dateCreation,"dd/MM/yyyy")," "),e.R7$(7),e.SpI(" ",(null==t.factureDetails.client?null:t.factureDetails.client.nomComplet)||(null==t.factureDetails.entrepriseClient?null:t.factureDetails.entrepriseClient.nom)," "),e.R7$(5),e.SpI(" ",t.factureDetails.description," "),e.R7$(16),e.Y8G("ngForOf",t.factureDetails.lignesFacture),e.R7$(6),e.JRh(e.bMT(55,27,t.factureDetails.totalHT)),e.R7$(2),e.Y8G("ngIf",t.factureDetails.remise>0),e.R7$(),e.Y8G("ngIf",t.factureDetails.tva),e.R7$(5),e.JRh(e.bMT(63,29,t.factureDetails.totalFacture)),e.R7$(8),e.JRh(t.entrepriseSignataire),e.R7$(3),e.JRh(t.entrepriseSignataireNom),e.R7$(6),e.JRh(t.entrepriseSiteWeb),e.R7$(3),e.LHq(" NINA: ",t.entrepriseNina," RCCM: ",t.entrepriseRccm," NIF: ",t.entrepriseNif," Banque: ",t.entrepriseBanque," "),e.R7$(3),e.Lme("Adresse : ",t.entrepriseAdresse," /",t.entreprisePays,"")}}function be(i,g){1&i&&(e.j41(0,"div",163),e.nrm(1,"i",164),e.j41(2,"p"),e.EFF(3,"Cette facture n\u2019est pas li\xe9e \xe0 cet utilisateur."),e.k0s()())}function xe(i,g){1&i&&(e.j41(0,"div",165),e.nrm(1,"i",166),e.EFF(2," Chargement des factures... "),e.k0s())}function Fe(i,g){if(1&i&&(e.j41(0,"div",167),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorFactures," ")}}function Me(i,g){1&i&&(e.j41(0,"div",168),e.nrm(1,"i",169),e.j41(2,"p"),e.EFF(3,"Aucune facture trouv\xe9e pour ce client"),e.k0s()())}function ye(i,g){if(1&i){const t=e.RV6();e.j41(0,"tr",170),e.bIt("click",function(){const r=e.eBV(t).$implicit,p=e.XpG(2);return e.Njj(p.onSelectFacture(r))}),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"td")(7,"span",171),e.EFF(8),e.k0s()(),e.j41(9,"td",81),e.EFF(10),e.nI1(11,"customNumber"),e.k0s()()}if(2&i){const t=g.$implicit,n=e.XpG(2);e.AVh("selected-row",n.selectedFactureId===t.id),e.R7$(2),e.JRh(t.numeroFacture),e.R7$(2),e.JRh(e.i5U(5,7,t.dateFacture,"dd/MM/yyyy")),e.R7$(3),e.Y8G("ngClass",e.ziG(12,Z,"BROUILLON"===t.statut,"ENVOYE"===t.statut,"APPROUVE"===t.statut,"VALIDE"===t.statut)),e.R7$(),e.SpI(" ",t.statut," "),e.R7$(2),e.JRh(e.bMT(11,10,t.totalFacture))}}function Pe(i,g){if(1&i&&(e.j41(0,"table")(1,"thead")(2,"tr",80)(3,"th"),e.EFF(4,"Num\xe9ro"),e.k0s(),e.j41(5,"th"),e.EFF(6,"Date"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Statut"),e.k0s(),e.j41(9,"th",81),e.EFF(10,"Montant"),e.k0s()()(),e.j41(11,"tbody"),e.DNE(12,ye,12,17,"tr",82),e.k0s()()),2&i){const t=e.XpG();e.R7$(12),e.Y8G("ngForOf",t.facturesClient)}}function ke(i,g){if(1&i&&(e.j41(0,"div",83)(1,"table",84)(2,"tfoot",85)(3,"tr")(4,"td",86),e.EFF(5,"Total"),e.k0s(),e.j41(6,"td",87),e.EFF(7),e.nI1(8,"customNumber"),e.k0s()()()()()),2&i){const t=e.XpG();e.R7$(7),e.SpI(" ",e.bMT(8,1,t.getTotalFactures())," ")}}function je(i,g){if(1&i&&(e.j41(0,"div",129)(1,"span"),e.EFF(2,"Achat"),e.k0s(),e.j41(3,"span",130),e.EFF(4),e.k0s()()),2&i){const t=e.XpG();e.R7$(4),e.JRh(t.achatCount)}}function Oe(i,g){if(1&i&&(e.j41(0,"tr")(1,"td",151),e.EFF(2),e.k0s(),e.j41(3,"td",151),e.EFF(4),e.nI1(5,"number"),e.k0s(),e.j41(6,"td",151),e.EFF(7),e.k0s(),e.j41(8,"td",151),e.EFF(9),e.nI1(10,"number"),e.k0s(),e.j41(11,"td",151),e.EFF(12),e.k0s()()),2&i){const t=g.$implicit;e.R7$(2),e.JRh(t.nomProduit),e.R7$(2),e.JRh(e.i5U(5,5,t.prixUnitaire,"1.0-0")),e.R7$(3),e.JRh(t.quantite),e.R7$(2),e.JRh(e.i5U(10,8,t.montantLigne,"1.0-0")),e.R7$(3),e.JRh(t.remise)}}function De(i,g){if(1&i&&(e.j41(0,"div",131)(1,"div",132)(2,"div",133),e.nrm(3,"img",172),e.k0s(),e.j41(4,"div",135)(5,"p",136),e.EFF(6,"Nom Entreprise"),e.k0s(),e.j41(7,"p",136),e.EFF(8,"Secteur Entreprise"),e.k0s(),e.j41(9,"div",136),e.EFF(10," Email: emailentreprise.com T\xe9l\xe9phone: 000000000 "),e.k0s()()(),e.nrm(11,"hr")(12,"hr"),e.j41(13,"div",137)(14,"h6"),e.EFF(15,"Facture proforma: "),e.j41(16,"span",138),e.EFF(17),e.k0s()()(),e.j41(18,"div",139)(19,"p",140),e.EFF(20),e.nI1(21,"date"),e.k0s()(),e.j41(22,"div",141)(23,"div",142)(24,"h6",143),e.EFF(25,"Vendeur : "),e.k0s(),e.j41(26,"p",143),e.EFF(27),e.k0s()(),e.j41(28,"div",144)(29,"h6",143),e.EFF(30,"Objet : "),e.k0s(),e.j41(31,"p",143),e.EFF(32),e.k0s()()(),e.j41(33,"div",145)(34,"table",146)(35,"thead")(36,"tr")(37,"th",147),e.EFF(38,"D\xe9signation"),e.k0s(),e.j41(39,"th",147),e.EFF(40,"PU"),e.k0s(),e.j41(41,"th",147),e.EFF(42,"Quantit\xe9"),e.k0s(),e.j41(43,"th",147),e.EFF(44,"Montant (FCFA)"),e.k0s(),e.j41(45,"th",147),e.EFF(46,"Remise "),e.k0s()()(),e.j41(47,"tbody"),e.DNE(48,Oe,13,11,"tr",148),e.k0s(),e.j41(49,"tfoot",149)(50,"tr")(51,"td",150),e.EFF(52,"Total HT"),e.k0s(),e.j41(53,"td",151),e.EFF(54),e.nI1(55,"number"),e.k0s()(),e.j41(56,"tr")(57,"td",150),e.EFF(58,"Remise 0%"),e.k0s(),e.j41(59,"td",151),e.EFF(60),e.nI1(61,"number"),e.k0s()(),e.j41(62,"tr")(63,"td",150),e.EFF(64,"Montant TTC"),e.k0s(),e.j41(65,"td",151),e.EFF(66),e.nI1(67,"number"),e.k0s()()()()(),e.j41(68,"div",152)(69,"p",153),e.EFF(70,"Arr\xeat\xe9 la pr\xe9sente facture \xe0 la somme de : Zero ....."),e.k0s()(),e.j41(71,"div",154)(72,"div",155)(73,"p",156),e.EFF(74,"Signataire"),e.k0s()(),e.j41(75,"div",157)(76,"p",156),e.EFF(77,"Nom Signataire"),e.k0s()()(),e.j41(78,"div",158)(79,"div",159),e.nrm(80,"hr"),e.j41(81,"p",160)(82,"strong"),e.EFF(83,"www.siteweb.com"),e.k0s()(),e.j41(84,"div",161)(85,"em"),e.EFF(86," NINA: 000000 RCCM: 000000 NIF: 000000 Banque: Banque "),e.k0s()(),e.j41(87,"div",162)(88,"em"),e.EFF(89,"Adresse : Rue / Pays"),e.k0s()()()()()),2&i){const t=e.XpG();e.R7$(17),e.SpI(" ",t.selectedAchat.numeroFacture," "),e.R7$(3),e.SpI(" ",e.i5U(21,8,t.selectedAchat.dateVente,"dd/MM/yyyy HH:mm")," "),e.R7$(7),e.JRh(t.selectedAchat.nomVendeur),e.R7$(5),e.JRh(t.selectedAchat.description),e.R7$(16),e.Y8G("ngForOf",t.selectedAchat.lignes),e.R7$(6),e.JRh(e.i5U(55,11,t.selectedAchat.montantTotal,"1.0-0")),e.R7$(6),e.JRh(e.i5U(61,14,t.selectedAchat.remiseGlobale,"1.0-0")),e.R7$(6),e.JRh(e.i5U(67,17,t.selectedAchat.montantTotal-t.selectedAchat.remiseGlobale,"1.0-0"))}}function Ie(i,g){if(1&i){const t=e.RV6();e.j41(0,"tr",170),e.bIt("click",function(){const r=e.eBV(t).$implicit,p=e.XpG();return e.Njj(p.onSelectAchat(r))}),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"td")(7,"span",173),e.EFF(8),e.k0s()(),e.j41(9,"td",81),e.EFF(10),e.nI1(11,"number"),e.k0s()()}if(2&i){const t=g.$implicit,n=e.XpG();e.AVh("selected-row",n.selectedAchatId===t.venteId),e.R7$(2),e.JRh(t.numeroFacture),e.R7$(2),e.JRh(e.i5U(5,6,t.dateVente,"dd/MM/yyyy")),e.R7$(4),e.JRh(t.modePaiement),e.R7$(2),e.JRh(e.i5U(11,9,t.montantTotal,"1.0-0"))}}function Te(i,g){1&i&&(e.j41(0,"div",194),e.EFF(1," Ce champ est requis "),e.k0s())}function Ae(i,g){if(1&i&&(e.j41(0,"option",99),e.EFF(1),e.k0s()),2&i){const t=g.$implicit,n=e.XpG(2);e.Y8G("value",t),e.R7$(),e.Lme(" ",t," (",n.paysIndicatifs[t].indicatif,") ")}}function $e(i,g){if(1&i){const t=e.RV6();e.j41(0,"div",174)(1,"div",175)(2,"div",176)(3,"h4"),e.EFF(4,"Ajouter une entreprise"),e.k0s(),e.j41(5,"button",177),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closePopup())}),e.EFF(6,"\xd7"),e.k0s()(),e.j41(7,"form",178)(8,"div",179)(9,"div",54)(10,"div",36),e.nrm(11,"input",180),e.j41(12,"label",181),e.EFF(13,"Nom entreprise "),e.j41(14,"span",182),e.EFF(15,"*"),e.k0s()(),e.DNE(16,Te,2,0,"div",183),e.k0s(),e.j41(17,"div",36),e.nrm(18,"input",184),e.j41(19,"label",181),e.EFF(20,"Email"),e.k0s()()(),e.j41(21,"div",54)(22,"div",36),e.nrm(23,"input",185),e.j41(24,"label",181),e.EFF(25,"Adresse"),e.k0s()(),e.j41(26,"div",36),e.nrm(27,"input",186),e.j41(28,"label",181),e.EFF(29,"Ville"),e.k0s()()(),e.j41(30,"div",187)(31,"div",44)(32,"select",45),e.bIt("change",function(r){e.eBV(t);const p=e.XpG();return e.Njj(p.onEntreprisePaysChange(r))}),e.j41(33,"option",46),e.EFF(34,"Pays"),e.k0s(),e.DNE(35,Ae,2,3,"option",47),e.k0s(),e.j41(36,"label",48),e.EFF(37,"Pays"),e.k0s()(),e.j41(38,"div",49)(39,"input",188),e.bIt("focus",function(){let r;e.eBV(t);const p=e.XpG();return e.Njj(p.onEntreprisePaysChange({target:{value:null==(r=p.entrepriseForm.get("pays"))?null:r.value}}))})("input",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.formatEntreprisePhoneNumber())}),e.k0s(),e.j41(40,"label",181),e.EFF(41,"T\xe9l\xe9phone"),e.k0s()(),e.j41(42,"div",52),e.nrm(43,"input",189),e.j41(44,"label",181),e.EFF(45,"Secteur"),e.k0s()()()(),e.nrm(46,"div",190),e.j41(47,"div",191)(48,"button",192),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.closePopup())}),e.EFF(49,"Annuler"),e.k0s(),e.j41(50,"button",193),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.ajouterEntreprise())}),e.EFF(51," Ajouter "),e.k0s()()()()()}if(2&i){let t;const n=e.XpG();e.R7$(7),e.Y8G("formGroup",n.entrepriseForm),e.R7$(9),e.Y8G("ngIf",(null==(t=n.entrepriseForm.get("nom"))?null:t.invalid)&&(null==(t=n.entrepriseForm.get("nom"))?null:t.touched)),e.R7$(19),e.Y8G("ngForOf",n.paysKeys),e.R7$(15),e.xc7("background-color",n.entrepriseForm.valid?"#0672E4":"#0671e434")("color",n.entrepriseForm.valid?"#ffffff":"#00000073")("cursor",n.entrepriseForm.valid?"pointer":"no-drop"),e.Y8G("disabled",n.entrepriseForm.invalid)}}let we=(()=>{class i{ngOnInit(){this.getListEntreprise(),this.initEntreprise(),this.getClientForm(),this.getEntrepriseForm(),this.loadEntreprises(),this.getRouteClient(),this.modifierClientForm.disable(),this.control.disable(),this.loadEntrepriseInfo(),this.getVentes()}constructor(t,n,r,p,_,x,$,N){this.router=t,this.fb=n,this.entrepriseService=r,this.clientService=p,this.route=_,this.factureService=x,this.usersService=$,this.venteService=N,this.imgUrl=B.c.imgUrl,this.ventes=[],this.errorMessage="",this.errorMessageApi="",this.successMessage="",this.isEntrepriseSelected=!1,this.showPopup=!1,this.urllink="assets/img/appareil.jpg",this.newPhotoUrl=null,this.selectedFile=null,this.imageFile=null,this.control=new m.MJ,this.filteredOptions=(0,y.of)([]),this.loading=!1,this.optionsEntreprise$=new b.t([]),this.entrepriseRequiredError=!1,this.indicatif="",this.maxPhoneLength=0,this.entrepriseIndicatif="",this.entrepriseMaxPhoneLength=0,this.isLoading=!1,this.facturesClient=[],this.loadingFactures=!1,this.errorFactures="",this.selectedFactureId=null,this.selectedAchatId=null,this.selectedAchat=null,this.factureDetails=null,this.clientPhotoUrl=null,this.selectedImageFile=null,this.entrepriseNom="",this.entrepriseSecteur="",this.entrepriseEmail="",this.entrepriseTelephone="",this.entrepriseSiege="",this.entrepriseLogo="",this.entrepriseSiteWeb="",this.entrepriseNina="",this.entrepriseRccm="",this.entrepriseNif="",this.entrepriseBanque="",this.entrepriseAdresse="",this.entreprisePays="",this.entrepriseSignataireNom="",this.entrepriseSignataire="",this.factureCount=0,this.achatCount=0,this.isEditing=!1,this.displayedColumns1=["numero","date","statut","montant"],this.paysIndicatifs={Mali:{indicatif:"+223",longueur:8},S\u00e9n\u00e9gal:{indicatif:"+221",longueur:9},"C\xf4te d'Ivoire":{indicatif:"+225",longueur:10},"Burkina Faso":{indicatif:"+226",longueur:8},Niger:{indicatif:"+227",longueur:8},France:{indicatif:"+33",longueur:9},Belgique:{indicatif:"+32",longueur:9},Suisse:{indicatif:"+41",longueur:9},Canada:{indicatif:"+1",longueur:10},"\xc9tats-Unis":{indicatif:"+1",longueur:10},Maroc:{indicatif:"+212",longueur:9},Alg\u00e9rie:{indicatif:"+213",longueur:9},Tunisie:{indicatif:"+216",longueur:8},Togo:{indicatif:"+228",longueur:8},B\u00e9nin:{indicatif:"+229",longueur:8},Guin\u00e9e:{indicatif:"+224",longueur:9},Tchad:{indicatif:"+235",longueur:8},Cameroun:{indicatif:"+237",longueur:9},RDC:{indicatif:"+243",longueur:9},Gabon:{indicatif:"+241",longueur:9},"Afrique du Sud":{indicatif:"+27",longueur:9},Rwanda:{indicatif:"+250",longueur:9},Kenya:{indicatif:"+254",longueur:9},Nig\u00e9ria:{indicatif:"+234",longueur:10},Ghana:{indicatif:"+233",longueur:9},\u00c9thiopie:{indicatif:"+251",longueur:9},\u00c9gypte:{indicatif:"+20",longueur:10},Inde:{indicatif:"+91",longueur:10},Chine:{indicatif:"+86",longueur:11},Mexique:{indicatif:"+52",longueur:10},Allemagne:{indicatif:"+49",longueur:10},Espagne:{indicatif:"+34",longueur:9},Italie:{indicatif:"+39",longueur:10},"Royaume-Uni":{indicatif:"+44",longueur:10},"Pays-Bas":{indicatif:"+31",longueur:9},Portugal:{indicatif:"+351",longueur:9}},this.paysKeys=Object.keys(this.paysIndicatifs),this.client=null,this.showConfirmationModalC=!1,this.isDeletingC=!1}testImageCompression(t){var n=this;return(0,h.A)(function*(){if(!t)return void console.log("Aucun fichier s\xe9lectionn\xe9.");console.log("Taille originale:",t.size/1024,"Ko");const r={maxSizeMB:1,maxWidthOrHeight:1e3,useWebWorker:!0};try{const p=yield(0,w.A)(t,r);if(console.log("Taille apr\xe8s compression:",p.size/1024,"Ko"),"image/png"!==p.type&&"image/jpeg"!==p.type)return console.error("Le fichier compress\xe9 n'est pas un format support\xe9 (PNG ou JPEG)."),void(n.errorMessage="Erreur de compression : Le format de l'image n'est pas valide.");const _=new FileReader;_.onload=x=>{n.newPhotoUrl=x.target?.result,console.log("Image compress\xe9e pr\xeate \xe0 \xeatre affich\xe9e !")},_.readAsDataURL(p)}catch(p){console.error("Erreur lors de la compression:",p)}})()}onFileSelected(t){this.errorMessage="";const n=t.target;if(n.files?.length){const r=n.files[0];if(this.selectedImageFile=r,!["image/jpeg","image/png","image/jpg"].includes(r.type))return void(this.errorMessage="Seuls les formats JPG, PNG sont accept\xe9s");this.testImageCompression(r);const _=new FileReader;_.onload=x=>{this.newPhotoUrl=x.target?.result},_.readAsDataURL(r)}}loadFactureDetails(t){this.factureService.getFactureProformaById(t).subscribe({next:n=>{const r=n.remise||0,p=n.totalHT-n.totalHT*r/100;let _=0,x=0;n.tva&&(_=n.totalFacture-p,p>0&&(x=_/p));let $=r;$>100&&(console.warn(`Remise invalide corrig\xe9e: ${$}% -> 100%`),$=100),this.factureDetails={...n,montantTVA:_,tauxTva:x,remise:$}},error:n=>{console.error("Erreur chargement d\xe9tails facture",n)}})}onSelectFacture(t){this.selectedFactureId=t.id,this.loadFactureDetails(t.id)}onSelectAchat(t){this.selectedAchat=t,this.selectedAchatId=t.venteId,console.log("Achat s\xe9lectionn\xe9:",this.selectedAchat)}loadEntrepriseInfo(){this.entrepriseService.getEntrepriseInfo().subscribe({next:t=>{this.entrepriseNom=t.nom,this.entrepriseSecteur=t.secteur,this.entrepriseEmail=t.email,this.entrepriseTelephone=t.telephone,this.entrepriseSiege=t.siege,this.entrepriseLogo=t.logo?`${this.imgUrl}${t.logo}`:"",this.entrepriseSiteWeb=t.siteWeb,this.entrepriseNina=t.nina,this.entrepriseRccm=t.rccm,this.entrepriseNif=t.nif,this.entrepriseBanque=t.banque,this.entrepriseAdresse=t.adresse,this.entreprisePays=t.pays,this.entrepriseSignataireNom=t.signataireNom,this.entrepriseSignataire=t.signataire},error:t=>{console.error("Erreur chargement infos entreprise",t)}})}getTotalFactures(){const t=this.facturesClient.reduce((n,r)=>n+r.totalFacture,0);return Math.round(t)}triggerFileInput(){this.isEditing&&this.fileInput.nativeElement.click()}startEditing(){this.isEditing=!0,this.modifierClientForm.enable()}onPaysChange(t){const r=this.paysIndicatifs[t.target.value];if(r){this.indicatif=r.indicatif,this.maxPhoneLength=r.longueur,this.modifierClientForm.get("telephone")?.enable();const p=this.modifierClientForm.get("telephone");let _=p?.value??"";const x=this.indicatif.replace(/\D/g,""),$=_.replace(/\D/g,"");if($.startsWith(x)){const N=$.slice(x.length);p?.setValue(this.indicatif+N)}else p?.setValue(this.indicatif);this.updatePhoneValidator(this.maxPhoneLength)}else this.modifierClientForm.get("telephone")?.disable()}updatePhoneValidator(t){const n=new RegExp(`^\\${this.indicatif}\\s?\\d{${t}}$`);this.modifierClientForm.controls.telephone.setValidators([m.k0.pattern(n)]),this.modifierClientForm.controls.telephone.updateValueAndValidity()}formatPhoneNumber(){const t=this.modifierClientForm.get("telephone");let r=(t?.value??"").replace(/\D/g,"");const p=this.indicatif.replace(/\D/g,"");r.startsWith(p)&&(r=r.slice(p.length));const _=this.indicatif+r.slice(0,this.maxPhoneLength);t?.setValue(_)}goToStock(){this.router.navigate(["/clients"])}getRouteClient(){this.route.params.subscribe(t=>{this.clientId=+t.id,this.loadClientData()})}cancelEditing(){this.isEditing=!1,this.modifierClientForm.disable(),this.loadClientData()}getFullImageUrl(t){return t.startsWith("http")||t.startsWith("assets")?t:t?`${B.c.imgUrl}${t}`:"assets/img/profil.png"}loadClientData(){this.clientService.getClientById(this.clientId).subscribe({next:t=>{this.clientPhotoUrl=t.photo?this.clientService.getFullImageUrl(t.photo):"assets/img/profil.png",this.populateForm(t),this.modifierClientForm.disable(),this.handleEntreprise(t.entrepriseClient),this.loadFacturesClient(),t.photo&&(this.clientPhotoUrl=this.clientService.getFullImageUrl(t.photo))},error:t=>{this.errorMessage="Erreur lors du chargement du client",console.error("Erreur:",t)}})}loadFacturesClient(){this.loadingFactures=!0,this.factureService.getFacturesByClient(this.clientId).subscribe({next:t=>{this.facturesClient=t,this.factureCount=t.length,this.loadingFactures=!1,this.facturesClient.length>0&&this.onSelectFacture(this.facturesClient[0])},error:t=>{this.errorFactures="Erreur lors du chargement des factures",this.loadingFactures=!1,console.error(t)}})}populateForm(t){if(this.modifierClientForm.patchValue({nomComplet:t.nomComplet,email:t.email,telephone:t.telephone,adresse:t.adresse,poste:t.poste,pays:t.pays,ville:t.ville}),t.telephone){const n=t.telephone.replace(/(\+\d{3})(\d+)/,"$1 $2");this.modifierClientForm.patchValue({telephone:n})}if(t.pays){const n=this.paysIndicatifs[t.pays];n&&(this.indicatif=`${n.indicatif} `,this.maxPhoneLength=n.longueur,this.updatePhoneValidator(n.longueur))}}handleEntreprise(t){this.isEntrepriseSelected=!!t,this.control.setValue(t),this.entrepriseRequiredError=!1}getClientForm(){this.modifierClientForm=this.fb.group({nomComplet:["",[m.k0.required,m.k0.minLength(2)]],email:["",[m.k0.email]],telephone:[""],adresse:[""],poste:[""],pays:[""],ville:[""]})}getEntrepriseForm(){this.entrepriseForm=this.fb.group({nom:["",m.k0.required],email:["",m.k0.email],telephone:[""],adresse:[""],siege:[""],secteur:[""],pays:[""]})}loadEntreprises(){localStorage.getItem("accessToken")&&this.entrepriseService.getListEntreprise().subscribe(n=>{this.optionsEntreprise$.next(n),this.setupAutocomplete()},n=>{console.error("Erreur lors de la r\xe9cup\xe9ration des entreprises :",n),this.errorMessage=n.error?.error||"Erreur chargement entreprises"})}setupAutocomplete(){this.filteredOptions=(0,v.z)([this.control.valueChanges.pipe((0,P.Z)(""),(0,O.T)(t=>"string"==typeof t?t:t?.nom)),this.optionsEntreprise$]).pipe((0,O.T)(([t,n])=>t?this._filter(t,n):n))}getListEntreprise(){this.usersService.getValidAccessToken().pipe((0,D.n)(t=>t?this.entrepriseService.getListEntreprise():(console.error("\u{1f510} Aucun token trouv\xe9 !"),(0,F.$)(()=>new Error("Aucun token trouv\xe9"))))).subscribe({next:t=>{console.log("\u{1f3e2} Entreprises re\xe7ues depuis l'API :",t),this.optionsEntreprise$.next(t),this.filteredOptions=this.control.valueChanges.pipe((0,P.Z)(""),(0,O.T)(n=>n?"string"==typeof n?n:n.nom:""),(0,O.T)(n=>n?this._filter(n,this.optionsEntreprise$.value):this.optionsEntreprise$.value.slice()))},error:t=>{console.error("\u274c Erreur lors de la r\xe9cup\xe9ration des entreprises :",t)}})}_filter(t,n){const r=t.toLowerCase();return n.filter(p=>p.nom.toLowerCase().includes(r))}displayFnEntreprise(t){return t?t.nom:""}onEntrepriseSelected(t){}openPopup(){this.isEditing?this.isEditing&&(this.getEntrepriseForm(),this.entrepriseForm.reset(),this.entrepriseForm.patchValue({pays:"Mali"}),this.onEntreprisePaysChange({target:{value:this.entrepriseForm.get("pays")?.value}}),this.showPopup=!0,this.entrepriseRequiredError=!1):this.errorMessage="Activez le mode \xe9dition pour cr\xe9er une entreprise"}closePopup(){this.showPopup=!1}initEntreprise(){this.entrepriseForm=this.fb.group({nom:["",m.k0.required],pays:[""],email:[""],telephone:[""],adresse:[""],siege:[""],secteur:[""]})}ajouterEntreprise(){this.entrepriseForm.invalid||(this.isLoading=!0,setTimeout(()=>{this.entrepriseService.addEntreprise({nom:this.entrepriseForm.value.nom,pays:this.entrepriseForm.value.pays,email:this.entrepriseForm.value.email,telephone:this.entrepriseForm.value.telephone,adresse:this.entrepriseForm.value.adresse,siege:this.entrepriseForm.value.siege,secteur:this.entrepriseForm.value.secteur,logo:this.entrepriseForm.value.logo,nif:this.entrepriseForm.value.nif,nina:this.entrepriseForm.value.nina,banque:this.entrepriseForm.value.banque,rccm:this.entrepriseForm.value.rccm,siteWeb:this.entrepriseForm.value.siteWeb,signataire:this.entrepriseForm.value.signataire,signataireNom:this.entrepriseForm.value.signataireNom,prefixe:this.entrepriseForm.value.prefixe,suffixe:this.entrepriseForm.value.suffixe,tauxTva:this.entrepriseForm.value.tauxTva,signaturNum:this.entrepriseForm.value.signaturNum,cachetNum:this.entrepriseForm.value.cachetNum}).subscribe({next:n=>{this.optionsEntreprise$.next([n,...this.optionsEntreprise$.value]),this.control.setValue(n),this.closePopup(),this.entrepriseForm.reset(),this.isLoading=!1},error:n=>{this.errorMessageApi=n.message||"Erreur lors de la cr\xe9ation",this.isLoading=!1}})},3e3))}modifierClient(){this.errorMessage="",this.errorMessageApi="",this.successMessage="",this.markFormGroupTouched(this.modifierClientForm),this.modifierClientForm.invalid?this.errorMessage="Veuillez corriger les erreurs dans le formulaire.":!this.isEntrepriseSelected||this.control.value?(this.isLoading=!0,setTimeout(()=>{const t={...this.modifierClientForm.value,id:this.clientId};let n;this.selectedImageFile?n=this.selectedImageFile:this.clientPhotoUrl?.includes("assets")&&(t.photo=null),t.entrepriseClient=this.isEntrepriseSelected&&this.control.value?.id?{id:this.control.value.id}:null,this.clientService.updateClient(this.clientId,t,n).subscribe({next:r=>{this.clientPhotoUrl=r.photo?this.clientService.getFullImageUrl(r.photo):"assets/img/profil.png",this.successMessage="Client modifi\xe9 avec succ\xe8s !",this.errorMessage="",this.newPhotoUrl=null,this.selectedImageFile=null,this.isEditing=!1,this.modifierClientForm.disable(),this.isLoading=!1},error:r=>{console.error("Erreur:",r),this.errorMessage=r.error?.message||"Erreur lors de la modification du client",this.successMessage="",this.isLoading=!1}})},3e3)):this.errorMessage="Veuillez s\xe9lectionner ou cr\xe9er une entreprise."}markFormGroupTouched(t){Object.values(t.controls).forEach(n=>{n.markAsTouched(),n instanceof m.gE&&this.markFormGroupTouched(n)})}toggleEditing(){this.isEditing=!this.isEditing,this.isEditing?(this.control.enable(),this.modifierClientForm.enable()):(this.errorMessage="",this.entrepriseRequiredError=!1,this.control.disable(),this.modifierClientForm.disable(),this.loadClientData())}goToClients(){this.isEditing?this.cancelEditing():this.router.navigate(["/clients"])}formatEntreprisePhoneNumber(){let t=this.entrepriseForm.get("telephone")?.value;if(!t.startsWith(this.entrepriseIndicatif))return void this.entrepriseForm.get("telephone")?.setValue(this.entrepriseIndicatif);const n=t.replace(this.entrepriseIndicatif,"").replace(/\D/g,""),r=this.entrepriseIndicatif+n,p=this.entrepriseIndicatif.length+this.entrepriseMaxPhoneLength;this.entrepriseForm.get("telephone")?.setValue(r.slice(0,p))}onEntreprisePaysChange(t){const r=this.paysIndicatifs[t.target.value];r&&(this.entrepriseIndicatif=`${r.indicatif} `,this.entrepriseMaxPhoneLength=r.longueur,(this.entrepriseForm.get("telephone")?.value||"").startsWith(this.entrepriseIndicatif)||this.entrepriseForm.get("telephone")?.setValue(this.entrepriseIndicatif),this.updateEntreprisePhoneValidator(r.longueur))}updateEntreprisePhoneValidator(t){this.entrepriseForm.controls.telephone.setValidators([m.k0.pattern(`^\\${this.entrepriseIndicatif}\\d{${t}}$`)]),this.entrepriseForm.controls.telephone.updateValueAndValidity()}navigateBack(){this.router.navigate(["/clients"])}deleteClient(){this.client||this.clientId?this.showConfirmationModalC=!0:console.error("Client ou ID non disponible.")}confirmDeleteC(){var t=this;return(0,h.A)(function*(){if(t.showConfirmationModalC=!1,t.client||t.clientId){t.isDeletingC=!0,t.errorMessage="",t.successMessage="";try{const n=t.client?.id||t.clientId,r=yield t.clientService.deleteClient(n).toPromise();t.successMessage=r||"Client supprim\xe9 avec succ\xe8s !",setTimeout(()=>{t.router.navigate(["/clients"])},2e3)}catch(n){let r=n?.message||n?.error||"Erreur lors de la suppression.";const p="Une erreur est survenue : ";r.startsWith(p)&&(r=r.substring(p.length)),t.errorMessage=r}finally{t.isDeletingC=!1,setTimeout(()=>{t.errorMessage="",t.successMessage=""},5e3)}}else t.errorMessage="Client non disponible pour suppression."})()}getVentes(){this.loading=!0,this.errorMessage="",this.venteService.getVenteByClient(this.clientId,this.entrepriseClientId).subscribe({next:t=>{console.log("donn\xe9es re\xe7ues :",t),this.ventes=t,this.achatCount=this.ventes.length,this.ventes.length>0&&(this.selectedAchatId=this.ventes[0].venteId,this.selectedAchat=this.ventes[0],console.log("Premier achat s\xe9lectionn\xe9 automatiquement :",this.selectedAchatId)),this.ventes=t,this.loading=!1},error:t=>{console.error("Erreur r\xe9cup\xe9ration ventes :",t),this.errorMessage="Impossible de r\xe9cup\xe9rer les ventes.",this.loading=!1}})}selectClient(t){this.clientId=t.id,this.entrepriseClientId=void 0,this.getVentes()}selectEntrepriseClient(t){this.entrepriseClientId=t.id,this.clientId=0,this.getVentes()}get totalMontant(){return this.ventes?.reduce(function(t,n){return t+(n.montantTotal||0)},0)||0}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(G.Ix),e.rXU(m.ok),e.rXU(W.r),e.rXU(Y.X),e.rXU(G.nX),e.rXU(X.c),e.rXU(J.g),e.rXU(K.W))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-detail-edit-client"]],viewQuery:function(n,r){if(1&n&&e.GBs(H,5),2&n){let p;e.mGM(p=e.lsd())&&(r.fileInput=p.first)}},decls:156,vars:31,consts:[["fileInput",""],["noFactureSelected",""],["auto","matAutocomplete"],[1,"toast-container"],["class","alert alert-danger toast-message-danger",4,"ngIf"],["class","alert alert-success toast-message-success",4,"ngIf"],[1,"container_client"],["title","Retour sur la page client",1,"retour_icon_text",2,"cursor","pointer","color","#0672E4",3,"click"],[1,"ri-arrow-left-s-line"],[2,"margin-left","8px","font-size","12px"],["class","loading-overlay",4,"ngIf"],[1,"information_cadre",2,"margin-bottom","20px","padding","20px"],[1,"info_personnel"],[1,"information_grid_two"],[1,"profil_section"],[1,"section_title"],[1,"title"],[1,"profile-img-wrapper",3,"click"],["alt","Photo de profil",1,"profile-img",3,"src"],[1,"overlay"],["src","assets/img/appareil.jpg","alt","Modifier",1,"camera-icon"],["type","file","accept","image/*","hidden","",3,"change"],[1,"taille_photo"],[2,"margin","0","font-size","8px","text-align","center"],[1,"delete-boutique-container",2,"margin-top","22px"],[2,"font-size","13px"],[1,"switch2"],["aria-label","Supprimer le client","title","Supprimer le client",1,"delete-boutique-btn",3,"click","disabled"],[1,"fas","fa-trash-alt"],[1,"info_section"],[1,"title","title_display"],[1,"icon_edit"],["class","ri-edit-box-line","title","Cliquer ici pour modifier",3,"click",4,"ngIf"],["style","color: #ff0000;","class","ri-close-line","title","Fermer l'\xe9dition",3,"click",4,"ngIf"],[1,"container_formulaire",3,"formGroup"],[1,"champ_grid_true"],[1,"champ_input"],["type","text","id","nomComplet","formControlName","nomComplet","name","nomComplet","placeholder","Saisis le nom et pr\xe9nom",1,"input_focus"],["for","nomComplet",1,"label"],["class","error",4,"ngIf"],["type","email","id","email","formControlName","email","placeholder","Saisis l'email",1,"input_focus"],["for","email",1,"label"],["id","adresse","formControlName","adresse","name","adresse","placeholder","Saisissez votre adresse ",1,"input_focus"],["for","adresse",1,"label"],[1,"champ_input","div1"],["formControlName","pays",1,"input_focus",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","pays",1,"label"],[1,"champ_input","div2"],["type","tel","id","telephone","formControlName","telephone","name","telephone","placeholder","Saisis le num\xe9ro de t\xe9l\xe9phone",1,"input_focus",3,"input"],["for","telephone",1,"label"],[1,"champ_input","div3"],["id","ville","formControlName","ville","name","ville","placeholder","Saisis la viille",1,"input_focus"],[1,"champ_grid"],["id","poste","formControlName","poste","name","poste","placeholder","Saisissez votre poste ",1,"input_focus"],["for","poste",1,"label"],["class","info_titre_input","style","margin-top: 20px;",4,"ngIf"],["class","cadre_entreprise",4,"ngIf"],["class"," information_cadre_save",4,"ngIf"],["class","confirmation-modal-averB",4,"ngIf"],[1,"information_cadre"],[1,"section_navbar"],[1,"custom-tabs",3,"selectedIndex"],["mat-tab-label",""],[1,"tab-content"],[1,"content_client"],[1,"profil_section","profil_section_facture"],["class","facture_model",4,"ngIf","ngIfElse"],[1,"non_facture"],[1,"info_section",2,"padding","0"],[1,"contact_info__"],[1,"section_title","section_title2",2,"padding","20px 20px 6px"],[1,"table-container",2,"max-height","41vh","border-radius","10px","display","flex","flex-direction","column","position","relative"],["class","loading-indicator",4,"ngIf"],["class","error-message",4,"ngIf"],["class","empty-state",4,"ngIf"],[4,"ngIf"],["class","sticky-footer",4,"ngIf"],["class","facture_model",4,"ngIf"],[2,"position","sticky","top","0","background","white","z-index","10","box-shadow","0 2px 2px -1px rgba(0,0,0,0.1)"],[1,"text-right"],[3,"selected-row","click",4,"ngFor","ngForOf"],[1,"sticky-footer"],[2,"width","100%"],[2,"background-color","#ffffff"],["colspan","3",1,"text-bold"],[1,"text-right","text-bold"],["label","Notes"],["label","????"],["class","popup-overlay",4,"ngIf"],[1,"alert","alert-danger","toast-message-danger"],[1,"alert","alert-success","toast-message-success"],[1,"loading-overlay"],[1,"loading-content"],[1,"spinner"],["title","Cliquer ici pour modifier",1,"ri-edit-box-line",3,"click"],["title","Fermer l'\xe9dition",1,"ri-close-line",2,"color","#ff0000",3,"click"],[1,"error"],[3,"value"],[1,"info_titre_input",2,"margin-top","20px"],[1,"champ_input_inventaire"],[1,"switch"],["type","checkbox",3,"ngModelChange","disabled","ngModel","ngModelOptions"],[1,"slider","round"],[1,"cadre_entreprise"],["type","text","placeholder","Selectionner un entreprise","matInput","",1,"input_focus","input_cursor",3,"formControl","matAutocomplete"],["for","categorieId",1,"label"],[3,"optionSelected","displayWith"],[1,"select-option",3,"click"],[2,"display","flex","align-items","center","color","#0672E4"],[1,"ri-community-line"],[2,"margin-left","8px"],[1,"icon_arrow"],[1,"ri-arrow-down-s-line"],[1,"option-content"],[1,"information_cadre_save"],[1,"info_titre_input","info_titre_input_btn"],[1,"btn_annuler"],[1,"btn_cancel",3,"click"],[1,"btn_ajouter"],[1,"btn_save",3,"click","disabled"],[1,"confirmation-modal-averB"],[1,"modal-content-averB"],[2,"font-size","16px","margin-bottom","10px"],[2,"margin","0","font-size","12px"],[1,"modal-actions-averB"],[1,"btn-confirm",2,"font-size","12px",3,"click"],[1,"btn-cancel",2,"font-size","12px",3,"click"],[1,"tab-label"],[1,"facture-count"],[1,"facture_model"],[1,"header_apercu",2,"display","flex","align-items","center","gap","5px","margin","10px"],[1,"logo_entreprise"],[3,"src"],[1,"entete_entreprise"],[1,"para1"],[1,"titre",2,"text-align","center","font-size","8px"],[2,"color","#0000003e"],[1,"date_right"],[2,"margin","0 10px","font-size","8px","text-align","right"],[1,"name_client",2,"margin-left","10px"],[1,"doit",2,"display","flex","align-items","center","gap","3px"],[2,"margin","0","font-size","8px"],[1,"objets",2,"display","flex","align-items","center","gap","3px"],[1,"container_table",2,"display","flex","justify-content","center"],[1,"table"],[1,"th"],[4,"ngFor","ngForOf"],[1,"tfoot"],["colspan","4",1,"td"],[1,"td"],[1,"arret_somme"],[2,"margin","0 0 0 10px","font-size","6px"],[1,"signature",2,"text-align","right","margin","20px 10px 16px 0"],[1,"post_signateure"],[2,"font-size","8px"],[1,"nom_signateure"],[1,"container_footer"],[1,"footer"],[2,"text-align","center","font-size","8px","margin","0 0 3px 0"],[2,"font-size","5px","text-align","center"],[2,"margin-top","0px","font-size","5px","text-align","center"],[1,"empty-preview"],[1,"ri-file-text-line"],[1,"loading-indicator"],[1,"ri-loader-4-line","spin"],[1,"error-message"],[1,"empty-state"],[1,"ri-file-list-2-line"],[3,"click"],[1,"status-badge",3,"ngClass"],["src","assets/img/Votre.png"],[1,"status-badge"],[1,"popup-overlay"],[1,"popup-content"],[1,"popup-header"],[1,"close-btn",3,"click"],[3,"formGroup"],[1,"popup-body"],["type","text","formControlName","nom","placeholder","Saisis le nom de l'entreprise",1,"input_focus"],[1,"label"],[2,"color","#ff0000","margin-left","5px"],["class","error-text",4,"ngIf"],["type","email","formControlName","email","placeholder","Saisis l'email",1,"input_focus"],["type","text","formControlName","adresse","placeholder","Saisis l'adresse",1,"input_focus"],["type","text","formControlName","siege","placeholder","Saisis le si\xe8ge",1,"input_focus"],[1,"grid_colonne"],["type","tel","formControlName","telephone","placeholder","Saisis le num\xe9ro de t\xe9l\xe9phone",1,"input_focus",3,"focus","input"],["formControlName","secteur","placeholder","Saisis le secteur",1,"input_focus"],[1,"container_error_message"],[1,"popup-footer"],["type","button",1,"btn-cancel",3,"click"],["type","submit",1,"btn-submit",3,"click","disabled"],[1,"error-text"]],template:function(n,r){if(1&n){const p=e.RV6();e.j41(0,"div",3),e.DNE(1,q,2,1,"div",4)(2,ee,2,1,"div",5)(3,te,2,1,"div",4),e.k0s(),e.j41(4,"div",6)(5,"p",7),e.bIt("click",function(){return e.eBV(p),e.Njj(r.navigateBack())}),e.nrm(6,"i",8),e.j41(7,"span",9),e.EFF(8,"Clients"),e.k0s()(),e.DNE(9,ie,5,0,"div",10),e.j41(10,"div",11)(11,"div",12)(12,"div",13)(13,"div",14)(14,"div",15)(15,"div",16)(16,"h6"),e.EFF(17,"Photo de profil du client"),e.k0s()()(),e.j41(18,"div",17),e.bIt("click",function(){return e.eBV(p),e.Njj(r.triggerFileInput())}),e.nrm(19,"img",18),e.j41(20,"div",19),e.nrm(21,"img",20),e.k0s()(),e.j41(22,"input",21,0),e.bIt("change",function(x){return e.eBV(p),e.Njj(r.onFileSelected(x))}),e.k0s(),e.j41(24,"div",22)(25,"p",23),e.EFF(26,"Formats JPG, GIF ou PNG autoris\xe9s. "),e.nrm(27,"br"),e.EFF(28," Taille maximale : 800 Ko."),e.k0s()(),e.j41(29,"div",24)(30,"span",25)(31,"span",25),e.EFF(32," Supprimer le client "),e.k0s()(),e.j41(33,"label",26)(34,"button",27),e.bIt("click",function(){return e.eBV(p),e.Njj(r.deleteClient())}),e.nrm(35,"i",28),e.k0s()()()(),e.j41(36,"div",29)(37,"div",15)(38,"div",30)(39,"h6"),e.EFF(40,"Informations Personnelles"),e.k0s(),e.j41(41,"div",31),e.DNE(42,ne,1,0,"i",32)(43,re,1,0,"i",33),e.k0s()()(),e.j41(44,"form",34)(45,"div",35)(46,"div",36),e.nrm(47,"input",37),e.j41(48,"label",38),e.EFF(49,"Nom et pr\xe9nom"),e.k0s(),e.DNE(50,ae,3,2,"div",39),e.k0s(),e.j41(51,"div",36),e.nrm(52,"input",40),e.j41(53,"label",41),e.EFF(54,"Email"),e.k0s(),e.DNE(55,ce,2,1,"div",39),e.k0s(),e.j41(56,"div",36),e.nrm(57,"input",42),e.j41(58,"label",43),e.EFF(59,"Adresse"),e.k0s()()(),e.j41(60,"div",35)(61,"div",44)(62,"select",45),e.bIt("change",function(x){return e.eBV(p),e.Njj(r.onPaysChange(x))}),e.j41(63,"option",46),e.EFF(64,"Pays"),e.k0s(),e.DNE(65,de,2,2,"option",47),e.k0s(),e.j41(66,"label",48),e.EFF(67,"Pays"),e.k0s()(),e.j41(68,"div",49)(69,"input",50),e.bIt("input",function(){return e.eBV(p),e.Njj(r.formatPhoneNumber())}),e.k0s(),e.j41(70,"label",51),e.EFF(71,"T\xe9l\xe9phone"),e.k0s()(),e.j41(72,"div",52),e.nrm(73,"input",53),e.j41(74,"label",48),e.EFF(75,"Ville"),e.k0s()()(),e.j41(76,"div",54)(77,"div",36),e.nrm(78,"input",55),e.j41(79,"label",56),e.EFF(80,"Poste"),e.k0s()(),e.j41(81,"div",36),e.nrm(82,"input",53),e.j41(83,"label",48),e.EFF(84,"Ville"),e.k0s()()()(),e.DNE(85,pe,9,4,"div",57)(86,me,16,6,"div",58)(87,ge,9,8,"div",59),e.k0s()()()(),e.DNE(88,he,11,0,"div",60),e.j41(89,"div",61)(90,"div",62)(91,"mat-tab-group",63)(92,"mat-tab"),e.DNE(93,fe,5,1,"ng-template",64),e.j41(94,"div",65)(95,"div",66)(96,"div",13)(97,"div",67),e.DNE(98,Ee,86,31,"div",68),e.j41(99,"div",69),e.DNE(100,be,4,0,"ng-template",null,1,e.C5r),e.k0s()(),e.j41(102,"div",70)(103,"div",71)(104,"div",72)(105,"div",16)(106,"h6"),e.EFF(107,"Toutes les factures"),e.k0s()()(),e.j41(108,"div",73),e.DNE(109,xe,3,0,"div",74)(110,Fe,2,1,"div",75)(111,Me,4,0,"div",76)(112,Pe,13,1,"table",77),e.k0s(),e.DNE(113,ke,9,3,"div",78),e.k0s()()()()()(),e.j41(114,"mat-tab"),e.DNE(115,je,5,1,"ng-template",64),e.j41(116,"div",65)(117,"div",66)(118,"div",13)(119,"div",67),e.DNE(120,De,90,20,"div",79),e.k0s(),e.j41(121,"div",70)(122,"div",71)(123,"div",72)(124,"div",16)(125,"h6"),e.EFF(126,"Toutes les achats"),e.k0s()()(),e.j41(127,"div",73)(128,"table")(129,"thead")(130,"tr",80)(131,"th"),e.EFF(132,"Num\xe9ro Facture"),e.k0s(),e.j41(133,"th"),e.EFF(134,"Date"),e.k0s(),e.j41(135,"th"),e.EFF(136,"Mode Paiement"),e.k0s(),e.j41(137,"th",81),e.EFF(138,"Montant"),e.k0s()()(),e.j41(139,"tbody"),e.DNE(140,Ie,12,12,"tr",82),e.k0s()()(),e.j41(141,"div",83)(142,"table",84)(143,"tfoot",85)(144,"tr")(145,"td",86),e.EFF(146,"Total"),e.k0s(),e.j41(147,"td",87),e.EFF(148),e.nI1(149,"number"),e.k0s()()()()()()()()()()(),e.j41(150,"mat-tab",88),e.nrm(151,"div",65),e.k0s(),e.j41(152,"mat-tab",89)(153,"div",65),e.EFF(154," Contenu de la s\xe9curit\xe9 "),e.k0s()()()()()(),e.DNE(155,$e,52,10,"div",90)}if(2&n){let p,_;const x=e.sdS(101);e.R7$(),e.Y8G("ngIf",r.errorMessage),e.R7$(),e.Y8G("ngIf",r.successMessage),e.R7$(),e.Y8G("ngIf",r.errorMessageApi),e.R7$(6),e.Y8G("ngIf",r.isLoading),e.R7$(10),e.Y8G("src",r.newPhotoUrl||r.clientPhotoUrl||"assets/img/profil.png",e.B4B),e.R7$(15),e.Y8G("disabled",r.isDeletingC),e.R7$(8),e.Y8G("ngIf",!r.isEditing),e.R7$(),e.Y8G("ngIf",r.isEditing),e.R7$(),e.Y8G("formGroup",r.modifierClientForm),e.R7$(6),e.Y8G("ngIf",(null==(p=r.modifierClientForm.get("nomComplet"))?null:p.touched)&&(null==(p=r.modifierClientForm.get("nomComplet"))?null:p.invalid)),e.R7$(5),e.Y8G("ngIf",(null==(_=r.modifierClientForm.get("email"))?null:_.touched)&&(null==(_=r.modifierClientForm.get("email"))?null:_.invalid)),e.R7$(10),e.Y8G("ngForOf",r.paysKeys),e.R7$(20),e.Y8G("ngIf",r.isEditing||r.isEntrepriseSelected),e.R7$(),e.Y8G("ngIf",r.isEntrepriseSelected&&(r.isEditing||r.isEntrepriseSelected)),e.R7$(),e.Y8G("ngIf",r.isEditing),e.R7$(),e.Y8G("ngIf",r.showConfirmationModalC),e.R7$(3),e.Y8G("selectedIndex",0),e.R7$(7),e.Y8G("ngIf",r.factureDetails)("ngIfElse",x),e.R7$(11),e.Y8G("ngIf",r.loadingFactures),e.R7$(),e.Y8G("ngIf",!r.loadingFactures&&r.errorFactures),e.R7$(),e.Y8G("ngIf",!r.loadingFactures&&!r.errorFactures&&0===r.facturesClient.length),e.R7$(),e.Y8G("ngIf",!r.loadingFactures&&!r.errorFactures&&r.facturesClient.length>0),e.R7$(),e.Y8G("ngIf",!r.loadingFactures&&!r.errorFactures&&r.facturesClient.length>0),e.R7$(7),e.Y8G("ngIf",r.selectedAchat),e.R7$(20),e.Y8G("ngForOf",r.ventes),e.R7$(8),e.SpI(" ",e.i5U(149,28,r.totalMontant,"1.0-0")," "),e.R7$(7),e.Y8G("ngIf",r.showPopup)}},dependencies:[m.YN,m.qT,m.xH,m.y7,m.me,m.Zm,m.wz,m.BC,m.cb,m.vS,E.MD,E.YU,E.Sq,E.bT,E.Jj,E.QX,E.vh,m.X1,m.l_,m.j4,m.JD,S.jL,S.$3,u.wT,S.pN,l.v,o.RI,o.ES,o.mq,o.T8,s.MY,a.RG,c.m_,U,L.tP,z],styles:['@charset "UTF-8";.container_client[_ngcontent-%COMP%]{width:100%;background-color:#f1f1f1;border-radius:12px;box-shadow:0 10px 30px #0000001a;overflow:hidden}.information_cadre[_ngcontent-%COMP%]{width:100%;height:auto;background-color:#fff;box-shadow:2px 2px 30px #0000001c;border-radius:5px;margin-top:0;margin-bottom:10px;padding:10px 0}.content_client[_ngcontent-%COMP%]{padding:30px}.information_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 2fr;gap:20px}.information_grid_two[_ngcontent-%COMP%]{display:grid;grid-template-columns:27% 2fr;gap:20px}.section_title[_ngcontent-%COMP%]{margin-bottom:10px;position:relative;padding-bottom:2px}.section_title[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#2c3e50;text-transform:uppercase;letter-spacing:1px}.title_display[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.section_title[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;width:50px;height:3px;background:linear-gradient(to right,#4b6cb7,#182848);border-radius:3px}.section_title2[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:21px;width:50px;height:3px;background:linear-gradient(to right,#4b6cb7,#182848);border-radius:3px}.profil_section[_ngcontent-%COMP%]{padding:25px;background-color:#fff;border:1px solid #e9e9e9;box-shadow:#00000001 0 0 0 1px;border-radius:20px}.profil_section_facture[_ngcontent-%COMP%]{min-height:50vh;padding:0!important}.info_section[_ngcontent-%COMP%]{padding:25px;background-color:#fff;border:1px solid #e9e9e9;box-shadow:#00000001 0 0 0 1px;border-radius:20px}.info_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:20px}.champ_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.champ_grid_true[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.champ_input[_ngcontent-%COMP%]{position:relative;margin-bottom:5px}.input_focus[_ngcontent-%COMP%]{width:100%;height:40px;outline:none;border-bottom:1px solid rgb(53,50,50);border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:10px;background:none;color:#000}.champ_input[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:4px;pointer-events:none;color:#999}.input_focus[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.input_focus[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:5px;left:0;transition:all .3s ease-in-out;background:none;font-size:10px;padding:0}.input_focus[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:12px;transition:all .2s ease-in-out}.profile-img-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100px;height:100px;border-radius:50%;overflow:hidden;cursor:pointer;transition:transform .2s ease-in-out;display:flex;justify-content:center;margin:20px auto}.profile-img-wrapper[_ngcontent-%COMP%]:hover{transform:scale(1.01)}.profile-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:50%}.overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0000004d;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s ease-in-out}.profile-img-wrapper[_ngcontent-%COMP%]:hover   .overlay[_ngcontent-%COMP%]{opacity:1}.camera-icon[_ngcontent-%COMP%]{width:30px;height:30px;background:#fff;padding:6px;border-radius:50%;box-shadow:0 0 4px #00000026}.icon_edit[_ngcontent-%COMP%]{margin-top:-7px}.icon_edit[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;cursor:pointer}@media (max-width: 768px){.information_grid[_ngcontent-%COMP%], .information_grid_two[_ngcontent-%COMP%], .info_grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.info_item[_ngcontent-%COMP%]{margin-bottom:20px}.info_label[_ngcontent-%COMP%]{font-size:14px;color:#6c757d;font-weight:500;margin-bottom:5px}.info_value[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#2c3e50}.contact_info[_ngcontent-%COMP%]{margin-top:20px}.contact_item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:15px}.contact_icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#e9ecef;display:flex;align-items:center;justify-content:center;color:#4b6cb7;font-size:18px}.tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-top:20px}.tag[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;padding:6px 12px;border-radius:20px;font-size:13px;font-weight:500}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:30px;height:15px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0 0 0 2px;background-color:#ccc;transition:.4s;border-radius:24px}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:11px;width:11px;left:2px;bottom:2px;background-color:#fff;transition:.4s;border-radius:50%}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#0672e4}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(13px)}.input_cursor[_ngcontent-%COMP%]{cursor:pointer}.icon_arrow[_ngcontent-%COMP%]{position:absolute;right:10px;top:25px}.icon_arrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px;color:#000}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;width:50%}.popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.popup-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer}.popup-footer[_ngcontent-%COMP%]{margin-top:20px;text-align:right}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{margin-left:10px;border:none;border-radius:4px;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]{background-color:red;padding:6px 25px;color:#fff}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#d80101;transition:all ease-in .5s}.btn-submit[_ngcontent-%COMP%]{background-color:#0672e4;padding:6px 25px;color:#fff;cursor:pointer;cursor:no-drop}.btn-submit[_ngcontent-%COMP%]:hover{background-color:#0863c5;transition:all ease-in .5s}.error-text[_ngcontent-%COMP%]{color:#f44;font-size:.8rem;margin-top:4px}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.error-messageApi[_ngcontent-%COMP%]{font-size:9px;color:red;font-weight:700;position:relative;top:-20px;left:-20px}.success-messageApi[_ngcontent-%COMP%]{font-size:9px;color:#0672e4;font-weight:700;position:relative;top:-20px;left:-20px}.error-messageApi2[_ngcontent-%COMP%]{font-size:9px;color:red;font-weight:700}.success-messageApi2[_ngcontent-%COMP%]{font-size:9px;color:#0672e4;font-weight:700}.error[_ngcontent-%COMP%]{font-size:9px;color:red;font-weight:700;position:relative}.champ_input_inventaire[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}.champ_input_inventaire[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.table-container[_ngcontent-%COMP%]{margin:0;overflow:auto}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:2px;height:2px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0003;border-radius:3px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:12px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #eee}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#fff;font-weight:600;color:#000;letter-spacing:.6px}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]{background-color:#f1f3f5}table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:600;color:#212529}.text-right[_ngcontent-%COMP%]{text-align:right}.text-bold[_ngcontent-%COMP%]{font-weight:600}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:12px;font-size:9px;font-weight:500}.status-badge.draft[_ngcontent-%COMP%]{background-color:#e9ecef;color:#495057}.status-badge.sent[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.status-badge.approved[_ngcontent-%COMP%]{background-color:#c5c5e2;color:#00f}.status-badge.valid[_ngcontent-%COMP%]{background-color:#d5e6d5;color:green}.loading-indicator[_ngcontent-%COMP%]{padding:20px;text-align:center;color:#6c757d}.loading-indicator[_ngcontent-%COMP%]   .spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-right:8px}.empty-state[_ngcontent-%COMP%]{padding:40px 20px;text-align:center;color:#6c757d}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px;color:#ced4da}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.error-message[_ngcontent-%COMP%]{padding:20px;text-align:center;color:#dc3545;background-color:#fff8f8;border-radius:8px;margin:10px 0}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative}.table-wrapper[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.sticky-footer[_ngcontent-%COMP%]{position:sticky;bottom:0;background:#fff;z-index:10;box-shadow:0 -2px 5px #0000001a;border-top:1px solid #eee}.sticky-footer[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{position:sticky;top:0;background:#fff;z-index:10;box-shadow:0 2px 5px #0000001a}.logo_entreprise[_ngcontent-%COMP%]{width:50px}.logo_entreprise[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.para1[_ngcontent-%COMP%]{font-size:6px;margin:0}hr[_ngcontent-%COMP%]{margin:3px}.titre[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:10px}.table[_ngcontent-%COMP%]{width:93%;border-collapse:collapse;margin:4px 0;font-size:5px}.table[_ngcontent-%COMP%]   .th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   .td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:3px 5px;text-align:center}.table[_ngcontent-%COMP%]   .th[_ngcontent-%COMP%]{background-color:#f5f5f5;font-weight:600}.table[_ngcontent-%COMP%]   .tfoot[_ngcontent-%COMP%]   .td[_ngcontent-%COMP%]{font-weight:600;background-color:#f9f9f9}@media (max-width: 768px){table[_ngcontent-%COMP%]{font-size:11px}}@media (max-width: 480px){table[_ngcontent-%COMP%]{font-size:10px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 3px}}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]{padding:6px 20px;font-size:10px;letter-spacing:.6px;border:none;border-radius:5px;background-color:red;color:#fff}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]:hover{background-color:#d80101;transition:all ease-in .5s}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]{padding:6px 20px;font-size:10px;letter-spacing:.6px;border:none;border-radius:5px;background-color:#0672e4;color:#fff}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]:hover{background-color:#0863c5;transition:all .5s}.info_titre_input_btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:end;gap:8px;margin-top:12px}.grid_colonne[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.div1[_ngcontent-%COMP%]{grid-area:1/1/2/2}.div2[_ngcontent-%COMP%]{grid-area:1/2/2/3}.div3[_ngcontent-%COMP%]{grid-area:1/3/2/4}.selected-row[_ngcontent-%COMP%]{border:2px solid #0672E4;background-color:#f0f8ff}.tab-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.facture-count[_ngcontent-%COMP%]{background-color:#ddd;color:#000;border-radius:50%;font-size:12px;min-width:22px;height:22px;display:flex;justify-content:center;align-items:center;padding:2px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;color:#fff;font-size:18px;z-index:1000}.loading-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid white;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.container_error_message[_ngcontent-%COMP%]{margin-top:10px}.information_cadre_save[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.success-messageApi2[_ngcontent-%COMP%]{font-size:12px;color:#0672e4;font-weight:700}.toast-container[_ngcontent-%COMP%]{position:fixed;top:60px;right:35px;z-index:9999}.toast-message-success[_ngcontent-%COMP%]{background-color:#77eb87;border:1px solid #ACCEBC;color:#000;padding:10px;border-radius:8px;font-size:13px;box-shadow:0 4px 6px #0000001a;opacity:0;animation:_ngcontent-%COMP%_fadeInOut 4s ease-in-out;transform:translateY(-20px)}.toast-message-danger[_ngcontent-%COMP%], .toast-message-warning[_ngcontent-%COMP%]{background-color:#f3d8da;border:1px solid #E7B1B6;color:#000;padding:10px;border-radius:8px;font-size:13px;box-shadow:0 4px 6px #0000001a;opacity:0;animation:_ngcontent-%COMP%_fadeInOut 4s ease-in-out;transform:translateY(-20px)}@keyframes _ngcontent-%COMP%_fadeInOut{0%{opacity:0;transform:translateY(-20px)}20%{opacity:1;transform:translateY(0)}80%{opacity:1}to{opacity:0;transform:translateY(2px)}}.empty-preview[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:#6c757d}.empty-preview[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:48px;margin-bottom:10px}.empty-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;text-align:center}.delete-boutique-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;margin-top:22px}.delete-boutique-btn[_ngcontent-%COMP%]{background-color:transparent;border:none;color:#7a7a7ae7;cursor:pointer;font-size:20px;padding:0;transition:color .2s;bottom:10px;position:relative;left:10px}.delete-boutique-btn[_ngcontent-%COMP%]:hover{color:#fa2a2a}.btn-confirm[_ngcontent-%COMP%], .btn-cancel[_ngcontent-%COMP%]{flex:1;padding:8px 0;border:none;border-radius:5px;font-size:13px;cursor:pointer;transition:background .2s ease}.btn-confirm[_ngcontent-%COMP%]{background-color:#0672e4;color:#fff}.btn-confirm[_ngcontent-%COMP%]:hover{background-color:#1b83f2;color:#fff}.btn-cancel[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#333}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#c8c8c8}.switch2[_ngcontent-%COMP%]{position:relative;display:inline-block;width:30px;height:15px}.confirmation-modal-averB[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1050}.confirmation-modal-averB[_ngcontent-%COMP%]   .modal-content-averB[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;box-shadow:0 4px 8px #0003;width:300px;color:#000}.modal-actions-averB[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:10px}.btn-confirmB[_ngcontent-%COMP%]{background-color:#0672e4;color:#fff;border:none;padding:4px 10px;border-radius:4px;cursor:pointer}']})}}return i})()},45024:(V,j,d)=>{d.d(j,{CB:()=>l,DQ:()=>S,Q3:()=>F,qS:()=>P,sL:()=>w,xn:()=>E,y4:()=>O,zP:()=>a});var h=d(30017),b=(d(74402),d(7673),d(21413)),v=d(54438);class P{}function O(c){return c&&"function"==typeof c.connect&&!(c instanceof h.G)}var F=function(c){return c[c.REPLACED=0]="REPLACED",c[c.INSERTED=1]="INSERTED",c[c.MOVED=2]="MOVED",c[c.REMOVED=3]="REMOVED",c}(F||{});const w=new v.nKC("_ViewRepeater");class E{applyChanges(o,e,u,C,f){o.forEachOperation((M,A,I)=>{let k,T;if(null==M.previousIndex){const R=u(M,A,I);k=e.createEmbeddedView(R.templateRef,R.context,R.index),T=F.INSERTED}else null==I?(e.remove(A),T=F.REMOVED):(k=e.get(A),e.move(k,I),T=F.MOVED);f&&f({context:k?.context,operation:T,record:M})})}detach(){}}class S{viewCacheSize=20;_viewCache=[];applyChanges(o,e,u,C,f){o.forEachOperation((M,A,I)=>{let k,T;null==M.previousIndex?(k=this._insertView(()=>u(M,A,I),I,e,C(M)),T=k?F.INSERTED:F.REPLACED):null==I?(this._detachAndCacheView(A,e),T=F.REMOVED):(k=this._moveView(A,I,e,C(M)),T=F.MOVED),f&&f({context:k?.context,operation:T,record:M})})}detach(){for(const o of this._viewCache)o.destroy();this._viewCache=[]}_insertView(o,e,u,C){const f=this._insertViewFromCache(e,u);if(f)return void(f.context.$implicit=C);const M=o();return u.createEmbeddedView(M.templateRef,M.context,M.index)}_detachAndCacheView(o,e){const u=e.detach(o);this._maybeCacheView(u,e)}_moveView(o,e,u,C){const f=u.get(o);return u.move(f,e),f.context.$implicit=C,f}_maybeCacheView(o,e){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(o);else{const u=e.indexOf(o);-1===u?o.destroy():e.remove(u)}}_insertViewFromCache(o,e){const u=this._viewCache.pop();return u&&e.insert(u,o),u||null}}class l{_multiple;_emitChanges;compareWith;_selection=new Set;_deselectedToEmit=[];_selectedToEmit=[];_selected;get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}changed=new b.B;constructor(o=!1,e,u=!0,C){this._multiple=o,this._emitChanges=u,this.compareWith=C,e&&e.length&&(o?e.forEach(f=>this._markSelected(f)):this._markSelected(e[0]),this._selectedToEmit.length=0)}select(...o){this._verifyValueAssignment(o),o.forEach(u=>this._markSelected(u));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}deselect(...o){this._verifyValueAssignment(o),o.forEach(u=>this._unmarkSelected(u));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}setSelection(...o){this._verifyValueAssignment(o);const e=this.selected,u=new Set(o.map(f=>this._getConcreteValue(f)));o.forEach(f=>this._markSelected(f)),e.filter(f=>!u.has(this._getConcreteValue(f,u))).forEach(f=>this._unmarkSelected(f));const C=this._hasQueuedChanges();return this._emitChangeEvent(),C}toggle(o){return this.isSelected(o)?this.deselect(o):this.select(o)}clear(o=!0){this._unmarkAll();const e=this._hasQueuedChanges();return o&&this._emitChangeEvent(),e}isSelected(o){return this._selection.has(this._getConcreteValue(o))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(o){this._multiple&&this.selected&&this._selected.sort(o)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(o){o=this._getConcreteValue(o),this.isSelected(o)||(this._multiple||this._unmarkAll(),this.isSelected(o)||this._selection.add(o),this._emitChanges&&this._selectedToEmit.push(o))}_unmarkSelected(o){o=this._getConcreteValue(o),this.isSelected(o)&&(this._selection.delete(o),this._emitChanges&&this._deselectedToEmit.push(o))}_unmarkAll(){this.isEmpty()||this._selection.forEach(o=>this._unmarkSelected(o))}_verifyValueAssignment(o){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(o,e){if(this.compareWith){e=e??this._selection;for(let u of e)if(this.compareWith(o,u))return u;return o}return o}}let a=(()=>{class c{_listeners=[];notify(e,u){for(let C of this._listeners)C(e,u)}listen(e){return this._listeners.push(e),()=>{this._listeners=this._listeners.filter(u=>e!==u)}}ngOnDestroy(){this._listeners=[]}static \u0275fac=function(u){return new(u||c)};static \u0275prov=v.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()}}]);