"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[505],{505:(k,l,s)=>{s.r(l),s.d(l,{PosAccueilComponent:()=>x});var a=s(177),m=s(9417),p=s(9192),_=s(724),u=s(2525),n=s(4438),g=s(145),f=s(8026),C=s(7022);function h(i,r){if(1&i){const e=n.RV6();n.j41(0,"li",26),n.bIt("click",function(){const t=n.eBV(e).$implicit,c=n.XpG();return n.Njj(c.setActiveCommande(t))}),n.EFF(1),n.k0s()}if(2&i){const e=r.$implicit,o=n.XpG();n.AVh("list_commande_active",o.activeCommande===e),n.R7$(),n.SpI(" ",e," ")}}function P(i,r){if(1&i){const e=n.RV6();n.j41(0,"li",27),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.showCommandePopup=!0)}),n.nrm(1,"i",28),n.k0s()}}function O(i,r){if(1&i){const e=n.RV6();n.j41(0,"li",26),n.bIt("click",function(){const t=n.eBV(e).$implicit,c=n.XpG(2);return n.Njj(c.setActiveCommande(t))}),n.EFF(1),n.k0s()}if(2&i){const e=r.$implicit,o=n.XpG(2);n.AVh("active",o.activeCommande===e),n.R7$(),n.SpI(" ",e," ")}}function M(i,r){if(1&i){const e=n.RV6();n.j41(0,"div",29),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.showCommandePopup=!1)}),n.j41(1,"div",30),n.bIt("click",function(t){return n.eBV(e),n.Njj(t.stopPropagation())}),n.j41(2,"div",31)(3,"h3"),n.EFF(4,"Liste des commandes"),n.k0s(),n.j41(5,"i",32),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.showCommandePopup=!1)}),n.k0s()(),n.j41(6,"div",33)(7,"ul",34),n.DNE(8,O,2,3,"li",35),n.k0s()()()()}if(2&i){const e=n.XpG();n.R7$(8),n.Y8G("ngForOf",e.commandes)}}function v(i,r){if(1&i){const e=n.RV6();n.j41(0,"div",36)(1,"div",37),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.toggleView("grid"))}),n.EFF(2),n.nI1(3,"async"),n.k0s(),n.j41(4,"div",37),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.toggleView("list"))}),n.EFF(5),n.nI1(6,"async"),n.k0s()()}if(2&i){const e=n.XpG();n.R7$(2),n.SpI(" Cadre ",n.bMT(3,2,e.isListView$)?"\u2713":""," "),n.R7$(3),n.SpI(" Liste ",n.bMT(6,4,e.isListView$)?"":"\u2713"," ")}}function b(i,r){if(1&i){const e=n.RV6();n.j41(0,"div",38)(1,"div",39),n.nrm(2,"i",40),n.EFF(3," Installer l'application "),n.k0s(),n.j41(4,"div",39),n.nrm(5,"i",41),n.EFF(6," Recharger les donnees "),n.k0s(),n.j41(7,"div",37),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.onLogout())}),n.nrm(8,"i",42),n.EFF(9," Fermer la caisse "),n.k0s()()}}let x=(()=>{class i{constructor(e,o,t,c){this.router=e,this.viewState=o,this.userService=t,this.commandeState=c,this.apiUrl=u.c.imgUrl,this.showDropdown=!1,this.activeButton="vente",this.showMenuDropdown=!1,this.userName="",this.nomEntreprise="",this.photo=null,this.photoUrl=null,this.commandes=["001"],this.activeCommande="001",this.showCommandePopup=!1,this.isListView$=this.viewState.isListView$,this.commandes=this.commandeState.getAllCommandesIds(),this.commandeState.commandeUpdated$.subscribe(()=>{this.commandes=this.commandeState.getAllCommandesIds()}),this.commandeState.activeCommandeId$.subscribe(d=>{this.activeCommande=d}),this.commandeSubscription=this.commandeState.activeCommandeId$.subscribe(d=>{this.activeCommande=d})}ngOnInit(){this.activeButton=this.router.url.includes("/commandes")?"commande":"vente",this.getUserInfo()}ngOnDestroy(){this.commandeSubscription&&this.commandeSubscription.unsubscribe()}toggleView(e){this.viewState.setViewPreference("grid"===e),this.showDropdown=!0}onClickCommandes(){this.activeButton="commande",this.router.navigate(["/pos-accueil/commandes"])}onClickVente(){this.activeButton="vente",this.router.navigate(["/pos-accueil"])}toggleMenuDropdown(){this.showMenuDropdown=!this.showMenuDropdown}addCommande(){const e=this.commandeState.addNewCommande();this.commandes=this.commandeState.getAllCommandesIds(),this.setActiveCommande(e),this.showCommandePopup=!1}setActiveCommande(e){this.commandeState.setActiveCommande(e),this.activeCommande=e,this.showCommandePopup=!1}get visibleCommandes(){const e=Math.max(0,this.commandes.length-6);return this.commandes.slice(e)}get hiddenCommandes(){return this.commandes.length>6?this.commandes.slice(0,this.commandes.length-6):[]}getUserInfo(){this.userService.getUserInfo().subscribe({next:e=>{this.userName=e.nomComplet.charAt(0).toUpperCase(),this.nomEntreprise=e.nomEntreprise},error:e=>{console.error("Erreur lors de la r\xe9cup\xe9ration des infos utilisateur :",e)}})}onLogout(){this.userService.getUserInfo().subscribe({next:e=>{const o=e.permissions;1===o.length&&o.includes("VENDRE_PRODUITS")?(this.userService.logoutUser(),this.router.navigate(["/connexion"]).then(t=>{console.log("D\xe9connexion r\xe9ussie ?",t)})):this.router.navigate(["/analytics"]).then(t=>{console.log("Navigation vers analytics r\xe9ussie ?",t)})}})}static{this.\u0275fac=function(o){return new(o||i)(n.rXU(p.Ix),n.rXU(g.C),n.rXU(f.g),n.rXU(C.f))}}static{this.\u0275cmp=n.VBU({type:i,selectors:[["app-pos-accueil"]],decls:36,vars:14,consts:[[1,"pos_container"],[1,"pos_content"],[1,"pos_header"],[1,"navBar"],[1,"header_left"],[1,"btn_vente_pos",3,"click"],[1,"btn","btn_default"],[1,"btn_commande_pos",3,"click"],[1,"btn_add_commande"],[1,"btn",3,"click"],[1,"ri-add-line"],[1,"list_commande"],[3,"list_commande_active","click",4,"ngFor","ngForOf"],["class","list_commande_plus",3,"click",4,"ngIf"],["class","commande-popup-overlay",3,"click",4,"ngIf"],[1,"header_right"],[1,"name_boutique"],[1,"inputSearch"],[1,"ri-search-2-line"],["type","text","placeholder","Recherche des produits"],["clickOutside","",1,"icon_sort",3,"click","clickOutside"],["class","view-dropdown",4,"ngIf"],[1,"profil"],["clickOutside","",1,"menu",3,"click","clickOutside"],[1,"ri-menu-line"],["class","menu-dropdown",4,"ngIf"],[3,"click"],[1,"list_commande_plus",3,"click"],[1,"ri-arrow-down-s-line"],[1,"commande-popup-overlay",3,"click"],[1,"commande-popup-content",3,"click"],[1,"popup-header"],[1,"ri-close-line",3,"click"],[1,"popup-commandes"],[1,"list_commande","commandes-grid"],[3,"active","click",4,"ngFor","ngForOf"],[1,"view-dropdown"],[1,"dropdown-item",3,"click"],[1,"menu-dropdown"],[1,"dropdown-item"],[1,"ri-download-line"],[1,"ri-restart-line"],[1,"ri-money-euro-circle-line"]],template:function(o,t){1&o&&(n.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"nav",3)(4,"div",4)(5,"div",5),n.bIt("click",function(){return t.onClickVente()}),n.j41(6,"button",6),n.EFF(7," Ventes POS "),n.k0s()(),n.j41(8,"div",7),n.bIt("click",function(){return t.onClickCommandes()}),n.j41(9,"button",6),n.EFF(10," Commandes "),n.k0s()(),n.j41(11,"div",8)(12,"button",9),n.bIt("click",function(){return t.addCommande()}),n.nrm(13,"i",10),n.k0s()(),n.j41(14,"ul",11),n.DNE(15,h,2,3,"li",12)(16,P,2,0,"li",13),n.k0s(),n.DNE(17,M,9,1,"div",14),n.k0s(),n.j41(18,"div",15)(19,"div",16)(20,"p"),n.EFF(21,"Ma boutique"),n.k0s()(),n.j41(22,"div",17),n.nrm(23,"i",18)(24,"input",19),n.k0s(),n.j41(25,"div",20),n.bIt("click",function(){return t.showDropdown=!t.showDropdown})("clickOutside",function(){return t.showDropdown=!1}),n.nrm(26,"i"),n.nI1(27,"async"),n.DNE(28,v,7,6,"div",21),n.k0s(),n.j41(29,"div",22)(30,"span"),n.EFF(31),n.k0s()(),n.j41(32,"div",23),n.bIt("click",function(){return t.toggleMenuDropdown()})("clickOutside",function(){return t.showMenuDropdown=!1}),n.nrm(33,"i",24),n.DNE(34,b,10,0,"div",25),n.k0s()()()(),n.nrm(35,"router-outlet"),n.k0s()()),2&o&&(n.R7$(6),n.AVh("btn_active","vente"===t.activeButton),n.R7$(3),n.AVh("btn_active","commande"===t.activeButton),n.R7$(6),n.Y8G("ngForOf",t.visibleCommandes),n.R7$(),n.Y8G("ngIf",t.commandes.length>6),n.R7$(),n.Y8G("ngIf",t.showCommandePopup),n.R7$(9),n.HbH(n.bMT(27,12,t.isListView$)?"ri-apps-fill":"ri-list-check"),n.R7$(2),n.Y8G("ngIf",t.showDropdown),n.R7$(3),n.JRh(t.userName),n.R7$(3),n.Y8G("ngIf",t.showMenuDropdown))},dependencies:[m.YN,a.MD,a.Sq,a.bT,a.Jj,p.iI,p.n3,_.z],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:flex;flex-direction:column;position:fixed;inset:0;overflow:hidden}.pos_container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}ul[_ngcontent-%COMP%]{list-style-type:none;padding:0}.pos_content[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-height:0}.pos_header[_ngcontent-%COMP%]{flex:0 0 auto}.view-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;background:#fff;border:1px solid #ddd;border-radius:4px;box-shadow:0 2px 5px #0000001a;z-index:100;min-width:150px}.dropdown-item[_ngcontent-%COMP%]{padding:8px 12px;font-size:14px;cursor:pointer}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.navBar[_ngcontent-%COMP%]{width:100%;height:60px;display:flex;align-items:center;justify-content:space-between;background-color:#fff;border-bottom:1px solid #ddd;box-shadow:#2123261a 0 10px 10px -10px;padding:0 15px}.header_left[_ngcontent-%COMP%], .header_right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.header_right[_ngcontent-%COMP%]{gap:20px}.btn_vente_pos[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%], .btn_commande_pos[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{gap:10px}.btn_default[_ngcontent-%COMP%]{background-color:#f4f4f4}.btn_default[_ngcontent-%COMP%]:focus{background-color:#f4f4f4}.btn[_ngcontent-%COMP%]{border:none;padding:8px 16px;border-radius:4px;cursor:pointer;transition:background-color .3s}.btn.btn_active[_ngcontent-%COMP%]{background-color:#cde3fa;color:#1a73e8}.btn_add_commande[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{background-color:#f4f4f4;padding:4px 13px}.btn_add_commande[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px}li.list_commande_active[_ngcontent-%COMP%]{background-color:#cde3fa!important}ul.list_commande[_ngcontent-%COMP%]{list-style-type:none;display:flex;align-items:center;gap:10px;margin:0;padding:0}ul.list_commande[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:#f4f4f4;padding:7px 13px;border-radius:5px;cursor:pointer}ul.list_commande[_ngcontent-%COMP%]   li.list_commande_plus[_ngcontent-%COMP%]{padding:5px}.name_boutique[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.inputSearch[_ngcontent-%COMP%]{position:relative;width:250px;height:35px;display:flex;align-items:center}.inputSearch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:100%;padding-left:10px;border-radius:5px;border:1px solid #000;font-size:13px}.inputSearch[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:0;margin-right:15px;font-size:17px}.icon_sort[_ngcontent-%COMP%]{position:relative;background-color:#f4f4f4;padding:5px 11px;border-radius:5px;cursor:pointer}.icon_sort[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px}.profil[_ngcontent-%COMP%]{background-color:#0672e4;padding:0 12px;border-radius:4px;cursor:pointer}.profil[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;color:#fff}.menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px;cursor:pointer}.menu[_ngcontent-%COMP%]{position:relative;cursor:pointer}.menu[_ngcontent-%COMP%]   .menu-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;background:#fff;border:1px solid #e1e1e1;border-radius:4px;box-shadow:0 4px 12px #0000001a;z-index:1000;min-width:200px;margin-top:8px;overflow:hidden}.menu[_ngcontent-%COMP%]   .menu-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{padding:10px 16px;display:flex;align-items:center;gap:12px;font-size:12px;color:#333;transition:all .2s;cursor:pointer}.menu[_ngcontent-%COMP%]   .menu-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#f5f7fa}.menu[_ngcontent-%COMP%]   .menu-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;color:#64748b}.commande-popup[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;width:300px;background:#fff;border:1px solid #e0e0e0;border-radius:8px;box-shadow:0 4px 12px #0000001a;z-index:1000;margin-top:8px}.commande-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #f0f0f0}.commande-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600}.commande-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer;font-size:20px;color:#666}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;max-height:300px;overflow-y:auto}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;cursor:pointer;border-bottom:1px solid #f8f8f8;transition:background .2s}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#f4f4f4}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background:#e6f4ff;color:#1890ff}.commande-popup[_ngcontent-%COMP%]   .popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#999}.commande-popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:10000}.commande-popup-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:90%;max-width:800px;max-height:40vh;overflow-y:auto;box-shadow:0 10px 30px #0000004d;animation:_ngcontent-%COMP%_popup-appear .3s ease-out}.commande-popup-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px;height:4px}.commande-popup-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0003;border-radius:3px}.commande-popup-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}@keyframes _ngcontent-%COMP%_popup-appear{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:5px 20px;border-bottom:1px solid #eee;position:sticky;top:0;background:#fff;z-index:10}.popup-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;color:#333}.popup-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px;cursor:pointer;color:#666;transition:color .2s}.popup-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:red}.popup-commandes[_ngcontent-%COMP%]{padding:15px}.popup-commandes[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:12px 15px;border-radius:6px;margin-bottom:8px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:all .2s;border:1px solid #f0f0f0}.popup-commandes[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;border-color:#e0e0e0}.popup-commandes[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background-color:#e6f4ff;border-color:#91caff;color:#1890ff;font-weight:500}.popup-commandes[_ngcontent-%COMP%]   .commandes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(65px,1fr));gap:10px;padding:0;margin:0;list-style:none}.popup-commandes[_ngcontent-%COMP%]   .commandes-grid[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px 15px;background-color:#f8f8f8;border:1px solid #e0e0e0;border-radius:6px;cursor:pointer;transition:all .2s;text-align:center;margin-bottom:0!important;display:flex;align-items:center;justify-content:center}.popup-commandes[_ngcontent-%COMP%]   .commandes-grid[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#e9e9e9}.popup-commandes[_ngcontent-%COMP%]   .commandes-grid[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background-color:#cde3fa;border-color:#a0c5f0;color:#1a73e8;font-weight:700}']})}}return i})()}}]);