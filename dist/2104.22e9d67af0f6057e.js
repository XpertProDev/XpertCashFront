"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[2104],{2120:(P,x,p)=>{p.d(x,{r:()=>I});var m=p(1626),F=p(4412),f=p(9437),h=p(8810),E=p(8141),b=p(1985),t=p(5558),T=p(2525),j=p(4438);let I=(()=>{class C{constructor(l){this.http=l,this.apiUrl=T.c.apiBaseUrl,this.entrepriseSubject=new F.t([]),this.entreprise$=this.entrepriseSubject.asObservable()}getListEntreprises(){const l=localStorage.getItem("authToken")||"",_=new m.Lr({Authorization:`Bearer ${l}`,"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}/entreprises`,{headers:_}).pipe((0,f.W)(g=>{let c="Erreur inconnue";return g.error instanceof ErrorEvent?c=`Erreur: ${g.error.message}`:404===g.status&&(c="Aucune entreprise trouv\xe9e"),(0,h.$)(()=>new Error(c))}))}addEntreprise(l){const _=localStorage.getItem("authToken")||"",g=new m.Lr({Authorization:`Bearer ${_}`,"Content-Type":"application/json"});return this.http.post(`${this.apiUrl}/entreprises`,l,{headers:g}).pipe((0,f.W)(c=>{let a="Erreur inconnue";return c.error instanceof ErrorEvent?a=`Erreur: ${c.error.message}`:400===c.status&&(a=c.error||"Donn\xe9es invalides"),(0,h.$)(()=>new Error(a))}),(0,E.M)(c=>{this.entrepriseSubject.next([...this.entrepriseSubject.value,c])}))}getListEntreprise(l){if(!l)return console.error("Token vide ou non d\xe9fini ! V\xe9rifiez que l'utilisateur est bien connect\xe9."),new b.c;const _=(new m.Lr).set("Authorization",`Bearer ${l}`);return console.log("En-t\xeates envoy\xe9r : ",_),this.http.get(`${this.apiUrl}/entreprises`,{headers:_}).pipe((0,E.M)(g=>{this.entrepriseSubject.next(g)}))}getEntrepriseById(l){const _=localStorage.getItem("authToken")||"",g=new m.Lr({Authorization:`Bearer ${_}`,"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}/entreprises/${l}`,{headers:g}).pipe((0,f.W)(c=>{let a="Erreur inconnue";return c.error instanceof ErrorEvent?a=`Erreur: ${c.error.message}`:404===c.status&&(a="Entreprise non trouv\xe9e"),(0,h.$)(()=>new Error(a))}))}updateEntreprise(l,_){const g=localStorage.getItem("authToken")||"",c=new m.Lr({Authorization:`Bearer ${g}`});return this.http.patch(`${this.apiUrl}/updateEntreprise/${l}`,_,{headers:c,responseType:"text"}).pipe((0,f.W)(a=>{let v="Erreur inconnue";return a.error instanceof ErrorEvent?v=`Erreur: ${a.error.message}`:400===a.status&&(v=a.error||"Donn\xe9es invalides"),(0,h.$)(()=>new Error(v))}))}getEntrepriseInfo(){const l=localStorage.getItem("authToken");if(!l)return console.error("Aucun token trouv\xe9"),(0,h.$)(()=>new Error("Aucun token trouv\xe9"));const _=this.decodeJwt(l);if(this.isTokenExpired(_))return this.getNewTokenFromApi().pipe((0,t.n)(c=>{localStorage.setItem("authToken",c.token);const a=new m.Lr({Authorization:`Bearer ${c.token}`});return this.http.get(`${this.apiUrl}/myEntreprise`,{headers:a}).pipe((0,E.M)(v=>{localStorage.setItem("entreprise",JSON.stringify(v))}))}));{const c=new m.Lr({Authorization:`Bearer ${l}`});return this.http.get(`${this.apiUrl}/myEntreprise`,{headers:c}).pipe((0,E.M)(a=>{localStorage.setItem("entreprise",JSON.stringify(a))}))}}decodeJwt(l){return JSON.parse(atob(l.split(".")[1]))}isTokenExpired(l){return new Date(1e3*l.exp)<new Date}getNewTokenFromApi(){const l=localStorage.getItem("refreshToken");return this.http.post(`${this.apiUrl}/refresh-token`,{refreshToken:l})}static{this.\u0275fac=function(_){return new(_||C)(j.KVO(m.Qq))}}static{this.\u0275prov=j.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}}return C})()},2104:(P,x,p)=>{p.r(x),p.d(x,{ClientsComponent:()=>Tt});var m=p(177),F=p(9417),f=p(3509),h=p(1281),E=p(9192),b=p(5698),t=p(4438);let T=(()=>{class n{constructor(e){this.elementRef=e,this.clickOutside=new t.bkB}onClick(e){this.elementRef.nativeElement.contains(e)||this.clickOutside.emit()}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(t.aKT))}}static{this.\u0275dir=t.FsC({type:n,selectors:[["","clickOutside",""]],hostBindings:function(o,i){1&o&&t.bIt("click",function(d){return i.onClick(d.target)},!1,t.EBC)},outputs:{clickOutside:"clickOutside"}})}}return n})();var j=p(7746),I=p(2120);const C=()=>[6,10,25,100];function $(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",25)(1,"div",26),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.toggleView("list"))}),t.EFF(2),t.k0s(),t.j41(3,"div",26),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.toggleView("grid"))}),t.EFF(4),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(2),t.SpI(" Liste ",e.isListView?"\u2713":""," "),t.R7$(2),t.SpI(" Cadre ",e.isListView?"":"\u2713"," ")}}function l(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",25)(1,"div",26),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.setListType("clients"))}),t.EFF(2),t.k0s(),t.j41(3,"div",26),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.setListType("entreprises"))}),t.EFF(4),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(2),t.SpI(" Clients ","clients"===e.currentListType?"\u2713":""," "),t.R7$(2),t.SpI(" Entreprises ","entreprises"===e.currentListType?"\u2713":""," ")}}function _(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.nomComplet)}}function g(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Nom est vide"),t.k0s())}function c(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.email)}}function a(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non email"),t.k0s())}function v(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.adresse)}}function O(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non adresse"),t.k0s())}function M(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.telephone)}}function R(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non num\xe9ro de t\xe9l\xe9phone"),t.k0s())}function w(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",34),t.bIt("click",function(i){t.eBV(e);const r=t.XpG().$implicit,d=t.XpG(2);return t.Njj(d.openEntrepriseClientDetail(r.id,i))}),t.nrm(1,"i",35),t.k0s()}}function y(n,s){}function D(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(t.i5U(2,1,e.createdAt,"dd/MM/yyyy"))}}function G(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non date"),t.k0s())}function S(n,s){if(1&n){const e=t.RV6();t.j41(0,"tr",27),t.bIt("click",function(){const i=t.eBV(e).$implicit,r=t.XpG(2);return t.Njj(r.openClientDetail(i.id))}),t.j41(1,"td")(2,"div",29),t.nrm(3,"img",30),t.k0s()(),t.j41(4,"td"),t.DNE(5,_,2,1,"span",31)(6,g,2,0,"ng-template",null,0,t.C5r),t.k0s(),t.j41(8,"td"),t.DNE(9,c,2,1,"span",31)(10,a,2,0,"ng-template",null,1,t.C5r),t.k0s(),t.j41(12,"td"),t.DNE(13,v,2,1,"span",31)(14,O,2,0,"ng-template",null,2,t.C5r),t.k0s(),t.j41(16,"td"),t.DNE(17,M,2,1,"span",31)(18,R,2,0,"ng-template",null,3,t.C5r),t.k0s(),t.j41(20,"td"),t.DNE(21,w,2,0,"div",32)(22,y,0,0,"ng-template",null,4,t.C5r),t.k0s(),t.j41(24,"td"),t.DNE(25,D,3,4,"span",31)(26,G,2,0,"ng-template",null,5,t.C5r),t.k0s()()}if(2&n){const e=s.$implicit,o=t.sdS(7),i=t.sdS(11),r=t.sdS(15),d=t.sdS(19),u=t.sdS(23),k=t.sdS(27);t.R7$(5),t.Y8G("ngIf",e.nomComplet)("ngIfElse",o),t.R7$(4),t.Y8G("ngIf",e.email)("ngIfElse",i),t.R7$(4),t.Y8G("ngIf",e.adresse)("ngIfElse",r),t.R7$(4),t.Y8G("ngIf",e.telephone)("ngIfElse",d),t.R7$(4),t.Y8G("ngIf",e.entrepriseClient)("ngIfElse",u),t.R7$(4),t.Y8G("ngIf",e.createdAt)("ngIfElse",k)}}function N(n,s){if(1&n){const e=t.RV6();t.j41(0,"table")(1,"thead")(2,"th"),t.EFF(3,"Photo"),t.k0s(),t.j41(4,"th",27),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.sort("nomComplet"))}),t.EFF(5," Nom & pr\xe9nom "),t.nrm(6,"i"),t.k0s(),t.j41(7,"th"),t.EFF(8," Email "),t.k0s(),t.j41(9,"th"),t.EFF(10," Adresse "),t.k0s(),t.j41(11,"th"),t.EFF(12," T\xe9l\xe9phone "),t.k0s(),t.j41(13,"th"),t.EFF(14," Entreprise "),t.k0s(),t.j41(15,"th"),t.EFF(16," Date de Creation "),t.k0s()(),t.j41(17,"tbody"),t.DNE(18,S,28,12,"tr",28),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(6),t.HbH("nomComplet"===e.sortField?"asc"===e.sortDirection?"ri-arrow-up-s-line":"ri-arrow-down-s-line":"ri-arrow-up-down-line"),t.R7$(12),t.Y8G("ngForOf",e.paginatedClients)}}function L(n,s){if(1&n){const e=t.RV6();t.j41(0,"span",27),t.bIt("click",function(i){t.eBV(e);const r=t.XpG().$implicit,d=t.XpG(2);return t.Njj(d.openEntrepriseClientDetail(r.id,i))}),t.nrm(1,"i",51),t.k0s()}}function X(n,s){if(1&n&&(t.j41(0,"div",52),t.nrm(1,"img",53),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.Y8G("src",e.photoUrl,t.B4B)}}function B(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.nomComplet)}}function A(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Nom est vide"),t.k0s())}function V(n,s){if(1&n&&(t.j41(0,"span",54),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(t.i5U(2,1,e.createdAt,"dd/MM/yyyy"))}}function z(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"truncateEmail"),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(t.bMT(2,1,e.email))}}function Y(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non email"),t.k0s())}function U(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.adresse)}}function J(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non adresse"),t.k0s())}function W(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.telephone)}}function K(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non num\xe9ro de t\xe9l\xe9phone"),t.k0s())}function H(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",39),t.bIt("click",function(){const i=t.eBV(e).$implicit,r=t.XpG(2);return t.Njj(r.openClientDetail(i.id))}),t.j41(1,"div",40)(2,"div",41),t.DNE(3,L,2,0,"span",42)(4,X,2,1,"ng-template",null,6,t.C5r),t.j41(6,"h3"),t.DNE(7,B,2,1,"span",31)(8,A,2,0,"ng-template",null,0,t.C5r),t.k0s()(),t.DNE(10,V,3,4,"span",43),t.k0s(),t.j41(11,"div",44)(12,"div",45)(13,"p"),t.nrm(14,"i",46),t.DNE(15,z,3,3,"span",31)(16,Y,2,0,"ng-template",null,1,t.C5r),t.k0s(),t.j41(18,"p"),t.nrm(19,"i",47),t.DNE(20,U,2,1,"span",31)(21,J,2,0,"ng-template",null,2,t.C5r),t.k0s(),t.j41(23,"p"),t.nrm(24,"i",48),t.DNE(25,W,2,1,"span",31)(26,K,2,0,"ng-template",null,3,t.C5r),t.k0s()(),t.j41(28,"div",49),t.nrm(29,"img",50),t.k0s()()()}if(2&n){const e=s.$implicit,o=t.sdS(5),i=t.sdS(9),r=t.sdS(17),d=t.sdS(22),u=t.sdS(27);t.R7$(3),t.Y8G("ngIf",e.entrepriseClient)("ngIfElse",o),t.R7$(4),t.Y8G("ngIf",e.nomComplet)("ngIfElse",i),t.R7$(3),t.Y8G("ngIf",e.createdAt),t.R7$(5),t.Y8G("ngIf",e.email)("ngIfElse",r),t.R7$(5),t.Y8G("ngIf",e.adresse)("ngIfElse",d),t.R7$(5),t.Y8G("ngIf",e.telephone)("ngIfElse",u),t.R7$(4),t.Y8G("src","assets/img/profil.png",t.B4B)}}function Q(n,s){if(1&n&&(t.j41(0,"div",36)(1,"div",37),t.DNE(2,H,30,12,"div",38),t.k0s()()),2&n){const e=t.XpG();t.R7$(2),t.Y8G("ngForOf",e.paginatedClients)}}function Z(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.nom)}}function q(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Nom vide"),t.k0s())}function tt(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.email)}}function et(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non email"),t.k0s())}function nt(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.adresse)}}function it(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non adresse"),t.k0s())}function st(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.telephone)}}function ot(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non t\xe9l\xe9phone"),t.k0s())}function rt(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(t.i5U(2,1,e.createdAt,"dd/MM/yyyy"))}}function lt(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non date"),t.k0s())}function ct(n,s){if(1&n){const e=t.RV6();t.j41(0,"tr",27),t.bIt("click",function(){const i=t.eBV(e).$implicit,r=t.XpG(2);return t.Njj(r.openEntrepriseDetail(i.id))}),t.j41(1,"td")(2,"div",29),t.nrm(3,"img",55),t.k0s()(),t.j41(4,"td"),t.DNE(5,Z,2,1,"span",31)(6,q,2,0,"ng-template",null,7,t.C5r),t.k0s(),t.j41(8,"td"),t.DNE(9,tt,2,1,"span",31)(10,et,2,0,"ng-template",null,1,t.C5r),t.k0s(),t.j41(12,"td"),t.DNE(13,nt,2,1,"span",31)(14,it,2,0,"ng-template",null,2,t.C5r),t.k0s(),t.j41(16,"td"),t.DNE(17,st,2,1,"span",31)(18,ot,2,0,"ng-template",null,3,t.C5r),t.k0s(),t.j41(20,"td"),t.EFF(21),t.k0s(),t.j41(22,"td"),t.EFF(23),t.k0s(),t.j41(24,"td"),t.EFF(25),t.k0s(),t.j41(26,"td"),t.DNE(27,rt,3,4,"span",31)(28,lt,2,0,"ng-template",null,5,t.C5r),t.k0s()()}if(2&n){const e=s.$implicit,o=t.sdS(7),i=t.sdS(11),r=t.sdS(15),d=t.sdS(19),u=t.sdS(29);t.R7$(5),t.Y8G("ngIf",e.nom)("ngIfElse",o),t.R7$(4),t.Y8G("ngIf",e.email)("ngIfElse",i),t.R7$(4),t.Y8G("ngIf",e.adresse)("ngIfElse",r),t.R7$(4),t.Y8G("ngIf",e.telephone)("ngIfElse",d),t.R7$(4),t.JRh(e.pays||"--"),t.R7$(2),t.JRh(e.siege||"--"),t.R7$(2),t.JRh(e.secteur||"--"),t.R7$(2),t.Y8G("ngIf",e.createdAt)("ngIfElse",u)}}function pt(n,s){if(1&n){const e=t.RV6();t.j41(0,"table")(1,"thead")(2,"th"),t.EFF(3,"Logo"),t.k0s(),t.j41(4,"th",27),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.sort("nom"))}),t.EFF(5," Nom "),t.nrm(6,"i"),t.k0s(),t.j41(7,"th"),t.EFF(8," Email "),t.k0s(),t.j41(9,"th"),t.EFF(10," Adresse "),t.k0s(),t.j41(11,"th"),t.EFF(12," T\xe9l\xe9phone "),t.k0s(),t.j41(13,"th"),t.EFF(14," Pays "),t.k0s(),t.j41(15,"th"),t.EFF(16," Si\xe8ge "),t.k0s(),t.j41(17,"th"),t.EFF(18," Secteur "),t.k0s(),t.j41(19,"th"),t.EFF(20," Date de Creation "),t.k0s()(),t.j41(21,"tbody"),t.DNE(22,ct,30,13,"tr",28),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(6),t.HbH("nom"===e.sortField?"asc"===e.sortDirection?"ri-arrow-up-s-line":"ri-arrow-down-s-line":"ri-arrow-up-down-line"),t.R7$(16),t.Y8G("ngForOf",e.paginatedEntreprises)}}function at(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.nom)}}function _t(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Nom est vide"),t.k0s())}function dt(n,s){if(1&n&&(t.j41(0,"span",54),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(t.i5U(2,1,e.createdAt,"dd/MM/yyyy"))}}function gt(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"truncateEmail"),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(t.bMT(2,1,e.email))}}function mt(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non email"),t.k0s())}function ut(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.adresse)}}function ft(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non adresse"),t.k0s())}function Ct(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.telephone)}}function ht(n,s){1&n&&(t.j41(0,"span",33),t.EFF(1,"Non t\xe9l\xe9phone"),t.k0s())}function Et(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",39),t.bIt("click",function(){const i=t.eBV(e).$implicit,r=t.XpG(2);return t.Njj(r.openEntrepriseDetail(i.id))}),t.j41(1,"div",40)(2,"div",41)(3,"h3"),t.DNE(4,at,2,1,"span",31)(5,_t,2,0,"ng-template",null,7,t.C5r),t.k0s()(),t.DNE(7,dt,3,4,"span",43),t.k0s(),t.j41(8,"div",44)(9,"div",45)(10,"p"),t.nrm(11,"i",46),t.DNE(12,gt,3,3,"span",31)(13,mt,2,0,"ng-template",null,1,t.C5r),t.k0s(),t.j41(15,"p"),t.nrm(16,"i",47),t.DNE(17,ut,2,1,"span",31)(18,ft,2,0,"ng-template",null,2,t.C5r),t.k0s(),t.j41(20,"p"),t.nrm(21,"i",48),t.DNE(22,Ct,2,1,"span",31)(23,ht,2,0,"ng-template",null,3,t.C5r),t.k0s()(),t.j41(25,"div",49),t.nrm(26,"img",55),t.k0s()()()}if(2&n){const e=s.$implicit,o=t.sdS(6),i=t.sdS(14),r=t.sdS(19),d=t.sdS(24);t.R7$(4),t.Y8G("ngIf",e.nom)("ngIfElse",o),t.R7$(3),t.Y8G("ngIf",e.createdAt),t.R7$(5),t.Y8G("ngIf",e.email)("ngIfElse",i),t.R7$(5),t.Y8G("ngIf",e.adresse)("ngIfElse",r),t.R7$(5),t.Y8G("ngIf",e.telephone)("ngIfElse",d)}}function vt(n,s){if(1&n&&(t.j41(0,"div",36)(1,"div",37),t.DNE(2,Et,27,9,"div",38),t.k0s()()),2&n){const e=t.XpG();t.R7$(2),t.Y8G("ngForOf",e.paginatedEntreprises)}}function kt(n,s){if(1&n&&(t.j41(0,"div",56),t.EFF(1),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.SpI(" ",e.messageNoEntreprise," ")}}function xt(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",57)(1,"mat-paginator",58),t.bIt("page",function(i){t.eBV(e);const r=t.XpG();return t.Njj(r.onPageChange(i))}),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(),t.Y8G("length",e.clients.length)("pageIndex",e.currentPageClients)("pageSize",e.pageSize)("pageSizeOptions",t.lJ4(4,C))}}function jt(n,s){if(1&n&&(t.j41(0,"div",56),t.EFF(1),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.SpI(" ",e.messageNoClient," ")}}function Ft(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",57)(1,"mat-paginator",58),t.bIt("page",function(i){t.eBV(e);const r=t.XpG();return t.Njj(r.onPageChange(i))}),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(),t.Y8G("length",e.entreprises.length)("pageIndex",e.currentPageEntreprises)("pageSize",e.pageSize)("pageSizeOptions",t.lJ4(4,C))}}function bt(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",59)(1,"div",60)(2,"div",61)(3,"h3"),t.EFF(4,"Ajouter une entreprise"),t.k0s(),t.j41(5,"button",62),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.closePopup())}),t.EFF(6,"\xd7"),t.k0s()(),t.j41(7,"div",63)(8,"div",64),t.EFF(9," Client individue "),t.k0s(),t.nrm(10,"div",65),t.j41(11,"div",66),t.EFF(12," Entreprise clients "),t.k0s()()()()}}let Tt=(()=>{class n{constructor(e,o,i){this.clientService=e,this.router=o,this.entrepriseService=i,this.apiUrl="http://31.207.34.194:8080",this.isListView=!0,this.showDropdown=!1,this.showPopup=!1,this.dataSource=new h.I6,this.pageSize=6,this.currentPage=0,this.currentPageClients=0,this.currentPageEntreprises=0,this.totalClients=0,this.totalEntrepriseClients=0,this.clients=[],this.entrepriseClient=[],this.sortField="nomComplet",this.sortDirection="asc",this.noClientsAvailable=!1,this.messageNoClient="Aucun client disponible.",this.showTypeDropdown=!1,this.currentListType="clients",this.entreprises=[],this.messageNoEntreprise="Aucune entreprise disponible."}ngOnInit(){const e=localStorage.getItem("viewPreference");this.isListView="grid"!==e;const o=localStorage.getItem("listTypePreference");("clients"===o||"entreprises"===o)&&(this.currentListType=o),"clients"===this.currentListType?this.getListClients():this.getListEntreprises()}onPageChange(e){"clients"===this.currentListType?this.currentPageClients=e.pageIndex:this.currentPageEntreprises=e.pageIndex,this.currentPage=e.pageIndex,this.pageSize=e.pageSize}toggleView(e){this.isListView="list"===e,this.showDropdown=!0,localStorage.setItem("viewPreference",e)}setListType(e){this.currentPage="clients"===e?this.currentPageClients:this.currentPageEntreprises,this.currentListType=e,this.showTypeDropdown=!1,localStorage.setItem("listTypePreference",e),"entreprises"===e&&0===this.entreprises.length?this.getListEntreprises():"clients"===e&&0===this.clients.length&&this.getListClients()}getListEntreprises(){localStorage.getItem("authToken")?this.entrepriseService.getListEntreprises().subscribe({next:o=>{console.log("Entreprises r\xe9cup\xe9r\xe9es:",o),this.entreprises=o,this.entreprises=this.entreprises.sort((i,r)=>(r.id??0)-(i.id??0))},error:o=>{console.error("Erreur lors de la r\xe9cup\xe9ration des entreprises :",o)}}):console.error("Aucun token trouv\xe9 !")}get paginatedEntreprises(){const e=this.currentPageEntreprises*this.pageSize;return this.entreprises.slice(e,e+this.pageSize)}sort(e){("clients"===this.currentListType&&this.clients.length>0&&e in this.clients[0]||"entreprises"===this.currentListType&&this.entreprises.length>0&&e in this.entreprises[0])&&(this.sortField===e?this.sortDirection="asc"===this.sortDirection?"desc":"asc":(this.sortField=e,this.sortDirection="asc"),"clients"===this.currentListType?this.clients.sort((i,r)=>{const d="asc"===this.sortDirection?1:-1,u=i[e]?.toString().toLowerCase()??"",k=r[e]?.toString().toLowerCase()??"";return u.localeCompare(k)*d}):this.entreprises.sort((i,r)=>{const d="asc"===this.sortDirection?1:-1,u=i[e]?.toString().toLowerCase()??"",k=r[e]?.toString().toLowerCase()??"";return u.localeCompare(k)*d}))}getListClients(){localStorage.getItem("authToken")?this.clientService.getListClients().subscribe({next:o=>{console.log("\u{1f4e5} Donn\xe9es brutes:",o),this.clients=o.map(i=>{const r=i.photo?`${this.apiUrl}${i.photo}`:null;return console.log(`\u{1f5bc}\ufe0f Client ID ${i.id} - photoUrl:`,r),{...i,photoUrl:r,entrepriseClient:i.entrepriseClient?{id:i.entrepriseClient.id}:null}}),this.clients=o.sort((i,r)=>(r.id??0)-(i.id??0)),this.totalClients=this.clients.length,this.noClientsAvailable=0===this.clients.length,this.dataSource.data=this.clients,this.dataSource.paginator=this.paginator,this.clients.length>0&&(console.log("\u{1f464} Exemple de client:",this.clients[0]),console.log("\u{1f3e2} Entreprise associ\xe9e:",this.clients[0].entrepriseClient)),console.log("\u2705 Clients r\xe9cup\xe9r\xe9s (tri\xe9s) :",this.clients)},error:o=>{console.error("\u274c Erreur lors de la r\xe9cup\xe9ration des clients :",o)}}):console.error("\u{1f510} Aucun token trouv\xe9 !")}get paginatedClients(){const e=this.currentPageClients*this.pageSize;return this.clients.slice(e,e+this.pageSize)}openClientDetail(e){this.router.navigate(["/detail-client",e])}openEntrepriseClientDetail(e,o){o.stopPropagation(),this.router.navigate(["/detail-entreprise-client",e])}openEntrepriseDetail(e){void 0!==e?this.router.navigate(["/detail-entreprise",e]):console.error("ID d'entreprise non d\xe9fini")}openPopup(){this.showPopup=!0}closePopup(){this.showPopup=!1}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(j.X),t.rXU(E.Ix),t.rXU(I.r))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-clients"]],viewQuery:function(o,i){if(1&o&&t.GBs(f.iy,5),2&o){let r;t.mGM(r=t.lsd())&&(i.paginator=r.first)}},decls:28,vars:14,consts:[["noNomComplet",""],["noEmail",""],["noAdresse",""],["noPhone",""],["noEntreprise",""],["noDate",""],["noEntrepriseCard",""],["noNom",""],[1,"containerTable"],[1,"tasks-header"],[1,"title"],[1,"actions"],[1,"add-task",3,"click"],[1,"barre"],["clickOutside","",1,"contentIcon",3,"click","clickOutside"],["class","view-dropdown",4,"ngIf"],[1,"ri-arrow-left-right-line"],[1,"inputSearch"],[1,"ri-search-2-line"],["type","text","placeholder","Recherche...."],[4,"ngIf"],["class","container_cadre",4,"ngIf"],["class","no-client-message",4,"ngIf"],["class","pagination",4,"ngIf"],["class","popup-overlay",4,"ngIf"],[1,"view-dropdown"],[1,"dropdown-item",3,"click"],[3,"click"],[3,"click",4,"ngFor","ngForOf"],[1,"imgClient"],["src","assets/img/profil.png","alt","Photo clients"],[4,"ngIf","ngIfElse"],["class","iconEntrepriseList",3,"click",4,"ngIf","ngIfElse"],[1,"no-phone-text"],[1,"iconEntrepriseList",3,"click"],["title","Affiliation d'Entreprise",1,"ri-git-branch-fill"],[1,"container_cadre"],[1,"grid-view"],["class","client-card",3,"click",4,"ngFor","ngForOf"],[1,"client-card",3,"click"],[1,"name_icon"],[1,"tete"],[3,"click",4,"ngIf","ngIfElse"],["class","dateCreat",4,"ngIf"],[1,"content_cadre_double"],[1,"info_cadre"],[1,"ri-mail-line"],[1,"ri-map-pin-line"],[1,"ri-phone-line"],[1,"imgClient_grid"],["alt","Photo clients",3,"src"],["title","Affiliation d'Entreprise",1,"ri-community-line"],[1,"imgClient2"],["alt","Photo client",3,"src"],[1,"dateCreat"],["src","assets/img/office_building.png","alt","Logo entreprise"],[1,"no-client-message"],[1,"pagination"],[3,"page","length","pageIndex","pageSize","pageSizeOptions"],[1,"popup-overlay"],[1,"popup-content"],[1,"popup-header"],[1,"close-btn",3,"click"],[1,"contentCadreChoix"],["routerLink","/ajouter-client",1,"cadreChoix"],[1,"sizeBox"],["routerLink","/ajouter-entreprise-client",1,"cadreChoix"]],template:function(o,i){1&o&&(t.j41(0,"div",8)(1,"div",9)(2,"h1",10),t.EFF(3),t.k0s(),t.j41(4,"div",11)(5,"button",12),t.bIt("click",function(){return i.openPopup()}),t.EFF(6,"Cr\xe9er un client"),t.k0s(),t.nrm(7,"div",13),t.j41(8,"div",14),t.bIt("click",function(){return i.showDropdown=!i.showDropdown})("clickOutside",function(){return i.showDropdown=!1}),t.nrm(9,"i"),t.DNE(10,$,5,2,"div",15),t.k0s(),t.nrm(11,"div",13),t.j41(12,"div",14),t.bIt("click",function(){return i.showTypeDropdown=!i.showTypeDropdown})("clickOutside",function(){return i.showTypeDropdown=!1}),t.nrm(13,"i",16),t.DNE(14,l,5,2,"div",15),t.k0s(),t.nrm(15,"div",13),t.j41(16,"div",17),t.nrm(17,"i",18)(18,"input",19),t.k0s()()(),t.DNE(19,N,19,3,"table",20)(20,Q,3,1,"div",21)(21,pt,23,3,"table",20)(22,vt,3,1,"div",21)(23,kt,2,1,"div",22)(24,xt,2,5,"div",23)(25,jt,2,1,"div",22)(26,Ft,2,5,"div",23),t.k0s(),t.DNE(27,bt,13,0,"div",24)),2&o&&(t.R7$(3),t.SpI(" ","clients"===i.currentListType?"Mes Clients":"Entreprises Client"," "),t.R7$(6),t.HbH(i.isListView?"ri-list-check":"ri-apps-fill"),t.R7$(),t.Y8G("ngIf",i.showDropdown),t.R7$(4),t.Y8G("ngIf",i.showTypeDropdown),t.R7$(5),t.Y8G("ngIf",i.isListView&&"clients"===i.currentListType),t.R7$(),t.Y8G("ngIf",!i.isListView&&"clients"===i.currentListType),t.R7$(),t.Y8G("ngIf",i.isListView&&"entreprises"===i.currentListType),t.R7$(),t.Y8G("ngIf",!i.isListView&&"entreprises"===i.currentListType),t.R7$(),t.Y8G("ngIf",0===i.entreprises.length&&"entreprises"===i.currentListType),t.R7$(),t.Y8G("ngIf","clients"===i.currentListType),t.R7$(),t.Y8G("ngIf",0===i.clients.length&&"clients"===i.currentListType),t.R7$(),t.Y8G("ngIf","entreprises"===i.currentListType),t.R7$(),t.Y8G("ngIf",i.showPopup))},dependencies:[m.MD,m.Sq,m.bT,m.vh,F.YN,f.Ou,f.iy,E.Wk,b.B,T],styles:['@charset "UTF-8";.containerTable[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:10px}.content_cadre_double[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.imgClient[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;overflow:hidden;display:flex;align-items:center;justify-content:center;background-color:#f5f5f5;box-shadow:0 4px 6px #0000001a;cursor:pointer}.imgClient[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80%;height:80%;object-fit:cover;border-radius:50%;transition:transform .2s}.imgClient[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.1)}.tete[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.imgClient2[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;overflow:hidden;display:flex;align-items:center;justify-content:center;background-color:#f5f5f5;box-shadow:0 4px 6px #0000001a;cursor:pointer}.imgClient2[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:50%;transition:transform .2s}.imgClient_grid[_ngcontent-%COMP%]{width:90px;height:90px;overflow:hidden;display:flex;align-items:center;justify-content:center;cursor:pointer;border:none}.imgClient_grid[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80%;height:80%;object-fit:cover;transition:transform .2s}.title[_ngcontent-%COMP%]{font-size:18px;margin:0}.tasks-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}.add-task[_ngcontent-%COMP%]{padding:10px 30px;background-color:#0672e4;color:#fff;border-radius:5px;border:none}.inputSearch[_ngcontent-%COMP%]{position:relative;width:250px;height:40px;display:flex;align-items:center}.inputSearch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:100%;padding-left:10px;border-radius:5px}.inputSearch[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:0;margin-right:15px;font-size:17px}.contentIcon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px;cursor:pointer;position:relative}.actions[_ngcontent-%COMP%]{display:flex;align-items:center}.actions[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#000}.barre[_ngcontent-%COMP%]{height:25px;width:1px;background-color:#0000003f;margin:8px 15px}.titleTableProduit[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:12px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}tr[_ngcontent-%COMP%]{font-size:13px}td[_ngcontent-%COMP%]{padding:18px 8px;border-bottom:1px solid rgba(221,221,221,.5803921569)}th[_ngcontent-%COMP%]{background-color:#f2f2f2;border-bottom:1px solid rgba(221,221,221,.5803921569);padding:12px 8px}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}tr[_ngcontent-%COMP%]:hover{background-color:#ddd}.contentIcon[_ngcontent-%COMP%]{position:relative;cursor:pointer}.view-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;background:#fff;border:1px solid #ddd;border-radius:4px;box-shadow:0 2px 5px #0000001a;z-index:100;min-width:150px}.dropdown-item[_ngcontent-%COMP%]{padding:8px 12px;font-size:14px;cursor:pointer}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.grid-view[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px}.client-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;box-shadow:0 4px 6px #0000000d;transition:transform .2s ease;border:1px solid #e0e0e0;margin:20px 0 -20px}.client-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 6px 12px #0000000a}.client-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;font-size:16px;margin:0;font-weight:600}.name_icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #eee;margin:0 0 12px;padding-bottom:10px}.name_icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;cursor:pointer}.client-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;font-size:14px;color:#666;display:flex;align-items:center;gap:8px}.client-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;color:#0672e4}.view-dropdown[_ngcontent-%COMP%]{transform-origin:top right;animation:_ngcontent-%COMP%_scaleIn .15s ease-out}@keyframes _ngcontent-%COMP%_scaleIn{0%{transform:scale(.9);opacity:0}to{transform:scale(1);opacity:1}}.dropdown-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;transition:background .2s ease}.dropdown-item[_ngcontent-%COMP%]:after{content:"\\2713";opacity:0;color:#0672e4}.dropdown-item.active[_ngcontent-%COMP%]:after{opacity:1}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;display:inline-block}.status-active[_ngcontent-%COMP%]{background:#e3fcef;color:#064}.status-inactive[_ngcontent-%COMP%]{background:#faeae5;color:#bf360c}@media (max-width: 768px){.tasks-header[_ngcontent-%COMP%]{display:block;justify-content:space-between;gap:15px}.inputSearch[_ngcontent-%COMP%]{width:100%}.grid-view[_ngcontent-%COMP%]{display:block}.client-card[_ngcontent-%COMP%]{margin-bottom:15px}}@media (min-width: 769px){.mobile-only[_ngcontent-%COMP%]{display:none!important}}.pagination[_ngcontent-%COMP%]{justify-content:right;margin-top:30px}mat-paginator[_ngcontent-%COMP%]{background-color:#fff;border-radius:5px}.no-phone-text[_ngcontent-%COMP%]{color:#c3c3c3;font-style:italic}.info_cadre[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#000}.no-client-message[_ngcontent-%COMP%]{text-align:center;padding:40px;font-size:13px;color:#666;background-color:#f8f9fa;border-radius:8px;margin:20px;box-shadow:0 2px 4px #0000001a}.iconEntrepriseList[_ngcontent-%COMP%]{padding-left:20px}.iconEntrepriseList[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;cursor:pointer}.no-entreprise-text[_ngcontent-%COMP%]{color:#666;font-size:.9em;font-style:italic}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background:#fff;padding:15px 20px;border-radius:8px;width:25%}.popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;margin-top:-5px}.popup-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px}.cadreChoix[_ngcontent-%COMP%]{background-color:#0672e4;box-shadow:0 6px 12px #0000001a;padding:10px;border-radius:5px;cursor:pointer;color:#fff}.sizeBox[_ngcontent-%COMP%]{margin:10px 0}.dateCreat[_ngcontent-%COMP%]{font-size:10px;font-style:italic;margin-left:auto}']})}}return n})()}}]);