"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[2051],{76822:(R,I,g)=>{g.d(I,{K:()=>C});var C=function(m){return m.BROUILLON="BROUILLON",m.APPROBATION="APPROBATION",m.APPROUVE="APPROUVE",m.ENVOYE="ENVOYE",m.VALIDE="VALIDE",m.ANNULE="ANNULE",m}(C||{})},92120:(R,I,g)=>{g.d(I,{r:()=>e});var C=g(21626),m=g(84412),a=g(25558),P=g(99437),_=g(18810),f=g(88141),w=g(22525),T=g(54438),N=g(88026);let e=(()=>{class E{constructor(u,c){this.http=u,this.usersService=c,this.apiUrl=w.c.apiBaseUrl,this.entrepriseSubject=new m.t([]),this.entreprise$=this.entrepriseSubject.asObservable()}getListEntreprises(){return this.usersService.getValidAccessToken().pipe((0,a.n)(u=>{const c=new C.Lr({Authorization:`Bearer ${u}`,"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}/entreprises`,{headers:c})}),(0,P.W)(u=>{let c="Erreur inconnue";return u.error instanceof ErrorEvent?c=`Erreur: ${u.error.message}`:404===u.status&&(c="Aucune entreprise trouv\xe9e"),(0,_.$)(()=>new Error(c))}))}addEntreprise(u){return this.usersService.getValidAccessToken().pipe((0,a.n)(c=>{const p=new C.Lr({Authorization:`Bearer ${c}`,"Content-Type":"application/json"});return this.http.post(`${this.apiUrl}/entreprise-clients`,u,{headers:p})}),(0,f.M)(c=>{this.entrepriseSubject.next([...this.entrepriseSubject.value,c])}),(0,P.W)(c=>{let p="Erreur inconnue";return c.error instanceof ErrorEvent?p=`Erreur: ${c.error.message}`:400===c.status&&(p=c.error||"Donn\xe9es invalides"),(0,_.$)(()=>new Error(p))}))}getListEntreprise(){return this.usersService.getValidAccessToken().pipe((0,a.n)(u=>{if(!u)return console.error("Token vide ou non d\xe9fini ! V\xe9rifiez que l'utilisateur est bien connect\xe9."),(0,_.$)(()=>new Error("Token manquant"));const c=(new C.Lr).set("Authorization",`Bearer ${u}`);return console.log("En-t\xeates envoy\xe9s : ",c),this.http.get(`${this.apiUrl}/entreprises`,{headers:c})}),(0,f.M)(u=>{this.entrepriseSubject.next(u)}),(0,P.W)(u=>(console.error("Erreur lors de la r\xe9cup\xe9ration des entreprises:",u),(0,_.$)(()=>u))))}getEntrepriseById(u){return this.usersService.getValidAccessToken().pipe((0,a.n)(c=>{if(!c)return console.error("Token manquant"),(0,_.$)(()=>new Error("Token manquant"));const p=new C.Lr({Authorization:`Bearer ${c}`,"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}/entreprises/${u}`,{headers:p})}),(0,P.W)(c=>{let p="Erreur inconnue";return c.error instanceof ErrorEvent?p=`Erreur: ${c.error.message}`:404===c.status&&(p="Entreprise non trouv\xe9e"),(0,_.$)(()=>new Error(p))}))}updateEntreprise(u,c){return this.usersService.getValidAccessToken().pipe((0,a.n)(p=>{if(!p)return(0,_.$)(()=>new Error("Token manquant"));const b=new C.Lr({Authorization:`Bearer ${p}`});return this.http.patch(`${this.apiUrl}/updateEntreprise/${u}`,c,{headers:b,responseType:"text"})}),(0,P.W)(p=>{let b="Erreur inconnue";return p.error instanceof ErrorEvent?b=`Erreur: ${p.error.message}`:400===p.status&&(b=p.error||"Donn\xe9es invalides"),(0,_.$)(()=>new Error(b))}))}getEntrepriseInfo(){return this.usersService.getValidAccessToken().pipe((0,a.n)(u=>{if(!u)return(0,_.$)(()=>new Error("Aucun token trouv\xe9"));const c=new C.Lr({Authorization:`Bearer ${u}`});return this.http.get(`${this.apiUrl}/myEntreprise`,{headers:c}).pipe((0,f.M)(p=>{localStorage.setItem("entreprise",JSON.stringify(p))}))}),(0,P.W)(u=>(console.error("Erreur r\xe9cup\xe9ration info entreprise:",u),(0,_.$)(()=>u))))}decodeJwt(u){return JSON.parse(atob(u.split(".")[1]))}isTokenExpired(u){return new Date(1e3*u.exp)<new Date}getNewTokenFromApi(){const u=localStorage.getItem("refreshToken");return this.http.post(`${this.apiUrl}/refresh-token`,{refreshToken:u})}static{this.\u0275fac=function(c){return new(c||E)(T.KVO(C.Qq),T.KVO(N.g))}}static{this.\u0275prov=T.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}}return E})()},61068:(R,I,g)=>{g.d(I,{Q:()=>a});var C=g(84412),m=g(54438);let a=(()=>{class P{constructor(){this.previewSubject=new C.t(null)}setPreview(f){this.previewSubject.next(f)}getPreview(){return this.previewSubject.asObservable()}static{this.\u0275fac=function(w){return new(w||P)}}static{this.\u0275prov=m.jDH({token:P,factory:P.\u0275fac,providedIn:"root"})}}return P})()},72409:(R,I,g)=>{g.d(I,{c:()=>e});var C=g(21626),m=g(25558),a=g(88141),P=g(99437),_=g(18810),f=g(76822),w=g(22525),T=g(54438),N=g(88026);let e=(()=>{class E{constructor(u,c){this.http=u,this.usersService=c,this.apiUrl=w.c.apiBaseUrl}creerFactureProforma(u,c,p,b){return this.usersService.getValidAccessToken().pipe((0,m.n)(v=>{const k=new C.Lr({Authorization:`Bearer ${v}`});let j=new C.Nl;return b&&(void 0!==c&&(j=j.set("remisePourcentage",c.toString())),void 0!==p&&(j=j.set("appliquerTVA",p.toString()))),this.http.post(`${this.apiUrl}/ajouter`,u,{headers:k,params:j})}),(0,a.M)(v=>console.log("Facture cr\xe9\xe9e avec succ\xe8s:",v)),(0,P.W)(v=>(console.error("Erreur d\xe9taill\xe9e:",v),console.log("Corps de la r\xe9ponse:",v.error),(0,_.$)(()=>v))))}getAlFactproformaOfEntreprise(u){return this.usersService.getValidAccessToken().pipe((0,m.n)(c=>{const p=new C.Lr({Authorization:`Bearer ${c}`});return this.http.get(`${this.apiUrl}/mes-factures`,{headers:p})}))}getFactureProformaById(u){return this.usersService.getValidAccessToken().pipe((0,m.n)(c=>{const p=new C.Lr({Authorization:`Bearer ${c}`});return this.http.get(`${this.apiUrl}/factureProforma/${u}`,{headers:p})}))}updateFactureProforma(u,c,p,b,v){return this.usersService.getValidAccessToken().pipe((0,m.n)(k=>{const j=new C.Lr({Authorization:`Bearer ${k}`,"Content-Type":"application/json"});let y=new C.Nl;return void 0!==c&&(y=y.set("remisePourcentage",c.toString())),void 0!==p&&(y=y.set("appliquerTVA",p.toString())),v&&v.length>0&&v.forEach(A=>{y=y.append("idsApprobateurs",A.toString())}),b.statut===f.K.ANNULE&&(y=y.set("isAnnulation","true")),this.http.put(`${this.apiUrl}/updatefacture/${u}`,b,{headers:j,params:y}).pipe((0,a.M)(A=>console.log("Facture mise \xe0 jour:",A)),(0,P.W)(A=>(console.error("Erreur mise \xe0 jour:",A),(0,_.$)(()=>A))))}))}envoyerFactureEmail(u,c){const p=new FormData;return p.append("to",c.to),p.append("cc",c.cc),p.append("subject",c.subject),p.append("body",c.body),c.attachments&&c.attachments.forEach((b,v)=>{p.append("attachments",b,b.name)}),this.usersService.getValidAccessToken().pipe((0,m.n)(b=>{const v=new C.Lr({Authorization:`Bearer ${b}`});return this.http.post(`${this.apiUrl}/factures/${u}/envoyer-email`,p,{headers:v,responseType:"text"})}))}getHistoriqueFacture(u){return this.usersService.getValidAccessToken().pipe((0,m.n)(c=>{const p=new C.Lr({Authorization:`Bearer ${c}`});return this.http.get(`${this.apiUrl}/factpro/${u}/historique`,{headers:p})}),(0,P.W)(c=>(console.error("Erreur r\xe9cup\xe9ration historique facture:",c),(0,_.$)(()=>c))))}getNotesFactureProforma(u){return this.usersService.getValidAccessToken().pipe((0,m.n)(c=>{const p=new C.Lr({Authorization:`Bearer ${c}`});return this.http.get(`${this.apiUrl}/factures/${u}/notes`,{headers:p})}),(0,P.W)(c=>(console.error("Erreur r\xe9cup\xe9ration historique facture:",c),(0,_.$)(()=>c))))}getNoteById(u,c){return this.usersService.getValidAccessToken().pipe((0,m.n)(p=>{const b=new C.Lr({Authorization:`Bearer ${p}`,Accept:"application/json"});return this.http.get(`${this.apiUrl}/auth/${u}/notes/${c}`,{headers:b})}),(0,P.W)(p=>(console.error("Erreur lors de la r\xe9cup\xe9ration de la note:",p),(0,_.$)(()=>p))))}updateNote(u,c,p){return this.usersService.getValidAccessToken().pipe((0,m.n)(b=>{const v=new C.Lr({Authorization:`Bearer ${b}`,"Content-Type":"application/json"});return this.http.put(`${this.apiUrl}/${u}/notes/${c}`,{nouveauContenu:p},{headers:v})}),(0,a.M)(b=>console.log("Note modifi\xe9e avec succ\xe8s:",b)),(0,P.W)(b=>(console.error("Erreur lors de la modification de la note:",b),(0,_.$)(()=>b))))}deletNoteFactureProforma(u,c){return this.usersService.getValidAccessToken().pipe((0,m.n)(p=>{const b=new C.Lr({Authorization:`Bearer ${p}`,Accept:"application/json"});return this.http.delete(`${this.apiUrl}/${u}/notes/${c}/supprimer`,{headers:b})}),(0,P.W)(p=>(console.error("Erreur lors de la suppression de la note:",p),(0,_.$)(()=>p))))}getFacturesByClient(u,c){return this.usersService.getValidAccessToken().pipe((0,m.n)(p=>{let b=new C.Nl;void 0!==u&&(b=b.set("clientId",u.toString())),void 0!==c&&(b=b.set("entrepriseClientId",c.toString()));const v=new C.Lr({Authorization:`Bearer ${p}`});return this.http.get(`${this.apiUrl}/factures/client`,{headers:v,params:b})}),(0,P.W)(p=>(console.error("Erreur dans getFacturesByClient:",p),(0,_.$)(()=>p))))}getFacturesParPeriode(u,c,p){return this.usersService.getValidAccessToken().pipe((0,m.n)(b=>{const v=new C.Lr({Authorization:`Bearer ${b}`});let k=(new C.Nl).set("type",u);if("personnalise"===u){if(!c||!p)throw new Error("Pour 'personnalise', les dates dateDebut et dateFin sont obligatoires.");k=k.set("dateDebut",c).set("dateFin",p)}return this.http.get(`${this.apiUrl}/mes-factures/par-periode`,{headers:v,params:k})}))}deletFactureProforma(u){return this.usersService.getValidAccessToken().pipe((0,m.n)(c=>{const p=new C.Lr({Authorization:`Bearer ${c}`,Accept:"application/json"});return this.http.delete(`${this.apiUrl}/deletefactureproforma/${u}`,{headers:p})}),(0,P.W)(c=>(console.error("Erreur lors de la suppression de la note:",c),(0,_.$)(()=>c))))}static{this.\u0275fac=function(c){return new(c||E)(T.KVO(C.Qq),T.KVO(N.g))}}static{this.\u0275prov=T.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}}return E})()},88704:(R,I,g)=>{g.d(I,{H:()=>m});var C=g(54438);let m=(()=>{class a{saveState(_){this.formState={..._}}getState(){return this.formState}clearState(){this.formState=null}static{this.\u0275fac=function(f){return new(f||a)}}static{this.\u0275prov=C.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})()},62051:(R,I,g)=>{g.r(I),g.d(I,{AddfactureProformaComponent:()=>St});var C=g(10467),m=g(60177),a=g(89417),P=g(60850),_=g(99172),f=g(96354),w=g(25558),T=g(18810),N=g(96115),e=g(54438),E=g(96967),B=g(7673),u=g(99213),c=g(58250),p=g(49293),b=g(9599),v=g(66375),k=g(49192),j=g(88026),y=g(3);const A=["autoUnite"],L=["autoCategory"],$=()=>({standalone:!0}),q=i=>({error:i});function U(i,l){1&i&&(e.j41(0,"div",65)(1,"div",66),e.nrm(2,"div",67),e.j41(3,"p"),e.EFF(4,"Connexion en cours..."),e.k0s()()())}function z(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",77)(1,"label")(2,"input",78),e.mxI("ngModelChange",function(n){const r=e.eBV(t).$implicit;return e.DH7(r.selected,n)||(r.selected=n),e.Njj(n)}),e.bIt("change",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.updateSelectedBoutiques())}),e.k0s(),e.EFF(3),e.k0s()()}if(2&i){const t=l.$implicit;e.R7$(2),e.R50("ngModel",t.selected),e.Y8G("ngModelOptions",e.lJ4(3,$)),e.R7$(),e.SpI(" ",t.nomBoutique," ")}}function Y(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",68)(1,"div",69)(2,"h4"),e.EFF(3,"S\xe9lectionner des boutiques"),e.k0s(),e.j41(4,"button",70),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.toggleBoutiqueSelectionPanel())}),e.EFF(5,"\xd7"),e.k0s()(),e.j41(6,"div",71)(7,"div",72)(8,"label")(9,"input",73),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.toggleSelectAllBoutiques(n))}),e.k0s(),e.EFF(10," S\xe9lectionner toutes les boutiques "),e.k0s()(),e.DNE(11,z,4,4,"div",74),e.k0s(),e.j41(12,"div",75)(13,"button",76),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.confirmBoutiqueSelection())}),e.EFF(14,"Confirmer"),e.k0s()()()}if(2&i){const t=e.XpG();e.R7$(9),e.Y8G("checked",t.areAllBoutiquesSelected()),e.R7$(2),e.Y8G("ngForOf",t.boutiquesList)}}function X(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Le nom produit est vide."),e.k0s())}function W(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Le nom doit avoir au moins 2 caract\xe8res."),e.k0s())}function J(i,l){if(1&i&&(e.j41(0,"div",79),e.DNE(1,X,2,0,"span",80)(2,W,2,0,"span",80),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",null==t.f.nom.errors?null:t.f.nom.errors.required),e.R7$(),e.Y8G("ngIf",null==t.f.nom.errors?null:t.f.nom.errors.minlength)}}function K(i,l){if(1&i&&(e.j41(0,"mat-option",81)(1,"div",82),e.EFF(2),e.k0s()()),2&i){const t=l.$implicit;e.Y8G("value",t),e.R7$(2),e.SpI(" ",t.nom," ")}}function H(i,l){if(1&i){const t=e.RV6();e.j41(0,"i",83),e.bIt("click",function(n){return e.eBV(t),e.XpG().toggleUniteDropdown(),e.Njj(n.stopPropagation())}),e.k0s()}}function Z(i,l){if(1&i){const t=e.RV6();e.j41(0,"i",84),e.bIt("click",function(n){return e.eBV(t),e.XpG().closeUniteDropdown(),e.Njj(n.stopPropagation())}),e.k0s()}}function Q(i,l){if(1&i&&(e.j41(0,"div",85)(1,"p"),e.EFF(2),e.k0s()()),2&i){const t=e.XpG();e.R7$(2),e.JRh(t.formattedPrixVente)}}function ee(i,l){1&i&&(e.j41(0,"div",79),e.EFF(1," Ce champ est obligatoire. "),e.k0s())}function te(i,l){if(1&i&&(e.j41(0,"div",85)(1,"p"),e.EFF(2),e.k0s()()),2&i){const t=e.XpG();e.R7$(2),e.JRh(t.formattedCoutProduit)}}function ne(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Le co\xfbt ne peut pas \xeatre n\xe9gatif."),e.k0s())}function oe(i,l){if(1&i&&(e.j41(0,"div",86),e.DNE(1,ne,2,0,"span",80),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",null==t.f.prixAchat.errors?null:t.f.prixAchat.errors.min)}}function ie(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",92)(1,"div",93)(2,"input",94),e.bIt("ngModelChange",function(n){e.eBV(t);const r=e.XpG().$implicit,s=e.XpG(3);return e.Njj(s.quantitesMap[r.id]=n)}),e.k0s(),e.j41(3,"label",95),e.EFF(4),e.k0s()(),e.j41(5,"div",93)(6,"input",96),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG().$implicit,s=e.XpG(3);return e.DH7(s.seuilsMap[r.id],n)||(s.seuilsMap[r.id]=n),e.Njj(n)}),e.k0s(),e.j41(7,"label",97),e.EFF(8,"Seuil d'alerte"),e.k0s()(),e.j41(9,"div",12),e.nrm(10,"input",98),e.j41(11,"label",99),e.EFF(12,"Date de pr\xe9emption (Facultatif)"),e.k0s()()()}if(2&i){const t=e.XpG().$implicit,o=e.XpG(3);e.R7$(2),e.Y8G("ngModel",o.quantitesMap[t.id]||0)("ngModelOptions",e.lJ4(7,$)),e.R7$(2),e.SpI("Quantit\xe9 en stock pour ",t.nomBoutique,""),e.R7$(2),e.Mz_("placeholder","Seuil d'alerte pour ",t.nomBoutique,""),e.R50("ngModel",o.seuilsMap[t.id]),e.Y8G("ngModelOptions",e.lJ4(8,$))}}function re(i,l){if(1&i&&(e.qex(0),e.DNE(1,ie,13,9,"div",91),e.bVm()),2&i){const t=l.$implicit;e.R7$(),e.Y8G("ngIf",t.selected)}}function se(i,l){if(1&i&&(e.j41(0,"div"),e.DNE(1,re,2,1,"ng-container",90),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.boutiquesList)}}function ae(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"h4"),e.EFF(3,"Inventaire"),e.k0s(),e.j41(4,"div",87)(5,"p"),e.EFF(6,"Ajouter dans les stocks"),e.k0s(),e.j41(7,"label",88)(8,"input",78),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.isChecked,n)||(r.isChecked=n),e.Njj(n)}),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onToggleChange(n))}),e.k0s(),e.nrm(9,"span",89),e.k0s()(),e.DNE(10,se,2,1,"div",80),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(8),e.R50("ngModel",t.isChecked),e.Y8G("ngModelOptions",e.lJ4(3,$)),e.R7$(2),e.Y8G("ngIf",t.isChecked)}}function le(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",100),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.clearImage())}),e.nrm(1,"i",101),e.k0s()}}function ce(i,l){if(1&i&&(e.j41(0,"div",79),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessage," ")}}function pe(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",102)(1,"div",103)(2,"div",104)(3,"div",105),e.nrm(4,"img",106),e.k0s(),e.j41(5,"h2"),e.EFF(6),e.k0s()(),e.j41(7,"p"),e.EFF(8),e.k0s(),e.j41(9,"button",107),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopup())}),e.EFF(10,"OK"),e.k0s()()()}if(2&i){const t=e.XpG();e.R7$(),e.Y8G("ngClass",e.eq3(4,q,"error"===t.popupData.type)),e.R7$(3),e.Y8G("src",t.popupData.image,e.B4B),e.R7$(2),e.JRh(t.popupData.title),e.R7$(2),e.JRh(t.popupData.message)}}function ue(i,l){1&i&&(e.j41(0,"div")(1,"small",123),e.EFF(2,"Ce champ est obligatoire."),e.k0s()())}function de(i,l){1&i&&(e.j41(0,"div")(1,"small",123),e.EFF(2,"Email invalide."),e.k0s()())}function ge(i,l){1&i&&(e.j41(0,"div")(1,"small",123),e.EFF(2,"Ce champ est obligatoire."),e.k0s()())}function me(i,l){if(1&i&&(e.j41(0,"div",124),e.nrm(1,"img",125),e.j41(2,"span"),e.EFF(3),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("src","success"===t.apiMessageType?"assets/img/succcccc.png":"assets/img/error.png",e.B4B),e.R7$(2),e.JRh(t.messageAPI)}}function fe(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",108)(1,"div",109)(2,"div",110)(3,"h4"),e.EFF(4,"Ajouter une boutique"),e.k0s(),e.j41(5,"button",70),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopupBoutique())}),e.EFF(6,"\xd7"),e.k0s()(),e.j41(7,"form",111)(8,"div",112)(9,"div",113)(10,"div",12),e.nrm(11,"input",114),e.j41(12,"label",115),e.EFF(13,"Nom boutque"),e.k0s(),e.DNE(14,ue,3,0,"div",80),e.k0s(),e.j41(15,"div",12),e.nrm(16,"input",116),e.j41(17,"label",115),e.EFF(18,"Email"),e.k0s(),e.DNE(19,de,3,0,"div",80),e.k0s()(),e.j41(20,"div",113)(21,"div",12),e.nrm(22,"input",117),e.j41(23,"label",115),e.EFF(24,"Phone"),e.k0s(),e.DNE(25,ge,3,0,"div",80),e.k0s(),e.j41(26,"div",12),e.nrm(27,"input",118),e.j41(28,"label",115),e.EFF(29,"Adresse boutique"),e.k0s()()(),e.DNE(30,me,4,2,"div",119),e.k0s(),e.j41(31,"div",120)(32,"button",121),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopupBoutique())}),e.EFF(33,"Annuler"),e.k0s(),e.j41(34,"button",122),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmitBoutique())}),e.EFF(35," Ajouter "),e.k0s()()()()()}if(2&i){let t,o,n;const r=e.XpG();e.R7$(7),e.Y8G("formGroup",r.boutiqueForm),e.R7$(7),e.Y8G("ngIf",(null==(t=r.boutiqueForm.get("nomBoutique"))?null:t.invalid)&&(null==(t=r.boutiqueForm.get("nomBoutique"))?null:t.touched)),e.R7$(5),e.Y8G("ngIf",(null==(o=r.boutiqueForm.get("emailBoutique"))?null:o.invalid)&&(null==(o=r.boutiqueForm.get("emailBoutique"))?null:o.touched)),e.R7$(6),e.Y8G("ngIf",(null==(n=r.boutiqueForm.get("telephoneBoutique"))?null:n.invalid)&&(null==(n=r.boutiqueForm.get("telephoneBoutique"))?null:n.touched)),e.R7$(5),e.Y8G("ngIf",r.messageAPI),e.R7$(4),e.xc7("background-color",r.boutiqueForm.valid?"#0672E4":"#0671e434")("color",r.boutiqueForm.valid?"#ffffff":"#00000073")("cursor",r.boutiqueForm.valid?"pointer":"no-drop"),e.Y8G("disabled",r.boutiqueForm.invalid)}}function _e(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Le nom doit avoir au moins 3 caract\xe8res."),e.k0s())}function he(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Le nom ne doit pas d\xe9passer 20 caract\xe8res."),e.k0s())}function Ce(i,l){if(1&i&&(e.j41(0,"div",79),e.DNE(1,_e,2,0,"span",80)(2,he,2,0,"span",80),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==t.c.categoryName.errors?null:t.c.categoryName.errors.minlength),e.R7$(),e.Y8G("ngIf",null==t.c.categoryName.errors?null:t.c.categoryName.errors.maxlength)}}function be(i,l){if(1&i&&(e.j41(0,"div",131),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.errorMessageCategory," ")}}function Pe(i,l){if(1&i&&(e.j41(0,"div",124),e.nrm(1,"img",125),e.j41(2,"span"),e.EFF(3),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("src","success"===t.apiMessageType?"assets/img/succcccc.png":"assets/img/error.png",e.B4B),e.R7$(2),e.JRh(t.messageAPI)}}function ve(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",108)(1,"div",126)(2,"div",110)(3,"h4"),e.EFF(4,"Cr\xe9er une cat\xe9gorie"),e.k0s(),e.j41(5,"button",70),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopupCategory())}),e.EFF(6,"\xd7"),e.k0s()(),e.j41(7,"form",111)(8,"div",112)(9,"div",127),e.nrm(10,"input",128),e.j41(11,"label",129),e.EFF(12,"Nom cat\xe9gorie"),e.k0s(),e.DNE(13,Ce,3,2,"div",27),e.k0s(),e.DNE(14,be,2,1,"div",130)(15,Pe,4,2,"div",119),e.k0s(),e.j41(16,"div",120)(17,"button",121),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopupCategory())}),e.EFF(18,"Annuler"),e.k0s(),e.j41(19,"button",122),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.submitFormCategory())}),e.EFF(20," Ajouter "),e.k0s()()()()()}if(2&i){const t=e.XpG();e.R7$(7),e.Y8G("formGroup",t.ajouteCategoryForm),e.R7$(6),e.Y8G("ngIf",t.c.categoryName.touched&&t.c.categoryName.invalid),e.R7$(),e.Y8G("ngIf",t.errorMessageCategory),e.R7$(),e.Y8G("ngIf",t.messageAPI),e.R7$(4),e.xc7("background-color",t.ajouteCategoryForm.valid?"#0672E4":"#0671e434"),e.Y8G("disabled",t.ajouteCategoryForm.invalid)}}function xe(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Le nom doit avoir au moins 2 caract\xe8res."),e.k0s())}function Me(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Le nom ne doit pas d\xe9passer 20 caract\xe8res."),e.k0s())}function Fe(i,l){if(1&i&&(e.j41(0,"div",79),e.DNE(1,xe,2,0,"span",80)(2,Me,2,0,"span",80),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==t.u.unityName.errors?null:t.u.unityName.errors.minlength),e.R7$(),e.Y8G("ngIf",null==t.u.unityName.errors?null:t.u.unityName.errors.maxlength)}}function Oe(i,l){if(1&i&&(e.j41(0,"div",131),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.errorMessageUnity," ")}}function Ee(i,l){if(1&i&&(e.j41(0,"div",124),e.nrm(1,"img",125),e.j41(2,"span"),e.EFF(3),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("src","success"===t.apiMessageType?"assets/img/succcccc.png":"assets/img/error.png",e.B4B),e.R7$(2),e.JRh(t.messageAPI)}}function ke(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",108)(1,"div",126)(2,"div",110)(3,"h4"),e.EFF(4,"Cr\xe9er une unit\xe9"),e.k0s(),e.j41(5,"button",70),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopupUnit())}),e.EFF(6,"\xd7"),e.k0s()(),e.j41(7,"form",111)(8,"div",112)(9,"div",127),e.nrm(10,"input",132),e.j41(11,"label",133),e.EFF(12,"Nom unit\xe9"),e.k0s(),e.DNE(13,Fe,3,2,"div",27),e.k0s(),e.DNE(14,Oe,2,1,"div",130)(15,Ee,4,2,"div",119),e.k0s(),e.j41(16,"div",120)(17,"button",121),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopupUnit())}),e.EFF(18,"Annuler"),e.k0s(),e.j41(19,"button",122),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.submitFormUnity())}),e.EFF(20," Ajouter "),e.k0s()()()()()}if(2&i){const t=e.XpG();e.R7$(7),e.Y8G("formGroup",t.ajouteUniteForm),e.R7$(6),e.Y8G("ngIf",t.u.unityName.touched&&t.u.unityName.invalid),e.R7$(),e.Y8G("ngIf",t.errorMessageUnity),e.R7$(),e.Y8G("ngIf",t.messageAPI),e.R7$(4),e.xc7("background-color",t.ajouteUniteForm.valid?"#0672E4":"#0671e434"),e.Y8G("disabled",t.ajouteUniteForm.invalid)}}let je=(()=>{class i{get c(){return this.ajouteCategoryForm.controls}get u(){return this.ajouteUniteForm.controls}get f(){return this.ajouteProduitForm.controls}clearImage(){this.newPhotoUrl=null,this.imageFile=null}testImageCompression(t){var o=this;return(0,C.A)(function*(){if(!t)return void console.log("Aucun fichier s\xe9lectionn\xe9.");console.log("Taille originale:",t.size/1024,"Ko");const n={maxSizeMB:1,maxWidthOrHeight:1e3,useWebWorker:!0};try{const r=yield(0,E.A)(t,n);if(console.log("Taille apr\xe8s compression:",r.size/1024,"Ko"),"image/png"!==r.type&&"image/jpeg"!==r.type)return console.error("Le fichier compress\xe9 n'est pas un format support\xe9 (PNG ou JPEG)."),void(o.errorMessage="Erreur de compression : Le format de l'image n'est pas valide.");const s=new FileReader;s.onload=d=>{o.newPhotoUrl=d.target?.result,console.log("Image compress\xe9e pr\xeate \xe0 \xeatre affich\xe9e !")},s.readAsDataURL(r)}catch(r){console.error("Erreur lors de la compression:",r)}})()}goToProduit(){this.router.navigate(["/produit"])}onResponseFromBackend(t){this.showPopupMessage({title:"success"===t.type?"Succ\xe8s":"Erreur",message:t.message,image:"success"===t.type?"assets/img/succes.png":"assets/img/error.png",type:t.type})}showPopupMessage(t){this.popupData=t,this.showPopup=!0}closePopup(){this.showPopup=!1}constructor(t,o,n,r,s,d){this.categorieService=t,this.uniteMesureService=o,this.produitService=n,this.fb=r,this.router=s,this.usersService=d,this.produitAjoute=new e.bkB,this.close=new e.bkB,this.isChecked=!1,this.showPopup=!1,this.boutiqueName="",this.boutiqueId=1,this.messageAPI="",this.apiMessageType="",this.seuilsMap={},this.errorMessage="",this.errorMessageCategory="",this.errorMessageUnity="",this.boutiquesList=[],this.showPopupCategory=!1,this.formSubmitted=!1,this.showPopupUnit=!1,this.popupTitle="",this.popupMessage="",this.popupImage="",this.popupType="success",this.imagePopup=null,this.nomEntreprise="",this.adresseEntreprise="",this.logoEntreprise="",this.imageFile=null,this.isLoading=!1,this.boutiqueIdSelected=[],this.quantitesMap={},this.successMessage=null,this.UniterControl=new a.MJ,this.showCategoryCreation=!1,this.showUniteCreation=!1,this.formattedPrixVente="",this.formattedCoutProduit="",this.filteredUsers=[],this.indicatif="",this.maxPhoneLength=8,this.isAscending=!0,this.searchTerm="",this.urllink="assets/img/appareil.jpg",this.newPhotoUrl=null,this.selectedFile=null,this.myControl=new a.MJ,this.uniteControl=new a.MJ,this.options=[],this.optionsUnite=[],this.filteredOptions=(0,B.of)([]),this.filteredNomUnite=(0,B.of)([]),this.controlBoutique=new a.MJ(""),this.streetsBoutique=[],this.showPopupBoutique=!1,this.showBoutiqueSelectionPanel=!1,this.selectedBoutiques=[],this.isSending=!1,this.showBarcode=!1,this.showBoutiqueError=!1,this.popupData={title:"",message:"",image:"",type:"success"},this.isUniteDropdownOpen=!1,this.isCategoryDropdownOpen=!1}openPopupCategory(){this.showPopupCategory=!0,this.ajouteCategoryForm.reset(),this.errorMessageCategory="",this.messageAPI=""}closePopupCategory(){this.showPopupCategory=!1}openPopupUnit(){this.showPopupUnit=!0,this.ajouteUniteForm.reset(),this.errorMessageUnity="",this.messageAPI=""}closePopupUnit(){this.showPopupUnit=!1}onToggleChange(t){const n=t.target.checked;n&&0===this.boutiqueIdSelected.length?(this.errorMessage="Veuillez s\xe9lectionner au moins une boutique avant d'ajouter des stocks.",this.showBoutiqueError=!0,setTimeout(()=>{this.isChecked=!1},0)):(this.isChecked=n,"Veuillez s\xe9lectionner au moins une boutique avant d'ajouter des stocks."===this.errorMessage&&(this.errorMessage=""))}onFileSelected(t){const o=t.target;if(o.files&&o.files.length>0){const n=o.files[0];if(!["image/jpeg","image/png","image/jpg"].includes(n.type))return void(this.errorMessage="Le fichier doit \xeatre une image (JPG, PNG)");this.selectedFile=n,this.imageFile=n,this.testImageCompression(n);const s=new FileReader;s.onload=d=>{this.newPhotoUrl=d.target?.result},s.readAsDataURL(this.selectedFile)}}setupFormSubscriptions(){const t=this.usersService.getValidAccessToken();t?this.categorieService.getCategories().subscribe(o=>{console.log("Cat\xe9gories re\xe7ues depuis l'API :",o),this.options=o,this.filteredOptions=this.myControl.valueChanges.pipe((0,_.Z)(""),(0,f.T)(n=>n?"string"==typeof n?n:n.nom:""),(0,f.T)(n=>n?this._filter(n):this.options.slice()))},o=>{console.error("Erreur lors de la r\xe9cup\xe9ration des cat\xe9gories :",o)}):console.error("Aucun token trouv\xe9 !"),t?this.uniteMesureService.getUniteMesure().subscribe(o=>{console.log("Unit\xe9 de mesure re\xe7ues depuis l'API :",o),this.optionsUnite=o,this.filteredNomUnite=this.uniteControl.valueChanges.pipe((0,_.Z)(""),(0,f.T)(n=>n?"string"==typeof n?n:n.nom:""),(0,f.T)(n=>n?this._filterUnite(n):this.optionsUnite.slice()))},o=>{console.error("Erreur lors de la r\xe9cup\xe9ration des cat\xe9gories :",o)}):console.error("Aucun token trouv\xe9 !")}loadInitialData(){this.ajouteProduitForm=this.fb.group({nom:["",[a.k0.required,a.k0.minLength(2)]],prixVente:["",a.k0.required],prixAchat:[""],quantite:["0"],seuilAlert:["0"],description:[""],codeBare:["",[a.k0.minLength(8),a.k0.maxLength(13)]],categorieId:[""],uniteId:[""],datePreemption:[""],typeProduit:["PHYSIQUE",a.k0.required]}),this.ajouteCategoryForm=this.fb.group({categoryName:["",[a.k0.minLength(3),a.k0.maxLength(20)]]}),this.ajouteUniteForm=this.fb.group({unityName:["",[a.k0.minLength(2),a.k0.maxLength(20)]]}),this.ajouteProduitForm.get("nom")?.valueChanges.subscribe(t=>{(!this.selectedFile||this.selectedFile&&"default.svg"===this.selectedFile.name)&&(t&&t.trim().length>0?(this.newPhotoUrl=this.generateImageFromLetter(t.trim()[0]),this.selectedFile=this.dataURLtoFile(this.newPhotoUrl,"default.svg"),this.imageFile=this.selectedFile):this.newPhotoUrl=this.urllink)}),this.ajouteProduitForm.get("codeBare")?.valueChanges.subscribe(t=>{this.showBarcode=t&&t.length>=3})}setupAutocompleteFilters(){this.ajouteCategoryForm.get("categoryName")?.valueChanges.subscribe(()=>{this.errorMessageCategory="",this.messageAPI="",this.apiMessageType=""}),this.ajouteUniteForm.get("unityName")?.valueChanges.subscribe(()=>{this.errorMessageUnity="",this.messageAPI="",this.apiMessageType=""})}ngOnInit(){this.initForm(),this.getBoutiqueName(),this.setupFormSubscriptions(),this.loadInitialData(),this.setupAutocompleteFilters(),this.getFilteredStreetsBoutique(),this.getBoutiqueName(),document.addEventListener("click",t=>{const o=t.target;!o.closest(".champ_input_cate")&&this.isCategoryDropdownOpen&&this.closeCategoryDropdown(),!o.closest(".champ_input_uni")&&this.isUniteDropdownOpen&&this.closeUniteDropdown()})}generateImageFromLetter(t){const o=`\n      <svg xmlns="http://www.w3.org/2000/svg" width="200" height="200">\n        <rect width="100%" height="100%" fill="#0671e4ac"/>\n        <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="100" fill="#fff">\n          ${t.toUpperCase()}\n        </text>\n      </svg>\n    `;return"data:image/svg+xml;base64,"+btoa(o)}dataURLtoFile(t,o){const n=t.split(","),r=n[0].match(/:(.*?);/);if(!r)throw new Error("Format de dataURL invalide");const s=r[1],d=atob(n[1]);let h=d.length;const F=new Uint8Array(h);for(;h--;)F[h]=d.charCodeAt(h);return new File([F],o,{type:s})}getBoutiqueName(){this.usersService.getUserInfo().subscribe(t=>{t&&t.boutiques?(this.boutiquesList=t.boutiques,this.streetsBoutique=this.boutiquesList.map(o=>o.nomBoutique),this.getFilteredStreetsBoutique()):(console.error("Aucune boutique trouv\xe9e pour cet utilisateur"),this.boutiqueName="Aucune boutique")},t=>{console.error("Erreur lors de la r\xe9cup\xe9ration des informations utilisateur",t)})}onCategorySelected(t){console.log("Option s\xe9lectionn\xe9e :",t.option.value),t.option&&t.option.value?this.ajouteProduitForm.get("categorieId")?.setValue(t.option.value.id):this.ajouteProduitForm.get("categorieId")?.setValue(null)}onUniteSelected(t){console.log("Unit\xe9 s\xe9lectionn\xe9e :",t.option.value),t.option&&t.option.value?this.ajouteProduitForm.get("uniteId")?.setValue(t.option.value.id):this.ajouteProduitForm.get("uniteId")?.setValue(null)}_filter(t){const o=t.toLowerCase();return this.options.filter(n=>n.nom.toLowerCase().includes(o))}displayFn(t){return t?t.nom:""}_filterUnite(t){const o=t.toLowerCase();return this.optionsUnite.filter(n=>n.nom.toLowerCase().includes(o))}displayFnUnite(t){return t?t.nom:""}onCreateCategoryClick(){this.openPopupCategory()}onCreateUniteClick(){this.openPopupUnit()}cancelCategoryCreation(){this.showCategoryCreation=!1}cancelUniteCreation(){this.showUniteCreation=!1}submitFormCategory(){const t={nom:this.ajouteCategoryForm.value.categoryName};this.categorieService.ajouterCategorie(t).subscribe({next:o=>{if(console.log("Cat\xe9gorie ajout\xe9e avec succ\xe8s : ",o),o&&o.id){this.ajouteCategoryForm.get("categoryName").setValue(""),this.closePopupCategory();const n={id:o.id,nom:t.nom};this.options.push(n),this.showCategoryCreation=!1,this.myControl.setValue(n),this.ajouteProduitForm.get("categorieId")?.setValue(n.id),this.filteredOptions=this.myControl.valueChanges.pipe((0,_.Z)(n),(0,f.T)(r=>"string"==typeof r?r:r?.nom),(0,f.T)(r=>r?this._filter(r):this.options.slice())),this.apiMessageType="success",this.messageAPI=o.message||"La cat\xe9gorie a \xe9t\xe9 cr\xe9\xe9e avec succ\xe8s."}},error:o=>{console.log("Erreur compl\xe8te :",o),console.log("R\xe9ponse API :",o.error);let n="Une erreur est survenue lors de la cr\xe9ation de la cat\xe9gorie.";o.error&&("object"==typeof o.error&&o.error.error?n=o.error.error:"string"==typeof o.error&&(n=o.error)),this.apiMessageType="error",this.messageAPI=n}})}submitFormUnity(){const t={nom:this.ajouteUniteForm.value.unityName};this.uniteMesureService.ajouterUnite(t).subscribe({next:o=>{if(console.log("Unit\xe9 ajout\xe9 avec succ\xe8s : ",o),o&&o.id){this.ajouteUniteForm.get("unityName").setValue(""),this.closePopupUnit();const n={id:o.id,nom:t.nom};this.showUniteCreation=!1,this.optionsUnite.push(n),this.uniteControl.updateValueAndValidity(),this.uniteControl.setValue(n),this.ajouteProduitForm.get("uniteId")?.setValue(n.id),this.filteredNomUnite=this.uniteControl.valueChanges.pipe((0,_.Z)(n),(0,f.T)(r=>"string"==typeof r?r:r?.nom),(0,f.T)(r=>r?this._filterUnite(r):this.optionsUnite.slice())),this.apiMessageType="success",this.messageAPI=o.message||"L'unit\xe9 a \xe9t\xe9 cr\xe9\xe9e avec succ\xe8s."}},error:o=>{console.log("Erreur compl\xe8te :",o),console.log("R\xe9ponse API :",o.error);let n="Une erreur est survenue lors de la cr\xe9ation de l'unit\xe9.";o.error&&("object"==typeof o.error&&o.error.error?n=o.error.error:"string"==typeof o.error&&(n=o.error)),this.apiMessageType="error",this.messageAPI=n}})}onSubmit(){var t=this;return(0,C.A)(function*(){if(""===t.ajouteProduitForm.value.prixAchat&&t.ajouteProduitForm.patchValue({prixAchat:null}),t.ajouteProduitForm.invalid)return void(t.errorMessage="Veuillez v\xe9rifier les informations saisies.");t.isSending=!0;const o=t.ajouteProduitForm.value;if(!localStorage.getItem("accessToken"))return t.showPopupMessage({title:"Erreur",message:"Aucun token trouv\xe9 !",image:"assets/img/error.png",type:"error"}),void(t.isSending=!1);const r=t.isChecked,s=t.ajouteProduitForm.get("datePreemption")?.value;try{let d;if(t.imageFile&&"default.svg"!==t.imageFile.name){const M={maxSizeMB:1,maxWidthOrHeight:1e3,useWebWorker:!0},O=yield(0,E.A)(t.imageFile,M);if("image/png"!==O.type&&"image/jpeg"!==O.type)return t.errorMessage="Le fichier compress\xe9 n'est pas un format valide (PNG ou JPEG).",void(t.isSending=!1);d=new File([O],t.imageFile.name.replace(/\..+$/,"image/png"===O.type?".png":".jpeg"),{type:O.type,lastModified:Date.now()})}else{const M=o.nom.trim()[0];d=t.dataURLtoFile(t.generateImageFromLetter(M),"default.svg")}if(0===t.boutiqueIdSelected.length)return t.errorMessage="Veuillez s\xe9lectionner au moins une boutique.",void(t.isSending=!1);const h=t.boutiqueIdSelected.map(M=>Number(t.quantitesMap[M])||0),F=t.boutiqueIdSelected.map(M=>Number(t.seuilsMap[M])||0);t.produitService.ajouterProduit(t.boutiqueIdSelected,h,F,o,d,r,s).subscribe({next:M=>{const O=M[0];if(O){const G={id:O.id,nom:o.nom,description:o.description||"",prixVente:o.prixVente,prixAchat:o.prixAchat,datePreemption:o.datePreemption,categorieId:o.categorieId,uniteId:o.uniteId,typeProduit:o.typeProduit,codeBare:o.codeBare||"",codeGenerique:O.codeGenerique||"",quantite:h[0]||0,seuilAlert:F[0]||0,photo:O.photo||"",enStock:r,boutiqueId:t.boutiqueIdSelected?.length>0?t.boutiqueIdSelected[0]:null};t.resetForm(),t.ajouteProduitForm.reset(),t.myControl.reset(),t.uniteControl.reset(),t.imageFile=null,t.selectedFile=null,t.newPhotoUrl=null,t.isSending=!1,t.produitAjoute.emit(G),t.close.emit()}else console.error("Aucun produit retourn\xe9 par l'API"),t.isSending=!1},error:M=>{let O;O=409===M.status?"Un produit portant ce nom existe d\xe9j\xe0.":M.error&&"string"==typeof M.error?M.error:M.error&&M.error.message?M.error.message:"Une erreur est survenue lors de la cr\xe9ation du produit.",t.errorMessage="Un produit portant ce nom existe d\xe9j\xe0.",t.isSending=!1}})}catch(d){console.error("Erreur lors de la compression:",d),t.errorMessage="Erreur lors de la compression de l'image",t.isSending=!1}})()}onCodeBarChange(){const t=this.ajouteProduitForm.get("codeBare")?.value||"";this.showBarcode=t.length>=1}validateNumericInput(t){const o=t.which?t.which:t.keyCode;(o<48||o>57)&&t.preventDefault()}getFilteredStreetsBoutique(){this.filteredStreetsBoutique=this.controlBoutique.valueChanges.pipe((0,_.Z)(""),(0,f.T)(t=>this._filterBoutique(t||"")))}_filterBoutique(t){const o=this._normalizeValue(t);return this.boutiquesList.filter(n=>this._normalizeValue(n.nomBoutique).includes(o)).map(n=>n.nomBoutique)}_normalizeValue(t){return t.toLowerCase().replace(/\s/g,"")}onFocusBoutiqueInput(){this.controlBoutique.setValue("")}initForm(){this.boutiqueForm=this.fb.group({nomBoutique:["",a.k0.required],emailBoutique:["",[a.k0.email,a.k0.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],adresseBoutique:[""],telephoneBoutique:["",a.k0.pattern(/^\d{8,15}$/)]})}updatePhoneValidator(t){this.boutiqueForm.controls.phone.setValidators([a.k0.required,a.k0.pattern(`^\\+\\d{1,3}\\s?\\d{${t}}$`)]),this.boutiqueForm.controls.phone.updateValueAndValidity()}openPopupBoutique(){this.showPopupBoutique=!0}closePopupBoutique(){this.showPopupBoutique=!1,this.resetForm()}resetForm(){this.ajouteProduitForm.reset({typeProduit:"PHYSIQUE"}),this.myControl.reset(),this.uniteControl.reset(),this.imageFile=null,this.selectedFile=null,this.newPhotoUrl=this.urllink,this.isChecked=!1,this.boutiqueIdSelected=[],this.quantitesMap={},this.seuilsMap={},this.controlBoutique.reset(),this.showBoutiqueSelectionPanel=!1,this.selectedBoutiques=[],this.errorMessage=""}onBoutiqueSelected(t){const o=t.option.value,n=this.boutiquesList.find(r=>r.nomBoutique===o);this.boutiqueIdSelected=n?[n.id]:[]}onSubmitBoutique(){Object.keys(this.boutiqueForm.controls).forEach(o=>{this.boutiqueForm.get(o)?.markAsTouched({onlySelf:!0})}),this.boutiqueForm.invalid||this.usersService.addBoutique(this.boutiqueForm.value).subscribe({next:o=>{this.showPopupMessage({title:"Succ\xe8s",message:"Boutique cr\xe9\xe9e avec succ\xe8s",image:"assets/img/succcccc.png",type:"success"}),this.closePopupBoutique(),this.getBoutiqueName(),this.boutiqueForm.reset()},error:o=>{let n="Erreur lors de la cr\xe9ation de la boutique";o.error&&(n="string"==typeof o.error?o.error:o.error.message),this.showPopupMessage({title:"Erreur",message:n,image:"assets/img/error.png",type:"error"})}})}displayFnBoutique(t){return t||""}toggleBoutiqueSelectionPanel(){this.showBoutiqueSelectionPanel=!this.showBoutiqueSelectionPanel}toggleSelectAllBoutiques(t){const o=t.target.checked;this.boutiquesList.forEach(n=>n.selected=o),this.updateSelectedBoutiques()}updateSelectedBoutiques(){this.selectedBoutiques=this.boutiquesList.filter(t=>t.selected)}confirmBoutiqueSelection(){this.selectedBoutiques=this.boutiquesList.filter(o=>o.selected),this.boutiqueIdSelected=this.selectedBoutiques.map(o=>o.id);const t=this.selectedBoutiques.map(o=>o.nomBoutique);this.controlBoutique.setValue(t.join(", ")),this.toggleBoutiqueSelectionPanel(),this.boutiqueIdSelected.length>0&&(this.showBoutiqueError=!1,"Veuillez s\xe9lectionner au moins une boutique."===this.errorMessage&&(this.errorMessage=""))}areAllBoutiquesSelected(){return this.boutiquesList.length>0&&this.boutiquesList.every(t=>t.selected)}formatPrixVente(){const t=this.ajouteProduitForm.get("prixVente")?.value;if(null==t||isNaN(t))this.formattedPrixVente="";else{const o=new Intl.NumberFormat("fr-FR").format(t);this.formattedPrixVente=`${o} FCFA`}}formatCoutProduit(){const t=this.ajouteProduitForm.get("prixAchat")?.value;if(null==t||isNaN(t))this.formattedCoutProduit="";else{const o=new Intl.NumberFormat("fr-FR").format(t);this.formattedCoutProduit=`${o} FCFA`}}closeForm(){this.close.emit()}markFormGroupTouched(t){Object.values(t.controls).forEach(o=>{o.markAsTouched(),o instanceof a.gE&&this.markFormGroupTouched(o)})}gotToReturn(){this.router.navigate(["/addfacture-proforma"])}toggleUniteDropdown(t){t&&t.stopPropagation(),this.uniteAutocompleteTrigger&&this.uniteAutocompleteTrigger.openPanel()}closeUniteDropdown(){this.uniteAutocompleteTrigger&&(this.uniteAutocompleteTrigger.closePanel(),this.isUniteDropdownOpen=!1)}toggleCategoryDropdown(t){t&&t.stopPropagation(),this.categoryAutocompleteTrigger&&this.categoryAutocompleteTrigger.openPanel()}closeCategoryDropdown(){this.categoryAutocompleteTrigger&&(this.categoryAutocompleteTrigger.closePanel(),this.isCategoryDropdownOpen=!1)}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(p.R),e.rXU(b.Q),e.rXU(v.D),e.rXU(a.ok),e.rXU(k.Ix),e.rXU(j.g))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-produit-form"]],viewQuery:function(o,n){if(1&o&&(e.GBs(A,5),e.GBs(P.pN,5),e.GBs(L,5),e.GBs(P.pN,5)),2&o){let r;e.mGM(r=e.lsd())&&(n.autoUnite=r.first),e.mGM(r=e.lsd())&&(n.uniteAutocompleteTrigger=r.first),e.mGM(r=e.lsd())&&(n.autoCategory=r.first),e.mGM(r=e.lsd())&&(n.categoryAutocompleteTrigger=r.first)}},outputs:{produitAjoute:"produitAjoute",close:"close"},decls:109,vars:31,consts:[["autoUnite","matAutocomplete"],[1,"container_global"],["class","loading-overlay",4,"ngIf"],[1,"content_formulaire"],[1,"modal-body"],[1,"container_formulaire",3,"formGroup"],[1,"Title"],[1,"form_left_right"],[1,"formulaire"],[1,"information_cadre"],[1,"info_titre_input"],[1,"double_input2"],[1,"champ_input"],["autocomplete","off","type","text","placeholder","S\xe9lectionner vos boutiques","matInput","",1,"input_focus",2,"cursor","pointer",3,"click","formControl"],["for","boutiqueId",1,"label"],["class","boutique-selection-panel",4,"ngIf"],[1,"triple"],[1,"radio-group"],[1,"radio-option"],["type","radio","id","typePhysique","formControlName","typeProduit","value","PHYSIQUE",1,"radio-input"],["for","typePhysique",1,"radio-label"],[1,"radio-custom"],["type","radio","id","typeService","formControlName","typeProduit","value","SERVICE",1,"radio-input"],["for","typeService",1,"radio-label"],[1,"double_input_grid"],["autocomplete","off","formControlName","nom","type","text","required","","id","nom","name","nom","placeholder","Saisis le nom de produit",1,"input_focus"],["for","nom",1,"label"],["class","error-message",4,"ngIf"],[1,"champ_input_uni","champ_input","champ_input2"],["autocomplete","off","type","text","placeholder","Saisis l'unit\xe9 de mesure","matInput","",1,"input_focus",2,"cursor","pointer",3,"click","formControl","matAutocomplete"],["for","uniteId",1,"label"],[3,"optionSelected","opened","closed","displayWith"],[1,"select-option",3,"click"],[2,"display","flex","align-items","center","color","#0672E4"],[1,"ri-add-circle-fill",2,"font-size","20px"],[2,"margin-left","8px"],[3,"value",4,"ngFor","ngForOf"],[1,"arrow_bas",2,"position","absolute","right","5px","top","20px","cursor","pointer"],["class","ri-arrow-down-s-line","style","font-size: 20px; z-index: 999;",3,"click",4,"ngIf"],["class","ri-close-line","style","font-size: 20px; z-index: 999;",3,"click",4,"ngIf"],["autocomplete","off","formControlName","prixVente","type","number","required","","id","prixVente","name","prixVente","placeholder","Saisis le nom de magasin",1,"input_focus",3,"input"],["for","prixVente",1,"label"],["class","nombreDevise",4,"ngIf"],["autocomplete","off","formControlName","prixAchat","type","number","id","prixAchat","name","prixAchat","placeholder","Saisis le prix d'achat",1,"input_focus",3,"input"],["for","prixAchat",1,"label"],["class","error-message divError",4,"ngIf"],["formControlName","description","id","description","name","description","maxlength","150","placeholder","Saisis Une description pour ce produit",1,"input_focus2"],["for","description",1,"label","labelColor"],["class","information_cadre",4,"ngIf"],[1,"container_file"],[1,"header_file"],["alt","Aper\xe7u de l'image",1,"roudel",2,"max-width","200px",3,"src"],["class","clear-image-btn",3,"click",4,"ngIf"],["for","file",1,"footer_file"],[1,"ri-file-3-fill"],["type","file","accept","image/*","id","file","hidden","",3,"change"],[1,"information_cadre","information_cadre_save"],[1,"container_error_message"],[1,"info_titre_input","info_titre_input_btn"],[1,"btn_annuler"],[1,"btn_cancel",3,"click"],[1,"btn_ajouter"],[1,"btn_save",3,"click"],["class","modal-overlay",4,"ngIf"],["class","popup-overlay",4,"ngIf"],[1,"loading-overlay"],[1,"loading-content"],[1,"spinner"],[1,"boutique-selection-panel"],[1,"panel-header"],[1,"close-btn",3,"click"],[1,"panel-body"],[1,"boutique-item","select-all"],["type","checkbox",3,"change","checked"],["class","boutique-item",4,"ngFor","ngForOf"],[1,"panel-footer"],[1,"btn-confirm",3,"click"],[1,"boutique-item"],["type","checkbox",3,"ngModelChange","change","ngModel","ngModelOptions"],[1,"error-message"],[4,"ngIf"],[3,"value"],[1,"option-content"],[1,"ri-arrow-down-s-line",2,"font-size","20px","z-index","999",3,"click"],[1,"ri-close-line",2,"font-size","20px","z-index","999",3,"click"],[1,"nombreDevise"],[1,"error-message","divError"],[1,"champ_input_inventaire"],[1,"switch"],[1,"slider","round"],[4,"ngFor","ngForOf"],["class"," double_input_grid_true",4,"ngIf"],[1,"double_input_grid_true"],[1,"champ_input","champ_input2"],["type","number","required","","placeholder","Saisis la quantit\xe9",1,"input_focus",3,"ngModelChange","ngModel","ngModelOptions"],["for","quantite",1,"label","labelColor"],["type","number",1,"input_focus",3,"ngModelChange","ngModel","ngModelOptions","placeholder"],["for","seuilAlert",1,"label","labelColor"],["type","date","formControlName","datePreemption","id","datePreemption","name","datePreemption",1,"input_focus"],["for","datePreemption",1,"label","labelColor"],[1,"clear-image-btn",3,"click"],[1,"ri-delete-bin-5-line"],[1,"modal-overlay"],[1,"modal-content",3,"ngClass"],[1,"popup-header"],[1,"popup-img"],["alt","Icone",1,"popup-icon2",3,"src"],[3,"click"],[1,"popup-overlay"],[1,"popup-content"],[1,"popup-headerBoutique"],[3,"formGroup"],[1,"popup-body"],[1,"champ_grid"],["type","text","formControlName","nomBoutique","placeholder","Saisis le nom de boutique",1,"input_focus",2,"min-width","150px"],[1,"label"],["type","email","formControlName","emailBoutique","placeholder","Saisis l'email",1,"input_focus",2,"min-width","150px"],["type","number","formControlName","telephoneBoutique","placeholder","00 00 00 00",1,"input_focus",2,"min-width","150px"],["type","text","formControlName","adresseBoutique","placeholder","Saisis l'adresse",1,"input_focus",2,"min-width","150px"],["class","errorAPI",4,"ngIf"],[1,"popup-footer"],[1,"btn-cancel",3,"click"],[1,"btn-submit",3,"click","disabled"],[1,"error"],[1,"errorAPI"],["alt","Message API",3,"src"],[1,"popup-content",2,"max-width","350px"],[1,"champ_input",2,"margin-top","15px"],["autocomplete","off","formControlName","categoryName","type","text","required","","id","categoryName","name","categoryName","placeholder","Saisis le nom de cat\xe9gorie",1,"input_focus","input_focus_cree_cate"],["for","categoryName",1,"label","labelColor"],["class","error-message-category",4,"ngIf"],[1,"error-message-category"],["autocomplete","off","formControlName","unityName","type","text","required","","id","unityName","name","unityName","placeholder","Saisis le nom de unit\xe9",1,"input_focus","input_focus_cree_cate"],["for","unityName",1,"label","labelColor"]],template:function(o,n){if(1&o){const r=e.RV6();e.j41(0,"div",1),e.DNE(1,U,5,0,"div",2),e.j41(2,"div",3)(3,"div",4)(4,"form",5)(5,"div",6)(6,"h3"),e.EFF(7,"Ajouter des produits"),e.k0s()(),e.j41(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"h4"),e.EFF(13,"Boutique"),e.k0s(),e.j41(14,"div",11)(15,"div",12)(16,"input",13),e.bIt("click",function(){return e.eBV(r),e.Njj(n.toggleBoutiqueSelectionPanel())}),e.k0s(),e.j41(17,"label",14),e.EFF(18,"S\xe9lectionner vos boutiques"),e.k0s(),e.DNE(19,Y,15,2,"div",15),e.k0s()()()(),e.j41(20,"div",9)(21,"div",10)(22,"h4"),e.EFF(23,"Information des produits"),e.k0s(),e.j41(24,"div",16)(25,"div",17)(26,"div",18),e.nrm(27,"input",19),e.j41(28,"label",20),e.nrm(29,"span",21),e.EFF(30," Produit "),e.k0s()(),e.j41(31,"div",18),e.nrm(32,"input",22),e.j41(33,"label",23),e.nrm(34,"span",21),e.EFF(35," Service "),e.k0s()()()(),e.j41(36,"div",24)(37,"div",12),e.nrm(38,"input",25),e.j41(39,"label",26),e.EFF(40,"Nom produit"),e.k0s(),e.DNE(41,J,3,2,"div",27),e.k0s(),e.j41(42,"div",11)(43,"div",28)(44,"input",29),e.bIt("click",function(d){return e.eBV(r),e.Njj(n.toggleUniteDropdown(d))}),e.k0s(),e.j41(45,"label",30),e.EFF(46,"Unit\xe9 de mesure"),e.k0s(),e.j41(47,"mat-autocomplete",31,0),e.bIt("optionSelected",function(d){return e.eBV(r),e.Njj(n.onUniteSelected(d))})("opened",function(){return e.eBV(r),e.Njj(n.isUniteDropdownOpen=!0)})("closed",function(){return e.eBV(r),e.Njj(n.isUniteDropdownOpen=!1)}),e.j41(49,"mat-option",32),e.bIt("click",function(){return e.eBV(r),e.Njj(n.onCreateUniteClick())}),e.j41(50,"div",33),e.nrm(51,"i",34),e.j41(52,"span",35),e.EFF(53,"Cr\xe9er une unit\xe9"),e.k0s()()(),e.DNE(54,K,3,2,"mat-option",36),e.nI1(55,"async"),e.k0s()(),e.j41(56,"div",37),e.DNE(57,H,1,0,"i",38)(58,Z,1,0,"i",39),e.k0s()()(),e.j41(59,"div",24)(60,"div",12)(61,"input",40),e.bIt("input",function(){return e.eBV(r),e.Njj(n.formatPrixVente())}),e.k0s(),e.j41(62,"label",41),e.EFF(63,"Prix de vente"),e.k0s(),e.DNE(64,Q,3,1,"div",42)(65,ee,2,0,"div",27),e.k0s(),e.j41(66,"div",12)(67,"input",43),e.bIt("input",function(){return e.eBV(r),e.Njj(n.formatCoutProduit())}),e.k0s(),e.j41(68,"label",44),e.EFF(69,"Co\xfbt du produit (Facultatif)"),e.k0s(),e.DNE(70,te,3,1,"div",42)(71,oe,2,1,"div",45),e.k0s()()()(),e.j41(72,"div",9)(73,"div",10)(74,"h4"),e.EFF(75,"Identit\xe9 de produit"),e.k0s(),e.j41(76,"div",12),e.nrm(77,"textarea",46),e.j41(78,"label",47),e.EFF(79,"Description (Facultatif)"),e.k0s()()()(),e.DNE(80,ae,11,4,"div",48),e.j41(81,"div",9)(82,"div",10)(83,"h4"),e.EFF(84,"Ajouter une image"),e.k0s(),e.j41(85,"div",49)(86,"div",50),e.nrm(87,"img",51),e.k0s(),e.DNE(88,le,2,0,"button",52),e.j41(89,"div")(90,"label",53),e.nrm(91,"i",54),e.j41(92,"p"),e.EFF(93,"Choisir un fichier"),e.k0s()(),e.j41(94,"input",55),e.bIt("change",function(d){return e.eBV(r),e.Njj(n.onFileSelected(d))}),e.k0s()()()()(),e.j41(95,"div",56)(96,"div",57),e.DNE(97,ce,2,1,"div",27),e.k0s(),e.j41(98,"div",58)(99,"div",59)(100,"button",60),e.bIt("click",function(){return e.eBV(r),e.Njj(n.goToProduit())}),e.EFF(101,"Annuler"),e.k0s()(),e.j41(102,"div",61)(103,"button",62),e.bIt("click",function(){return e.eBV(r),e.Njj(n.onSubmit())}),e.EFF(104,"Sauvegarder"),e.k0s()()()(),e.DNE(105,pe,11,6,"div",63),e.k0s()()()()()(),e.DNE(106,fe,36,12,"div",64)(107,ve,21,7,"div",64)(108,ke,21,7,"div",64)}if(2&o){let r;const s=e.sdS(48);e.R7$(),e.Y8G("ngIf",n.isLoading),e.R7$(3),e.Y8G("formGroup",n.ajouteProduitForm),e.R7$(11),e.AVh("invalid-field",n.showBoutiqueError),e.R7$(),e.Y8G("formControl",n.controlBoutique),e.R7$(3),e.Y8G("ngIf",n.showBoutiqueSelectionPanel),e.R7$(18),e.AVh("invalid-field",n.f.nom.invalid&&(n.f.nom.touched||n.formSubmitted)),e.R7$(4),e.Y8G("ngIf",n.f.nom.touched&&n.f.nom.invalid),e.R7$(3),e.Y8G("formControl",n.uniteControl)("matAutocomplete",s),e.R7$(3),e.Y8G("displayWith",n.displayFnUnite),e.R7$(7),e.Y8G("ngForOf",e.bMT(55,29,n.filteredNomUnite)),e.R7$(3),e.Y8G("ngIf",!n.isUniteDropdownOpen),e.R7$(),e.Y8G("ngIf",n.isUniteDropdownOpen),e.R7$(2),e.AVh("invalid-field",n.f.prixVente.invalid&&(n.f.prixVente.touched||n.formSubmitted)),e.R7$(4),e.Y8G("ngIf",n.formattedPrixVente),e.R7$(),e.Y8G("ngIf",n.f.prixVente.touched&&n.f.prixVente.invalid),e.R7$(5),e.Y8G("ngIf",n.formattedCoutProduit),e.R7$(),e.Y8G("ngIf",n.f.prixAchat.touched&&n.f.prixAchat.invalid),e.R7$(9),e.Y8G("ngIf","PHYSIQUE"===(null==(r=n.ajouteProduitForm.get("typeProduit"))?null:r.value)),e.R7$(7),e.Y8G("src",n.newPhotoUrl||n.urllink,e.B4B),e.R7$(),e.Y8G("ngIf",n.newPhotoUrl&&n.newPhotoUrl!==n.urllink),e.R7$(9),e.Y8G("ngIf",n.errorMessage),e.R7$(8),e.Y8G("ngIf",n.showPopup),e.R7$(),e.Y8G("ngIf",n.showPopupBoutique),e.R7$(),e.Y8G("ngIf",n.showPopupCategory),e.R7$(),e.Y8G("ngIf",n.showPopupUnit)}},dependencies:[a.YN,a.qT,a.me,a.Q0,a.Zm,a.Fm,a.BC,a.cb,a.YS,a.tU,a.vS,m.MD,m.YU,m.Sq,m.bT,m.Jj,a.X1,a.l_,a.j4,a.JD,P.jL,P.$3,y.wT,P.pN,c.c,u.m_],styles:['@charset "UTF-8";.content_formulaire[_ngcontent-%COMP%]{display:flex}.modal-body[_ngcontent-%COMP%]{margin-right:30px}.champ_input[_ngcontent-%COMP%]{position:relative;margin-bottom:10px}.champ_input_Categorie[_ngcontent-%COMP%]{margin-bottom:15px!important}.formulaire[_ngcontent-%COMP%]{position:relative}.Title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;margin:72px 20px 15px}.input_focus[_ngcontent-%COMP%]{width:100%;height:49px;outline:none;border-bottom:1px solid rgb(53,50,50);border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:12px;background:none;color:#695c5c}.double_input_grid_true[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.champ_input[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:4px;pointer-events:none;color:#000}.input_focus[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.input_focus[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:0;left:0;transition:all .3s ease-in-out;background:none;font-size:11px;padding:0}.input_focus[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:12px;transition:all .2s ease-in-out}.input_focus2[_ngcontent-%COMP%]{width:100%;outline:none;border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:12px;padding-left:10px;background:none;color:#777474;border-radius:5px;padding-top:10px;border-bottom:1px solid rgb(53,50,50)}.input_focus2[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.champ_input2[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:0;pointer-events:none;color:#423838}.champ_input[_ngcontent-%COMP%]   .labelCategory[_ngcontent-%COMP%]{color:#423838;left:0;font-size:14px}.input_focus2[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus2[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:0;left:0;transition:all .3s ease-in-out;background:none;font-size:11px;padding:0}.input_focus2[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus2[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:15px;transition:all .2s ease-in-out}.info_titre_input[_ngcontent-%COMP%]{padding:10px 20px}.info_titre_input[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:13px;margin-bottom:10px;letter-spacing:.6px}.information_cadre[_ngcontent-%COMP%]{width:100%;height:auto;background-color:#fff;box-shadow:2px 2px 30px #0000001c;border-radius:5px;margin-bottom:10px;margin-left:10px}.information_cadre_save[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.input_focus_magasin[_ngcontent-%COMP%]{width:100%}.input_focus_petit[_ngcontent-%COMP%]{width:50%}.double_input[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.double_input_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}.double_inputh[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;position:relative;top:10px}.champ_input2[_ngcontent-%COMP%]{display:inline-block;width:100%;box-sizing:border-box;vertical-align:top}.champ_input_inventaire[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}.champ_input_inventaire[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:24px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:24px}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#0672e4}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(26px)}.container_file[_ngcontent-%COMP%]{width:150px;border-radius:10px;box-shadow:4px 4px 30px #0003;display:flex;flex-direction:column;align-items:center;justify-content:space-between;padding:10px;gap:5px;background-color:#006eff0a;margin-bottom:10px;margin-top:20px}.header_file[_ngcontent-%COMP%]{height:140px;width:140px;border:1px dashed rgba(6,113,228,.6156862745);border-radius:10px;flex-direction:column;overflow:hidden;display:flex;align-items:center;justify-content:center;box-shadow:#959da533 0 8px 24px}.header_file[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:cover;transition:transform .2s}.header_file[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:100px}.header_file[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;color:#000}.footer_file[_ngcontent-%COMP%]{background-color:#006eff13;width:140px;height:35px;padding:5px 8px;border-radius:5px;cursor:pointer;display:flex;align-items:center;color:#000;border:none;margin-top:3px}.footer_file[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0!important;font-size:10px}.footer_file[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;margin-right:7px}#file[_ngcontent-%COMP%]{display:none}.header_file[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.info_titre_input_btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:end;gap:20px}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]{padding:8px 30px;border:none;border-radius:5px;background-color:red;color:#fff}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]:hover{background-color:#d80101;transition:all ease-in .5s}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]{padding:8px 30px;border:none;border-radius:5px;background-color:#0672e4;color:#fff}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]:hover{background-color:#0863c5;transition:all .5s}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}.btn_add_category2[_ngcontent-%COMP%]{border:none;padding:2px 10px;border-radius:4px;background-color:#0672e4;color:#fff;cursor:pointer}.btn_add_category2[_ngcontent-%COMP%]:hover{background-color:#0863c5;transition:all ease .5s}.btn_add_categoryDiv2[_ngcontent-%COMP%]{margin:10px 0;justify-content:center;position:absolute;right:10px;top:10px}.double_input2[_ngcontent-%COMP%]{position:relative}.ajouter_cadre_cree_c_u[_ngcontent-%COMP%]{width:250px;height:230px;background-color:#fff;margin-top:40px;border-radius:5px;box-shadow:2px 2px 30px #0000001c}.container_error_message[_ngcontent-%COMP%]{margin-left:20px}.error-message[_ngcontent-%COMP%]{font-size:10px;color:red;font-weight:700}.error[_ngcontent-%COMP%]{color:red}.input_focus_cree_cate[_ngcontent-%COMP%]{min-width:auto}.btn-c-s[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px}.btn_s_category[_ngcontent-%COMP%]{width:100%;height:35px;background-color:#0671e4c8;color:#fff;border:none;border-radius:5px;letter-spacing:.6px;padding:0 25px}.btn_c_category[_ngcontent-%COMP%]{width:100%;height:35px;background-color:#ff0000ce;color:#fff;border:none;border-radius:5px;letter-spacing:.6px;padding:0 25px}.btn_s_category[_ngcontent-%COMP%]:hover{background-color:#0672e4;transition:all ease .5s}.btn_c_category[_ngcontent-%COMP%]:hover{background-color:red;transition:all ease .5s}.error-message-category[_ngcontent-%COMP%]{font-size:10px;color:red;font-weight:700;margin-top:10px;margin-bottom:10px}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px}.errorAPI[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px;margin-top:-9px}.errorAPI[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:12px;height:12px}.errorAPI[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;padding-left:5px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:10px;text-align:center;width:90%;max-width:400px;box-shadow:0 5px 15px #0000004d;animation:fadeInDown .3s ease;position:relative}.popup-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.popup-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;margin-bottom:10px}.popup-icon[_ngcontent-%COMP%]{width:100%;height:100%;margin-bottom:10px}.modal-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5em;color:#333}.modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em;color:#555;margin:20px 0}.modal-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#0672e4;color:#fff;border:none;padding:10px 20px;font-size:1em;border-radius:5px;cursor:pointer;transition:background .3s ease}.modal-content.error[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#e53935}.modal-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0863c5}.modal-content.error[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#d32f2f}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;color:#fff;font-size:18px;z-index:1000}.loading-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid white;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}.champs_code_bare_double[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 150px}.clear-image-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:red;font-size:18px;cursor:pointer;position:relative;left:19%;transform:translate(60px,-139px);margin:-18px}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px}.popup-headerBoutique[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.popup-headerBoutique[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer}.popup-footer[_ngcontent-%COMP%]{margin-top:20px;text-align:right}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{padding:8px 20px;margin-left:10px;border:none;border-radius:4px;cursor:pointer!important}.btn-cancel[_ngcontent-%COMP%]{background-color:#ff0000ce;padding:6px 25px;color:#fff}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:red;transition:all .5s}.btn-submit[_ngcontent-%COMP%]{background-color:#0671e4c8;padding:6px 25px;color:#fff;cursor:pointer}.btn-submit[_ngcontent-%COMP%]:hover{background-color:#0672e4;transition:all .5s}.champ_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.boutique-selection-panel[_ngcontent-%COMP%]{position:absolute;z-index:1000;background:#fff;border:1px solid #ddd;border-radius:4px;box-shadow:0 2px 4px #0003;width:100%;max-width:400px;margin-top:8px}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:16px}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:20px;cursor:pointer}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;padding:12px}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]   .boutique-item[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid #eee}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]   .boutique-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;width:100%}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]   .boutique-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:8px}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%]{padding:12px;text-align:right;border-top:1px solid #eee}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{background-color:#0672e4;color:#fff;border:none;padding:8px 16px;border-radius:4px;cursor:pointer}.boutique-selection-panel[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:hover{background-color:#055cb3}.two_input[_ngcontent-%COMP%]{position:relative}.nombreDevise[_ngcontent-%COMP%]{position:absolute;bottom:-20px;right:10px;transition:opacity .3s ease}.nombreDevise[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px;margin:0;font-family:monospace}.option-with-icon[_ngcontent-%COMP%]   .option-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.option-with-icon[_ngcontent-%COMP%]   .option-icon[_ngcontent-%COMP%]{font-size:18px;height:18px;width:18px}.option_icon_div[_ngcontent-%COMP%]{position:absolute;right:0;top:16px}.container_name_icon[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}.option_icon_div[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:20px}.option-icon[_ngcontent-%COMP%]{color:#666;font-size:18px}.mini-spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:3px solid #f3f3f3;border-radius:50%;border-top:3px solid #3498db;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.radio-group[_ngcontent-%COMP%]{display:flex;gap:20px;margin-top:10px}.radio-option[_ngcontent-%COMP%]{display:flex;align-items:center}.radio-input[_ngcontent-%COMP%]{display:none}.radio-input[_ngcontent-%COMP%]:checked + .radio-label[_ngcontent-%COMP%]   .radio-custom[_ngcontent-%COMP%]{background-color:#0672e4;border-color:#0672e4}.radio-input[_ngcontent-%COMP%]:checked + .radio-label[_ngcontent-%COMP%]   .radio-custom[_ngcontent-%COMP%]:after{content:"";display:block;width:6px;height:6px;background:#fff;border-radius:50%;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.radio-label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;font-size:14px;color:#333;position:relative;padding-left:28px}.radio-custom[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-50%);width:18px;height:18px;border:2px solid #ccc;border-radius:50%;transition:all .3s}.triple[_ngcontent-%COMP%]{margin-top:20px}.ferme_mat_option[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:22px}.mat-form-field-suffix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:none!important}.mat-form-field-appearance-fill[_ngcontent-%COMP%]   .mat-form-field-flex[_ngcontent-%COMP%]{background-color:transparent!important;padding:0!important}.champ_input_categorie[_ngcontent-%COMP%], .champ_input_unite[_ngcontent-%COMP%]{pointer-events:none}.champ_input_categorie[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .champ_input_unite[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{pointer-events:auto}.mat-autocomplete-panel[_ngcontent-%COMP%]{pointer-events:auto!important}.arrow_bas[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{pointer-events:auto;z-index:1000;position:relative}']})}}return i})();var ye=g(84412),Ie=g(84572),D=g(92120),V=g(47746);const Te=()=>({standalone:!0});function we(i,l){1&i&&(e.j41(0,"div",50)(1,"div",51),e.nrm(2,"div",52),e.j41(3,"p"),e.EFF(4,"Creation en cours..."),e.k0s()()())}function Ae(i,l){1&i&&(e.j41(0,"small"),e.EFF(1,"Champ requis."),e.k0s())}function Se(i,l){1&i&&(e.j41(0,"small"),e.EFF(1,"Au moins 2 caract\xe8res."),e.k0s())}function Re(i,l){if(1&i&&(e.j41(0,"div",53),e.DNE(1,Ae,2,0,"small",54)(2,Se,2,0,"small",54),e.k0s()),2&i){let t,o;const n=e.XpG();e.R7$(),e.Y8G("ngIf",null==(t=n.clientForm.get("nomComplet"))||null==t.errors?null:t.errors.required),e.R7$(),e.Y8G("ngIf",null==(o=n.clientForm.get("nomComplet"))||null==o.errors?null:o.errors.minlength)}}function Ne(i,l){1&i&&(e.j41(0,"small"),e.EFF(1,"Format invalide."),e.k0s())}function Ge(i,l){if(1&i&&(e.j41(0,"div",53),e.DNE(1,Ne,2,0,"small",54),e.k0s()),2&i){let t;const o=e.XpG();e.R7$(),e.Y8G("ngIf",null==(t=o.clientForm.get("email"))||null==t.errors?null:t.errors.email)}}function $e(i,l){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const t=l.$implicit,o=e.XpG();e.Y8G("value",t),e.R7$(),e.Lme(" ",t," (",o.paysIndicatifs[t].indicatif,") ")}}function Be(i,l){1&i&&(e.j41(0,"div",53)(1,"small"),e.EFF(2,"Ce champ est requis"),e.k0s()())}function De(i,l){if(1&i&&(e.j41(0,"div",53)(1,"small"),e.EFF(2),e.k0s()()),2&i){const t=l.ngIf,o=e.XpG();e.R7$(2),e.Lme(" Le num\xe9ro doit contenir ",o.paysIndicatifs[t].longueur," chiffres apr\xe8s l\u2019indicatif ",o.paysIndicatifs[t].indicatif.trim(),". ")}}function Ve(i,l){1&i&&(e.j41(0,"div",53)(1,"small"),e.EFF(2,"Le t\xe9l\xe9phone est requis."),e.k0s()())}function Le(i,l){if(1&i&&(e.j41(0,"mat-option",55)(1,"div",66),e.EFF(2),e.k0s()()),2&i){const t=l.$implicit;e.Y8G("value",t),e.R7$(2),e.SpI(" ",t.nom," ")}}function qe(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",56),e.nrm(3,"input",57),e.j41(4,"label",58),e.EFF(5,"Mon entreprise"),e.k0s(),e.j41(6,"mat-autocomplete",59,0),e.bIt("optionSelected",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onEntrepriseSelected(n))}),e.j41(8,"mat-option",60),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.openPopup())}),e.j41(9,"div",61),e.nrm(10,"i",62),e.j41(11,"span",63),e.EFF(12,"Cr\xe9er une entreprise"),e.k0s()()(),e.DNE(13,Le,3,2,"mat-option",26),e.nI1(14,"async"),e.k0s(),e.j41(15,"div",64),e.nrm(16,"i",65),e.k0s()()()()}if(2&i){const t=e.sdS(7),o=e.XpG();e.R7$(3),e.Y8G("formControl",o.control)("matAutocomplete",t),e.R7$(3),e.Y8G("displayWith",o.displayFnEntreprise),e.R7$(7),e.Y8G("ngForOf",e.bMT(14,4,o.filteredOptions))}}function Ue(i,l){if(1&i&&(e.j41(0,"div",67),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.errorMessage)}}function ze(i,l){if(1&i&&(e.j41(0,"div",68),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.successMessage)}}function Ye(i,l){1&i&&(e.j41(0,"div",69)(1,"p"),e.EFF(2,"Vous devez s\xe9lectionner ou cr\xe9er une entreprise"),e.k0s()())}function Xe(i,l){1&i&&(e.j41(0,"div",93),e.EFF(1," Ce champ est requis "),e.k0s())}function We(i,l){if(1&i&&(e.j41(0,"div",94),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.errorMessageApi," ")}}function Je(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",70)(1,"div",71)(2,"div",72)(3,"h4"),e.EFF(4,"Ajouter une entreprise"),e.k0s(),e.j41(5,"button",73),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopup())}),e.EFF(6,"\xd7"),e.k0s()(),e.j41(7,"form",74)(8,"div",75)(9,"div",76)(10,"div",56),e.nrm(11,"input",77),e.j41(12,"label",78),e.EFF(13,"Nom entreprise "),e.j41(14,"span",79),e.EFF(15,"*"),e.k0s()(),e.DNE(16,Xe,2,0,"div",80),e.k0s(),e.j41(17,"div",56),e.nrm(18,"input",81),e.j41(19,"label",78),e.EFF(20,"Email"),e.k0s()()(),e.j41(21,"div",76)(22,"div",56),e.nrm(23,"input",82),e.j41(24,"label",78),e.EFF(25,"Adresse"),e.k0s()(),e.j41(26,"div",56),e.nrm(27,"input",83),e.j41(28,"label",78),e.EFF(29,"Ville"),e.k0s()()(),e.j41(30,"div",22)(31,"div",23)(32,"select",24),e.bIt("change",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onEntreprisePaysChange(n))}),e.j41(33,"option",25),e.EFF(34,"Pays"),e.k0s(),e.j41(35,"option",84),e.EFF(36,"Mali"),e.k0s(),e.j41(37,"option",85),e.EFF(38,"S\xe9n\xe9gal"),e.k0s(),e.j41(39,"option",86),e.EFF(40,"C\xf4te d'Ivoire"),e.k0s()(),e.j41(41,"label",27),e.EFF(42,"Pays"),e.k0s()(),e.j41(43,"div",28)(44,"input",87),e.bIt("input",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.formatEntreprisePhoneNumber())}),e.k0s(),e.j41(45,"label",30),e.EFF(46,"T\xe9l\xe9phone"),e.k0s()(),e.j41(47,"div",31),e.nrm(48,"input",88),e.j41(49,"label",33),e.EFF(50,"Secteur"),e.k0s()()()(),e.j41(51,"div",40),e.DNE(52,We,2,1,"div",89),e.k0s(),e.j41(53,"div",90)(54,"button",91),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopup())}),e.EFF(55,"Annuler"),e.k0s(),e.j41(56,"button",92),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.ajouterEntreprise())}),e.EFF(57," Ajouter "),e.k0s()()()()()}if(2&i){let t;const o=e.XpG();e.R7$(7),e.Y8G("formGroup",o.entrepriseForm),e.R7$(9),e.Y8G("ngIf",(null==(t=o.entrepriseForm.get("nom"))?null:t.invalid)&&(null==(t=o.entrepriseForm.get("nom"))?null:t.touched)),e.R7$(36),e.Y8G("ngIf",o.errorMessageApi),e.R7$(4),e.xc7("background-color",o.entrepriseForm.valid?"#0672E4":"#0671e434")("color",o.entrepriseForm.valid?"#ffffff":"#00000073")("cursor",o.entrepriseForm.valid?"pointer":"no-drop"),e.Y8G("disabled",o.entrepriseForm.invalid)}}function Ke(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",68),e.EFF(1),e.j41(2,"button",95),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetForm())}),e.EFF(3,"Ajouter un autre"),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.successMessage," ")}}let He=(()=>{class i{constructor(t,o,n,r,s){this.router=t,this.fb=o,this.entrepriseService=n,this.clientService=r,this.usersService=s,this.clientAjoute=new e.bkB,this.close=new e.bkB,this.errorMessage="",this.errorMessageApi="",this.successMessage="",this.isEntrepriseSelected=!1,this.showPopup=!1,this.urllink="assets/img/appareil.jpg",this.newPhotoUrl=null,this.selectedFile=null,this.imageFile=null,this.control=new a.MJ,this.filteredOptions=(0,B.of)([]),this.loading=!1,this.optionsEntreprise$=new ye.t([]),this.entrepriseRequiredError=!1,this.isLoading=!1,this.indicatif="",this.maxPhoneLength=0,this.entrepriseIndicatif="",this.entrepriseMaxPhoneLength=0,this.paysIndicatifs={Mali:{indicatif:"+223",longueur:8},S\u00e9n\u00e9gal:{indicatif:"+221",longueur:9},"C\xf4te d'Ivoire":{indicatif:"+225",longueur:10},"Burkina Faso":{indicatif:"+226",longueur:8},Niger:{indicatif:"+227",longueur:8},France:{indicatif:"+33",longueur:9},Belgique:{indicatif:"+32",longueur:9},Suisse:{indicatif:"+41",longueur:9},Canada:{indicatif:"+1",longueur:10},"\xc9tats-Unis":{indicatif:"+1",longueur:10},Maroc:{indicatif:"+212",longueur:9},Alg\u00e9rie:{indicatif:"+213",longueur:9},Tunisie:{indicatif:"+216",longueur:8},Togo:{indicatif:"+228",longueur:8},B\u00e9nin:{indicatif:"+229",longueur:8},Guin\u00e9e:{indicatif:"+224",longueur:9},Tchad:{indicatif:"+235",longueur:8},Cameroun:{indicatif:"+237",longueur:9},RDC:{indicatif:"+243",longueur:9},Gabon:{indicatif:"+241",longueur:9},"Afrique du Sud":{indicatif:"+27",longueur:9},Rwanda:{indicatif:"+250",longueur:9},Kenya:{indicatif:"+254",longueur:9},Nig\u00e9ria:{indicatif:"+234",longueur:10},Ghana:{indicatif:"+233",longueur:9},\u00c9thiopie:{indicatif:"+251",longueur:9},\u00c9gypte:{indicatif:"+20",longueur:10},Inde:{indicatif:"+91",longueur:10},Chine:{indicatif:"+86",longueur:11},Mexique:{indicatif:"+52",longueur:10},Allemagne:{indicatif:"+49",longueur:10},Espagne:{indicatif:"+34",longueur:9},Italie:{indicatif:"+39",longueur:10},"Royaume-Uni":{indicatif:"+44",longueur:10},"Pays-Bas":{indicatif:"+31",longueur:9},Portugal:{indicatif:"+351",longueur:9}},this.paysKeys=Object.keys(this.paysIndicatifs)}onPaysChange(t){const n=this.paysIndicatifs[t.target.value];n&&(this.indicatif=`${n.indicatif} `,this.maxPhoneLength=this.indicatif.length+n.longueur,this.clientForm.get("telephone")?.value.startsWith(this.indicatif)||this.clientForm.get("telephone")?.setValue(this.indicatif),this.updatePhoneValidator(n.longueur))}updatePhoneValidator(t){const o=new RegExp(`^\\${this.indicatif}\\d{${t}}$`);this.clientForm.controls.telephone.setValidators([a.k0.required,a.k0.pattern(o)]),this.clientForm.controls.telephone.updateValueAndValidity()}formatPhoneNumber(){let t=this.clientForm.get("telephone")?.value;if(!t.startsWith(this.indicatif))return void this.clientForm.get("telephone")?.setValue(this.indicatif);const o=t.replace(this.indicatif,"").replace(/\D/g,""),n=this.indicatif+o;this.clientForm.get("telephone")?.setValue(n.slice(0,this.indicatif.length+this.maxPhoneLength))}testImageCompression(t){var o=this;return(0,C.A)(function*(){if(!t)return void console.log("Aucun fichier s\xe9lectionn\xe9.");console.log("Taille originale:",t.size/1024,"Ko");const n={maxSizeMB:1,maxWidthOrHeight:1e3,useWebWorker:!0};try{const r=yield(0,E.A)(t,n);if(console.log("Taille apr\xe8s compression:",r.size/1024,"Ko"),"image/png"!==r.type&&"image/jpeg"!==r.type)return console.error("Le fichier compress\xe9 n'est pas un format support\xe9 (PNG ou JPEG)."),void(o.errorMessage="Erreur de compression : Le format de l'image n'est pas valide.");const s=new FileReader;s.onload=d=>{o.newPhotoUrl=d.target?.result,console.log("Image compress\xe9e pr\xeate \xe0 \xeatre affich\xe9e !")},s.readAsDataURL(r)}catch(r){console.error("Erreur lors de la compression:",r)}})()}onFileSelected(t){const o=t.target;if(o.files&&o.files.length>0){const n=o.files[0];if(!["image/jpeg","image/png","image/jpg"].includes(n.type))return void(this.errorMessage="Le fichier doit \xeatre une image (JPG, PNG)");this.selectedFile=n,this.imageFile=n,this.testImageCompression(n);const s=new FileReader;s.onload=d=>{this.newPhotoUrl=d.target?.result},s.readAsDataURL(this.selectedFile)}}goToStock(){this.router.navigate(["/clients"])}ngOnInit(){this.getListEntreprise(),this.initEntreprise(),this.getClientForm(),this.loadEntreprises()}getClientForm(){this.clientForm=this.fb.group({nomComplet:["",[a.k0.required,a.k0.minLength(2)]],email:["",[a.k0.email]],telephone:["",a.k0.required],adresse:[""],poste:[""],pays:[""],ville:[""]})}onEntreprisePaysChange(t){const n=this.paysIndicatifs[t.target.value];n&&(this.entrepriseIndicatif=`${n.indicatif} `,this.entrepriseMaxPhoneLength=this.entrepriseIndicatif.length+n.longueur,this.entrepriseForm.get("telephone")?.value.startsWith(this.entrepriseIndicatif)||this.entrepriseForm.get("telephone")?.setValue(this.entrepriseIndicatif),this.updateEntreprisePhoneValidator(n.longueur))}updateEntreprisePhoneValidator(t){this.entrepriseForm.controls.telephone.setValidators([a.k0.pattern(`^\\${this.entrepriseIndicatif}\\d{${t}}$`)]),this.entrepriseForm.controls.telephone.updateValueAndValidity()}formatEntreprisePhoneNumber(){let t=this.entrepriseForm.get("telephone")?.value;if(!t.startsWith(this.entrepriseIndicatif))return void this.entrepriseForm.get("telephone")?.setValue(this.entrepriseIndicatif);const o=t.replace(this.entrepriseIndicatif,"").replace(/\D/g,""),n=this.entrepriseIndicatif+o;this.entrepriseForm.get("telephone")?.setValue(n.slice(0,this.entrepriseIndicatif.length+this.entrepriseMaxPhoneLength))}loadEntreprises(){localStorage.getItem("accessToken")&&this.entrepriseService.getListEntreprise().subscribe(o=>{this.optionsEntreprise$.next(o),this.setupAutocomplete()},o=>{console.error("Erreur lors de la r\xe9cup\xe9ration des entreprises :",o)})}setupAutocomplete(){this.filteredOptions=(0,Ie.z)([this.control.valueChanges.pipe((0,_.Z)(""),(0,f.T)(t=>"string"==typeof t?t:t?.nom)),this.optionsEntreprise$]).pipe((0,f.T)(([t,o])=>t?this._filter(t,o):o))}getListEntreprise(){this.usersService.getValidAccessToken().pipe((0,w.n)(t=>t?this.entrepriseService.getListEntreprise():(console.error("Aucun token valide trouv\xe9 !"),(0,T.$)(()=>new Error("Aucun token trouv\xe9"))))).subscribe(t=>{console.log("Entreprises re\xe7ues depuis l'API :",t),this.optionsEntreprise$.next(t),this.filteredOptions=this.control.valueChanges.pipe((0,_.Z)(""),(0,f.T)(o=>o?"string"==typeof o?o:o.nom:""),(0,f.T)(o=>o?this._filter(o,this.optionsEntreprise$.value):this.optionsEntreprise$.value.slice()))},t=>{console.error("Erreur lors de la r\xe9cup\xe9ration des entreprises :",t)})}_filter(t,o){const n=t.toLowerCase();return o.filter(r=>r.nom.toLowerCase().includes(n))}displayFnEntreprise(t){return t?t.nom:""}onEntrepriseSelected(t){}resetForm(){this.clientForm.reset({pays:""}),this.control.reset(),this.isEntrepriseSelected=!1,this.errorMessage="",this.successMessage="",this.entrepriseRequiredError=!1}openPopup(){this.showPopup=!0}closePopup(){this.showPopup=!1}initEntreprise(){this.entrepriseForm=this.fb.group({nom:["",a.k0.required],pays:[""],email:[""],telephone:[""],adresse:[""],siege:[""],secteur:[""]})}ajouterEntreprise(){this.entrepriseForm.invalid||this.entrepriseService.addEntreprise({nom:this.entrepriseForm.value.nom,pays:this.entrepriseForm.value.pays,email:this.entrepriseForm.value.email,telephone:this.entrepriseForm.value.telephone,adresse:this.entrepriseForm.value.adresse,siege:this.entrepriseForm.value.siege,secteur:this.entrepriseForm.value.secteur,logo:this.entrepriseForm.value.logo,nif:this.entrepriseForm.value.nif,nina:this.entrepriseForm.value.nina,banque:this.entrepriseForm.value.banque,rccm:this.entrepriseForm.value.rccm,siteWeb:this.entrepriseForm.value.siteWeb,signataire:this.entrepriseForm.value.signataire,signataireNom:this.entrepriseForm.value.signataireNom,prefixe:this.entrepriseForm.value.prefixe,suffixe:this.entrepriseForm.value.suffixe,tauxTva:this.entrepriseForm.value.tauxTva,signaturNum:this.entrepriseForm.value.signaturNum,cachetNum:this.entrepriseForm.value.cachetNum}).subscribe({next:o=>{this.optionsEntreprise$.next([o,...this.optionsEntreprise$.value]),this.control.setValue(o),this.closePopup(),this.entrepriseForm.reset()},error:o=>{this.errorMessageApi=o.message||"Erreur lors de la cr\xe9ation"}})}ajouterClient(){if(this.errorMessage="",this.successMessage="",this.entrepriseRequiredError=!1,this.isEntrepriseSelected){const o=this.control.value;if(!o||!o.id)return void(this.entrepriseRequiredError=!0)}if(this.clientForm.invalid)return void(this.errorMessage="Veuillez corriger les erreurs du formulaire.");this.isLoading=!0;const t=this.clientForm.value;if(this.isEntrepriseSelected){const o=this.control.value;o&&o.id&&(t.entrepriseClient={id:o.id})}this.clientService.addClient(t).subscribe({next:o=>{this.isLoading=!1,this.clientForm.reset(),this.isEntrepriseSelected=!1;const n=parseInt(o.clientId,10);if(isNaN(n))return console.error("ID client invalide re\xe7u :",o.clientId),void(this.errorMessage="Erreur : ID du client invalide");const r={id:n,nomComplet:t.nomComplet,adresse:t.adresse,email:t.email,telephone:t.telephone,poste:t.poste,pays:t.pays,ville:t.ville,entrepriseClient:t.entrepriseClient,photo:t.photo||this.urllink};this.resetForm(),this.clientAjoute.emit(r),this.successMessage="Client cr\xe9\xe9 avec succ\xe8s !",this.closeForm()},error:o=>{this.isLoading=!1,this.errorMessage=o.error?.error||"Erreur lors de la cr\xe9ation"}})}goToClients(){this.router.navigate(["/clients"])}closeForm(){this.close.emit()}markFormGroupTouched(t){Object.values(t.controls).forEach(o=>{o.markAsTouched(),o instanceof a.gE&&this.markFormGroupTouched(o)})}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(k.Ix),e.rXU(a.ok),e.rXU(D.r),e.rXU(V.X),e.rXU(j.g))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-client-form"]],outputs:{clientAjoute:"clientAjoute",close:"close"},decls:76,vars:25,consts:[["auto","matAutocomplete"],[1,"container_global"],["class","loading-overlay",4,"ngIf"],[1,"content_formulaire"],[1,"modal-body"],[1,"container_formulaire",3,"formGroup"],[1,"Title"],[1,"form_left_right"],[1,"formulaire"],[1,"information_cadre"],[1,"info_titre_input"],[1,"double_input"],[1,"champ_input","champ_input2"],["type","text","id","nomComplet","formControlName","nomComplet","name","nomComplet","placeholder","Saisis le nom et pr\xe9nom",1,"input_focus"],["for","nomComplet",1,"label"],["class","error",4,"ngIf"],["type","email","id","email","formControlName","email","name","email","placeholder","Saisis l'email",1,"input_focus"],["for","email",1,"label"],["id","adresse","formControlName","adresse","name","adresse","placeholder","Saisis l'adresse",1,"input_focus"],["for","adresse",1,"label"],["id","poste","formControlName","poste","name","poste","placeholder","Saisissez votre poste ",1,"input_focus"],["for","poste",1,"label"],[1,"grid_colonne"],[1,"champ_input","div1"],["formControlName","pays",1,"input_focus",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","pays",1,"label"],[1,"champ_input","div2"],["type","tel","id","telephone","formControlName","telephone","name","telephone","placeholder","Saisis le num\xe9ro de t\xe9l\xe9phone",1,"input_focus",3,"input"],["for","telephone",1,"label"],[1,"champ_input","div3"],["id","ville","formControlName","ville","name","ville","placeholder","Saisis la ville",1,"input_focus"],["for","ville",1,"label"],[1,"champ_input_inventaire"],[1,"switch"],["type","checkbox",3,"ngModelChange","ngModel","ngModelOptions"],[1,"slider","round"],["class","information_cadre",4,"ngIf"],[1,"information_cadre","information_cadre_save"],[1,"container_error_message"],["class","error-messageApi2",4,"ngIf"],["class","success-messageApi2",4,"ngIf"],["class","error","style","margin-top: 8px;",4,"ngIf"],[1,"info_titre_input","info_titre_input_btn"],[1,"btn_annuler"],[1,"btn_cancel",3,"click"],[1,"btn_ajouter"],[1,"btn_save",3,"click","disabled"],["class","popup-overlay",4,"ngIf"],[1,"loading-overlay"],[1,"loading-content"],[1,"spinner"],[1,"error"],[4,"ngIf"],[3,"value"],[1,"champ_input"],["type","text","placeholder","Selectionner un entreprise","matInput","",1,"input_focus","input_cursor",3,"formControl","matAutocomplete"],["for","categorieId",1,"label"],[3,"optionSelected","displayWith"],[1,"select-option",3,"click"],[2,"display","flex","align-items","center","color","#0672E4"],[1,"ri-community-line"],[2,"margin-left","8px"],[1,"icon_arrow"],[1,"ri-arrow-down-s-line"],[1,"option-content"],[1,"error-messageApi2"],[1,"success-messageApi2"],[1,"error",2,"margin-top","8px"],[1,"popup-overlay"],[1,"popup-content"],[1,"popup-header"],[1,"close-btn",3,"click"],[3,"formGroup"],[1,"popup-body"],[1,"champ_grid"],["type","text","formControlName","nom","placeholder","Saisis le nom de l'entreprise",1,"input_focus"],[1,"label"],[2,"color","#ff0000","margin-left","5px"],["class","error-text",4,"ngIf"],["type","email","formControlName","email","placeholder","Saisis l'email",1,"input_focus"],["type","text","formControlName","adresse","placeholder","Saisis l'adresse",1,"input_focus"],["type","text","formControlName","siege","placeholder","Saisis le si\xe8ge",1,"input_focus"],["value","Mali"],["value","S\xe9n\xe9gal"],["value","C\xf4te d'Ivoire"],["type","tel","formControlName","telephone","placeholder","Saisis le num\xe9ro de t\xe9l\xe9phone",1,"input_focus",3,"input"],["id","ville","formControlName","secteur","name","ville","placeholder","Saisis la ville",1,"input_focus"],["class","error-messageApi",4,"ngIf"],[1,"popup-footer"],["type","button",1,"btn-cancel",3,"click"],["type","submit",1,"btn-submit",3,"click","disabled"],[1,"error-text"],[1,"error-messageApi"],[3,"click"]],template:function(o,n){if(1&o&&(e.j41(0,"div",1),e.DNE(1,we,5,0,"div",2),e.j41(2,"div",3)(3,"div",4)(4,"form",5)(5,"div",6)(6,"h3"),e.EFF(7,"Ajouter un client"),e.k0s()(),e.j41(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12),e.nrm(14,"input",13),e.j41(15,"label",14),e.EFF(16,"Nom et pr\xe9nom"),e.k0s(),e.DNE(17,Re,3,2,"div",15),e.k0s(),e.j41(18,"div",12),e.nrm(19,"input",16),e.j41(20,"label",17),e.EFF(21,"Email"),e.k0s(),e.DNE(22,Ge,2,1,"div",15),e.k0s()(),e.j41(23,"div",11)(24,"div",12),e.nrm(25,"input",18),e.j41(26,"label",19),e.EFF(27,"Adresse"),e.k0s()(),e.j41(28,"div",12),e.nrm(29,"input",20),e.j41(30,"label",21),e.EFF(31,"Poste"),e.k0s()()(),e.j41(32,"div",22)(33,"div",23)(34,"select",24),e.bIt("change",function(s){return n.onPaysChange(s)}),e.j41(35,"option",25),e.EFF(36,"Pays"),e.k0s(),e.DNE(37,$e,2,3,"option",26),e.k0s(),e.j41(38,"label",27),e.EFF(39,"Pays"),e.k0s(),e.DNE(40,Be,3,0,"div",15),e.k0s(),e.j41(41,"div",28)(42,"input",29),e.bIt("input",function(){return n.formatPhoneNumber()}),e.k0s(),e.j41(43,"label",30),e.EFF(44,"T\xe9l\xe9phone"),e.k0s(),e.DNE(45,De,3,2,"div",15)(46,Ve,3,0,"div",15),e.k0s(),e.j41(47,"div",31),e.nrm(48,"input",32),e.j41(49,"label",33),e.EFF(50,"Ville"),e.k0s()()()()(),e.j41(51,"div",9)(52,"div",10)(53,"h4"),e.EFF(54,"Entreprise"),e.k0s(),e.j41(55,"div",34)(56,"p"),e.EFF(57,"J'appartient \xe0 une entreprise"),e.k0s(),e.j41(58,"label",35)(59,"input",36),e.mxI("ngModelChange",function(s){return e.DH7(n.isEntrepriseSelected,s)||(n.isEntrepriseSelected=s),s}),e.k0s(),e.nrm(60,"span",37),e.k0s()()()(),e.DNE(61,qe,17,6,"div",38),e.j41(62,"div",39)(63,"div",40),e.DNE(64,Ue,2,1,"div",41)(65,ze,2,1,"div",42)(66,Ye,3,0,"div",43),e.k0s(),e.j41(67,"div",44)(68,"div",45)(69,"button",46),e.bIt("click",function(){return n.closeForm()}),e.EFF(70,"Annuler"),e.k0s()(),e.j41(71,"div",47)(72,"button",48),e.bIt("click",function(){return n.ajouterClient()}),e.EFF(73," Ajouter "),e.k0s()()()()()()()()()(),e.DNE(74,Je,58,10,"div",49)(75,Ke,4,1,"div",42)),2&o){let r,s,d,h,F;e.R7$(),e.Y8G("ngIf",n.isLoading),e.R7$(3),e.Y8G("formGroup",n.clientForm),e.R7$(13),e.Y8G("ngIf",(null==(r=n.clientForm.get("nomComplet"))?null:r.touched)&&(null==(r=n.clientForm.get("nomComplet"))?null:r.invalid)),e.R7$(5),e.Y8G("ngIf",(null==(s=n.clientForm.get("email"))?null:s.touched)&&(null==(s=n.clientForm.get("email"))?null:s.invalid)),e.R7$(15),e.Y8G("ngForOf",n.paysKeys),e.R7$(3),e.Y8G("ngIf",(null==(d=n.clientForm.get("pays"))?null:d.invalid)&&(null==(d=n.clientForm.get("pays"))?null:d.touched)),e.R7$(5),e.Y8G("ngIf",(null==(h=n.clientForm.get("telephone"))?null:h.touched)&&(null==(h=n.clientForm.get("telephone"))||null==h.errors?null:h.errors.pattern)&&(null==(h=n.clientForm.get("pays"))?null:h.value)),e.R7$(),e.Y8G("ngIf",(null==(F=n.clientForm.get("telephone"))?null:F.touched)&&(null==(F=n.clientForm.get("telephone"))||null==F.errors?null:F.errors.required)),e.R7$(13),e.R50("ngModel",n.isEntrepriseSelected),e.Y8G("ngModelOptions",e.lJ4(24,Te)),e.R7$(2),e.Y8G("ngIf",n.isEntrepriseSelected),e.R7$(3),e.Y8G("ngIf",n.errorMessage),e.R7$(),e.Y8G("ngIf",n.successMessage),e.R7$(),e.Y8G("ngIf",n.entrepriseRequiredError),e.R7$(6),e.xc7("background-color",n.clientForm.valid?"#0672E4":"#0671e434")("color",n.clientForm.valid?"#ffffff":"#00000073")("cursor",n.clientForm.valid?"pointer":"no-drop"),e.Y8G("disabled",n.clientForm.invalid)("disabled",n.clientForm.invalid),e.R7$(2),e.Y8G("ngIf",n.showPopup),e.R7$(),e.Y8G("ngIf",n.successMessage)}},dependencies:[a.YN,a.qT,a.xH,a.y7,a.me,a.Zm,a.wz,a.BC,a.cb,a.vS,m.MD,m.Sq,m.bT,m.Jj,a.X1,a.l_,a.j4,a.JD,P.jL,P.$3,y.wT,P.pN],styles:['@charset "UTF-8";.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;color:#fff;font-size:18px;z-index:1000}.loading-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid white;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.container_global[_ngcontent-%COMP%]{position:relative;margin-right:5%}.title[_ngcontent-%COMP%]{font-size:18px}.champ_input[_ngcontent-%COMP%]{position:relative;margin-bottom:30px}.champ_input_list_stock[_ngcontent-%COMP%]{position:relative;margin-bottom:10px}.champ_input[_ngcontent-%COMP%]   .title_input[_ngcontent-%COMP%]{position:absolute;top:-18px}.champ_input_Categorie[_ngcontent-%COMP%]{margin-bottom:15px!important}.formulaire[_ngcontent-%COMP%]{position:relative}.Title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px}.input_focus[_ngcontent-%COMP%]{width:100%;height:49px;outline:none;border-bottom:1px solid rgb(53,50,50);border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:14px;background:none;color:#695c5c}.champ_input[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:4px;pointer-events:none;color:#6b6666}.input_focus[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.input_focus[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:5px;left:0;transition:all .3s ease-in-out;background:none;font-size:11px;padding:0}.input_focus[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:12px;transition:all .2s ease-in-out}.input_focus2[_ngcontent-%COMP%]{width:100%;min-width:250px;height:57px;outline:none;border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:14px;padding-left:10px;background:none;color:#777474;border-radius:5px;padding-top:10px;border-bottom:1px solid rgb(53,50,50);resize:none}.input_focus2[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.champ_input2[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:0;pointer-events:none;color:#423838}.champ_input[_ngcontent-%COMP%]   .labelCategory[_ngcontent-%COMP%]{color:#423838;left:0;font-size:14px}.input_focus2[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus2[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:0;left:0;transition:all .3s ease-in-out;background:none;font-size:11px;padding:0;background-color:#fff}.input_focus2[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus2[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:15px;transition:all .2s ease-in-out}.info_titre_input[_ngcontent-%COMP%]{padding:20px}.info_titre_input[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;margin-bottom:10px;letter-spacing:.6px}.champ_input2[_ngcontent-%COMP%]{display:inline-block;width:50%;box-sizing:border-box;vertical-align:top}.champ_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.information_cadre[_ngcontent-%COMP%]{width:100%;height:auto;background-color:#fff;box-shadow:2px 2px 30px #0000001c;border-radius:5px;margin-top:20px;margin-bottom:20px}.double_input[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-top:10px}.container_file[_ngcontent-%COMP%]{width:150px;border-radius:10px;box-shadow:4px 4px 30px #0003;display:flex;flex-direction:column;align-items:center;justify-content:space-between;padding:10px;gap:5px;background-color:#006eff0a;margin-bottom:10px;margin-top:20px}.header_file[_ngcontent-%COMP%]{height:140px;width:140px;border:1px dashed rgba(6,113,228,.6156862745);border-radius:10px;flex-direction:column;overflow:hidden;display:flex;align-items:center;justify-content:center;box-shadow:#959da533 0 8px 24px}.header_file[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:cover;transition:transform .2s}.header_file[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:100px}.header_file[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;color:#000}.footer_file[_ngcontent-%COMP%]{background-color:#006eff13;width:140px;height:35px;padding:5px 8px;border-radius:5px;cursor:pointer;display:flex;align-items:center;color:#000;border:none;margin-top:3px}.footer_file[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0!important;font-size:10px}.footer_file[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;margin-right:7px}#file[_ngcontent-%COMP%]{display:none}.header_file[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.container_error_message[_ngcontent-%COMP%]{margin-left:20px}.error-message[_ngcontent-%COMP%]{font-size:14px;color:red;font-weight:700}.information_cadre_save[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.info_titre_input_btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:end;gap:20px}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]{padding:8px 30px;border:none;border-radius:5px;background-color:red;color:#fff}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]:hover{background-color:#d80101;transition:all ease-in .5s}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]{padding:8px 30px;border:none;border-radius:5px;background-color:#0672e4;color:#fff}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]:hover{background-color:#0863c5;transition:all .5s}.champ_input_inventaire[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}.champ_input_inventaire[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:24px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:24px}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#0672e4}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(26px)}.input_cursor[_ngcontent-%COMP%]{cursor:pointer}.icon_arrow[_ngcontent-%COMP%]{position:absolute;right:10px;top:25px}.icon_arrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px;color:#000}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;width:50%}.popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.popup-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer}.popup-footer[_ngcontent-%COMP%]{margin-top:20px;text-align:right}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{margin-left:10px;border:none;border-radius:4px;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]{background-color:red;padding:6px 25px;color:#fff}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#d80101;transition:all ease-in .5s}.btn-submit[_ngcontent-%COMP%]{background-color:#0672e4;padding:6px 25px;color:#fff;cursor:pointer;cursor:no-drop}.btn-submit[_ngcontent-%COMP%]:hover{background-color:#0863c5;transition:all ease-in .5s}.error-text[_ngcontent-%COMP%]{color:#f44;font-size:.8rem;margin-top:4px}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.error-messageApi[_ngcontent-%COMP%]{font-size:14px;color:red;font-weight:700;position:relative;top:-20px;left:-20px}.success-messageApi[_ngcontent-%COMP%]{font-size:14px;color:#0672e4;font-weight:700;position:relative;top:-20px;left:-20px}.error-messageApi2[_ngcontent-%COMP%]{font-size:14px;color:red;font-weight:700}.success-messageApi2[_ngcontent-%COMP%]{font-size:14px;color:#0672e4;font-weight:700}.error[_ngcontent-%COMP%]{font-size:14px;color:red;font-weight:700;position:relative}.grid_colonne[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.div1[_ngcontent-%COMP%]{grid-area:1/1/2/2}.div2[_ngcontent-%COMP%]{grid-area:1/2/2/3}.div3[_ngcontent-%COMP%]{grid-area:1/3/2/4}input[type=tel][_ngcontent-%COMP%]{letter-spacing:.5px}']})}}return i})();var Ze=g(21413),Qe=g(56977),et=g(31673);function tt(i,l){1&i&&(e.j41(0,"small"),e.EFF(1," Ce champ est obligatoire "),e.k0s())}function nt(i,l){1&i&&(e.j41(0,"small"),e.EFF(1," Minimum 2 caract\xe8res "),e.k0s())}function ot(i,l){if(1&i&&(e.j41(0,"div",40),e.DNE(1,tt,2,0,"small",41)(2,nt,2,0,"small",41),e.k0s()),2&i){let t,o;const n=e.XpG();e.R7$(),e.Y8G("ngIf",null==(t=n.entrepriseClientForm.get("nom"))||null==t.errors?null:t.errors.required),e.R7$(),e.Y8G("ngIf",null==(o=n.entrepriseClientForm.get("nom"))||null==o.errors?null:o.errors.minlength)}}function it(i,l){1&i&&(e.j41(0,"small"),e.EFF(1," Format d'email invalide "),e.k0s())}function rt(i,l){if(1&i&&(e.j41(0,"div",40),e.DNE(1,it,2,0,"small",41),e.k0s()),2&i){let t;const o=e.XpG();e.R7$(),e.Y8G("ngIf",null==(t=o.entrepriseClientForm.get("email"))||null==t.errors?null:t.errors.email)}}function st(i,l){if(1&i&&(e.j41(0,"option",42),e.EFF(1),e.k0s()),2&i){const t=l.$implicit,o=e.XpG();e.Y8G("value",t),e.R7$(),e.Lme(" ",t," (",o.paysIndicatifs[t].indicatif,") ")}}function at(i,l){if(1&i&&(e.j41(0,"div",40)(1,"small"),e.EFF(2),e.k0s()()),2&i){const t=l.ngIf,o=e.XpG();e.R7$(2),e.Lme(" Le num\xe9ro doit contenir ",o.paysIndicatifs[t].longueur," chiffres apr\xe8s l\u2019indicatif ",o.paysIndicatifs[t].indicatif.trim(),". ")}}function lt(i,l){1&i&&(e.j41(0,"div",40)(1,"small"),e.EFF(2,"Le t\xe9l\xe9phone est requis."),e.k0s()())}function ct(i,l){if(1&i&&(e.j41(0,"div",43),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.errorMessageApi)}}function pt(i,l){if(1&i&&(e.j41(0,"div",44),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.successMessage)}}let ut=(()=>{class i{constructor(t,o,n){this.router=t,this.fb=o,this.entrepriseClientService=n,this.entrepriseAjoute=new e.bkB,this.close=new e.bkB,this.errorMessageApi="",this.errorMessage="",this.successMessage="",this.isSubmitting=!1,this.destroy$=new Ze.B,this.entrepriseIndicatif="",this.entrepriseMaxPhoneLength=0,this.paysIndicatifs={Mali:{indicatif:"+223",longueur:8},S\u00e9n\u00e9gal:{indicatif:"+221",longueur:9},"C\xf4te d'Ivoire":{indicatif:"+225",longueur:10},"Burkina Faso":{indicatif:"+226",longueur:8},Niger:{indicatif:"+227",longueur:8},France:{indicatif:"+33",longueur:9},Belgique:{indicatif:"+32",longueur:9},Suisse:{indicatif:"+41",longueur:9},Canada:{indicatif:"+1",longueur:10},"\xc9tats-Unis":{indicatif:"+1",longueur:10},Maroc:{indicatif:"+212",longueur:9},Alg\u00e9rie:{indicatif:"+213",longueur:9},Tunisie:{indicatif:"+216",longueur:8},Togo:{indicatif:"+228",longueur:8},B\u00e9nin:{indicatif:"+229",longueur:8},Guin\u00e9e:{indicatif:"+224",longueur:9},Tchad:{indicatif:"+235",longueur:8},Cameroun:{indicatif:"+237",longueur:9},RDC:{indicatif:"+243",longueur:9},Gabon:{indicatif:"+241",longueur:9},"Afrique du Sud":{indicatif:"+27",longueur:9},Rwanda:{indicatif:"+250",longueur:9},Kenya:{indicatif:"+254",longueur:9},Nig\u00e9ria:{indicatif:"+234",longueur:10},Ghana:{indicatif:"+233",longueur:9},\u00c9thiopie:{indicatif:"+251",longueur:9},\u00c9gypte:{indicatif:"+20",longueur:10},Inde:{indicatif:"+91",longueur:10},Chine:{indicatif:"+86",longueur:11},Mexique:{indicatif:"+52",longueur:10},Allemagne:{indicatif:"+49",longueur:10},Espagne:{indicatif:"+34",longueur:9},Italie:{indicatif:"+39",longueur:10},"Royaume-Uni":{indicatif:"+44",longueur:10},"Pays-Bas":{indicatif:"+31",longueur:9},Portugal:{indicatif:"+351",longueur:9}},this.paysKeys=Object.keys(this.paysIndicatifs)}ngOnInit(){this.initializeForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}resetForm(){this.entrepriseClientForm.reset({pays:""}),this.errorMessageApi="",this.successMessage="",this.entrepriseIndicatif="",this.entrepriseMaxPhoneLength=0}onEntreprisePaysChange(t){const n=this.paysIndicatifs[t.target.value];if(!n)return;this.entrepriseIndicatif=n.indicatif,this.entrepriseMaxPhoneLength=n.longueur;const r=this.entrepriseClientForm.get("telephone");r.value?.startsWith(this.entrepriseIndicatif)||r.setValue(this.entrepriseIndicatif),this.updatePhoneValidator(n.longueur)}updatePhoneValidator(t){const o=this.entrepriseClientForm.get("telephone"),n=new RegExp(`^\\${this.entrepriseIndicatif.trim()}\\s\\d{${t}}$`);o.setValidators([a.k0.required,a.k0.pattern(n)]),o.updateValueAndValidity()}formatEntreprisePhoneNumber(){const t=this.entrepriseClientForm.get("telephone");let o=t.value;if(!o.startsWith(this.entrepriseIndicatif))return void t.setValue(this.entrepriseIndicatif);const n=o.replace(this.entrepriseIndicatif,"").replace(/\D/g,""),r=`${this.entrepriseIndicatif}${n}`.slice(0,this.entrepriseIndicatif.length+this.entrepriseMaxPhoneLength);t.setValue(r,{emitEvent:!1})}initializeForm(){this.entrepriseClientForm=this.fb.group({nom:["",[a.k0.required,a.k0.minLength(2)]],adresse:[""],email:["",[a.k0.email]],telephone:[""],pays:[""],siege:[""],secteur:[""]})}ajouterEntrepriseClient(){if(this.errorMessageApi="",this.successMessage="",this.entrepriseClientForm.invalid)return void this.markAllAsTouched();this.isSubmitting=!0;const t=this.entrepriseClientForm.value;this.entrepriseClientService.addEntrepriseClient(t).pipe((0,Qe.Q)(this.destroy$)).subscribe({next:o=>{this.successMessage="Entreprise ajout\xe9e avec succ\xe8s!",this.isSubmitting=!1,this.entrepriseAjoute.emit({id:o.id||o.id,nom:t.nom,adresse:t.adresse,email:t.email,telephone:t.telephone,pays:t.pays,siege:t.siege,secteur:t.secteur}),this.resetForm(),this.entrepriseClientForm.reset(),this.closeForm()},error:o=>{this.errorMessageApi=o.error?.error||o.message||"Erreur lors de l'ajout de l'entreprise",this.isSubmitting=!1}})}markAllAsTouched(){Object.values(this.entrepriseClientForm.controls).forEach(t=>{t.markAsTouched()})}closeForm(){this.close.emit()}markFormGroupTouched(t){Object.values(t.controls).forEach(o=>{o.markAsTouched(),o instanceof a.gE&&this.markFormGroupTouched(o)})}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(k.Ix),e.rXU(a.ok),e.rXU(et.K))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-entreprise-form"]],outputs:{entrepriseAjoute:"entrepriseAjoute",close:"close"},decls:60,vars:16,consts:[[1,"container_global"],[1,"content_formulaire"],[1,"modal-body"],[1,"container_formulaire",3,"formGroup"],[1,"Title"],[1,"form_left_right"],[1,"formulaire"],[1,"information_cadre"],[1,"info_titre_input"],[1,"double_input"],[1,"champ_input","champ_input2"],["type","text","id","nomComplet","formControlName","nom","name","nomComplet","placeholder","Saisis le nom d'entreprise",1,"input_focus"],["for","nomComplet",1,"label"],["class","error",4,"ngIf"],["type","email","id","email","formControlName","email","name","email","placeholder","Saisis l'email",1,"input_focus"],["for","email",1,"label"],["autocomplete","off","id","adresse","formControlName","adresse","name","adresse","placeholder","Saisis l'adresse",1,"input_focus"],["for","adresse",1,"label"],["type","text","id","siege","formControlName","siege","name","siege","placeholder","Saisis le si\xe8ge",1,"input_focus"],["for","telephone",1,"label"],[1,"grid_colonne"],[1,"champ_input","div1"],["formControlName","pays",1,"input_focus",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","pays",1,"label"],[1,"champ_input","div2"],["type","tel","formControlName","telephone","placeholder","Saisis le num\xe9ro de t\xe9l\xe9phone",1,"input_focus",3,"input"],[1,"champ_input","div3"],["id","ville","formControlName","secteur","name","ville","placeholder","Saisis la ville",1,"input_focus"],["for","ville",1,"label"],[1,"information_cadre","information_cadre_save"],[1,"container_error_message"],["class","error-messageApi2",4,"ngIf"],["class","success-messageApi2",4,"ngIf"],[1,"info_titre_input","info_titre_input_btn"],[1,"btn_annuler"],[1,"btn_cancel",3,"click"],[1,"btn_ajouter"],[1,"btn_save",3,"click","disabled"],[1,"error"],[4,"ngIf"],[3,"value"],[1,"error-messageApi2"],[1,"success-messageApi2"]],template:function(o,n){if(1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"div",4)(5,"h3"),e.EFF(6,"Ajouter un client entreprise"),e.k0s()(),e.j41(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10),e.nrm(13,"input",11),e.j41(14,"label",12),e.EFF(15,"Nom d'entreprise"),e.k0s(),e.DNE(16,ot,3,2,"div",13),e.k0s(),e.j41(17,"div",10),e.nrm(18,"input",14),e.j41(19,"label",15),e.EFF(20,"Email"),e.k0s(),e.DNE(21,rt,2,1,"div",13),e.k0s()(),e.j41(22,"div",9)(23,"div",10),e.nrm(24,"input",16),e.j41(25,"label",17),e.EFF(26,"Adresse"),e.k0s()(),e.j41(27,"div",10),e.nrm(28,"input",18),e.j41(29,"label",19),e.EFF(30,"Ville"),e.k0s()()(),e.j41(31,"div",20)(32,"div",21)(33,"select",22),e.bIt("change",function(s){return n.onEntreprisePaysChange(s)}),e.j41(34,"option",23),e.EFF(35,"Pays"),e.k0s(),e.DNE(36,st,2,3,"option",24),e.k0s(),e.j41(37,"label",25),e.EFF(38,"Pays"),e.k0s()(),e.j41(39,"div",26)(40,"input",27),e.bIt("input",function(){return n.formatEntreprisePhoneNumber()}),e.k0s(),e.j41(41,"label",19),e.EFF(42,"T\xe9l\xe9phone"),e.k0s(),e.DNE(43,at,3,2,"div",13)(44,lt,3,0,"div",13),e.k0s(),e.j41(45,"div",28),e.nrm(46,"input",29),e.j41(47,"label",30),e.EFF(48,"Secteur"),e.k0s()()()()(),e.j41(49,"div",31)(50,"div",32),e.DNE(51,ct,2,1,"div",33)(52,pt,2,1,"div",34),e.k0s(),e.j41(53,"div",35)(54,"div",36)(55,"button",37),e.bIt("click",function(){return n.closeForm()}),e.EFF(56,"Annuler"),e.k0s()(),e.j41(57,"div",38)(58,"button",39),e.bIt("click",function(){return n.ajouterEntrepriseClient()}),e.EFF(59," Ajouter "),e.k0s()()()()()()()()()()),2&o){let r,s,d,h;e.R7$(3),e.Y8G("formGroup",n.entrepriseClientForm),e.R7$(13),e.Y8G("ngIf",(null==(r=n.entrepriseClientForm.get("nom"))?null:r.touched)&&(null==(r=n.entrepriseClientForm.get("nom"))?null:r.invalid)),e.R7$(5),e.Y8G("ngIf",(null==(s=n.entrepriseClientForm.get("email"))?null:s.touched)&&(null==(s=n.entrepriseClientForm.get("email"))?null:s.invalid)),e.R7$(15),e.Y8G("ngForOf",n.paysKeys),e.R7$(7),e.Y8G("ngIf",(null==(d=n.entrepriseClientForm.get("telephone"))?null:d.touched)&&(null==(d=n.entrepriseClientForm.get("telephone"))||null==d.errors?null:d.errors.pattern)&&(null==(d=n.entrepriseClientForm.get("pays"))?null:d.value)),e.R7$(),e.Y8G("ngIf",(null==(h=n.entrepriseClientForm.get("telephone"))?null:h.touched)&&(null==(h=n.entrepriseClientForm.get("telephone"))||null==h.errors?null:h.errors.required)),e.R7$(7),e.Y8G("ngIf",n.errorMessageApi),e.R7$(),e.Y8G("ngIf",n.successMessage),e.R7$(6),e.xc7("background-color",n.entrepriseClientForm.valid?"#0672E4":"#0671e434")("color",n.entrepriseClientForm.valid?"#ffffff":"#00000073")("cursor",n.entrepriseClientForm.valid?"pointer":"no-drop"),e.Y8G("disabled",n.entrepriseClientForm.invalid)("disabled",n.entrepriseClientForm.invalid)}},dependencies:[a.YN,a.qT,a.xH,a.y7,a.me,a.wz,a.BC,a.cb,m.MD,m.Sq,m.bT,a.X1,a.j4,a.JD,P.jL],styles:['@charset "UTF-8";.container_global[_ngcontent-%COMP%]{position:relative;margin-right:5%}.title[_ngcontent-%COMP%]{font-size:18px}.champ_input[_ngcontent-%COMP%]{position:relative;margin-bottom:30px}.champ_input_list_stock[_ngcontent-%COMP%]{position:relative;margin-bottom:10px}.champ_input[_ngcontent-%COMP%]   .title_input[_ngcontent-%COMP%]{position:absolute;top:-18px}.champ_input_Categorie[_ngcontent-%COMP%]{margin-bottom:15px!important}.formulaire[_ngcontent-%COMP%]{position:relative}.Title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px}.input_focus[_ngcontent-%COMP%]{width:100%;height:49px;outline:none;border-bottom:1px solid rgb(53,50,50);border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:14px;background:none;color:#695c5c}.champ_input[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:4px;pointer-events:none;color:#6b6666}.input_focus[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.input_focus[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:5px;left:0;transition:all .3s ease-in-out;background:none;font-size:11px;padding:0}.input_focus[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:12px;transition:all .2s ease-in-out}.input_focus2[_ngcontent-%COMP%]{width:100%;min-width:250px;height:57px;outline:none;border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:14px;padding-left:10px;background:none;color:#777474;border-radius:5px;padding-top:10px;border-bottom:1px solid rgb(53,50,50);resize:none}.input_focus2[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.champ_input2[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:0;pointer-events:none;color:#423838}.champ_input[_ngcontent-%COMP%]   .labelCategory[_ngcontent-%COMP%]{color:#423838;left:0;font-size:14px}.input_focus2[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus2[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#0672e4;top:0;left:0;transition:all .3s ease-in-out;background:none;font-size:11px;padding:0;background-color:#fff}.input_focus2[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus2[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:15px;transition:all .2s ease-in-out}.info_titre_input[_ngcontent-%COMP%]{padding:20px}.info_titre_input[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;margin-bottom:10px;letter-spacing:.6px}.champ_input2[_ngcontent-%COMP%]{display:inline-block;width:50%;box-sizing:border-box;vertical-align:top}.champ_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.information_cadre[_ngcontent-%COMP%]{width:100%;height:auto;background-color:#fff;box-shadow:2px 2px 30px #0000001c;border-radius:5px;margin-top:20px;margin-bottom:20px}.double_input[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-top:30px}.container_file[_ngcontent-%COMP%]{width:150px;border-radius:10px;box-shadow:4px 4px 30px #0003;display:flex;flex-direction:column;align-items:center;justify-content:space-between;padding:10px;gap:5px;background-color:#006eff0a;margin-bottom:10px;margin-top:20px}.header_file[_ngcontent-%COMP%]{height:140px;width:140px;border:1px dashed rgba(6,113,228,.6156862745);border-radius:10px;flex-direction:column;overflow:hidden;display:flex;align-items:center;justify-content:center;box-shadow:#959da533 0 8px 24px}.header_file[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:cover;transition:transform .2s}.header_file[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:100px}.header_file[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;color:#000}.footer_file[_ngcontent-%COMP%]{background-color:#006eff13;width:140px;height:35px;padding:5px 8px;border-radius:5px;cursor:pointer;display:flex;align-items:center;color:#000;border:none;margin-top:3px}.footer_file[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0!important;font-size:10px}.footer_file[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;margin-right:7px}#file[_ngcontent-%COMP%]{display:none}.header_file[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.container_error_message[_ngcontent-%COMP%]{margin-left:20px}.error-message[_ngcontent-%COMP%]{font-size:14px;color:red;font-weight:700}.information_cadre_save[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.info_titre_input_btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:end;gap:20px}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]{padding:8px 30px;border:none;border-radius:5px;background-color:red;color:#fff}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]:hover{background-color:#d80101;transition:all ease-in .5s}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]{padding:8px 30px;border:none;border-radius:5px;background-color:#0672e4;color:#fff}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]:hover{background-color:#0863c5;transition:all .5s}.champ_input_inventaire[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}.champ_input_inventaire[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:24px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:24px}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#0672e4}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(26px)}.input_cursor[_ngcontent-%COMP%]{cursor:pointer}.icon_arrow[_ngcontent-%COMP%]{position:absolute;right:10px;top:25px}.icon_arrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px;color:#000}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;width:50%}.popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.popup-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer}.popup-footer[_ngcontent-%COMP%]{margin-top:20px;text-align:right}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{margin-left:10px;border:none;border-radius:4px;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]{background-color:red;padding:6px 25px;color:#fff}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#d80101;transition:all ease-in .5s}.btn-submit[_ngcontent-%COMP%]{background-color:#0672e4;padding:6px 25px;color:#fff;cursor:pointer;cursor:no-drop}.btn-submit[_ngcontent-%COMP%]:hover{background-color:#0863c5;transition:all ease-in .5s}.error-text[_ngcontent-%COMP%]{color:#f44;font-size:.8rem;margin-top:4px}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.error-messageApi[_ngcontent-%COMP%]{font-size:14px;color:red;font-weight:700;position:relative;top:-20px;left:-20px}.success-messageApi[_ngcontent-%COMP%]{font-size:14px;color:#0672e4;font-weight:700;position:relative;top:-20px;left:-20px}.error-messageApi2[_ngcontent-%COMP%]{font-size:14px;color:red;font-weight:700}.success-messageApi2[_ngcontent-%COMP%]{font-size:14px;color:#0672e4;font-weight:700}.error[_ngcontent-%COMP%]{font-size:14px;color:red;font-weight:700;position:relative}.grid_colonne[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px;gap:20px}.div1[_ngcontent-%COMP%]{grid-area:1/1/2/2}.div2[_ngcontent-%COMP%]{grid-area:1/2/2/3}.div3[_ngcontent-%COMP%]{grid-area:1/3/2/4}input[type=tel][_ngcontent-%COMP%]{letter-spacing:.5px}']})}}return i})();var dt=g(72409),gt=g(61068),mt=g(88704);const S=()=>({standalone:!0}),ft=i=>({duplicate:i});function _t(i,l){1&i&&(e.j41(0,"div",65)(1,"div",66),e.nrm(2,"div",67),e.j41(3,"p"),e.EFF(4,"Connexion en cours..."),e.k0s()()())}function ht(i,l){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI("- ",t.entrepriseClient.nom,"")}}function Ct(i,l){if(1&i&&(e.j41(0,"mat-option",70)(1,"div",75),e.EFF(2),e.DNE(3,ht,2,1,"span",22),e.k0s()()),2&i){const t=l.$implicit;e.Y8G("value",t),e.R7$(2),e.SpI(" ",t.nomComplet," "),e.R7$(),e.Y8G("ngIf",t.entrepriseClient)}}function bt(i,l){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"div",36)(2,"input",68),e.bIt("focus",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onClientFocus())})("blur",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onClientBlur())}),e.k0s(),e.j41(3,"label",27),e.EFF(4,"Clients"),e.k0s(),e.j41(5,"mat-autocomplete",69,0),e.bIt("optionSelected",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onClientSelected(n))}),e.j41(7,"mat-option",70)(8,"div",71),e.nrm(9,"i",72),e.j41(10,"span",73),e.EFF(11,"Cr\xe9er un client"),e.k0s()()(),e.DNE(12,Ct,4,3,"mat-option",74),e.nI1(13,"async"),e.k0s()()()}if(2&i){const t=e.sdS(6),o=e.XpG();e.R7$(2),e.Y8G("formControl",o.clientControl)("matAutocomplete",t),e.R7$(3),e.Y8G("displayWith",o.displayClient),e.R7$(2),e.Y8G("value",null),e.R7$(5),e.Y8G("ngForOf",e.bMT(13,5,o.filteredClients))}}function Pt(i,l){if(1&i&&(e.j41(0,"mat-option",70)(1,"div",75),e.EFF(2),e.k0s()()),2&i){const t=l.$implicit;e.Y8G("value",t),e.R7$(2),e.SpI(" ",t.nom," ")}}function vt(i,l){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"div",36)(2,"input",76),e.bIt("focus",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onEntrepriseFocus())})("blur",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onEntrepriseBlur())}),e.k0s(),e.j41(3,"label",27),e.EFF(4,"Entreprise"),e.k0s(),e.j41(5,"mat-autocomplete",69,1),e.bIt("optionSelected",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onEntrepriseSelected(n))}),e.j41(7,"mat-option",70)(8,"div",71),e.nrm(9,"i",72),e.j41(10,"span",73),e.EFF(11,"Cr\xe9er une entreprise"),e.k0s()()(),e.DNE(12,Pt,3,2,"mat-option",74),e.nI1(13,"async"),e.k0s()()()}if(2&i){const t=e.sdS(6),o=e.XpG();e.R7$(2),e.Y8G("formControl",o.entrepriseControl)("matAutocomplete",t),e.R7$(3),e.Y8G("displayWith",o.displayEntreprise),e.R7$(2),e.Y8G("value",null),e.R7$(5),e.Y8G("ngForOf",e.bMT(13,5,o.filteredEntreprises))}}function xt(i,l){if(1&i){const t=e.RV6();e.j41(0,"tr",77)(1,"td")(2,"div",36),e.nrm(3,"input",78),e.k0s()(),e.j41(4,"td")(5,"div",36),e.nrm(6,"textarea",79),e.k0s()(),e.j41(7,"td")(8,"div",36),e.nrm(9,"input",80),e.k0s()(),e.j41(10,"td")(11,"div",36),e.nrm(12,"input",81),e.nI1(13,"customNumber"),e.k0s()(),e.j41(14,"td")(15,"div",36),e.nrm(16,"input",82),e.nI1(17,"customNumber"),e.k0s()(),e.j41(18,"td")(19,"div",83),e.bIt("click",function(){const n=e.eBV(t).index,r=e.XpG();return e.Njj(r.supprimerLigneConfirmee(n))}),e.nrm(20,"i",84),e.k0s()()()}if(2&i){const t=l.$implicit,o=e.XpG();e.R7$(3),e.Y8G("value",o.getProduitNom(t.produitId)),e.R7$(3),e.Y8G("value",t.ligneDescription),e.R7$(3),e.Y8G("value",t.quantite),e.R7$(3),e.Y8G("value",e.bMT(13,5,o.getPrixVente(t.produitId))),e.R7$(4),e.Y8G("value",e.bMT(17,7,o.getMontantTotal(t)))}}function Mt(i,l){if(1&i&&(e.j41(0,"mat-option",70)(1,"div",75),e.EFF(2),e.k0s()()),2&i){const t=l.$implicit;e.Y8G("value",t),e.R7$(2),e.SpI(" ",t.nom," ")}}function Ft(i,l){1&i&&(e.j41(0,"div",92),e.nrm(1,"div",93),e.j41(2,"span"),e.EFF(3,"Chargement de plus de produits..."),e.k0s()())}function Ot(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",94),e.bIt("click",function(){e.eBV(t);const n=e.XpG().index,r=e.XpG();return e.Njj(r.ajouterLigneFacture(n))}),e.nrm(1,"i",95),e.k0s()}}function Et(i,l){if(1&i){const t=e.RV6();e.j41(0,"tr",77)(1,"td")(2,"div",36)(3,"input",85),e.bIt("focus",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onFocus())}),e.k0s(),e.j41(4,"mat-autocomplete",69,2),e.bIt("optionSelected",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onProduitSelected(n))}),e.j41(6,"div",86,3),e.bIt("scroll",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onTableScroll(n))}),e.j41(8,"mat-option",70)(9,"div",71),e.nrm(10,"i",72),e.j41(11,"span",73),e.EFF(12,"Cr\xe9er un produit"),e.k0s()()(),e.DNE(13,Mt,3,2,"mat-option",74),e.nI1(14,"async"),e.DNE(15,Ft,4,0,"div",87),e.k0s()()()(),e.j41(16,"td")(17,"div",36)(18,"textarea",88),e.mxI("ngModelChange",function(n){const r=e.eBV(t).$implicit;return e.DH7(r.ligneDescription,n)||(r.ligneDescription=n),e.Njj(n)}),e.k0s()()(),e.j41(19,"td")(20,"div",36)(21,"input",89),e.mxI("ngModelChange",function(n){const r=e.eBV(t).$implicit;return e.DH7(r.quantite,n)||(r.quantite=n),e.Njj(n)}),e.bIt("ngModelChange",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.updateCalculs())}),e.k0s()()(),e.j41(22,"td")(23,"div",36),e.nrm(24,"input",90),e.nI1(25,"customNumber"),e.k0s()(),e.j41(26,"td")(27,"div",36),e.nrm(28,"input",37),e.nI1(29,"customNumber"),e.k0s()(),e.j41(30,"td"),e.DNE(31,Ot,2,0,"div",91),e.k0s()()}if(2&i){const t=l.$implicit,o=l.index,n=e.sdS(5),r=e.XpG();e.R7$(3),e.Y8G("formControl",r.productControl)("matAutocomplete",n)("ngClass",e.eq3(20,ft,r.inputLignes[0].isDuplicate)),e.R7$(),e.Y8G("displayWith",r.displayProduit),e.R7$(4),e.Y8G("value",null),e.R7$(5),e.Y8G("ngForOf",e.bMT(14,14,r.filteredProduits)),e.R7$(2),e.Y8G("ngIf",r.isLoadingMore),e.R7$(3),e.R50("ngModel",t.ligneDescription),e.Y8G("ngModelOptions",e.lJ4(22,S)),e.R7$(3),e.R50("ngModel",t.quantite),e.Y8G("ngModelOptions",e.lJ4(23,S)),e.R7$(3),e.Y8G("value",e.bMT(25,16,r.getPrixVente(t.produitId))),e.R7$(4),e.Y8G("value",e.bMT(29,18,r.getMontantTotal(t))),e.R7$(3),e.Y8G("ngIf",o===r.inputLignes.length-1)}}function kt(i,l){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI("(",t.remisePourcentage,"%)")}}function jt(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",96)(1,"div",16)(2,"input",97),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.remisePourcentage,n)||(r.remisePourcentage=n),e.Njj(n)}),e.bIt("input",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onRemiseChange())}),e.k0s(),e.j41(3,"label",98),e.EFF(4," REMISE "),e.DNE(5,kt,2,1,"span",22),e.k0s()(),e.j41(6,"div",16),e.nrm(7,"input",99),e.nI1(8,"customNumber"),e.j41(9,"label",98),e.EFF(10,"Montant (CFA)"),e.k0s()()()}if(2&i){const t=e.XpG();e.R7$(2),e.R50("ngModel",t.remisePourcentage),e.R7$(3),e.Y8G("ngIf",null!==t.remisePourcentage),e.R7$(2),e.Y8G("value",e.bMT(8,3,t.getMontantRemise()))}}function yt(i,l){if(1&i&&(e.j41(0,"div",96)(1,"div",23),e.nrm(2,"input",100),e.nI1(3,"number"),e.j41(4,"label",98),e.EFF(5,"TVA (%)"),e.k0s()(),e.j41(6,"div",23),e.nrm(7,"input",99),e.nI1(8,"customNumber"),e.j41(9,"label",98),e.EFF(10,"Montant (CFA)"),e.k0s()()()),2&i){let t;const o=e.XpG();e.R7$(2),e.Y8G("value",e.i5U(3,2,100*(null==(t=o.form.get("tauxTva"))?null:t.value),"1.0-2")+" %"),e.R7$(5),e.Y8G("value",e.bMT(8,5,o.getMontantTVA()))}}function It(i,l){if(1&i){const t=e.RV6();e.j41(0,"app-produit-form",101),e.bIt("produitAjoute",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onProduitAjoute(n))})("close",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeProductFormPanel())}),e.k0s()}}function Tt(i,l){if(1&i){const t=e.RV6();e.j41(0,"app-client-form",102),e.bIt("clientAjoute",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.onClientAjoute(n))})("close",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeClientFormPanel())}),e.k0s()}}function wt(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",103)(1,"div",104)(2,"p",105),e.EFF(3,"Ce produit est d\xe9j\xe0 dans la liste."),e.k0s(),e.j41(4,"button",106),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopup())})("keyup.enter",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closePopup())}),e.EFF(5,"OK"),e.k0s()()()}}function At(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",103)(1,"div",104)(2,"p"),e.EFF(3),e.k0s(),e.j41(4,"button",107),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.showExistingInvoiceError=!1)}),e.EFF(5,"OK"),e.k0s()()()}if(2&i){const t=e.XpG();e.R7$(3),e.JRh(t.errorMessage)}}let St=(()=>{class i{constructor(t,o,n,r,s,d,h,F,M,O,G){this.router=t,this.clientService=o,this.factureProFormaService=n,this.produitService=r,this.usersService=s,this.previewService=d,this.formStateService=h,this.cdr=F,this.entrepriseService=M,this.cdRef=O,this.fb=G,this.pendingAdjustments=[],this.description="",this.dateFacture="",this.siege="",this.typeDestinataire="client",this.selectedClientId=null,this.selectedEntrepriseId=null,this.selectedEntreprise=null,this.nomEntreprise="",this.produits=[],this.inputLignes=[{produitId:null,quantite:0,ligneDescription:null,isDuplicate:!1}],this.confirmedLignes=[],this.clients=[],this.totalClients=0,this.noClientsAvailable=!1,this.entreprises=[],this.activeRemise=!1,this.activeTva=!1,this.remisePourcentage=0,this.tva=0,this.entrepriseId=0,this.userEntrepriseId=null,this.isLoading=!1,this.facturesproforma=[],this.totalHT=0,this.showDuplicatePopup=!1,this.showExistingInvoiceError=!1,this.errorMessage="",this.hasDuplicateError=!1,this.duplicateIndex=null,this.productControl=new a.MJ,this.currentPage=0,this.pageSize=20,this.totalPages=0,this.isLoadingMore=!1,this.allProductsLoaded=!1,this.totalProductsCount=0,this.showProductFormPanel=!1,this.panelAnimationState="hidden",this.clientControl=new a.MJ,this.showClientFormPanel=!1,this.entrepriseControl=new a.MJ,this.showEntrepriseFormPanel=!1,this.filteredProduits=this.productControl.valueChanges.pipe((0,_.Z)(null),(0,f.T)(x=>"string"==typeof x?x:x?.nom),(0,f.T)(x=>x?this._filterProduits(x):this.produits.slice())),this.filteredClients=this.clientControl.valueChanges.pipe((0,_.Z)(""),(0,f.T)(x=>"string"==typeof x?x:x?.nomComplet),(0,f.T)(x=>x?this._filterClients(x):this.clients.slice())),this.filteredEntreprises=this.entrepriseControl.valueChanges.pipe((0,_.Z)(""),(0,f.T)(x=>"string"==typeof x?x:x?.nom),(0,f.T)(x=>x?this._filterEntreprises(x):this.entreprises.slice()))}_filterClients(t){const o=t.toLowerCase();return this.clients.filter(n=>n.nomComplet.toLowerCase().includes(o)||n.entrepriseClient?.nom.toLowerCase().includes(o))}displayClient(t){return t?t.entrepriseClient?`${t.nomComplet} - ${t.entrepriseClient.nom}`:t.nomComplet:""}onClientBlur(){const t=this.clientControl.value;t&&"object"==typeof t&&"id"in t?this.selectedClientId=t.id:(this.selectedClientId=null,this.clientControl.setValue(null))}onClientSelected(t){null===t.option.value?this.openClientFormPanel():(this.selectedClientId=t.option.value.id,this.clientControl.setValue(t.option.value))}onClientFocus(){this.clientControl.value||this.clientControl.setValue("")}_filterEntreprises(t){const o=t.toLowerCase();return this.entreprises.filter(n=>n.nom.toLowerCase().includes(o))}displayEntreprise(t){return t&&t.nom?t.nom:""}onEntrepriseSelected(t){null===t.option.value?this.openEntrepriseFormPanel():this.selectedEntreprise=t.option.value}onEntrepriseFocus(){this.entrepriseControl.value||this.entrepriseControl.setValue("")}ngOnInit(){var t=this;return(0,C.A)(function*(){t.getUserInfo(),yield Promise.all([t.getListClients(),t.getListEntreprise(),t.getProduits(),t.getFormInit(),t.getEntrepriseInfo()]);const o=t.formStateService.getState();o&&(t.typeDestinataire=o.typeDestinataire,t.selectedClientId=o.selectedClientId,t.selectedEntreprise=o.selectedEntreprise,t.description=o.description,t.inputLignes=o.inputLignes,t.confirmedLignes=o.confirmedLignes,t.activeRemise=o.activeRemise,t.remisePourcentage=o.remisePourcentage,t.activeTva=o.activeTva,o.clientControl&&t.clientControl.setValue(o.clientControl),o.entrepriseControl&&t.entrepriseControl.setValue(o.entrepriseControl))})()}navigateBack(){this.router.navigate(["/facture-proforma"])}onToggleRemise(){this.activeRemise||(this.remisePourcentage=0)}onToggleTVA(){this.activeTva||(this.tva=0)}onRemiseChange(){this.remisePourcentage=Number(this.remisePourcentage)}getMontantRemise(){return this.getTotalHT()*this.remisePourcentage/100}getTotalApresRemise(){return this.getTotalHT()-this.getMontantRemise()}getMontantTVA(){if(!this.activeTva)return 0;const t=this.form.get("tauxTva")?.value||0,o=this.getTotalApresRemise()*t;return Math.round(100*o)/100}getTotalCommercial(){return this.getTotalApresRemise()}getTotalTTC(){return this.getTotalApresRemise()+this.getMontantTVA()}updateCalculs(){this.inputLignes=[...this.inputLignes],this.confirmedLignes=[...this.confirmedLignes]}closePopup(){null!==this.duplicateIndex&&(this.inputLignes[this.duplicateIndex]={produitId:null,quantite:1,ligneDescription:null,isDuplicate:!1},this.duplicateIndex=null),this.showDuplicatePopup=!1,this.updateCalculs(),this.cdr.detectChanges()}trackByFn(t,o){return t}supprimerLigneConfirmee(t){this.confirmedLignes.splice(t,1),this.confirmedLignes=[...this.confirmedLignes]}getProduitNom(t){return t&&this.produits.find(n=>n.id===t)?.nom||""}goToFacture(){this.description="",this.typeDestinataire="client",this.selectedClientId=null,this.selectedEntrepriseId=null,this.selectedEntreprise=null,this.inputLignes=[{produitId:null,quantite:0,ligneDescription:null,isDuplicate:!1}],this.confirmedLignes=[],this.activeRemise=!1,this.remisePourcentage=0,this.activeTva=!1,this.formStateService.clearState(),this.router.navigate(["/facture-proforma"])}getListClients(){this.usersService.getValidAccessToken().pipe((0,w.n)(t=>t?this.clientService.getListClients():(console.error("Token manquant pour clients"),(0,T.$)(()=>new Error("Token manquant"))))).subscribe({next:t=>{this.clients=t.map(o=>({...o,entrepriseClient:o.entrepriseClient?{id:o.entrepriseClient.id,nom:o.entrepriseClient.nom}:null})).sort((o,n)=>(n.id??0)-(o.id??0)),this.clientControl.setValue(null),this.totalClients=this.clients.length,this.noClientsAvailable=0===this.clients.length},error:t=>{console.error("Erreur r\xe9cup\xe9ration clients :",t)}})}getListEntreprise(){this.usersService.getToken()?this.clientService.getListEntreprises().subscribe({next:o=>{this.entreprises=o.sort((n,r)=>(r.id??0)-(n.id??0)),this.entrepriseControl.setValue(null)},error:o=>{console.error("Erreur r\xe9cup\xe9ration entreprises :",o)}}):console.error("Token manquant pour entreprises")}getProduits(t=!1){t?this.isLoadingMore=!0:(this.isLoading=!0,this.currentPage=0,this.allProductsLoaded=!1),this.usersService.getValidAccessToken().subscribe({next:o=>{o?this.userEntrepriseId?this.produitService.getProduitsByEntrepriseIdPaginated(this.userEntrepriseId,this.currentPage,this.pageSize).subscribe({next:n=>{console.log("Produits r\xe9cup\xe9r\xe9s :",n);const r=n.content;t?this.produits=[...this.produits,...r]:(this.produits=r,this.totalProductsCount=n.totalElements);const s=this.produits.filter(d=>Array.isArray(d.boutiques)&&d.boutiques.some(h=>"ENTREPOT"!==(h.typeBoutique||"").toUpperCase()));this.filteredProduits=this.productControl.valueChanges.pipe((0,_.Z)(null),(0,f.T)(d=>"string"==typeof d?d:d?.nom),(0,f.T)(d=>{if(!d)return s;const h=d.toLowerCase();return s.filter(F=>F.nom?.toLowerCase().includes(h))})),this.totalPages=n.totalPages,this.isLoading=!1,this.isLoadingMore=!1,this.allProductsLoaded=this.currentPage>=n.totalPages-1,console.log("Produits visibles dans autocomplete :",s)},error:n=>{console.error("Erreur r\xe9cup\xe9ration produits :",n),this.isLoading=!1,this.isLoadingMore=!1}}):console.error("ID entreprise utilisateur manquant"):console.error("Token manquant pour r\xe9cup\xe9rer les produits")},error:o=>{console.error("Erreur r\xe9cup\xe9ration token :",o),this.isLoading=!1,this.isLoadingMore=!1}})}getPrixVente(t){return t&&this.produits.find(n=>n.id===t)?.prixVente||0}getMontantTotal(t){return this.getPrixVente(t.produitId)*(t.quantite||0)}getTotalHT(){return this.confirmedLignes.reduce((n,r)=>n+this.getMontantTotal(r),0)+this.inputLignes.reduce((n,r)=>r.produitId&&r.quantite>0?n+this.getMontantTotal(r):n,0)}creerFactureProforma(){this.usersService.getValidAccessToken().subscribe({next:t=>{if(!t)return void console.error("Token manquant");if(!this.selectedClientId&&!this.selectedEntreprise)return this.errorMessage="S\xe9lectionnez un client ou une entreprise",void(this.showExistingInvoiceError=!0);const o=[...this.confirmedLignes],n=this.inputLignes[0];if(n.produitId&&n.quantite>0){if(o.some(h=>h.produitId===n.produitId))return void(this.showDuplicatePopup=!0);o.push(n)}if(0===o.length)return void alert("Ajoutez au moins un produit");const r=this.dateFacture.includes("T")?this.dateFacture.split("T")[0]:this.dateFacture,s={description:this.description,lignesFacture:o.map(d=>({produit:{id:d.produitId},quantite:d.quantite,ligneDescription:d.ligneDescription}))};if(this.dateFacture&&(s.dateFacture=r),"client"===this.typeDestinataire&&this.selectedClientId)s.client={id:this.selectedClientId};else{if("entreprise"!==this.typeDestinataire||!this.selectedEntreprise)return void console.error("Destinataire non sp\xe9cifi\xe9");s.entrepriseClient={id:this.selectedEntreprise.id}}this.factureProFormaService.creerFactureProforma(s,this.activeRemise?this.remisePourcentage:void 0,this.activeTva,this.activeRemise||this.activeTva).subscribe({next:d=>{console.log("Facture cr\xe9\xe9e avec succ\xe8s:",d),this.formStateService.clearState(),this.confirmedLignes=[],this.inputLignes=[{produitId:null,quantite:1,ligneDescription:null,isDuplicate:!1}],this.router.navigate(["/facture-proforma"])},error:d=>{this.errorMessage=("string"==typeof d.error?d.error:d.error?.message)||"Erreur lors de la cr\xe9ation : erreur inconnue",this.showExistingInvoiceError=!0}})},error:t=>{console.error("Erreur r\xe9cup\xe9ration token :",t)}})}removePendingAdjustment(t){this.pendingAdjustments.splice(t,1)}getUserInfo(){this.usersService.getUserInfo().subscribe({next:t=>{this.nomEntreprise=t.nomEntreprise,this.userEntrepriseId=t.entrepriseId,console.log("Infos utilisateur r\xe9cup\xe9r\xe9es :",t),this.getProduits()},error:t=>{console.error("Erreur lors de la r\xe9cup\xe9ration des infos utilisateur :",t)}})}onProduitChange(t,o,n){if(o.produitId=t,o.isDuplicate=!1,t){const r=this.confirmedLignes.some(h=>h.produitId===t),s=this.inputLignes.some((h,F)=>F!==n&&h.produitId===t);if(r||s)return this.duplicateIndex=n,this.showDuplicatePopup=!0,void setTimeout(()=>{o.produitId=null,o.ligneDescription=null,this.updateCalculs(),this.cdr.detectChanges()},0);const d=this.produits.find(h=>h.id===t);o.ligneDescription=d?.description||null}else o.ligneDescription=null;this.updateCalculs()}ajouterLigneFacture(t){const o=this.inputLignes[t];if(o.produitId&&o.quantite>0){if([...this.confirmedLignes,...this.inputLignes].filter(s=>s!==o).some(s=>s.produitId===o.produitId))return this.duplicateIndex=t,this.showDuplicatePopup=!0,o.isDuplicate=!0,void setTimeout(()=>o.isDuplicate=!1,500);this.confirmedLignes.push({...o}),this.inputLignes=[{produitId:null,quantite:1,ligneDescription:null,isDuplicate:!1}],this.productControl.setValue(null)}}apercuFactureProforma(){this.formStateService.saveState({typeDestinataire:this.typeDestinataire,selectedClientId:this.selectedClientId,selectedEntreprise:this.selectedEntreprise,description:this.description,inputLignes:this.inputLignes,confirmedLignes:this.confirmedLignes,activeRemise:this.activeRemise,remisePourcentage:this.remisePourcentage,activeTva:this.activeTva,clientControl:this.clientControl.value,entrepriseControl:this.entrepriseControl.value});const t=[...this.confirmedLignes.map(n=>({produit:{id:n.produitId,nom:this.getProduitNom(n.produitId)},quantite:n.quantite,ligneDescription:n.ligneDescription,prixUnitaire:this.getPrixVente(n.produitId)})),...this.inputLignes.filter(n=>n.produitId&&n.quantite>0).map(n=>({produit:{id:n.produitId,nom:this.getProduitNom(n.produitId)},quantite:n.quantite,ligneDescription:n.ligneDescription,prixUnitaire:this.getPrixVente(n.produitId)}))],o={id:0,numeroFacture:"\u2014",dateCreation:(new Date).toISOString(),siege:this.siege,description:this.description,totalHT:this.getTotalHT(),remise:this.activeRemise?this.remisePourcentage:0,tva:this.activeTva,totalFacture:this.getTotalTTC(),lignesFacture:t,client:"client"===this.typeDestinataire&&this.selectedClientId?{id:this.selectedClientId,nomComplet:this.getClientName(this.selectedClientId)}:void 0,entrepriseClient:"entreprise"===this.typeDestinataire&&this.selectedEntreprise?{id:this.selectedEntreprise.id,nom:this.selectedEntreprise.nom}:void 0};this.previewService.setPreview(o),this.router.navigate(["/facture-proforma-apercu"])}getClientName(t){const o=this.clients.find(n=>n.id===t);return o?o.nomComplet:""}getEntrepriseName(t){const o=this.entreprises.find(n=>n.id===t);return o?o.nom:""}onProduitAjoute(t){this.produits.push(t),this.inputLignes.length>0&&(this.inputLignes[0].produitId=t.id,this.inputLignes[0].ligneDescription=t.description||null,this.inputLignes[0].quantite=1,this.inputLignes[0].isDuplicate=!1,this.productControl.setValue(t),this.filteredProduits=this.productControl.valueChanges.pipe((0,_.Z)(""),(0,f.T)(o=>"string"==typeof o?o:o?.nom),(0,f.T)(o=>o?this._filterProduits(o):this.produits.slice())),this.updateCalculs(),this.cdr.detectChanges()),this.closeProductFormPanel()}onFocus(){this.productControl.value||this.productControl.setValue("")}_filterProduits(t){if(!t)return this.produits.slice();const o=t.toLowerCase();return this.produits.filter(n=>n.nom.toLowerCase().includes(o))}displayProduit(t){return t&&t.nom?t.nom:""}openProductFormPanel(){this.showProductFormPanel=!0,this.panelAnimationState="visible"}closeProductFormPanel(){this.panelAnimationState="hidden",setTimeout(()=>{this.showProductFormPanel=!1},300)}openClientFormPanel(){this.showClientFormPanel=!0,this.panelAnimationState="visible"}closeClientFormPanel(){this.panelAnimationState="hidden",setTimeout(()=>{this.showClientFormPanel=!1},300)}openEntrepriseFormPanel(){this.showEntrepriseFormPanel=!0,this.panelAnimationState="visible"}closeEntrepriseFormPanel(){this.panelAnimationState="hidden",setTimeout(()=>{this.showEntrepriseFormPanel=!1},300)}onProduitSelected(t){const o=t.option.value;if(null!==o){if(o&&o.id){const n=this.inputLignes[0];if(n.produitId=o.id,n.ligneDescription=o.description||null,n.quantite=n.quantite||1,n.isDuplicate=!1,this.confirmedLignes.some(s=>s.produitId===o.id))return this.duplicateIndex=0,this.showDuplicatePopup=!0,void setTimeout(()=>{n.produitId=null,n.ligneDescription=null,n.quantite=1,this.productControl.setValue(null),this.updateCalculs(),this.cdr.detectChanges()},0);this.productControl.setValue(o),this.updateCalculs(),this.cdr.detectChanges()}}else this.openProductFormPanel()}onClientAjoute(t){this.clients.push(t),this.clients.sort((o,n)=>(n.id??0)-(o.id??0)),this.selectedClientId=t.id,this.clientControl.setValue(t),this.filteredClients=this.clientControl.valueChanges.pipe((0,_.Z)(t),(0,f.T)(o=>"string"==typeof o?o:o?.nomComplet),(0,f.T)(o=>o?this._filterClients(o):this.clients.slice())),this.filteredClients=this.clientControl.valueChanges.pipe((0,_.Z)(""),(0,f.T)(o=>"string"==typeof o?o:o?.nomComplet),(0,f.T)(o=>o?this._filterClients(o):this.clients.slice())),this.cdr.detectChanges(),this.closeClientFormPanel()}onEntrepriseAjoute(t){this.entreprises.push(t),this.entreprises.sort((o,n)=>(n.id??0)-(o.id??0)),this.selectedEntreprise=t,this.entrepriseControl.setValue(t),this.filteredEntreprises=this.entrepriseControl.valueChanges.pipe((0,_.Z)(""),(0,f.T)(o=>"string"==typeof o?o:o?.nom),(0,f.T)(o=>o?this._filterEntreprises(o):this.entreprises.slice())),this.cdr.detectChanges()}onEntrepriseBlur(){const t=this.entrepriseControl.value;t&&"object"==typeof t&&"id"in t?this.selectedEntreprise=t:(this.selectedEntreprise=null,this.entrepriseControl.setValue(null))}getFormInit(){this.form=this.fb.group({tauxTva:[null]})}getEntrepriseInfo(){this.entrepriseService.getEntrepriseInfo().subscribe({next:t=>{this.form.patchValue({tauxTva:t.tauxTva}),console.log("data dentreprise",t)},error:t=>{console.error("Erreur lors de la r\xe9cup\xe9ration des informations de l'entreprise",t)}})}loadMoreProducts(){this.isLoadingMore||this.allProductsLoaded||!this.userEntrepriseId||(this.isLoadingMore=!0,this.currentPage++,this.usersService.getValidAccessToken().subscribe({next:t=>{if(!t)return console.error("Token manquant pour r\xe9cup\xe9rer les produits"),void(this.isLoadingMore=!1);this.produitService.getProduitsByEntrepriseIdPaginated(this.userEntrepriseId,this.currentPage,this.pageSize).subscribe({next:o=>{this.produits=[...this.produits,...o.content];const r=this.produits.filter(s=>Array.isArray(s.boutiques)&&s.boutiques.some(d=>"ENTREPOT"!==(d.typeBoutique||"").toUpperCase()));this.filteredProduits=this.productControl.valueChanges.pipe((0,_.Z)(null),(0,f.T)(s=>"string"==typeof s?s:s?.nom),(0,f.T)(s=>{if(!s)return r;const d=s.toLowerCase();return r.filter(h=>h.nom?.toLowerCase().includes(d))})),this.totalPages=o.totalPages,setTimeout(()=>{this.isLoadingMore=!1},3e3),this.allProductsLoaded=this.currentPage>=o.totalPages-1},error:o=>{console.error("Erreur chargement produits suppl\xe9mentaires",o),setTimeout(()=>{this.isLoadingMore=!1},3e3),this.currentPage--}})},error:t=>{console.error("Erreur r\xe9cup\xe9ration token :",t),this.isLoadingMore=!1}}))}onTableScroll(t){if(this.allProductsLoaded||this.isLoadingMore||!this.userEntrepriseId)return;const n=t.target;n.scrollTop+n.offsetHeight>n.scrollHeight-100&&this.loadMoreProducts()}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(k.Ix),e.rXU(V.X),e.rXU(dt.c),e.rXU(v.D),e.rXU(j.g),e.rXU(gt.Q),e.rXU(mt.H),e.rXU(e.gRc),e.rXU(D.r),e.rXU(e.gRc),e.rXU(a.ok))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-addfacture-proforma"]],decls:137,vars:56,consts:[["autoClients","matAutocomplete"],["autoEntreprises","matAutocomplete"],["autoProduits","matAutocomplete"],["tableScrollContainer",""],[1,"container_global"],["class","loading-overlay",4,"ngIf"],[1,"content_formulaire"],[1,"modal-body"],[1,"container_formulaire"],["title","Retour sur la page facture pro forma",1,"retour_icon_text",2,"cursor","pointer","color","#0672E4","margin-bottom","15px",3,"click"],[1,"ri-arrow-left-s-line"],[2,"margin-left","8px","font-size","12px"],[1,"Title"],[1,"information_cadre"],[1,"info_titre_input"],[2,"margin-bottom","8px","font-size","18px"],[1,"champ_input","champ_input2"],[1,"title_input"],["type","radio","name","typeDestinataire","value","client",3,"ngModelChange","ngModel","ngModelOptions"],[2,"margin-left","20px"],["type","radio","name","typeDestinataire","value","entreprise",3,"ngModelChange","ngModel","ngModelOptions"],[1,"champ_grid"],[4,"ngIf"],[1,"champ_input"],["for","dateFacture",2,"font-size","12px","position","relative","top","0"],["lass","input_focus","type","date","id","dateFacture","name","dateFacture",1,"input_focus",2,"position","relative","top","-21px",3,"ngModelChange","ngModel"],["type","text","id","description","name","description","placeholder","Saisis l'object",1,"input_focus2",3,"ngModelChange","ngModel","ngModelOptions"],["for","description",1,"label"],[1,"add_new_quantite_stock"],[1,"containerTable"],[1,"titleTableProduit"],[1,"title_table_name"],[1,""],["class","tr_stock","style","border-top: 1px solid #f0f2f5;",4,"ngFor","ngForOf"],["class","tr_stock","style","border-top: 1px solid #f0f2f5;",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tr_stock"],[1,"champ_input",2,"margin-right","15px"],["type","text","disabled","",1,"input_focus_type",2,"cursor","no-drop","text-align","center",3,"value"],[1,"champ_input_inventaire"],[1,"switch"],["type","checkbox",3,"ngModelChange","change","ngModel","ngModelOptions"],[1,"slider","round"],["class","double_input_grid","style","margin-top: 15px;",4,"ngIf"],[1,"double_input_ttc"],[1,"montantTTC"],[1,"information_cadre","information_cadre_save",2,"display","flex","align-items","center","justify-content","space-between"],[2,"cursor","pointer","text-align","right","margin-left","20px",3,"click"],["title","Voir l'aper\xe7u de facture proforma",1,"btn_apercu"],[1,"ri-eye-2-line"],[1,"info_titre_input","info_titre_input_btn",2,"display","flex","justify-content","flex-end","gap","10px"],[1,"btn_annuler"],["type","button",1,"btn_cancel",3,"click"],[1,"btn_ajouter"],["type","button",1,"btn_save",3,"click"],[1,"container_cadre_facture"],[1,"overlay",3,"click"],[1,"content_cadre_right",3,"click"],[1,"cadre_right"],[1,"add_produit"],[3,"produitAjoute","close",4,"ngIf"],[1,"add_client",2,"margin","10% 0 0 5%"],[3,"clientAjoute","close",4,"ngIf"],[1,"add_entreprise",2,"margin","10% 0 0 5%"],[3,"entrepriseAjoute","close"],["class","duplicate-popup",4,"ngIf"],[1,"loading-overlay"],[1,"loading-content"],[1,"spinner"],["matInput","","placeholder","S\xe9lectionner un client",1,"input_focus",3,"focus","blur","formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value"],[2,"display","flex","align-items","center","color","#0672E4"],[1,"ri-add-circle-fill",2,"font-size","20px"],[2,"margin-left","8px"],[3,"value",4,"ngFor","ngForOf"],[1,"option-content"],["matInput","","placeholder","S\xe9lectionner une entreprise",1,"input_focus",3,"focus","blur","formControl","matAutocomplete"],[1,"tr_stock",2,"border-top","1px solid #f0f2f5"],["type","text","readonly","",1,"input_focus_type",3,"value"],["type","text","readonly","","placeholder","Description",1,"input_focus_type",2,"margin-bottom","-7px","min-width","120px","resize","none",3,"value"],["type","number","readonly","",1,"input_focus_type","input_focus_type_quantite",3,"value"],["type","text","placeholder","Prix unitaire",1,"input_focus_type",2,"cursor","no-drop",3,"value"],["type","text","disabled","","id","prixTotal",1,"input_focus_type",2,"cursor","no-drop","text-align","center",3,"value"],[1,"btn_delete_icon_add",3,"click"],[1,"ri-delete-bin-5-fill"],["matInput","","placeholder","S\xe9lectionner un produit",1,"input_focus_type","input_focus_type_select",3,"focus","formControl","matAutocomplete","ngClass"],[1,"table-scroll-container",3,"scroll"],["class","loading-more-products",4,"ngIf"],["type","text","placeholder","Description",1,"input_focus_type",2,"margin-bottom","-7px","min-width","120px","resize","none",3,"ngModelChange","ngModel","ngModelOptions"],["type","number","placeholder","Quantit\xe9",1,"input_focus_type","input_focus_type_quantite",3,"ngModelChange","ngModel","ngModelOptions"],["type","text","placeholder","Prix unitaire","readonly","",1,"input_focus_type",2,"cursor","no-drop",3,"value"],["class","btn_ajouter_icon_add",3,"click",4,"ngIf"],[1,"loading-more-products"],[1,"spinner-small"],[1,"btn_ajouter_icon_add",3,"click"],[1,"ri-add-fill"],[1,"double_input_grid",2,"margin-top","15px"],["type","number","step","0.01","name","remisePourcentage","placeholder","Remise en %",1,"input_focus",3,"ngModelChange","input","ngModel"],[1,"label"],["type","text","readonly","",1,"input_focus",2,"cursor","no-drop",3,"value"],["type","text","readonly","",1,"input_focus",3,"value"],[3,"produitAjoute","close"],[3,"clientAjoute","close"],[1,"duplicate-popup"],[1,"popup-content"],[1,"modal-content-text"],[1,"modal-content-text-button",3,"click","keyup.enter"],[3,"click"]],template:function(o,n){1&o&&(e.j41(0,"div",4),e.DNE(1,_t,5,0,"div",5),e.j41(2,"div",6)(3,"div",7)(4,"form",8)(5,"p",9),e.bIt("click",function(){return n.navigateBack()}),e.nrm(6,"i",10),e.j41(7,"span",11),e.EFF(8,"Facture pro forma"),e.k0s()(),e.j41(9,"div",12)(10,"h3"),e.EFF(11,"Cr\xe9er une facture pro forma"),e.k0s()(),e.j41(12,"div",13)(13,"div",14)(14,"h5",15),e.EFF(15,"Client(e)"),e.k0s(),e.j41(16,"div",16)(17,"div",17)(18,"label")(19,"input",18),e.mxI("ngModelChange",function(s){return e.DH7(n.typeDestinataire,s)||(n.typeDestinataire=s),s}),e.k0s(),e.EFF(20," Client "),e.k0s(),e.j41(21,"label",19)(22,"input",20),e.mxI("ngModelChange",function(s){return e.DH7(n.typeDestinataire,s)||(n.typeDestinataire=s),s}),e.k0s(),e.EFF(23," Entreprise "),e.k0s()(),e.j41(24,"div",21),e.DNE(25,bt,14,7,"div",22)(26,vt,14,7,"div",22),e.j41(27,"div",23)(28,"label",24),e.EFF(29," Date de facture "),e.k0s(),e.j41(30,"input",25),e.mxI("ngModelChange",function(s){return e.DH7(n.dateFacture,s)||(n.dateFacture=s),s}),e.k0s()()()(),e.j41(31,"div",23)(32,"textarea",26),e.mxI("ngModelChange",function(s){return e.DH7(n.description,s)||(n.description=s),s}),e.k0s(),e.j41(33,"label",27),e.EFF(34,"Objet"),e.k0s()()()(),e.j41(35,"div",13)(36,"div",14)(37,"div",28)(38,"h4"),e.EFF(39,"Produits"),e.k0s()(),e.j41(40,"div",29)(41,"table")(42,"thead")(43,"tr",30)(44,"th",31),e.EFF(45,"D\xe9signation"),e.k0s(),e.j41(46,"th",32),e.EFF(47,"Description"),e.k0s(),e.j41(48,"th",32),e.EFF(49,"Quantit\xe9"),e.k0s(),e.j41(50,"th",32),e.EFF(51,"Prix Unitaire"),e.k0s(),e.j41(52,"th",32),e.EFF(53,"Montant (FCFA)"),e.k0s()()(),e.j41(54,"tbody"),e.DNE(55,xt,21,9,"tr",33),e.k0s(),e.j41(56,"tbody"),e.DNE(57,Et,32,24,"tr",34),e.k0s(),e.j41(58,"tfoot")(59,"tr",35)(60,"td")(61,"h4"),e.EFF(62,"MONTANT TOTAL HT "),e.k0s()(),e.nrm(63,"td")(64,"td")(65,"td"),e.j41(66,"td")(67,"div",36),e.nrm(68,"input",37),e.nI1(69,"customNumber"),e.k0s()(),e.nrm(70,"td"),e.k0s()()()()()(),e.j41(71,"div",13)(72,"div",14)(73,"div",38)(74,"p"),e.EFF(75,"Application de REMISE"),e.k0s(),e.j41(76,"label",39)(77,"input",40),e.mxI("ngModelChange",function(s){return e.DH7(n.activeRemise,s)||(n.activeRemise=s),s}),e.bIt("change",function(){return n.onToggleRemise()}),e.k0s(),e.nrm(78,"span",41),e.k0s()(),e.DNE(79,jt,11,5,"div",42),e.k0s()(),e.j41(80,"div",13)(81,"div",14)(82,"div",43)(83,"h4"),e.EFF(84," MONTANT COMMERCIAL "),e.k0s(),e.j41(85,"div",44),e.EFF(86),e.nI1(87,"customNumber"),e.k0s()()()(),e.j41(88,"div",13)(89,"div",14)(90,"div",38)(91,"p"),e.EFF(92,"Application de TVA"),e.k0s(),e.j41(93,"label",39)(94,"input",40),e.mxI("ngModelChange",function(s){return e.DH7(n.activeTva,s)||(n.activeTva=s),s}),e.bIt("change",function(){return n.onToggleTVA()}),e.k0s(),e.nrm(95,"span",41),e.k0s()(),e.DNE(96,yt,11,7,"div",42),e.k0s()(),e.j41(97,"div",13)(98,"div",14)(99,"div",43)(100,"h4"),e.EFF(101,"MONTANT TOTAL TTC "),e.k0s(),e.j41(102,"div",44),e.EFF(103),e.nI1(104,"customNumber"),e.k0s()()()(),e.j41(105,"div",45)(106,"div",46),e.bIt("click",function(){return n.apercuFactureProforma()}),e.j41(107,"button",47),e.EFF(108,"Aper\xe7u "),e.nrm(109,"i",48),e.k0s()(),e.j41(110,"div",49)(111,"div",50)(112,"button",51),e.bIt("click",function(){return n.goToFacture()}),e.EFF(113,"Annuler"),e.k0s()(),e.j41(114,"div",52)(115,"button",53),e.bIt("click",function(){return n.creerFactureProforma()}),e.EFF(116),e.k0s()()()()()()(),e.j41(117,"div",54)(118,"div",55),e.bIt("click",function(){return n.closeProductFormPanel()}),e.k0s(),e.j41(119,"div",56),e.bIt("click",function(s){return s.stopPropagation()}),e.j41(120,"div",57)(121,"div",58),e.DNE(122,It,1,0,"app-produit-form",59),e.k0s()()()(),e.j41(123,"div",54)(124,"div",55),e.bIt("click",function(){return n.closeClientFormPanel()}),e.k0s(),e.j41(125,"div",56),e.bIt("click",function(s){return s.stopPropagation()}),e.j41(126,"div",57)(127,"div",60),e.DNE(128,Tt,1,0,"app-client-form",61),e.k0s()()()(),e.j41(129,"div",54)(130,"div",55),e.bIt("click",function(){return n.closeEntrepriseFormPanel()}),e.k0s(),e.j41(131,"div",56),e.bIt("click",function(s){return s.stopPropagation()}),e.j41(132,"div",57)(133,"div",62)(134,"app-entreprise-form",63),e.bIt("entrepriseAjoute",function(s){return n.onEntrepriseAjoute(s)})("close",function(){return n.closeEntrepriseFormPanel()}),e.k0s()()()()()(),e.DNE(135,wt,6,0,"div",64)(136,At,6,1,"div",64)),2&o&&(e.R7$(),e.Y8G("ngIf",n.isLoading),e.R7$(18),e.R50("ngModel",n.typeDestinataire),e.Y8G("ngModelOptions",e.lJ4(51,S)),e.R7$(3),e.R50("ngModel",n.typeDestinataire),e.Y8G("ngModelOptions",e.lJ4(52,S)),e.R7$(3),e.Y8G("ngIf","client"===n.typeDestinataire),e.R7$(),e.Y8G("ngIf","entreprise"===n.typeDestinataire),e.R7$(4),e.R50("ngModel",n.dateFacture),e.R7$(2),e.R50("ngModel",n.description),e.Y8G("ngModelOptions",e.lJ4(53,S)),e.R7$(23),e.Y8G("ngForOf",n.confirmedLignes),e.R7$(2),e.Y8G("ngForOf",n.inputLignes)("ngForTrackBy",n.trackByFn),e.R7$(11),e.Y8G("value",e.bMT(69,45,n.getTotalHT())),e.R7$(9),e.R50("ngModel",n.activeRemise),e.Y8G("ngModelOptions",e.lJ4(54,S)),e.R7$(2),e.Y8G("ngIf",n.activeRemise),e.R7$(7),e.SpI(" ",e.bMT(87,47,n.getTotalCommercial())," "),e.R7$(8),e.R50("ngModel",n.activeTva),e.Y8G("ngModelOptions",e.lJ4(55,S)),e.R7$(2),e.Y8G("ngIf",n.activeTva),e.R7$(7),e.SpI(" ",e.bMT(104,49,n.getTotalTTC())," "),e.R7$(13),e.SpI(" ",n.inputLignes.length>0?"Ajouter la facture":"Cr\xe9er facture"," "),e.R7$(),e.AVh("show",n.showProductFormPanel)("slide-in","visible"===n.panelAnimationState)("slide-out","hidden"===n.panelAnimationState),e.R7$(5),e.Y8G("ngIf",n.showProductFormPanel),e.R7$(),e.AVh("show",n.showClientFormPanel)("slide-in","visible"===n.panelAnimationState)("slide-out","hidden"===n.panelAnimationState),e.R7$(5),e.Y8G("ngIf",n.showClientFormPanel),e.R7$(),e.AVh("show",n.showEntrepriseFormPanel)("slide-in","visible"===n.panelAnimationState)("slide-out","hidden"===n.panelAnimationState),e.R7$(6),e.Y8G("ngIf",n.showDuplicatePopup),e.R7$(),e.Y8G("ngIf",n.showExistingInvoiceError))},dependencies:[a.YN,a.qT,a.me,a.Q0,a.Zm,a.Fm,a.BC,a.cb,a.vS,a.cV,m.MD,m.YU,m.Sq,m.bT,m.Jj,m.QX,a.X1,a.l_,P.jL,P.$3,y.wT,P.pN,N.v,u.m_,c.c,je,He,ut],styles:['@charset "UTF-8";.container_global[_ngcontent-%COMP%]{display:grid;grid-template-columns:72% 28%;position:relative}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%]{padding:10px 0}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.title_input[_ngcontent-%COMP%]{margin-top:15px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;color:#fff;font-size:18px;z-index:1000}.name_icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.iconEntrepriseList[_ngcontent-%COMP%]{padding-left:20px}.iconEntrepriseList[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;cursor:pointer}.loading-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid white;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}.content_formulaire[_ngcontent-%COMP%]{display:flex}.Title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px}.modal-body[_ngcontent-%COMP%]{margin-right:30px}.information_cadre[_ngcontent-%COMP%]{width:100%;height:auto;background-color:#fff;box-shadow:2px 2px 30px #0000001c;border-radius:5px;margin-top:20px;margin-bottom:20px}.info_titre_etat[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:space-between;padding:20px}.etat_content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.btn_etat[_ngcontent-%COMP%]{border:none;padding:6px 20px;background-color:#00000030;color:#fff;border-radius:5px}.btn_etat[_ngcontent-%COMP%]:hover{background-color:#e9d421;transition:all ease .2s;color:#000}.active[_ngcontent-%COMP%]{background-color:#e9d421!important;border:none;padding:6px 20px;color:#000;border-radius:5px}.info_titre_input[_ngcontent-%COMP%]{padding:10px 20px}.info_titre_input[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:14px;margin-bottom:0;letter-spacing:.6px}.champ_input[_ngcontent-%COMP%]{position:relative;margin-bottom:6px;margin-right:0}.double_input_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}.input_focus[_ngcontent-%COMP%]{width:100%;min-width:250px;height:49px;outline:none;border-bottom:1px solid rgb(53,50,50);border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:14px;background:none;color:#000}.btn_apercu[_ngcontent-%COMP%]{border:none;padding:2px 20px;border-radius:5px;background-color:#d0d0d0;color:#001225}.champ_input[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:4px;pointer-events:none;color:#6b6666}.input_focus[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.input_focus[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#423838;top:0;left:0;transition:all .3s ease-in-out;background:none;font-size:11px;padding:0}.input_focus[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:12px;transition:all .2s ease-in-out}.input_focus2[_ngcontent-%COMP%]{width:100%;min-width:250px;height:70px;outline:none;border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:14px;background:none;border-radius:5px;padding-top:10px;border-bottom:1px solid rgb(53,50,50);color:#000}.input_focus2[_ngcontent-%COMP%]:hover{border-bottom:1px solid #0672E4;border-top:none;border-left:none;border-right:none}.champ_input2[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;top:22px;left:0;pointer-events:none;color:#423838}.champ_input[_ngcontent-%COMP%]   .labelCategory[_ngcontent-%COMP%]{color:#423838;left:0;font-size:14px}.input_focus2[_ngcontent-%COMP%]:not(:placeholder-shown) + .label[_ngcontent-%COMP%], .input_focus2[_ngcontent-%COMP%]:focus + .label[_ngcontent-%COMP%]{color:#423838;top:0;left:0;transition:all .3s ease-in-out;background:none;font-size:11px;padding:0}.input_focus2[_ngcontent-%COMP%]::placeholder{opacity:0}.input_focus2[_ngcontent-%COMP%]:focus::placeholder{opacity:1;animation-delay:1s;font-size:12px;transition:all .2s ease-in-out}.input_focus_type_select[_ngcontent-%COMP%]{min-width:200px}.champ_grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:1fr;grid-column-gap:0px;grid-row-gap:0px}.input_focus_type[_ngcontent-%COMP%]{width:100%;height:49px;outline:none;border-bottom:1px solid rgb(53,50,50);border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:14px;background:none;color:#000}.input_table[_ngcontent-%COMP%]{width:100%;height:49px;outline:none;border-bottom:1px solid rgb(53,50,50);border-top:none;border-left:none;border-right:none;margin:10px 0 0;transition:all .3s;font-size:14px;background:none;color:#695c5c}.add_new_quantite_stock[_ngcontent-%COMP%]{margin-bottom:20px}.add_new_quantite_stock[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.6px;color:#0000008e}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:24px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:24px}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#0672e4}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(26px)}.input_cursor[_ngcontent-%COMP%]{cursor:pointer}.icon_arrow[_ngcontent-%COMP%]{position:absolute;right:10px;top:25px}.icon_arrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:17px;color:#000}.champ_input_inventaire[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.champ_input_inventaire[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.error-message[_ngcontent-%COMP%]{font-size:10px;color:red;font-weight:700;margin-top:10px;margin-bottom:10px}.info_titre_input_btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:end;gap:20px}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]{padding:8px 30px;border:none;border-radius:5px;background-color:red;color:#fff}.btn_annuler[_ngcontent-%COMP%]   .btn_cancel[_ngcontent-%COMP%]:hover{background-color:#d80101;transition:all ease-in .5s}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]{padding:8px 30px;border:none;border-radius:5px;background-color:#0672e4;color:#fff}.btn_ajouter[_ngcontent-%COMP%]   .btn_save[_ngcontent-%COMP%]:hover{background-color:#0863c5;transition:all .5s}.containerTable[_ngcontent-%COMP%]{position:relative;background-color:#fff;border-radius:10px}.titleTableProduit[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:13px;font-weight:500}.btn_ajouter_icon_add[_ngcontent-%COMP%]{margin-left:30px}.btn_ajouter_icon_add[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px;background-color:transparent;color:#0672e4;padding:2px;border-radius:50%;cursor:pointer;border:3px solid #0672E4}.btn_ajouter_icon_add[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{background-color:#0863c50e;transition:all ease .5s}.btn_delete_icon_add[_ngcontent-%COMP%]{margin-left:30px;margin-top:10px}.btn_delete_icon_add[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;color:red;cursor:pointer}.btn_delete_icon_add[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:#ca0000;transition:all ease .5s}.champ_input_list_stock[_ngcontent-%COMP%]{display:block;position:relative;margin-bottom:6px}.double_input_ttc[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.duplicate-popup[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000;border-radius:4px;gap:15px;color:#d32f2f;animation:_ngcontent-%COMP%_shake .4s ease-in-out}.popup-content[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:10px;text-align:center;width:90%;max-width:400px;box-shadow:0 5px 15px #0000004d;animation:fadeInDown .3s ease;position:relative}.popup-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:10px;padding:8px 15px;background:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer}.modal-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.modal-content-text[_ngcontent-%COMP%]{margin:0;font-size:14px}.modal-content-text-button[_ngcontent-%COMP%]{background:none;border:1px solid #d32f2f;color:#d32f2f;padding:5px 15px;border-radius:4px;cursor:pointer;transition:all .3s}.modal-content-text-button[_ngcontent-%COMP%]:hover{background:#d32f2f;color:#fff}.input_focus_type_select.duplicate[_ngcontent-%COMP%]{border-color:#f44!important;animation:_ngcontent-%COMP%_shake .5s}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(5px)}75%{transform:translate(-5px)}}.container_cadre_facture[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:flex-end;opacity:0;visibility:hidden;transition:opacity .3s ease,visibility .3s}.container_cadre_facture.show[_ngcontent-%COMP%]{opacity:1;visibility:visible}.container_cadre_facture[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#00000080;z-index:1}.container_cadre_facture[_ngcontent-%COMP%]   .content_cadre_right[_ngcontent-%COMP%]{width:700px;height:100%;background-color:#fff;box-shadow:0 5px 15px #0000004d;position:relative;z-index:2;overflow-y:auto;transform:translate(100%);transition:transform .3s ease-in-out}.container_cadre_facture.slide-in[_ngcontent-%COMP%]   .content_cadre_right[_ngcontent-%COMP%]{transform:translate(0)}.container_cadre_facture.slide-out[_ngcontent-%COMP%]   .content_cadre_right[_ngcontent-%COMP%]{transform:translate(100%)}mat-option[_ngcontent-%COMP%]{align-items:center;background:#0000;font-size:13px;min-height:30px!important;padding:0 12px}.table-scroll-container[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;padding:8px 0}.table-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:2px;height:2px}.table-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0003;border-radius:3px}.table-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.loading-more-products[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:12px;color:#666;font-size:14px;border-top:1px solid #eee;margin-top:8px}.spinner-small[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid #f3f3f3;border-top:2px solid #0672E4;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-right:8px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']})}}return i})()}}]);