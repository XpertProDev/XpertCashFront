"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[8615],{37726:(v,h,n)=>{n.d(h,{$:()=>t});var a=n(54438),c=n(345);let t=(()=>{class o{constructor(u){this.sanitizer=u}transform(u){return this.sanitizer.bypassSecurityTrustHtml(u)}static{this.\u0275fac=function(l){return new(l||o)(a.rXU(c.up,16))}}static{this.\u0275pipe=a.EJ8({name:"safeHtml",type:o,pure:!0})}}return o})()},37788:(v,h,n)=>{n.d(h,{j:()=>t});var a=n(84412),c=n(54438);let t=(()=>{class o{constructor(){this.STORAGE_KEY="selectedBoutiqueId",this.selectedBoutiqueSubject=new a.t(this.loadInitial()),this.selectedBoutique$=this.selectedBoutiqueSubject.asObservable()}loadInitial(){const u=localStorage.getItem(this.STORAGE_KEY);if(null!==u){try{sessionStorage.setItem(this.STORAGE_KEY,u)}catch(p){console.warn("Impossible de migrer la boutique depuis localStorage",p)}localStorage.removeItem(this.STORAGE_KEY)}const l=sessionStorage.getItem(this.STORAGE_KEY);return null!==l?Number(l):null}setSelectedBoutique(u){null!==u?sessionStorage.setItem(this.STORAGE_KEY,u.toString()):sessionStorage.removeItem(this.STORAGE_KEY),this.selectedBoutiqueSubject.next(u)}getCurrentValue(){const u=sessionStorage.getItem(this.STORAGE_KEY);return null!==u?Number(u):null}static{this.\u0275fac=function(l){return new(l||o)}}static{this.\u0275prov=c.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})()},12334:(v,h,n)=>{n.d(h,{f:()=>t});var a=n(84412),c=n(54438);let t=(()=>{class o{constructor(){this.caisseCreatedSource=new a.t(null),this.refreshCaissesSource=new a.t(!1),this.showAllCaissesSource=new a.t(!1),this.caisseCreated$=this.caisseCreatedSource.asObservable(),this.refreshCaisses$=this.refreshCaissesSource.asObservable(),this.showAllCaisses$=this.showAllCaissesSource.asObservable()}notifyCaisseCreated(u){this.caisseCreatedSource.next(u)}triggerRefresh(){this.refreshCaissesSource.next(!0)}showAllCaisses(u){this.showAllCaissesSource.next(!!u),console.log("[CaisseStateService] showAllCaisses ->",!!u)}toggleShowAllCaisses(){const u=!this.showAllCaissesSource.getValue();this.showAllCaissesSource.next(u),console.log("[CaisseStateService] toggle ->",u)}getShowAllCaissesValue(){return this.showAllCaissesSource.getValue()}static{this.\u0275fac=function(l){return new(l||o)}}static{this.\u0275prov=c.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})()},74864:(v,h,n)=>{n.d(h,{U:()=>E});var a=n(21626),c=n(22525),t=n(18810),o=n(25558),d=n(99437),u=n(96354),l=n(54438),p=n(88026);let E=(()=>{class g{constructor(r,e){this.http=r,this.usersService=e,this.apiUrl=c.c.apiBaseUrl}ouvrirCaisse(r){return this.usersService.getValidAccessToken().pipe((0,o.n)(e=>{if(!e)throw new Error("Aucun token trouv\xe9");const s=new a.Lr({Authorization:`Bearer ${e}`});return this.http.post(`${this.apiUrl}/ouvrir`,r,{headers:s})}),(0,d.W)(e=>{console.error("Erreur d\xe9taill\xe9e",e);let s="Erreur lors de l'ouverture de la caisse";return e.error&&e.error.error?s=e.error.error:e.error&&e.error.message?s=e.error.message:e.message&&(s=e.message),(0,t.$)(()=>({message:s,originalError:e}))}))}fermerCaisse(r){return console.log("Tentative de r\xe9cup\xe9ration du token..."),this.usersService.getValidAccessToken().pipe((0,o.n)(e=>{if(!e)throw console.error("Aucun token trouv\xe9"),new Error("Aucun token trouv\xe9");console.log("Token r\xe9cup\xe9r\xe9 :",e);const s=new a.Lr({Authorization:`Bearer ${e}`}),A={boutiqueId:r};return console.log("Envoi de la requ\xeate POST pour fermer la caisse..."),this.http.post(`${this.apiUrl}/fermer`,A,{headers:s}).pipe((0,d.W)(_=>(console.error("Erreur lors de la requ\xeate pour fermer la caisse:",_),(0,t.$)(()=>_))))}),(0,d.W)(e=>{console.error("Erreur d\xe9taill\xe9e dans le service:",e);let s="Erreur lors de la fermeture de la caisse";return e.error&&e.error.error?s=e.error.error:e.error&&e.error.message?s=e.error.message:e.message&&(s=e.message),(0,t.$)(()=>({message:s,originalError:e}))}))}getDerniereCaisseVendeur(r){return this.usersService.getValidAccessToken().pipe((0,o.n)(e=>{if(!e)throw new Error("Aucun token trouv\xe9");const s=new a.Lr({Authorization:`Bearer ${e}`});return this.http.get(`${this.apiUrl}/caisse/derniere/${r}`,{headers:s,responseType:"text"}).pipe((0,u.T)(A=>{try{return JSON.parse(A)}catch{throw new Error(A||"R\xe9ponse serveur invalide")}}))}),(0,d.W)(e=>{let s="Erreur lors du chargement de la derni\xe8re caisse";return e instanceof Error?s=e.message:e?.error&&(s=e.error),(0,t.$)(()=>new Error(s))}))}getCaissesByBoutique(r){return this.usersService.getValidAccessToken().pipe((0,o.n)(e=>{if(!e)throw new Error("Aucun token trouv\xe9");const s=new a.Lr({Authorization:`Bearer ${e}`});return this.http.get(`${this.apiUrl}/boutique/${r}/caisses`,{headers:s})}),(0,d.W)(e=>{let s="Erreur lors du chargement des caisses";return e?.error?.error?s=e.error.error:e?.error?.message?s=e.error.message:e.message&&(s=e.message),(0,t.$)(()=>({message:s,originalError:e}))}))}getHistoriqueCaissesByVendeur(r){return this.usersService.getValidAccessToken().pipe((0,o.n)(e=>{if(!e)throw new Error("Aucun token trouv\xe9");const s=new a.Lr({Authorization:`Bearer ${e}`});return this.http.get(`${this.apiUrl}/vendeur/${r}`,{headers:s})}),(0,d.W)(e=>{let s="Erreur lors du chargement de l'historique des caisses";return e?.error?.error?s=e.error.error:e?.error?.message?s=e.error.message:e.message&&(s=e.message),(0,t.$)(()=>({message:s,originalError:e}))}))}static{this.\u0275fac=function(e){return new(e||g)(l.KVO(a.Qq),l.KVO(p.g))}}static{this.\u0275prov=l.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}}return g})()},52719:(v,h,n)=>{n.d(h,{c:()=>p});var a=n(21626),c=n(25558),t=n(18810),o=n(99437),d=n(22525),u=n(54438),l=n(88026);let p=(()=>{class E{constructor(i,r){this.http=i,this.usersService=r,this.apiUrl=d.c.apiBaseUrl}updateBoutique(i,r){return this.usersService.getValidAccessToken().pipe((0,c.n)(e=>{if(!e)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const s=new a.Lr({Authorization:`Bearer ${e}`});return this.http.put(`${this.apiUrl}/updatedBoutique/${i}`,r,{headers:s})}),(0,o.W)(e=>(console.error("Erreur lors de la mise \xe0 jour de la boutique:",e),(0,t.$)(()=>e))))}getBoutiquesByEntreprise(){return this.usersService.getValidAccessToken().pipe((0,c.n)(i=>{if(!i)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const r=new a.Lr({Authorization:`Bearer ${i}`});return this.http.get(`${this.apiUrl}/boutiqueEntreprise`,{headers:r})}),(0,o.W)(i=>(console.error("Erreur lors de la r\xe9cup\xe9ration des boutiques:",i),(0,t.$)(()=>i))))}getBoutiqueById(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.get(`${this.apiUrl}/boutique/${i}`,{headers:e})}),(0,o.W)(r=>(console.error("Erreur lors de la r\xe9cup\xe9ration de la boutique:",r),(0,t.$)(()=>r))))}activerBoutique(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.put(`${this.apiUrl}/activerBoutique/${i}`,{},{headers:e})}),(0,o.W)(r=>(console.error("Erreur lors de l'activation de la boutique:",r),(0,t.$)(()=>r))))}desactiverBoutique(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.put(`${this.apiUrl}/desactiverBoutique/${i}`,{},{headers:e})}),(0,o.W)(r=>(console.error("Erreur lors de la d\xe9sactivation de la boutique:",r),(0,t.$)(()=>r))))}deleteBoutique(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.delete(`${this.apiUrl}/boutique/${i}`,{headers:e})}),(0,o.W)(r=>(console.error("Erreur lors de la suppression de la boutique:",r),(0,t.$)(()=>r))))}getProductsByBoutiqueId(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.get(`${this.apiUrl}/boutique/${i}/produits`,{headers:e})}),(0,o.W)(r=>(console.error("Erreur lors de la r\xe9cup\xe9ration des produits:",r),(0,t.$)(()=>r))))}copierProduits(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/copier-produits`,i,{headers:e,responseType:"json"})}),(0,o.W)(r=>{if(r.error&&"string"==typeof r.error)try{const e=JSON.parse(r.error);return(0,t.$)(()=>e)}catch{return(0,t.$)(()=>({message:r.error}))}return(0,t.$)(()=>r)}))}mettreEnCorbeille(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.delete(`${this.apiUrl}/corbeille/${i}`,{headers:e})}),(0,o.W)(r=>{let e="Erreur lors de la mise en corbeille";return r.error?.message?e=r.error.message:r.message&&(e=r.message),(0,t.$)(()=>new Error(e))}))}associateUserToBoutique(i,r){return this.http.post(`${this.apiUrl}/boutiques/${i}/users/${r}`,{})}assignerVendeur(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/assigner-vendeur`,i,{headers:e})}),(0,o.W)(r=>(console.error("Erreur lors de l'assignation du vendeur:",r),(0,t.$)(()=>r))))}retirerVendeur(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/retirer-vendeur`,i,{headers:e})}),(0,o.W)(r=>(console.error("Erreur lors de l'assignation du vendeur:",r),(0,t.$)(()=>r))))}getVendeursDeBoutique(i){return this.usersService.getValidAccessToken().pipe((0,c.n)(r=>{if(!r)return console.error("Aucun token trouv\xe9"),(0,t.$)(()=>new Error("Aucun token trouv\xe9"));const e=new a.Lr({Authorization:`Bearer ${r}`});return this.http.get(`${this.apiUrl}/vendeurs/${i}`,{headers:e}).pipe((0,o.W)(s=>(console.error("Erreur lors de la r\xe9cup\xe9ration des vendeurs:",s),(0,t.$)(()=>s))))}))}static{this.\u0275fac=function(r){return new(r||E)(u.KVO(a.Qq),u.KVO(l.g))}}static{this.\u0275prov=u.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}}return E})()}}]);